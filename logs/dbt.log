[0m20:48:47.859702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002079FC97E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207A00D0F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207A031F290>]}


============================== 20:48:47.875762 | 38403ac9-ee2a-429c-90f8-45a40514bd3f ==============================
[0m20:48:47.875762 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:48:47.875762 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m20:48:47.902365 [info ] [MainThread]: dbt version: 1.10.15
[0m20:48:47.902365 [info ] [MainThread]: python version: 3.12.8
[0m20:48:47.902365 [info ] [MainThread]: python path: C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\.venv\Scripts\python.exe
[0m20:48:47.902365 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m20:48:48.152241 [info ] [MainThread]: Using profiles dir at C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main
[0m20:48:48.152241 [info ] [MainThread]: Using profiles.yml file at C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\profiles.yml
[0m20:48:48.152241 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\dbt_project.yml
[0m20:48:48.194109 [info ] [MainThread]: adapter type: duckdb
[0m20:48:48.194109 [info ] [MainThread]: adapter version: 1.10.0
[0m20:48:48.268860 [info ] [MainThread]: Configuration:
[0m20:48:48.268860 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:48:48.268860 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:48:48.268860 [info ] [MainThread]: Required dependencies:
[0m20:48:48.268860 [debug] [MainThread]: Executing "git --help"
[0m20:48:48.319714 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:48:48.327016 [debug] [MainThread]: STDERR: "b''"
[0m20:48:48.327016 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:48:48.328157 [info ] [MainThread]: Connection:
[0m20:48:48.328157 [info ] [MainThread]:   database: takehome
[0m20:48:48.329118 [info ] [MainThread]:   schema: dev
[0m20:48:48.330097 [info ] [MainThread]:   path: takehome.duckdb
[0m20:48:48.330097 [info ] [MainThread]:   config_options: None
[0m20:48:48.331079 [info ] [MainThread]:   extensions: None
[0m20:48:48.332106 [info ] [MainThread]:   settings: {}
[0m20:48:48.332106 [info ] [MainThread]:   external_root: .
[0m20:48:48.332106 [info ] [MainThread]:   use_credential_provider: None
[0m20:48:48.333069 [info ] [MainThread]:   attach: None
[0m20:48:48.333069 [info ] [MainThread]:   filesystems: None
[0m20:48:48.333069 [info ] [MainThread]:   remote: None
[0m20:48:48.334109 [info ] [MainThread]:   plugins: None
[0m20:48:48.334109 [info ] [MainThread]:   disable_transactions: False
[0m20:48:48.335100 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:48:48.463848 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m20:48:57.132641 [debug] [MainThread]: Using duckdb connection "debug"
[0m20:48:57.133886 [debug] [MainThread]: On debug: select 1 as id
[0m20:48:57.133886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:57.192528 [debug] [MainThread]: SQL status: OK in 0.058 seconds
[0m20:48:57.192528 [debug] [MainThread]: On debug: Close
[0m20:48:57.192528 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:48:57.192528 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:48:57.192528 [debug] [MainThread]: Command `dbt debug` succeeded at 20:48:57.192528 after 9.66 seconds
[0m20:48:57.192528 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:48:57.192528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002079DCC8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207A093FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002079FD49FA0>]}
[0m20:48:57.192528 [debug] [MainThread]: Flushing usage events
[0m20:48:57.858175 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:38.258851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C2AB6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C081D760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C2948CB0>]}


============================== 20:53:38.258851 | 426bd578-5b82-4dab-a645-c4940c62613c ==============================
[0m20:53:38.258851 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:53:38.258851 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'write_json': 'True', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m20:53:38.272400 [info ] [MainThread]: dbt version: 1.10.15
[0m20:53:38.272400 [info ] [MainThread]: python version: 3.12.8
[0m20:53:38.272400 [info ] [MainThread]: python path: C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\.venv\Scripts\python.exe
[0m20:53:38.272400 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m20:53:38.364731 [info ] [MainThread]: Using profiles dir at C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main
[0m20:53:38.364731 [info ] [MainThread]: Using profiles.yml file at C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\profiles.yml
[0m20:53:38.364731 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\dbt_project.yml
[0m20:53:38.364731 [info ] [MainThread]: adapter type: duckdb
[0m20:53:38.364731 [info ] [MainThread]: adapter version: 1.10.0
[0m20:53:38.461675 [info ] [MainThread]: Configuration:
[0m20:53:38.462702 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:53:38.462702 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:53:38.463665 [info ] [MainThread]: Required dependencies:
[0m20:53:38.463665 [debug] [MainThread]: Executing "git --help"
[0m20:53:38.507160 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:53:38.507160 [debug] [MainThread]: STDERR: "b''"
[0m20:53:38.507160 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:53:38.507160 [info ] [MainThread]: Connection:
[0m20:53:38.507160 [info ] [MainThread]:   database: takehome
[0m20:53:38.507160 [info ] [MainThread]:   schema: dev
[0m20:53:38.507160 [info ] [MainThread]:   path: takehome.duckdb
[0m20:53:38.507160 [info ] [MainThread]:   config_options: None
[0m20:53:38.507160 [info ] [MainThread]:   extensions: None
[0m20:53:38.507160 [info ] [MainThread]:   settings: {}
[0m20:53:38.507160 [info ] [MainThread]:   external_root: .
[0m20:53:38.507160 [info ] [MainThread]:   use_credential_provider: None
[0m20:53:38.507160 [info ] [MainThread]:   attach: None
[0m20:53:38.507160 [info ] [MainThread]:   filesystems: None
[0m20:53:38.507160 [info ] [MainThread]:   remote: None
[0m20:53:38.507160 [info ] [MainThread]:   plugins: None
[0m20:53:38.507160 [info ] [MainThread]:   disable_transactions: False
[0m20:53:38.507160 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:53:38.645445 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m20:53:38.687996 [debug] [MainThread]: Using duckdb connection "debug"
[0m20:53:38.688989 [debug] [MainThread]: On debug: select 1 as id
[0m20:53:38.688989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:53:38.711286 [debug] [MainThread]: SQL status: OK in 0.023 seconds
[0m20:53:38.712673 [debug] [MainThread]: On debug: Close
[0m20:53:38.714685 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:53:38.715267 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:53:38.716278 [debug] [MainThread]: Command `dbt debug` succeeded at 20:53:38.716278 after 0.63 seconds
[0m20:53:38.717342 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:53:38.717342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C4DD86B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C5397B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260C2948CB0>]}
[0m20:53:38.718338 [debug] [MainThread]: Flushing usage events
[0m20:53:39.474775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:03:24.381952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214FF7C61B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021481604A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214FE581E50>]}


============================== 21:03:24.389395 | ad6920c8-99aa-48b7-8796-0b8581881b84 ==============================
[0m21:03:24.389395 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:03:24.390237 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt run', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m21:03:24.646837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad6920c8-99aa-48b7-8796-0b8581881b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021482826810>]}
[0m21:03:24.679176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad6920c8-99aa-48b7-8796-0b8581881b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148164F1A0>]}
[0m21:03:24.679176 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:03:24.854649 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:03:24.854649 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:03:24.854649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ad6920c8-99aa-48b7-8796-0b8581881b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214FFFCAFF0>]}
[0m21:03:29.336534 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome.marts
[0m21:03:29.343477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad6920c8-99aa-48b7-8796-0b8581881b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021483232420>]}
[0m21:03:29.403465 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:03:29.403465 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:03:29.435472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad6920c8-99aa-48b7-8796-0b8581881b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214833C1160>]}
[0m21:03:29.435472 [info ] [MainThread]: Found 3 models, 2 data tests, 1 source, 468 macros
[0m21:03:29.435472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad6920c8-99aa-48b7-8796-0b8581881b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214FE839400>]}
[0m21:03:29.435472 [info ] [MainThread]: 
[0m21:03:29.435472 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:03:29.435472 [info ] [MainThread]: 
[0m21:03:29.435472 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:03:29.435472 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:03:29.451579 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:03:29.454381 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:03:29.493279 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:03:29.493279 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:03:29.493279 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:03:29.493279 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:03:29.493279 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:03:29.493279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:29.493279 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:03:29.493279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:29.493279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:29.511326 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:03:29.512341 [debug] [ThreadPool]: On list_takehome: Close
[0m21:03:29.513405 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:03:29.513405 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m21:03:29.514372 [debug] [ThreadPool]: On list_takehome: Close
[0m21:03:29.515384 [debug] [ThreadPool]: On list_takehome: Close
[0m21:03:29.516276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev)
[0m21:03:29.516276 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev"
"
[0m21:03:29.517365 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:03:29.517365 [debug] [ThreadPool]: On create_takehome_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:03:29.517365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:29.517365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m21:03:29.517365 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m21:03:29.517365 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:03:29.517365 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:03:29.517365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:29.517365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m21:03:29.517365 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m21:03:29.517365 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:03:29.517365 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:03:29.517365 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:03:29.517365 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:03:29.517365 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:03:29.517365 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:03:29.517365 [debug] [ThreadPool]: On create_takehome_dev: BEGIN
[0m21:03:29.517365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:03:29.517365 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m21:03:29.517365 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:03:29.517365 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:03:29.517365 [debug] [ThreadPool]: On create_takehome_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev"} */

    
    
        create schema if not exists "takehome"."dev"
    
[0m21:03:29.517365 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:03:29.517365 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:03:29.533348 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:03:29.533348 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:03:29.533348 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m21:03:29.533348 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:03:29.533348 [debug] [ThreadPool]: On create_takehome_dev: COMMIT
[0m21:03:29.533348 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m21:03:29.533348 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:03:29.533348 [debug] [ThreadPool]: On create_takehome_dev: COMMIT
[0m21:03:29.533348 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:03:29.533348 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m21:03:29.533348 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:03:29.533348 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:03:29.533348 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:03:29.533348 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m21:03:29.533348 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m21:03:29.533348 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:03:29.533348 [debug] [ThreadPool]: On create_takehome_dev: Close
[0m21:03:29.533348 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:03:29.533348 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m21:03:29.533348 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:03:29.533348 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m21:03:29.533348 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:03:29.533348 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m21:03:29.533348 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:03:29.533348 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m21:03:29.549470 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev'
[0m21:03:29.549470 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev"
[0m21:03:29.549470 [debug] [ThreadPool]: On list_takehome_dev: BEGIN
[0m21:03:29.549470 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m21:03:29.549470 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m21:03:29.549470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:29.549470 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:03:29.549470 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:03:29.549470 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m21:03:29.549470 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m21:03:29.549470 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:03:29.549470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:29.549470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:03:29.549470 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev"
[0m21:03:29.549470 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:03:29.549470 [debug] [ThreadPool]: On list_takehome_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev'
    and lower(table_catalog) = 'takehome'
  
[0m21:03:29.549470 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:03:29.549470 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:03:29.549470 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:03:29.549470 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m21:03:29.549470 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m21:03:29.565491 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m21:03:29.565491 [debug] [ThreadPool]: On list_takehome_dev: ROLLBACK
[0m21:03:29.565491 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m21:03:29.565491 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m21:03:29.565491 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:03:29.565491 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m21:03:29.565491 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev'
[0m21:03:29.565491 [debug] [ThreadPool]: On list_takehome_dev: Close
[0m21:03:29.565491 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m21:03:29.565491 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m21:03:29.565491 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m21:03:29.565491 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m21:03:29.581542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad6920c8-99aa-48b7-8796-0b8581881b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214FE783A70>]}
[0m21:03:29.581542 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:29.581542 [debug] [MainThread]: On master: BEGIN
[0m21:03:29.581542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:03:29.581542 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:03:29.581542 [debug] [MainThread]: On master: COMMIT
[0m21:03:29.581542 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:29.581542 [debug] [MainThread]: On master: COMMIT
[0m21:03:29.581542 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:03:29.581542 [debug] [MainThread]: On master: Close
[0m21:03:29.597351 [debug] [Thread-1 (]: Began running node model.takehome.stg_patients
[0m21:03:29.597351 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_staging.stg_patients ........................... [RUN]
[0m21:03:29.597351 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_patients'
[0m21:03:29.597351 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_patients
[0m21:03:29.597351 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m21:03:29.613320 [debug] [Thread-1 (]: Began executing node model.takehome.stg_patients
[0m21:03:29.637232 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m21:03:29.637232 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:03:29.637232 [debug] [Thread-1 (]: On model.takehome.stg_patients: BEGIN
[0m21:03:29.637232 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:03:29.637232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:03:29.637232 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:03:29.637232 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    SELECT
    *,
    null as updated_at,
    id as patient_id
from "takehome"."raw"."patients"
  );

[0m21:03:29.637232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:03:29.648268 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:03:29.648268 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m21:03:29.649268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:03:29.656312 [debug] [Thread-1 (]: On model.takehome.stg_patients: COMMIT
[0m21:03:29.656312 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:03:29.656312 [debug] [Thread-1 (]: On model.takehome.stg_patients: COMMIT
[0m21:03:29.658227 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:03:29.662240 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:03:29.662240 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

      drop view if exists "takehome"."dev_staging"."stg_patients__dbt_backup" cascade
    
[0m21:03:29.662240 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:03:29.662240 [debug] [Thread-1 (]: On model.takehome.stg_patients: Close
[0m21:03:29.662240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad6920c8-99aa-48b7-8796-0b8581881b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021483861A90>]}
[0m21:03:29.662240 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev_staging.stg_patients ...................... [[32mOK[0m in 0.06s]
[0m21:03:29.662240 [debug] [Thread-1 (]: Finished running node model.takehome.stg_patients
[0m21:03:29.662240 [debug] [Thread-3 (]: Began running node model.takehome.patients
[0m21:03:29.662240 [info ] [Thread-3 (]: 2 of 3 START sql table model dev_bronze.patients ............................... [RUN]
[0m21:03:29.662240 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.patients'
[0m21:03:29.662240 [debug] [Thread-3 (]: Began compiling node model.takehome.patients
[0m21:03:29.662240 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.patients"
[0m21:03:29.662240 [debug] [Thread-3 (]: Began executing node model.takehome.patients
[0m21:03:29.687127 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.patients"
[0m21:03:29.688503 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:03:29.689521 [debug] [Thread-3 (]: On model.takehome.patients: BEGIN
[0m21:03:29.689521 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:03:29.690519 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:03:29.690519 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:03:29.691323 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      

with 

pt as ( select * from "takehome"."dev_staging"."stg_patients" )

select
    *
    
from pt

qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m21:03:29.707099 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m21:03:29.710099 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:03:29.710099 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients__dbt_tmp" rename to "patients"
[0m21:03:29.711099 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:03:29.714892 [debug] [Thread-3 (]: On model.takehome.patients: COMMIT
[0m21:03:29.714892 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:03:29.714892 [debug] [Thread-3 (]: On model.takehome.patients: COMMIT
[0m21:03:29.718929 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m21:03:29.720893 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:03:29.720893 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

      drop table if exists "takehome"."dev_bronze"."patients__dbt_backup" cascade
    
[0m21:03:29.720893 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:03:29.720893 [debug] [Thread-3 (]: On model.takehome.patients: Close
[0m21:03:29.720893 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad6920c8-99aa-48b7-8796-0b8581881b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214837FFD10>]}
[0m21:03:29.720893 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev_bronze.patients .......................... [[32mOK[0m in 0.06s]
[0m21:03:29.720893 [debug] [Thread-3 (]: Finished running node model.takehome.patients
[0m21:03:29.720893 [debug] [Thread-2 (]: Began running node model.takehome.patients_by_age
[0m21:03:29.720893 [info ] [Thread-2 (]: 3 of 3 START sql view model dev.patients_by_age ................................ [RUN]
[0m21:03:29.720893 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.takehome.patients_by_age'
[0m21:03:29.720893 [debug] [Thread-2 (]: Began compiling node model.takehome.patients_by_age
[0m21:03:29.720893 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.patients_by_age"
[0m21:03:29.720893 [debug] [Thread-2 (]: Began executing node model.takehome.patients_by_age
[0m21:03:29.720893 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.patients_by_age"
[0m21:03:29.720893 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:03:29.720893 [debug] [Thread-2 (]: On model.takehome.patients_by_age: BEGIN
[0m21:03:29.720893 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:03:29.720893 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:03:29.720893 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:03:29.720893 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

  
  create view "takehome"."dev"."patients_by_age__dbt_tmp" as (
    /*
    This model should work.
*/


with

pt as ( select * from "takehome"."dev_bronze"."patients" ),

pt_age as (

    select
        patient_id, 
        datediff('years', pt.date_of_birth, current_date()) as age_years

    from pt

)

select 
    age_years, 
    count(distinct patient_id) as patient_count

from pt_age

group by age_years
  );

[0m21:03:29.720893 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:03:29.740663 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:03:29.741815 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter view "takehome"."dev"."patients_by_age__dbt_tmp" rename to "patients_by_age"
[0m21:03:29.742564 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:03:29.743403 [debug] [Thread-2 (]: On model.takehome.patients_by_age: COMMIT
[0m21:03:29.744951 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:03:29.745509 [debug] [Thread-2 (]: On model.takehome.patients_by_age: COMMIT
[0m21:03:29.747977 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:03:29.750993 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:03:29.750993 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

      drop view if exists "takehome"."dev"."patients_by_age__dbt_backup" cascade
    
[0m21:03:29.751993 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:03:29.753000 [debug] [Thread-2 (]: On model.takehome.patients_by_age: Close
[0m21:03:29.753775 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad6920c8-99aa-48b7-8796-0b8581881b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148487F440>]}
[0m21:03:29.753775 [info ] [Thread-2 (]: 3 of 3 OK created sql view model dev.patients_by_age ........................... [[32mOK[0m in 0.03s]
[0m21:03:29.755785 [debug] [Thread-2 (]: Finished running node model.takehome.patients_by_age
[0m21:03:29.757429 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:29.757429 [debug] [MainThread]: On master: BEGIN
[0m21:03:29.757429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:03:29.759953 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:03:29.759953 [debug] [MainThread]: On master: COMMIT
[0m21:03:29.759953 [debug] [MainThread]: Using duckdb connection "master"
[0m21:03:29.759953 [debug] [MainThread]: On master: COMMIT
[0m21:03:29.761965 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:03:29.761965 [debug] [MainThread]: On master: Close
[0m21:03:29.761965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:03:29.761965 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m21:03:29.763092 [debug] [MainThread]: Connection 'create_takehome_dev' was properly closed.
[0m21:03:29.763092 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m21:03:29.763092 [debug] [MainThread]: Connection 'list_takehome_dev' was properly closed.
[0m21:03:29.763092 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m21:03:29.763092 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m21:03:29.763092 [debug] [MainThread]: Connection 'model.takehome.stg_patients' was properly closed.
[0m21:03:29.764482 [debug] [MainThread]: Connection 'model.takehome.patients' was properly closed.
[0m21:03:29.764482 [debug] [MainThread]: Connection 'model.takehome.patients_by_age' was properly closed.
[0m21:03:29.764482 [info ] [MainThread]: 
[0m21:03:29.764482 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m21:03:29.765520 [debug] [MainThread]: Command end result
[0m21:03:29.781638 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:03:29.783671 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:03:29.789106 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m21:03:29.790104 [info ] [MainThread]: 
[0m21:03:29.790104 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:03:29.790104 [info ] [MainThread]: 
[0m21:03:29.790104 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:03:29.790104 [debug] [MainThread]: Command `dbt run` succeeded at 21:03:29.790104 after 5.58 seconds
[0m21:03:29.790104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214FF6CF5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002148296D970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021483758C50>]}
[0m21:03:29.790104 [debug] [MainThread]: Flushing usage events
[0m21:03:30.410071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:40.566804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F7556BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F53C2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F57A5100>]}


============================== 21:18:40.566804 | 166c3e2f-0268-4904-981e-ca46910de588 ==============================
[0m21:18:40.566804 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:18:40.566804 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'invocation_command': 'dbt run', 'warn_error': 'None', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m21:18:40.729318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '166c3e2f-0268-4904-981e-ca46910de588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F97B28D0>]}
[0m21:18:40.777650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '166c3e2f-0268-4904-981e-ca46910de588', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F860FC20>]}
[0m21:18:40.784904 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:18:40.914883 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:18:41.059166 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at dbt/models\dbt_project.yml is invalid because the value of 'models' is not a list
[0m21:18:41.059166 [debug] [MainThread]: Command `dbt run` failed at 21:18:41.059166 after 0.80 seconds
[0m21:18:41.059166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F52C7E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F9BBBC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F9BBBDA0>]}
[0m21:18:41.059166 [debug] [MainThread]: Flushing usage events
[0m21:18:41.545857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:24.617740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1DD14C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1C0CFB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1FFAF470>]}


============================== 21:19:24.633663 | f4af46a2-121e-4117-a17f-143b493dd1fb ==============================
[0m21:19:24.633663 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:19:24.633663 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m21:19:24.818385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4af46a2-121e-4117-a17f-143b493dd1fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA204CEA50>]}
[0m21:19:24.850573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4af46a2-121e-4117-a17f-143b493dd1fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA20361E20>]}
[0m21:19:24.850573 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:19:24.971431 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:19:25.106914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:19:25.106914 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\_stg_sources.yml
[0m21:19:25.106914 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\_stg_models.yml
[0m21:19:25.106914 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\stg_patients.sql
[0m21:19:25.449289 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome.marts
[0m21:19:25.449289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4af46a2-121e-4117-a17f-143b493dd1fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA221F74A0>]}
[0m21:19:25.501752 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:19:25.501752 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:19:25.541217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4af46a2-121e-4117-a17f-143b493dd1fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA21DC78F0>]}
[0m21:19:25.541217 [info ] [MainThread]: Found 3 models, 4 data tests, 8 sources, 468 macros
[0m21:19:25.541217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4af46a2-121e-4117-a17f-143b493dd1fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA21A93380>]}
[0m21:19:25.541217 [info ] [MainThread]: 
[0m21:19:25.541217 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:19:25.541217 [info ] [MainThread]: 
[0m21:19:25.541217 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:19:25.547292 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:19:25.608456 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:19:25.612447 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:19:25.645933 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:19:25.645933 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:19:25.645933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:25.645933 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:19:25.645933 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:19:25.645933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:25.645933 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:19:25.645933 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:19:25.645933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:25.688152 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m21:19:25.688152 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m21:19:25.688152 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m21:19:25.688152 [debug] [ThreadPool]: On list_takehome: Close
[0m21:19:25.688152 [debug] [ThreadPool]: On list_takehome: Close
[0m21:19:25.688152 [debug] [ThreadPool]: On list_takehome: Close
[0m21:19:25.688152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev)
[0m21:19:25.688152 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev"
"
[0m21:19:25.699848 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:19:25.699848 [debug] [ThreadPool]: On create_takehome_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:19:25.699848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:25.699848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m21:19:25.699848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m21:19:25.699848 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m21:19:25.699848 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:19:25.699848 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m21:19:25.703866 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:19:25.703866 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:19:25.703866 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:19:25.703866 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:19:25.703866 [debug] [ThreadPool]: On create_takehome_dev: BEGIN
[0m21:19:25.703866 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:19:25.703866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:25.703866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:25.703866 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:19:25.703866 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:19:25.703866 [debug] [ThreadPool]: On create_takehome_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev"} */

    
    
        create schema if not exists "takehome"."dev"
    
[0m21:19:25.703866 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:19:25.703866 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:19:25.703866 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:19:25.703866 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:19:25.703866 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:19:25.703866 [debug] [ThreadPool]: On create_takehome_dev: COMMIT
[0m21:19:25.703866 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m21:19:25.703866 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m21:19:25.703866 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:19:25.703866 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:19:25.703866 [debug] [ThreadPool]: On create_takehome_dev: COMMIT
[0m21:19:25.703866 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:19:25.703866 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:19:25.703866 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:19:25.703866 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m21:19:25.703866 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:19:25.703866 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m21:19:25.703866 [debug] [ThreadPool]: On create_takehome_dev: Close
[0m21:19:25.703866 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:19:25.719923 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m21:19:25.719923 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:19:25.719923 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:19:25.719923 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m21:19:25.719923 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m21:19:25.719923 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:19:25.719923 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m21:19:25.719923 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:19:25.719923 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m21:19:25.719923 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:19:25.719923 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m21:19:25.719923 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev'
[0m21:19:25.727947 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev"
[0m21:19:25.727947 [debug] [ThreadPool]: On list_takehome_dev: BEGIN
[0m21:19:25.727947 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m21:19:25.727947 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m21:19:25.727947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:25.727947 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:19:25.727947 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:19:25.727947 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m21:19:25.727947 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m21:19:25.727947 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:19:25.727947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:25.727947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:25.727947 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev"
[0m21:19:25.727947 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:19:25.727947 [debug] [ThreadPool]: On list_takehome_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev'
    and lower(table_catalog) = 'takehome'
  
[0m21:19:25.727947 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:19:25.727947 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:19:25.735725 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:19:25.735725 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m21:19:25.735725 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m21:19:25.745756 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m21:19:25.745756 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m21:19:25.745756 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m21:19:25.745756 [debug] [ThreadPool]: On list_takehome_dev: ROLLBACK
[0m21:19:25.745756 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:19:25.745756 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev'
[0m21:19:25.745756 [debug] [ThreadPool]: On list_takehome_dev: Close
[0m21:19:25.745756 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m21:19:25.745756 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m21:19:25.745756 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m21:19:25.751815 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m21:19:25.751815 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m21:19:25.751815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4af46a2-121e-4117-a17f-143b493dd1fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA21F07350>]}
[0m21:19:25.751815 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:25.751815 [debug] [MainThread]: On master: BEGIN
[0m21:19:25.751815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:25.751815 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:19:25.751815 [debug] [MainThread]: On master: COMMIT
[0m21:19:25.751815 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:25.751815 [debug] [MainThread]: On master: COMMIT
[0m21:19:25.755966 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:19:25.755966 [debug] [MainThread]: On master: Close
[0m21:19:25.757973 [debug] [Thread-1 (]: Began running node model.takehome.stg_patients
[0m21:19:25.757973 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_staging.stg_patients ........................... [RUN]
[0m21:19:25.757973 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_patients'
[0m21:19:25.757973 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_patients
[0m21:19:25.757973 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m21:19:25.767643 [debug] [Thread-1 (]: Began executing node model.takehome.stg_patients
[0m21:19:25.791309 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m21:19:25.792420 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:19:25.793391 [debug] [Thread-1 (]: On model.takehome.stg_patients: BEGIN
[0m21:19:25.793391 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:19:25.794388 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:19:25.794388 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:19:25.794388 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id as patient_id,
    *
from "takehome"."raw"."patients"
  );

[0m21:19:25.795406 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:19:25.799733 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:19:25.799733 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m21:19:25.799733 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:19:25.802018 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:19:25.803017 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m21:19:25.803017 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:19:25.810054 [debug] [Thread-1 (]: On model.takehome.stg_patients: COMMIT
[0m21:19:25.812060 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:19:25.812060 [debug] [Thread-1 (]: On model.takehome.stg_patients: COMMIT
[0m21:19:25.812060 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:19:25.819634 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:19:25.819634 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

      drop view if exists "takehome"."dev_staging"."stg_patients__dbt_backup" cascade
    
[0m21:19:25.819634 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:19:25.823682 [debug] [Thread-1 (]: On model.takehome.stg_patients: Close
[0m21:19:25.825688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4af46a2-121e-4117-a17f-143b493dd1fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA224BF5F0>]}
[0m21:19:25.825688 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev_staging.stg_patients ...................... [[32mOK[0m in 0.07s]
[0m21:19:25.825688 [debug] [Thread-1 (]: Finished running node model.takehome.stg_patients
[0m21:19:25.825688 [debug] [Thread-3 (]: Began running node model.takehome.patients
[0m21:19:25.825688 [info ] [Thread-3 (]: 2 of 3 START sql table model dev_bronze.patients ............................... [RUN]
[0m21:19:25.825688 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.patients'
[0m21:19:25.825688 [debug] [Thread-3 (]: Began compiling node model.takehome.patients
[0m21:19:25.825688 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.patients"
[0m21:19:25.825688 [debug] [Thread-3 (]: Began executing node model.takehome.patients
[0m21:19:25.844851 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.patients"
[0m21:19:25.845851 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:19:25.845851 [debug] [Thread-3 (]: On model.takehome.patients: BEGIN
[0m21:19:25.845851 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:19:25.845851 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:19:25.845851 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:19:25.845851 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      

with 

pt as ( select * from "takehome"."dev_staging"."stg_patients" )

select
    *
    
from pt

qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m21:19:25.849944 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      

with 

pt as ( select * from "takehome"."dev_staging"."stg_patients" )

select
    *
    
from pt

qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m21:19:25.849944 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m21:19:25.849944 [debug] [Thread-3 (]: On model.takehome.patients: ROLLBACK
[0m21:19:25.867353 [debug] [Thread-3 (]: Failed to rollback 'model.takehome.patients'
[0m21:19:25.867353 [debug] [Thread-3 (]: On model.takehome.patients: Close
[0m21:19:25.867353 [debug] [Thread-3 (]: Runtime Error in model patients (dbt/models\intermediate\patients.sql)
  Binder Error: Referenced column updated_at not found in FROM clause and can't find in alias map.
  
  LINE 24:     order by updated_at desc
                        ^
[0m21:19:25.867353 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4af46a2-121e-4117-a17f-143b493dd1fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1D52ADE0>]}
[0m21:19:25.874717 [error] [Thread-3 (]: 2 of 3 ERROR creating sql table model dev_bronze.patients ...................... [[31mERROR[0m in 0.04s]
[0m21:19:25.875724 [debug] [Thread-3 (]: Finished running node model.takehome.patients
[0m21:19:25.875724 [debug] [Thread-7 (]: Marking all children of 'model.takehome.patients' to be skipped because of status 'error'.  Reason: Runtime Error in model patients (dbt/models\intermediate\patients.sql)
  Binder Error: Referenced column updated_at not found in FROM clause and can't find in alias map.
  
  LINE 24:     order by updated_at desc
                        ^.
[0m21:19:25.876724 [debug] [Thread-2 (]: Began running node model.takehome.patients_by_age
[0m21:19:25.876724 [info ] [Thread-2 (]: 3 of 3 SKIP relation dev.patients_by_age ....................................... [[33mSKIP[0m]
[0m21:19:25.877866 [debug] [Thread-2 (]: Finished running node model.takehome.patients_by_age
[0m21:19:25.879896 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:25.879896 [debug] [MainThread]: On master: BEGIN
[0m21:19:25.879896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:19:25.880913 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:19:25.880913 [debug] [MainThread]: On master: COMMIT
[0m21:19:25.880913 [debug] [MainThread]: Using duckdb connection "master"
[0m21:19:25.880913 [debug] [MainThread]: On master: COMMIT
[0m21:19:25.880913 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:19:25.881912 [debug] [MainThread]: On master: Close
[0m21:19:25.881912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:25.881912 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m21:19:25.881912 [debug] [MainThread]: Connection 'create_takehome_dev' was properly closed.
[0m21:19:25.881912 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m21:19:25.882913 [debug] [MainThread]: Connection 'list_takehome_dev' was properly closed.
[0m21:19:25.882913 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m21:19:25.882913 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m21:19:25.882913 [debug] [MainThread]: Connection 'model.takehome.stg_patients' was properly closed.
[0m21:19:25.882913 [debug] [MainThread]: Connection 'model.takehome.patients' was properly closed.
[0m21:19:25.884141 [info ] [MainThread]: 
[0m21:19:25.884141 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m21:19:25.884141 [debug] [MainThread]: Command end result
[0m21:19:25.902669 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:19:25.904675 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:19:25.910772 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m21:19:25.910772 [info ] [MainThread]: 
[0m21:19:25.911771 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:19:25.912336 [info ] [MainThread]: 
[0m21:19:25.912336 [error] [MainThread]: [31mFailure in model patients (dbt/models\intermediate\patients.sql)[0m
[0m21:19:25.912336 [error] [MainThread]:   Runtime Error in model patients (dbt/models\intermediate\patients.sql)
  Binder Error: Referenced column updated_at not found in FROM clause and can't find in alias map.
  
  LINE 24:     order by updated_at desc
                        ^
[0m21:19:25.912336 [info ] [MainThread]: 
[0m21:19:25.912336 [info ] [MainThread]:   compiled code at target\compiled\takehome\dbt/models\intermediate\patients.sql
[0m21:19:25.912336 [info ] [MainThread]: 
[0m21:19:25.912336 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=3
[0m21:19:25.917440 [debug] [MainThread]: Command `dbt run` failed at 21:19:25.917440 after 1.41 seconds
[0m21:19:25.917440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA204CF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1FF17020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1FF15FA0>]}
[0m21:19:25.917440 [debug] [MainThread]: Flushing usage events
[0m21:19:26.383858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:26:23.566478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E709066540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70937F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E709433DA0>]}


============================== 21:26:23.566478 | 23115520-0d5e-4c0a-90f0-fcb097b5452e ==============================
[0m21:26:23.566478 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:26:23.566478 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m21:26:23.735627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23115520-0d5e-4c0a-90f0-fcb097b5452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70A851790>]}
[0m21:26:23.767067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23115520-0d5e-4c0a-90f0-fcb097b5452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E708F18E30>]}
[0m21:26:23.782736 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:26:23.889356 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:26:24.032602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:26:24.032602 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\stg_patients.sql
[0m21:26:24.319202 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome.marts
[0m21:26:24.323134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23115520-0d5e-4c0a-90f0-fcb097b5452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70B252E10>]}
[0m21:26:24.384365 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:26:24.386321 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:26:24.409646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23115520-0d5e-4c0a-90f0-fcb097b5452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70B31AA50>]}
[0m21:26:24.410709 [info ] [MainThread]: Found 3 models, 4 data tests, 8 sources, 468 macros
[0m21:26:24.410709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23115520-0d5e-4c0a-90f0-fcb097b5452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70B30E390>]}
[0m21:26:24.412767 [info ] [MainThread]: 
[0m21:26:24.412767 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:26:24.413738 [info ] [MainThread]: 
[0m21:26:24.414729 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:26:24.414729 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:26:24.414729 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:26:24.414729 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:26:24.468553 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:26:24.468553 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:26:24.469545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:24.470428 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:26:24.470428 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:26:24.470428 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:26:24.471448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:24.472447 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:26:24.472447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:24.484323 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m21:26:24.485317 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:26:24.486318 [debug] [ThreadPool]: On list_takehome: Close
[0m21:26:24.486318 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m21:26:24.487320 [debug] [ThreadPool]: On list_takehome: Close
[0m21:26:24.488318 [debug] [ThreadPool]: On list_takehome: Close
[0m21:26:24.489325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m21:26:24.489677 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m21:26:24.489677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m21:26:24.489677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev)
[0m21:26:24.529679 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m21:26:24.537923 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:26:24.539930 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev"
"
[0m21:26:24.539930 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:26:24.539930 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:26:24.539930 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:26:24.539930 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:26:24.539930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:24.539930 [debug] [ThreadPool]: On create_takehome_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:26:24.539930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:24.539930 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:24.545393 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:26:24.545393 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m21:26:24.545393 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:26:24.545393 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:26:24.545393 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m21:26:24.545393 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev: BEGIN
[0m21:26:24.545393 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m21:26:24.545393 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m21:26:24.545393 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m21:26:24.545393 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:26:24.545393 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev"} */

    
    
        create schema if not exists "takehome"."dev"
    
[0m21:26:24.545393 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m21:26:24.545393 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev: COMMIT
[0m21:26:24.545393 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:26:24.545393 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:26:24.545393 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev: COMMIT
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m21:26:24.545393 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:26:24.545393 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev: Close
[0m21:26:24.545393 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m21:26:24.545393 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m21:26:24.545393 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:26:24.545393 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m21:26:24.561456 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m21:26:24.561604 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m21:26:24.561604 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:26:24.561604 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev'
[0m21:26:24.561604 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:26:24.561604 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m21:26:24.561604 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev"
[0m21:26:24.561604 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m21:26:24.561604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:24.561604 [debug] [ThreadPool]: On list_takehome_dev: BEGIN
[0m21:26:24.561604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:24.561604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:24.561604 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:26:24.561604 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:26:24.561604 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:26:24.561604 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:26:24.561604 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:26:24.561604 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m21:26:24.561604 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev"
[0m21:26:24.561604 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m21:26:24.561604 [debug] [ThreadPool]: On list_takehome_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev'
    and lower(table_catalog) = 'takehome'
  
[0m21:26:24.583254 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:26:24.583254 [debug] [ThreadPool]: On list_takehome_dev: ROLLBACK
[0m21:26:24.583254 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:26:24.583254 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev'
[0m21:26:24.583254 [debug] [ThreadPool]: On list_takehome_dev: Close
[0m21:26:24.583254 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m21:26:24.587715 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m21:26:24.587715 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m21:26:24.588639 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:26:24.588639 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m21:26:24.588639 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m21:26:24.588639 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m21:26:24.588639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23115520-0d5e-4c0a-90f0-fcb097b5452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70B2DA870>]}
[0m21:26:24.588639 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:24.588639 [debug] [MainThread]: On master: BEGIN
[0m21:26:24.588639 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:24.588639 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:26:24.588639 [debug] [MainThread]: On master: COMMIT
[0m21:26:24.588639 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:24.593309 [debug] [MainThread]: On master: COMMIT
[0m21:26:24.593309 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:26:24.593309 [debug] [MainThread]: On master: Close
[0m21:26:24.593309 [debug] [Thread-1 (]: Began running node model.takehome.stg_patients
[0m21:26:24.593309 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_staging.stg_patients ........................... [RUN]
[0m21:26:24.593309 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_patients'
[0m21:26:24.593309 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_patients
[0m21:26:24.593309 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m21:26:24.593309 [debug] [Thread-1 (]: Began executing node model.takehome.stg_patients
[0m21:26:24.633793 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m21:26:24.633793 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:26:24.633793 [debug] [Thread-1 (]: On model.takehome.stg_patients: BEGIN
[0m21:26:24.633793 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:26:24.633793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:26:24.633793 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:26:24.633793 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id as patient_id,
    last_updated as updated_at,
    *
from "takehome"."raw"."patients"
  );

[0m21:26:24.633793 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id as patient_id,
    last_updated as updated_at,
    *
from "takehome"."raw"."patients"
  );

[0m21:26:24.633793 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m21:26:24.633793 [debug] [Thread-1 (]: On model.takehome.stg_patients: ROLLBACK
[0m21:26:24.641743 [debug] [Thread-1 (]: Failed to rollback 'model.takehome.stg_patients'
[0m21:26:24.642890 [debug] [Thread-1 (]: On model.takehome.stg_patients: Close
[0m21:26:24.643895 [debug] [Thread-1 (]: Runtime Error in model stg_patients (dbt/models\staging\stg_patients.sql)
  Binder Error: Referenced column "last_updated" not found in FROM clause!
  Candidate bindings: "last_name", "date_of_death", "first_name", "date_activated", "date_deactivated"
  
  LINE 7:     last_updated as updated_at,
              ^
[0m21:26:24.645890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23115520-0d5e-4c0a-90f0-fcb097b5452e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70B1681D0>]}
[0m21:26:24.646838 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dev_staging.stg_patients .................. [[31mERROR[0m in 0.05s]
[0m21:26:24.646838 [debug] [Thread-1 (]: Finished running node model.takehome.stg_patients
[0m21:26:24.647785 [debug] [Thread-7 (]: Marking all children of 'model.takehome.stg_patients' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_patients (dbt/models\staging\stg_patients.sql)
  Binder Error: Referenced column "last_updated" not found in FROM clause!
  Candidate bindings: "last_name", "date_of_death", "first_name", "date_activated", "date_deactivated"
  
  LINE 7:     last_updated as updated_at,
              ^.
[0m21:26:24.648849 [debug] [Thread-3 (]: Began running node model.takehome.patients
[0m21:26:24.648849 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev_bronze.patients ....................................... [[33mSKIP[0m]
[0m21:26:24.648849 [debug] [Thread-3 (]: Finished running node model.takehome.patients
[0m21:26:24.650224 [debug] [Thread-2 (]: Began running node model.takehome.patients_by_age
[0m21:26:24.650224 [info ] [Thread-2 (]: 3 of 3 SKIP relation dev.patients_by_age ....................................... [[33mSKIP[0m]
[0m21:26:24.650224 [debug] [Thread-2 (]: Finished running node model.takehome.patients_by_age
[0m21:26:24.652306 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:24.652306 [debug] [MainThread]: On master: BEGIN
[0m21:26:24.652306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:24.653339 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:26:24.653339 [debug] [MainThread]: On master: COMMIT
[0m21:26:24.653339 [debug] [MainThread]: Using duckdb connection "master"
[0m21:26:24.653339 [debug] [MainThread]: On master: COMMIT
[0m21:26:24.654341 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:26:24.654341 [debug] [MainThread]: On master: Close
[0m21:26:24.654341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:24.654341 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m21:26:24.655342 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m21:26:24.655342 [debug] [MainThread]: Connection 'create_takehome_dev' was properly closed.
[0m21:26:24.655342 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m21:26:24.655342 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m21:26:24.655342 [debug] [MainThread]: Connection 'list_takehome_dev' was properly closed.
[0m21:26:24.655342 [debug] [MainThread]: Connection 'model.takehome.stg_patients' was properly closed.
[0m21:26:24.656344 [info ] [MainThread]: 
[0m21:26:24.656344 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m21:26:24.656344 [debug] [MainThread]: Command end result
[0m21:26:24.658343 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:26:24.658343 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:26:24.677359 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m21:26:24.677359 [info ] [MainThread]: 
[0m21:26:24.678434 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:26:24.679617 [info ] [MainThread]: 
[0m21:26:24.680751 [error] [MainThread]: [31mFailure in model stg_patients (dbt/models\staging\stg_patients.sql)[0m
[0m21:26:24.682582 [error] [MainThread]:   Runtime Error in model stg_patients (dbt/models\staging\stg_patients.sql)
  Binder Error: Referenced column "last_updated" not found in FROM clause!
  Candidate bindings: "last_name", "date_of_death", "first_name", "date_activated", "date_deactivated"
  
  LINE 7:     last_updated as updated_at,
              ^
[0m21:26:24.682582 [info ] [MainThread]: 
[0m21:26:24.683594 [info ] [MainThread]:   compiled code at target\compiled\takehome\dbt/models\staging\stg_patients.sql
[0m21:26:24.684598 [info ] [MainThread]: 
[0m21:26:24.685610 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=3
[0m21:26:24.686595 [debug] [MainThread]: Command `dbt run` failed at 21:26:24.686595 after 1.25 seconds
[0m21:26:24.686595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E706FCC5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E709433DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E708FAC2C0>]}
[0m21:26:24.687592 [debug] [MainThread]: Flushing usage events
[0m21:26:25.466274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:42.464430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9D93ADB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9A8A0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9A92A060>]}


============================== 21:28:42.464430 | 8ed7ff79-de2f-4912-be9d-d085761ca61d ==============================
[0m21:28:42.464430 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:28:42.464430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m21:28:42.636555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ed7ff79-de2f-4912-be9d-d085761ca61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9EC12C30>]}
[0m21:28:42.677901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ed7ff79-de2f-4912-be9d-d085761ca61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9AC195B0>]}
[0m21:28:42.677901 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:28:42.791902 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:28:42.941837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:28:42.941837 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\stg_patients.sql
[0m21:28:43.200041 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome.marts
[0m21:28:43.208844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ed7ff79-de2f-4912-be9d-d085761ca61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9F70B710>]}
[0m21:28:43.264743 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:28:43.264743 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:28:43.289256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ed7ff79-de2f-4912-be9d-d085761ca61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9F810590>]}
[0m21:28:43.290256 [info ] [MainThread]: Found 3 models, 4 data tests, 8 sources, 468 macros
[0m21:28:43.290256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ed7ff79-de2f-4912-be9d-d085761ca61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9F7BA510>]}
[0m21:28:43.292714 [info ] [MainThread]: 
[0m21:28:43.292714 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:28:43.292714 [info ] [MainThread]: 
[0m21:28:43.292714 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:28:43.296706 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:28:43.304406 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:28:43.304406 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:28:43.349736 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:28:43.349736 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:28:43.349736 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:28:43.350737 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:28:43.350737 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:28:43.350737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:43.350737 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:28:43.351736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:43.351736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:43.356935 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m21:28:43.356935 [debug] [ThreadPool]: On list_takehome: Close
[0m21:28:43.356935 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m21:28:43.356935 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m21:28:43.356935 [debug] [ThreadPool]: On list_takehome: Close
[0m21:28:43.356935 [debug] [ThreadPool]: On list_takehome: Close
[0m21:28:43.356935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev)
[0m21:28:43.356935 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev"
"
[0m21:28:43.405925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m21:28:43.405925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m21:28:43.405925 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:28:43.405925 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m21:28:43.421981 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m21:28:43.421981 [debug] [ThreadPool]: On create_takehome_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:28:43.421981 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:28:43.421981 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:28:43.421981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:43.421981 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:28:43.421981 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:28:43.421981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:43.421981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:28:43.421981 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:28:43.421981 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:28:43.421981 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:28:43.421981 [debug] [ThreadPool]: On create_takehome_dev: BEGIN
[0m21:28:43.421981 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:28:43.421981 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m21:28:43.421981 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:28:43.421981 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:28:43.421981 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:28:43.421981 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m21:28:43.421981 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:28:43.421981 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m21:28:43.421981 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:28:43.421981 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m21:28:43.421981 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m21:28:43.421981 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:28:43.421981 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:28:43.421981 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:28:43.421981 [debug] [ThreadPool]: On create_takehome_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev"} */

    
    
        create schema if not exists "takehome"."dev"
    
[0m21:28:43.421981 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:28:43.421981 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m21:28:43.421981 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m21:28:43.421981 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:28:43.437853 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:28:43.438352 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m21:28:43.438352 [debug] [ThreadPool]: On create_takehome_dev: COMMIT
[0m21:28:43.439388 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:28:43.439388 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev"
[0m21:28:43.440348 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m21:28:43.440348 [debug] [ThreadPool]: On create_takehome_dev: COMMIT
[0m21:28:43.440348 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:28:43.441449 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m21:28:43.441449 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m21:28:43.441449 [debug] [ThreadPool]: On create_takehome_dev: Close
[0m21:28:43.442383 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:28:43.442383 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m21:28:43.443447 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev'
[0m21:28:43.447752 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev"
[0m21:28:43.448495 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m21:28:43.448495 [debug] [ThreadPool]: On list_takehome_dev: BEGIN
[0m21:28:43.448495 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m21:28:43.448495 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:28:43.448495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:43.448495 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:28:43.448495 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m21:28:43.448495 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m21:28:43.448495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:43.448495 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m21:28:43.448495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:28:43.448495 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev"
[0m21:28:43.448495 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:28:43.448495 [debug] [ThreadPool]: On list_takehome_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev'
    and lower(table_catalog) = 'takehome'
  
[0m21:28:43.448495 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:28:43.448495 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:28:43.448495 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m21:28:43.448495 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:28:43.448495 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m21:28:43.465738 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:28:43.467755 [debug] [ThreadPool]: On list_takehome_dev: ROLLBACK
[0m21:28:43.467755 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:28:43.467755 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m21:28:43.469771 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m21:28:43.469771 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m21:28:43.469771 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m21:28:43.469771 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m21:28:43.469771 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m21:28:43.469771 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m21:28:43.469771 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev'
[0m21:28:43.469771 [debug] [ThreadPool]: On list_takehome_dev: Close
[0m21:28:43.469771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ed7ff79-de2f-4912-be9d-d085761ca61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9F7B8980>]}
[0m21:28:43.469771 [debug] [MainThread]: Using duckdb connection "master"
[0m21:28:43.469771 [debug] [MainThread]: On master: BEGIN
[0m21:28:43.469771 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:28:43.469771 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:28:43.469771 [debug] [MainThread]: On master: COMMIT
[0m21:28:43.469771 [debug] [MainThread]: Using duckdb connection "master"
[0m21:28:43.469771 [debug] [MainThread]: On master: COMMIT
[0m21:28:43.469771 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:28:43.469771 [debug] [MainThread]: On master: Close
[0m21:28:43.479427 [debug] [Thread-1 (]: Began running node model.takehome.stg_patients
[0m21:28:43.479427 [info ] [Thread-1 (]: 1 of 3 START sql view model dev_staging.stg_patients ........................... [RUN]
[0m21:28:43.479427 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_patients'
[0m21:28:43.479427 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_patients
[0m21:28:43.479427 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m21:28:43.488439 [debug] [Thread-1 (]: Began executing node model.takehome.stg_patients
[0m21:28:43.508408 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m21:28:43.515091 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:28:43.516223 [debug] [Thread-1 (]: On model.takehome.stg_patients: BEGIN
[0m21:28:43.516223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:28:43.517214 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:28:43.517214 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:28:43.517214 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id                                   as patient_id,
    -- “última actualización” lógica del paciente
    coalesce(
        date_deactivated,
        date_activated,
        date_of_death,
        date_of_birth
    )                                    as updated_at,
    first_name,
    last_name,
    ssn,
    date_of_birth,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_death,
    date_activated,
    date_deactivated
from "takehome"."raw"."patients"
  );

[0m21:28:43.518218 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:28:43.524881 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:28:43.524881 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m21:28:43.525877 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:28:43.527881 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:28:43.527881 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m21:28:43.528885 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m21:28:43.531876 [debug] [Thread-1 (]: On model.takehome.stg_patients: COMMIT
[0m21:28:43.531876 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:28:43.531876 [debug] [Thread-1 (]: On model.takehome.stg_patients: COMMIT
[0m21:28:43.531876 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:28:43.531876 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:28:43.531876 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

      drop view if exists "takehome"."dev_staging"."stg_patients__dbt_backup" cascade
    
[0m21:28:43.547847 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:28:43.547847 [debug] [Thread-1 (]: On model.takehome.stg_patients: Close
[0m21:28:43.547847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed7ff79-de2f-4912-be9d-d085761ca61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9F630350>]}
[0m21:28:43.547847 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dev_staging.stg_patients ...................... [[32mOK[0m in 0.07s]
[0m21:28:43.547847 [debug] [Thread-1 (]: Finished running node model.takehome.stg_patients
[0m21:28:43.547847 [debug] [Thread-3 (]: Began running node model.takehome.patients
[0m21:28:43.547847 [info ] [Thread-3 (]: 2 of 3 START sql table model dev_bronze.patients ............................... [RUN]
[0m21:28:43.547847 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.patients'
[0m21:28:43.547847 [debug] [Thread-3 (]: Began compiling node model.takehome.patients
[0m21:28:43.547847 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.patients"
[0m21:28:43.547847 [debug] [Thread-3 (]: Began executing node model.takehome.patients
[0m21:28:43.574595 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.patients"
[0m21:28:43.575607 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:28:43.575607 [debug] [Thread-3 (]: On model.takehome.patients: BEGIN
[0m21:28:43.575607 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:28:43.576592 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:28:43.577629 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:28:43.577629 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      

with 

pt as ( select * from "takehome"."dev_staging"."stg_patients" )

select
    *
    
from pt

qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m21:28:43.591977 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m21:28:43.596968 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:28:43.596968 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m21:28:43.597970 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:28:43.598669 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:28:43.598669 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m21:28:43.599748 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:28:43.601742 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:28:43.602791 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients" rename to "patients__dbt_backup"
[0m21:28:43.602791 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:28:43.604746 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:28:43.605797 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients__dbt_tmp" rename to "patients"
[0m21:28:43.605797 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:28:43.606792 [debug] [Thread-3 (]: On model.takehome.patients: COMMIT
[0m21:28:43.606792 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:28:43.606792 [debug] [Thread-3 (]: On model.takehome.patients: COMMIT
[0m21:28:43.606792 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m21:28:43.606792 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m21:28:43.606792 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

      drop table if exists "takehome"."dev_bronze"."patients__dbt_backup" cascade
    
[0m21:28:43.618034 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:28:43.618034 [debug] [Thread-3 (]: On model.takehome.patients: Close
[0m21:28:43.618034 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed7ff79-de2f-4912-be9d-d085761ca61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9F493560>]}
[0m21:28:43.618034 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev_bronze.patients .......................... [[32mOK[0m in 0.07s]
[0m21:28:43.618034 [debug] [Thread-3 (]: Finished running node model.takehome.patients
[0m21:28:43.618034 [debug] [Thread-2 (]: Began running node model.takehome.patients_by_age
[0m21:28:43.618034 [info ] [Thread-2 (]: 3 of 3 START sql view model dev.patients_by_age ................................ [RUN]
[0m21:28:43.622464 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.takehome.patients_by_age'
[0m21:28:43.622464 [debug] [Thread-2 (]: Began compiling node model.takehome.patients_by_age
[0m21:28:43.624486 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.patients_by_age"
[0m21:28:43.624486 [debug] [Thread-2 (]: Began executing node model.takehome.patients_by_age
[0m21:28:43.627238 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.patients_by_age"
[0m21:28:43.627238 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:28:43.627238 [debug] [Thread-2 (]: On model.takehome.patients_by_age: BEGIN
[0m21:28:43.627238 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:28:43.629259 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:28:43.629259 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:28:43.629259 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

  
  create view "takehome"."dev"."patients_by_age__dbt_tmp" as (
    /*
    This model should work.
*/


with

pt as ( select * from "takehome"."dev_bronze"."patients" ),

pt_age as (

    select
        patient_id, 
        datediff('years', pt.date_of_birth, current_date()) as age_years

    from pt

)

select 
    age_years, 
    count(distinct patient_id) as patient_count

from pt_age

group by age_years
  );

[0m21:28:43.629259 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:28:43.631278 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:28:43.631278 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter view "takehome"."dev"."patients_by_age" rename to "patients_by_age__dbt_backup"
[0m21:28:43.631278 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:28:43.631278 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:28:43.631278 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter view "takehome"."dev"."patients_by_age__dbt_tmp" rename to "patients_by_age"
[0m21:28:43.631278 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m21:28:43.638587 [debug] [Thread-2 (]: On model.takehome.patients_by_age: COMMIT
[0m21:28:43.638587 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:28:43.638587 [debug] [Thread-2 (]: On model.takehome.patients_by_age: COMMIT
[0m21:28:43.643157 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:28:43.645913 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:28:43.646544 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

      drop view if exists "takehome"."dev"."patients_by_age__dbt_backup" cascade
    
[0m21:28:43.649188 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:28:43.651161 [debug] [Thread-2 (]: On model.takehome.patients_by_age: Close
[0m21:28:43.651161 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ed7ff79-de2f-4912-be9d-d085761ca61d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9F4D7650>]}
[0m21:28:43.652155 [info ] [Thread-2 (]: 3 of 3 OK created sql view model dev.patients_by_age ........................... [[32mOK[0m in 0.03s]
[0m21:28:43.652797 [debug] [Thread-2 (]: Finished running node model.takehome.patients_by_age
[0m21:28:43.652797 [debug] [MainThread]: Using duckdb connection "master"
[0m21:28:43.656518 [debug] [MainThread]: On master: BEGIN
[0m21:28:43.656518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:28:43.657532 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:28:43.657532 [debug] [MainThread]: On master: COMMIT
[0m21:28:43.657532 [debug] [MainThread]: Using duckdb connection "master"
[0m21:28:43.657532 [debug] [MainThread]: On master: COMMIT
[0m21:28:43.657532 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:28:43.657532 [debug] [MainThread]: On master: Close
[0m21:28:43.657532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:43.657532 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m21:28:43.657532 [debug] [MainThread]: Connection 'create_takehome_dev' was properly closed.
[0m21:28:43.657532 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m21:28:43.657532 [debug] [MainThread]: Connection 'list_takehome_dev' was properly closed.
[0m21:28:43.657532 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m21:28:43.657532 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m21:28:43.657532 [debug] [MainThread]: Connection 'model.takehome.stg_patients' was properly closed.
[0m21:28:43.657532 [debug] [MainThread]: Connection 'model.takehome.patients' was properly closed.
[0m21:28:43.657532 [debug] [MainThread]: Connection 'model.takehome.patients_by_age' was properly closed.
[0m21:28:43.657532 [info ] [MainThread]: 
[0m21:28:43.657532 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m21:28:43.657532 [debug] [MainThread]: Command end result
[0m21:28:43.678433 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:28:43.681669 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:28:43.687797 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m21:28:43.687797 [info ] [MainThread]: 
[0m21:28:43.688823 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:28:43.688823 [info ] [MainThread]: 
[0m21:28:43.689996 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m21:28:43.691017 [debug] [MainThread]: Command `dbt run` succeeded at 21:28:43.689996 after 1.54 seconds
[0m21:28:43.691017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9C97C2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9CEB75F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A9CEB5CD0>]}
[0m21:28:43.691017 [debug] [MainThread]: Flushing usage events
[0m21:28:44.180699 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:41:11.132416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023503EFADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023501521DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023504166BA0>]}


============================== 21:41:11.138483 | 0863ae5c-f09e-49c5-8a2a-2fb52d1cd99e ==============================
[0m21:41:11.138483 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:41:11.139411 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m21:41:11.307762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0863ae5c-f09e-49c5-8a2a-2fb52d1cd99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002350578CD70>]}
[0m21:41:11.350453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0863ae5c-f09e-49c5-8a2a-2fb52d1cd99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235017037A0>]}
[0m21:41:11.352593 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:41:11.481682 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:41:11.596110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:41:11.596110 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:41:11.600108 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.takehome.marts
[0m21:41:11.630519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0863ae5c-f09e-49c5-8a2a-2fb52d1cd99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002350578D5E0>]}
[0m21:41:11.685079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:41:11.688057 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:41:11.719697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0863ae5c-f09e-49c5-8a2a-2fb52d1cd99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023505CF59D0>]}
[0m21:41:11.719697 [info ] [MainThread]: Found 3 models, 4 data tests, 8 sources, 468 macros
[0m21:41:11.720981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0863ae5c-f09e-49c5-8a2a-2fb52d1cd99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023505C8B920>]}
[0m21:41:11.721983 [info ] [MainThread]: 
[0m21:41:11.721983 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:41:11.722982 [info ] [MainThread]: 
[0m21:41:11.722982 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:41:11.723982 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev'
[0m21:41:11.735384 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m21:41:11.739380 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m21:41:11.776568 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev"
[0m21:41:11.777569 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:41:11.777569 [debug] [ThreadPool]: On list_takehome_dev: BEGIN
[0m21:41:11.778566 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:41:11.778566 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m21:41:11.778566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:11.778566 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m21:41:11.779565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:11.779565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:11.819234 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m21:41:11.820236 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:41:11.820620 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m21:41:11.820620 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m21:41:11.821624 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:41:11.821624 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m21:41:11.821624 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m21:41:11.822622 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev"
[0m21:41:11.822622 [debug] [ThreadPool]: On list_takehome_dev: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev'
    and lower(table_catalog) = 'takehome'
  
[0m21:41:11.831902 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:41:11.833014 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m21:41:11.833014 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:41:11.833907 [debug] [ThreadPool]: On list_takehome_dev: ROLLBACK
[0m21:41:11.833907 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m21:41:11.834912 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m21:41:11.836901 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m21:41:11.836901 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m21:41:11.836901 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m21:41:11.837901 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m21:41:11.838496 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev'
[0m21:41:11.838496 [debug] [ThreadPool]: On list_takehome_dev: Close
[0m21:41:11.840011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0863ae5c-f09e-49c5-8a2a-2fb52d1cd99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023506193E00>]}
[0m21:41:11.840011 [debug] [MainThread]: Using duckdb connection "master"
[0m21:41:11.840011 [debug] [MainThread]: On master: BEGIN
[0m21:41:11.840011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:41:11.841123 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:41:11.841123 [debug] [MainThread]: On master: COMMIT
[0m21:41:11.841123 [debug] [MainThread]: Using duckdb connection "master"
[0m21:41:11.841123 [debug] [MainThread]: On master: COMMIT
[0m21:41:11.842120 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:41:11.842120 [debug] [MainThread]: On master: Close
[0m21:41:11.846767 [debug] [Thread-1 (]: Began running node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m21:41:11.846767 [debug] [Thread-2 (]: Began running node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m21:41:11.846767 [info ] [Thread-1 (]: 1 of 4 START test not_null_patients_patient_id ................................. [RUN]
[0m21:41:11.847768 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.takehome.not_null_patients_patient_id.330c5fb3d9'
[0m21:41:11.847768 [debug] [Thread-1 (]: Began compiling node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m21:41:11.848767 [debug] [Thread-3 (]: Began running node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m21:41:11.859352 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m21:41:11.860461 [debug] [Thread-4 (]: Began running node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m21:41:11.846767 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_patients_patient_id ............................. [RUN]
[0m21:41:11.861360 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.takehome.not_null_stg_patients_patient_id.e578180344'
[0m21:41:11.862472 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m21:41:11.864467 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m21:41:11.860461 [info ] [Thread-3 (]: 3 of 4 START test unique_patients_patient_id ................................... [RUN]
[0m21:41:11.865362 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.takehome.unique_patients_patient_id.8d0f9eb60a'
[0m21:41:11.865362 [debug] [Thread-3 (]: Began compiling node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m21:41:11.870365 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m21:41:11.861360 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_patients_patient_id ............................... [RUN]
[0m21:41:11.871563 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.takehome.unique_stg_patients_patient_id.8907d3ccf0'
[0m21:41:11.872564 [debug] [Thread-4 (]: Began compiling node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m21:41:11.876565 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m21:41:11.878565 [debug] [Thread-3 (]: Began executing node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m21:41:11.892979 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m21:41:11.893979 [debug] [Thread-1 (]: Began executing node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m21:41:11.898979 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m21:41:11.901979 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m21:41:11.897987 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m21:41:11.902988 [debug] [Thread-4 (]: Began executing node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m21:41:11.906979 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m21:41:11.907978 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m21:41:11.908984 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m21:41:11.909979 [debug] [Thread-3 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: BEGIN
[0m21:41:11.910979 [debug] [Thread-1 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: BEGIN
[0m21:41:11.910979 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:41:11.910979 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m21:41:11.911979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:41:11.911979 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m21:41:11.912979 [debug] [Thread-4 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: BEGIN
[0m21:41:11.912979 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:41:11.913979 [debug] [Thread-2 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: BEGIN
[0m21:41:11.913979 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:41:11.914978 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:41:11.914978 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m21:41:11.914978 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:41:11.915977 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m21:41:11.915977 [debug] [Thread-3 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_patients_patient_id.8d0f9eb60a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_bronze"."patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:41:11.916980 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:41:11.916980 [debug] [Thread-1 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_patient_id.330c5fb3d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_bronze"."patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m21:41:11.916980 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:41:11.918085 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m21:41:11.918085 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m21:41:11.919098 [debug] [Thread-4 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_staging"."stg_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:41:11.920098 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:41:11.921098 [debug] [Thread-2 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_patients_patient_id.e578180344"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_staging"."stg_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m21:41:11.922096 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m21:41:11.926133 [debug] [Thread-1 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: ROLLBACK
[0m21:41:11.926133 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m21:41:11.927101 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:41:11.928097 [debug] [Thread-3 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: ROLLBACK
[0m21:41:11.929097 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.not_null_patients_patient_id.330c5fb3d9'
[0m21:41:11.930096 [debug] [Thread-4 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: ROLLBACK
[0m21:41:11.931096 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.unique_patients_patient_id.8d0f9eb60a'
[0m21:41:11.932127 [debug] [Thread-2 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m21:41:11.932127 [debug] [Thread-1 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: Close
[0m21:41:11.933096 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.unique_stg_patients_patient_id.8907d3ccf0'
[0m21:41:11.933096 [debug] [Thread-3 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: Close
[0m21:41:11.934122 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_stg_patients_patient_id.e578180344'
[0m21:41:11.934122 [debug] [Thread-4 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: Close
[0m21:41:11.934122 [info ] [Thread-1 (]: 1 of 4 PASS not_null_patients_patient_id ....................................... [[32mPASS[0m in 0.09s]
[0m21:41:11.935101 [debug] [Thread-2 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: Close
[0m21:41:11.936096 [debug] [Thread-1 (]: Finished running node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m21:41:11.935101 [info ] [Thread-3 (]: 3 of 4 PASS unique_patients_patient_id ......................................... [[32mPASS[0m in 0.07s]
[0m21:41:11.937096 [debug] [Thread-3 (]: Finished running node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m21:41:11.936096 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_patients_patient_id ..................................... [[32mPASS[0m in 0.07s]
[0m21:41:11.938098 [debug] [Thread-4 (]: Finished running node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m21:41:11.937096 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_patients_patient_id ................................... [[32mPASS[0m in 0.07s]
[0m21:41:11.938503 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m21:41:11.939512 [debug] [MainThread]: Using duckdb connection "master"
[0m21:41:11.939512 [debug] [MainThread]: On master: BEGIN
[0m21:41:11.940626 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:41:11.940626 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:41:11.940626 [debug] [MainThread]: On master: COMMIT
[0m21:41:11.940626 [debug] [MainThread]: Using duckdb connection "master"
[0m21:41:11.941611 [debug] [MainThread]: On master: COMMIT
[0m21:41:11.941611 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:41:11.941611 [debug] [MainThread]: On master: Close
[0m21:41:11.941611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:11.942616 [debug] [MainThread]: Connection 'list_takehome_dev' was properly closed.
[0m21:41:11.942616 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m21:41:11.942616 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m21:41:11.942616 [debug] [MainThread]: Connection 'test.takehome.not_null_patients_patient_id.330c5fb3d9' was properly closed.
[0m21:41:11.942616 [debug] [MainThread]: Connection 'test.takehome.not_null_stg_patients_patient_id.e578180344' was properly closed.
[0m21:41:11.942616 [debug] [MainThread]: Connection 'test.takehome.unique_patients_patient_id.8d0f9eb60a' was properly closed.
[0m21:41:11.942616 [debug] [MainThread]: Connection 'test.takehome.unique_stg_patients_patient_id.8907d3ccf0' was properly closed.
[0m21:41:11.943615 [info ] [MainThread]: 
[0m21:41:11.943615 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m21:41:11.944620 [debug] [MainThread]: Command end result
[0m21:41:11.961173 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:41:11.963183 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:41:11.968175 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m21:41:11.968175 [info ] [MainThread]: 
[0m21:41:11.969184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:41:11.970175 [info ] [MainThread]: 
[0m21:41:11.970175 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:41:11.971176 [debug] [MainThread]: Command `dbt test` succeeded at 21:41:11.971176 after 1.14 seconds
[0m21:41:11.972185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002350577C920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023503A75FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023505C0AB40>]}
[0m21:41:11.972185 [debug] [MainThread]: Flushing usage events
[0m21:41:12.455126 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:58:39.167430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116A6675760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116A99D0F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116A99D1E20>]}


============================== 15:58:39.193269 | c620dac3-ae00-436a-b03d-64b54cc455f6 ==============================
[0m15:58:39.193269 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:58:39.194127 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m15:58:39.744800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116AB3A2FC0>]}
[0m15:58:39.784450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116A66C18B0>]}
[0m15:58:39.804120 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:58:40.343830 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:58:43.728286 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 12 files added, 2 files changed.
[0m15:58:43.728286 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\staging\stg_conditions.sql
[0m15:58:43.729505 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\staging\stg_patient_conditions.sql
[0m15:58:43.729505 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\staging\stg_medications.sql
[0m15:58:43.729505 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\marts\summary\patients_per_month.sql
[0m15:58:43.730497 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\marts\silver\_mart_silver_models.yml
[0m15:58:43.730497 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\staging\stg_visits.sql
[0m15:58:43.730497 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\staging\stg_documents.sql
[0m15:58:43.730497 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\marts\summary\medications_per_month.sql
[0m15:58:43.730497 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\marts\summary\patients_by_age.sql
[0m15:58:43.730497 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\marts\summary\_mart_summary_models.yml
[0m15:58:43.730497 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\staging\stg_orders.sql
[0m15:58:43.730497 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\staging\stg_med_admins.sql
[0m15:58:43.730497 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\_stg_models.yml
[0m15:58:43.734189 [debug] [MainThread]: Partial parsing: deleted file: takehome://dbt/models\mart\summary\patients_by_age.sql
[0m15:58:43.734189 [debug] [MainThread]: Partial parsing: deleted file: takehome://dbt/models\mart\summary\patients_per_month.sql
[0m15:58:43.734189 [debug] [MainThread]: Partial parsing: deleted file: takehome://dbt/models\mart\summary\medications_per_month.sql
[0m15:58:43.734189 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\stg_patients.sql
[0m15:58:44.254659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116ABD14110>]}
[0m15:58:44.348786 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m15:58:44.393038 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m15:58:44.471477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116ABC933E0>]}
[0m15:58:44.472449 [info ] [MainThread]: Found 10 models, 8 data tests, 8 sources, 468 macros
[0m15:58:44.473655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116ABE16D50>]}
[0m15:58:44.476450 [info ] [MainThread]: 
[0m15:58:44.476450 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:44.477391 [info ] [MainThread]: 
[0m15:58:44.478390 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:58:44.485740 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m15:58:44.546435 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m15:58:44.556173 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m15:58:49.924775 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m15:58:49.925761 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m15:58:49.925761 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m15:58:49.925761 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m15:58:49.925761 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m15:58:49.926767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:49.926767 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m15:58:49.926767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:49.926767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:49.985965 [debug] [ThreadPool]: SQL status: OK in 0.067 seconds
[0m15:58:49.985965 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m15:58:49.996406 [debug] [ThreadPool]: On list_takehome: Close
[0m15:58:49.996406 [debug] [ThreadPool]: SQL status: OK in 0.071 seconds
[0m15:58:49.997612 [debug] [ThreadPool]: On list_takehome: Close
[0m15:58:49.999613 [debug] [ThreadPool]: On list_takehome: Close
[0m15:58:49.999613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m15:58:50.000611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_silver)
[0m15:58:50.000611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m15:58:50.002175 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m15:58:50.002682 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_silver"
"
[0m15:58:50.002682 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m15:58:50.008518 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m15:58:50.010798 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m15:58:50.010798 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m15:58:50.010798 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m15:58:50.010798 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m15:58:50.010798 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m15:58:50.010798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:50.010798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:50.010798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:50.010798 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:58:50.010798 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:58:50.010798 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m15:58:50.010798 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m15:58:50.010798 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m15:58:50.010798 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m15:58:50.010798 [debug] [ThreadPool]: On create_takehome_dev_silver: BEGIN
[0m15:58:50.010798 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m15:58:50.010798 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:50.010798 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m15:58:50.010798 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:50.021071 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m15:58:50.021539 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m15:58:50.021539 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:50.022600 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m15:58:50.022600 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
    
        create schema if not exists "takehome"."dev_silver"
    
[0m15:58:50.022600 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m15:58:50.023539 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m15:58:50.026316 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:58:50.026316 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m15:58:50.027313 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m15:58:50.027313 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:58:50.027313 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:58:50.027313 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m15:58:50.028449 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m15:58:50.029558 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m15:58:50.029558 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m15:58:50.029558 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m15:58:50.030593 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:50.030593 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m15:58:50.030593 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m15:58:50.030593 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m15:58:50.031920 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:50.031920 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m15:58:50.034434 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:58:50.034434 [debug] [ThreadPool]: On create_takehome_dev_silver: Close
[0m15:58:50.036287 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m15:58:50.036287 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m15:58:50.037290 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m15:58:50.040288 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m15:58:50.041286 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m15:58:50.042286 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m15:58:50.043288 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m15:58:50.043288 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m15:58:50.043288 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m15:58:50.043288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:50.043288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:50.044285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:50.044285 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:50.045286 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:50.045286 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m15:58:50.045286 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:50.045286 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m15:58:50.045286 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m15:58:50.046287 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m15:58:50.046287 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m15:58:50.046287 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m15:58:50.077818 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m15:58:50.079014 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m15:58:50.080017 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m15:58:50.080017 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m15:58:50.081014 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m15:58:50.081014 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m15:58:50.093210 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m15:58:50.094230 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m15:58:50.094230 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m15:58:50.095228 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m15:58:50.095228 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m15:58:50.096229 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m15:58:50.097218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116ABCF9700>]}
[0m15:58:50.097218 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:50.098260 [debug] [MainThread]: On master: BEGIN
[0m15:58:50.098260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:50.099178 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:58:50.099178 [debug] [MainThread]: On master: COMMIT
[0m15:58:50.099178 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:50.099178 [debug] [MainThread]: On master: COMMIT
[0m15:58:50.100196 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:58:50.100196 [debug] [MainThread]: On master: Close
[0m15:58:50.123931 [debug] [Thread-1 (]: Began running node model.takehome.stg_conditions
[0m15:58:50.123931 [debug] [Thread-2 (]: Began running node model.takehome.stg_documents
[0m15:58:50.124957 [debug] [Thread-3 (]: Began running node model.takehome.stg_med_admins
[0m15:58:50.123931 [info ] [Thread-1 (]: 1 of 10 START sql view model dev_staging.stg_conditions ........................ [RUN]
[0m15:58:50.124957 [debug] [Thread-4 (]: Began running node model.takehome.stg_medications
[0m15:58:50.124957 [info ] [Thread-2 (]: 2 of 10 START sql view model dev_staging.stg_documents ......................... [RUN]
[0m15:58:50.125963 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_conditions'
[0m15:58:50.125963 [info ] [Thread-3 (]: 3 of 10 START sql view model dev_staging.stg_med_admins ........................ [RUN]
[0m15:58:50.126929 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.takehome.stg_documents'
[0m15:58:50.126929 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_conditions
[0m15:58:50.125963 [info ] [Thread-4 (]: 4 of 10 START sql view model dev_staging.stg_medications ....................... [RUN]
[0m15:58:50.126929 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.stg_med_admins'
[0m15:58:50.126929 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_documents
[0m15:58:50.131496 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_conditions"
[0m15:58:50.131496 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.takehome.stg_medications'
[0m15:58:50.132488 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_med_admins
[0m15:58:50.135473 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_documents"
[0m15:58:50.136506 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_medications
[0m15:58:50.139490 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_med_admins"
[0m15:58:50.141472 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_medications"
[0m15:58:50.142493 [debug] [Thread-1 (]: Began executing node model.takehome.stg_conditions
[0m15:58:50.169055 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_conditions"
[0m15:58:50.170112 [debug] [Thread-2 (]: Began executing node model.takehome.stg_documents
[0m15:58:50.171078 [debug] [Thread-3 (]: Began executing node model.takehome.stg_med_admins
[0m15:58:50.175032 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_documents"
[0m15:58:50.175032 [debug] [Thread-4 (]: Began executing node model.takehome.stg_medications
[0m15:58:50.178116 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_med_admins"
[0m15:58:50.180681 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_medications"
[0m15:58:50.182337 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m15:58:50.183346 [debug] [Thread-1 (]: On model.takehome.stg_conditions: BEGIN
[0m15:58:50.183346 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:58:50.184387 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.184387 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m15:58:50.185320 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

  
  create view "takehome"."dev_staging"."stg_conditions__dbt_tmp" as (
    select
    id   as condition_id,
    name as condition_name
from "takehome"."raw"."conditions"
  );

[0m15:58:50.185320 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m15:58:50.185320 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m15:58:50.186382 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m15:58:50.186382 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: BEGIN
[0m15:58:50.186382 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.186382 [debug] [Thread-2 (]: On model.takehome.stg_documents: BEGIN
[0m15:58:50.187411 [debug] [Thread-4 (]: On model.takehome.stg_medications: BEGIN
[0m15:58:50.187411 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:58:50.192214 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m15:58:50.192214 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:58:50.192214 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:58:50.193214 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:58:50.193214 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions__dbt_tmp" rename to "stg_conditions"
[0m15:58:50.194220 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m15:58:50.194220 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.195330 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:58:50.196221 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

  
  create view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" as (
    select
    patient_id,
    patient_condition_id,
    medication_id,
    coalesce(date_stopped, date_started) as updated_at,
    date_started,
    date_stopped,
    dosage
from "takehome"."raw"."med_admins"
  );

[0m15:58:50.196221 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m15:58:50.196221 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.196221 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m15:58:50.197305 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

  
  create view "takehome"."dev_staging"."stg_medications__dbt_tmp" as (
    select
    id   as medication_id,
    name as medication_name
from "takehome"."raw"."medications"
  );

[0m15:58:50.203671 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m15:58:50.203671 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

  
  create view "takehome"."dev_staging"."stg_documents__dbt_tmp" as (
    select
    document_id,
    patient_id,
    visit_id,
    document_line,
    document_text
from "takehome"."raw"."documents"
  );

[0m15:58:50.204699 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:58:50.204699 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m15:58:50.205694 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.207148 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m15:58:50.207148 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m15:58:50.207148 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:58:50.209841 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m15:58:50.209841 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" rename to "stg_med_admins"
[0m15:58:50.212763 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m15:58:50.212763 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications__dbt_tmp" rename to "stg_medications"
[0m15:58:50.212763 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:58:50.213887 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents__dbt_tmp" rename to "stg_documents"
[0m15:58:50.214815 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.217841 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m15:58:50.218847 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:58:50.219842 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: COMMIT
[0m15:58:50.219842 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_conditions__dbt_backup" cascade
    
[0m15:58:50.220848 [debug] [Thread-4 (]: On model.takehome.stg_medications: COMMIT
[0m15:58:50.220848 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.220848 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m15:58:50.221844 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m15:58:50.222840 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m15:58:50.222840 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: COMMIT
[0m15:58:50.222840 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.223791 [debug] [Thread-4 (]: On model.takehome.stg_medications: COMMIT
[0m15:58:50.223791 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m15:58:50.225764 [debug] [Thread-1 (]: On model.takehome.stg_conditions: Close
[0m15:58:50.225764 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.226855 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m15:58:50.229311 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m15:58:50.230697 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

      drop view if exists "takehome"."dev_staging"."stg_med_admins__dbt_backup" cascade
    
[0m15:58:50.230697 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:58:50.233796 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m15:58:50.233796 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

      drop view if exists "takehome"."dev_staging"."stg_medications__dbt_backup" cascade
    
[0m15:58:50.233796 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:58:50.234796 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:58:50.234796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116ABE6C6E0>]}
[0m15:58:50.235729 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: Close
[0m15:58:50.235729 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.237799 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m15:58:50.238803 [debug] [Thread-4 (]: On model.takehome.stg_medications: Close
[0m15:58:50.239729 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116AD2D4A10>]}
[0m15:58:50.237799 [info ] [Thread-1 (]: 1 of 10 OK created sql view model dev_staging.stg_conditions ................... [[32mOK[0m in 0.10s]
[0m15:58:50.239729 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

      drop view if exists "takehome"."dev_staging"."stg_documents__dbt_backup" cascade
    
[0m15:58:50.239729 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116AD31EB10>]}
[0m15:58:50.240795 [debug] [Thread-1 (]: Finished running node model.takehome.stg_conditions
[0m15:58:50.240795 [info ] [Thread-3 (]: 3 of 10 OK created sql view model dev_staging.stg_med_admins ................... [[32mOK[0m in 0.11s]
[0m15:58:50.241801 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.241801 [info ] [Thread-4 (]: 4 of 10 OK created sql view model dev_staging.stg_medications .................. [[32mOK[0m in 0.11s]
[0m15:58:50.241801 [debug] [Thread-1 (]: Began running node model.takehome.stg_orders
[0m15:58:50.242796 [debug] [Thread-3 (]: Finished running node model.takehome.stg_med_admins
[0m15:58:50.243797 [debug] [Thread-2 (]: On model.takehome.stg_documents: Close
[0m15:58:50.243797 [debug] [Thread-4 (]: Finished running node model.takehome.stg_medications
[0m15:58:50.244800 [debug] [Thread-3 (]: Began running node model.takehome.stg_patient_conditions
[0m15:58:50.243797 [info ] [Thread-1 (]: 5 of 10 START sql view model dev_staging.stg_orders ............................ [RUN]
[0m15:58:50.244800 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116AD31E3C0>]}
[0m15:58:50.244800 [debug] [Thread-4 (]: Began running node model.takehome.stg_patients
[0m15:58:50.245801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_conditions, now model.takehome.stg_orders)
[0m15:58:50.245801 [info ] [Thread-3 (]: 6 of 10 START sql view model dev_staging.stg_patient_conditions ................ [RUN]
[0m15:58:50.246800 [info ] [Thread-2 (]: 2 of 10 OK created sql view model dev_staging.stg_documents .................... [[32mOK[0m in 0.12s]
[0m15:58:50.246800 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_orders
[0m15:58:50.247822 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_med_admins, now model.takehome.stg_patient_conditions)
[0m15:58:50.246800 [info ] [Thread-4 (]: 7 of 10 START sql view model dev_staging.stg_patients .......................... [RUN]
[0m15:58:50.247822 [debug] [Thread-2 (]: Finished running node model.takehome.stg_documents
[0m15:58:50.249791 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_orders"
[0m15:58:50.249791 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_patient_conditions
[0m15:58:50.249791 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_medications, now model.takehome.stg_patients)
[0m15:58:50.250784 [debug] [Thread-2 (]: Began running node model.takehome.stg_visits
[0m15:58:50.252793 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_patient_conditions"
[0m15:58:50.252793 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_patients
[0m15:58:50.255610 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m15:58:50.253245 [info ] [Thread-2 (]: 8 of 10 START sql view model dev_staging.stg_visits ............................ [RUN]
[0m15:58:50.256669 [debug] [Thread-3 (]: Began executing node model.takehome.stg_patient_conditions
[0m15:58:50.256669 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_documents, now model.takehome.stg_visits)
[0m15:58:50.257636 [debug] [Thread-1 (]: Began executing node model.takehome.stg_orders
[0m15:58:50.260711 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_patient_conditions"
[0m15:58:50.261690 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_visits
[0m15:58:50.263618 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_orders"
[0m15:58:50.264748 [debug] [Thread-4 (]: Began executing node model.takehome.stg_patients
[0m15:58:50.266696 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_visits"
[0m15:58:50.270706 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m15:58:50.271609 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m15:58:50.272600 [debug] [Thread-1 (]: On model.takehome.stg_orders: BEGIN
[0m15:58:50.272600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:50.273601 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m15:58:50.274599 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m15:58:50.274599 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: BEGIN
[0m15:58:50.275587 [debug] [Thread-2 (]: Began executing node model.takehome.stg_visits
[0m15:58:50.275587 [debug] [Thread-4 (]: On model.takehome.stg_patients: BEGIN
[0m15:58:50.276596 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:58:50.276596 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:58:50.280522 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_visits"
[0m15:58:50.281444 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:58:50.281916 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m15:58:50.281916 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

  
  create view "takehome"."dev_staging"."stg_orders__dbt_tmp" as (
    select
    id            as order_id,
    patient_id,
    condition_id,
    order_date    as updated_at,
    order_date
from "takehome"."raw"."orders"
  );

[0m15:58:50.281916 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m15:58:50.281916 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m15:58:50.281916 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

  
  create view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" as (
    select
    id                     as patient_condition_id,
    patient_id,
    condition_id,
    coalesce(date_ended, date_started) as updated_at,
    date_started,
    date_ended
from "takehome"."raw"."patient_conditions"
  );

[0m15:58:50.281916 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:58:50.286657 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m15:58:50.286657 [debug] [Thread-4 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id as patient_id,
    coalesce(
        date_deactivated,
        date_activated,
        date_of_death,
        date_of_birth
    )                                    as updated_at,
    first_name,
    last_name,
    ssn,
    date_of_birth,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_death,
    date_activated,
    date_deactivated
from "takehome"."raw"."patients"
  );

[0m15:58:50.287553 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.291327 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m15:58:50.291327 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m15:58:50.292327 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" rename to "stg_patient_conditions"
[0m15:58:50.292327 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:58:50.293328 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m15:58:50.296437 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m15:58:50.298465 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m15:58:50.298465 [debug] [Thread-2 (]: On model.takehome.stg_visits: BEGIN
[0m15:58:50.299459 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.299459 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:58:50.299459 [debug] [Thread-4 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m15:58:50.299459 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:50.300459 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m15:58:50.301466 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m15:58:50.302368 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.302368 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.303413 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m15:58:50.303413 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:58:50.305428 [debug] [Thread-1 (]: On model.takehome.stg_orders: COMMIT
[0m15:58:50.307439 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m15:58:50.307439 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m15:58:50.309022 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m15:58:50.310065 [debug] [Thread-4 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m15:58:50.310065 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

  
  create view "takehome"."dev_staging"."stg_visits__dbt_tmp" as (
    select
    id                    as visit_id,
    visit_date            as updated_at,
    patient_condition_id,
    visit_date
from "takehome"."raw"."visits"
  );

[0m15:58:50.311189 [debug] [Thread-1 (]: On model.takehome.stg_orders: COMMIT
[0m15:58:50.311767 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:58:50.314928 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m15:58:50.316044 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:58:50.316044 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:58:50.316044 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:50.316044 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_patient_conditions__dbt_backup" cascade
    
[0m15:58:50.319056 [debug] [Thread-4 (]: On model.takehome.stg_patients: COMMIT
[0m15:58:50.321058 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m15:58:50.322055 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m15:58:50.322055 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m15:58:50.323054 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits__dbt_tmp" rename to "stg_visits"
[0m15:58:50.323054 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

      drop view if exists "takehome"."dev_staging"."stg_orders__dbt_backup" cascade
    
[0m15:58:50.323054 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.324056 [debug] [Thread-4 (]: On model.takehome.stg_patients: COMMIT
[0m15:58:50.325171 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: Close
[0m15:58:50.326177 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.326177 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.327181 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116AD2E64E0>]}
[0m15:58:50.328435 [debug] [Thread-1 (]: On model.takehome.stg_orders: Close
[0m15:58:50.329435 [debug] [Thread-2 (]: On model.takehome.stg_visits: COMMIT
[0m15:58:50.329435 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:58:50.329435 [info ] [Thread-3 (]: 6 of 10 OK created sql view model dev_staging.stg_patient_conditions ........... [[32mOK[0m in 0.08s]
[0m15:58:50.330433 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m15:58:50.330433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116AD357EF0>]}
[0m15:58:50.332572 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m15:58:50.332572 [debug] [Thread-3 (]: Finished running node model.takehome.stg_patient_conditions
[0m15:58:50.332572 [debug] [Thread-2 (]: On model.takehome.stg_visits: COMMIT
[0m15:58:50.333569 [debug] [Thread-4 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

      drop view if exists "takehome"."dev_staging"."stg_patients__dbt_backup" cascade
    
[0m15:58:50.333569 [info ] [Thread-1 (]: 5 of 10 OK created sql view model dev_staging.stg_orders ....................... [[32mOK[0m in 0.08s]
[0m15:58:50.334485 [debug] [Thread-1 (]: Finished running node model.takehome.stg_orders
[0m15:58:50.336628 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.338656 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m15:58:50.338656 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:58:50.338656 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

      drop view if exists "takehome"."dev_staging"."stg_visits__dbt_backup" cascade
    
[0m15:58:50.339657 [debug] [Thread-4 (]: On model.takehome.stg_patients: Close
[0m15:58:50.340765 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m15:58:50.341783 [debug] [Thread-2 (]: On model.takehome.stg_visits: Close
[0m15:58:50.342657 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116ABDF5040>]}
[0m15:58:50.342657 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116AD37D850>]}
[0m15:58:50.343661 [info ] [Thread-4 (]: 7 of 10 OK created sql view model dev_staging.stg_patients ..................... [[32mOK[0m in 0.09s]
[0m15:58:50.344657 [debug] [Thread-4 (]: Finished running node model.takehome.stg_patients
[0m15:58:50.344657 [info ] [Thread-2 (]: 8 of 10 OK created sql view model dev_staging.stg_visits ....................... [[32mOK[0m in 0.09s]
[0m15:58:50.345659 [debug] [Thread-2 (]: Finished running node model.takehome.stg_visits
[0m15:58:50.346657 [debug] [Thread-2 (]: Began running node model.takehome.patients
[0m15:58:50.346657 [info ] [Thread-2 (]: 9 of 10 START sql table model dev_bronze.patients .............................. [RUN]
[0m15:58:50.347656 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_visits, now model.takehome.patients)
[0m15:58:50.347656 [debug] [Thread-2 (]: Began compiling node model.takehome.patients
[0m15:58:50.349656 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.patients"
[0m15:58:50.350657 [debug] [Thread-2 (]: Began executing node model.takehome.patients
[0m15:58:50.375926 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.patients"
[0m15:58:50.376931 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m15:58:50.378294 [debug] [Thread-2 (]: On model.takehome.patients: BEGIN
[0m15:58:50.378294 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:58:50.379298 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.380298 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m15:58:50.380298 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      

with 

pt as ( select * from "takehome"."dev_staging"."stg_patients" )

select
    *
    
from pt

qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m15:58:50.431145 [debug] [Thread-2 (]: SQL status: OK in 0.050 seconds
[0m15:58:50.437506 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m15:58:50.438527 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m15:58:50.439510 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.441500 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m15:58:50.441500 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m15:58:50.444541 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.447516 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m15:58:50.448513 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients" rename to "patients__dbt_backup"
[0m15:58:50.449589 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.452531 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m15:58:50.453763 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients__dbt_tmp" rename to "patients"
[0m15:58:50.454768 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.461249 [debug] [Thread-2 (]: On model.takehome.patients: COMMIT
[0m15:58:50.462265 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m15:58:50.462265 [debug] [Thread-2 (]: On model.takehome.patients: COMMIT
[0m15:58:50.467309 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:58:50.471150 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m15:58:50.472271 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

      drop table if exists "takehome"."dev_bronze"."patients__dbt_backup" cascade
    
[0m15:58:50.474269 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.476266 [debug] [Thread-2 (]: On model.takehome.patients: Close
[0m15:58:50.477266 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116AD3C2510>]}
[0m15:58:50.477266 [info ] [Thread-2 (]: 9 of 10 OK created sql table model dev_bronze.patients ......................... [[32mOK[0m in 0.13s]
[0m15:58:50.478527 [debug] [Thread-2 (]: Finished running node model.takehome.patients
[0m15:58:50.480642 [debug] [Thread-1 (]: Began running node model.takehome.patients_by_age
[0m15:58:50.480642 [info ] [Thread-1 (]: 10 of 10 START sql table model dev_silver.patients_by_age ...................... [RUN]
[0m15:58:50.480642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_orders, now model.takehome.patients_by_age)
[0m15:58:50.483343 [debug] [Thread-1 (]: Began compiling node model.takehome.patients_by_age
[0m15:58:50.486548 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.patients_by_age"
[0m15:58:50.488557 [debug] [Thread-1 (]: Began executing node model.takehome.patients_by_age
[0m15:58:50.491555 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.patients_by_age"
[0m15:58:50.493558 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m15:58:50.493558 [debug] [Thread-1 (]: On model.takehome.patients_by_age: BEGIN
[0m15:58:50.494344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:50.494860 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.495869 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m15:58:50.495869 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_by_age__dbt_tmp"
  
    as (
      /*
    This model should work.
*/


with

pt as ( select * from "takehome"."dev_bronze"."patients" ),

pt_age as (

    select
        patient_id, 
        datediff('years', pt.date_of_birth, current_date()) as age_years

    from pt

)

select 
    age_years, 
    count(distinct patient_id) as patient_count

from pt_age

group by age_years
    );
  
  
[0m15:58:50.509375 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m15:58:50.514384 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m15:58:50.514384 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age__dbt_tmp" rename to "patients_by_age"
[0m15:58:50.516384 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.518384 [debug] [Thread-1 (]: On model.takehome.patients_by_age: COMMIT
[0m15:58:50.518384 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m15:58:50.519384 [debug] [Thread-1 (]: On model.takehome.patients_by_age: COMMIT
[0m15:58:50.521384 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:50.525384 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m15:58:50.526384 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

      drop table if exists "takehome"."dev_silver"."patients_by_age__dbt_backup" cascade
    
[0m15:58:50.527384 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:50.528680 [debug] [Thread-1 (]: On model.takehome.patients_by_age: Close
[0m15:58:50.529698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c620dac3-ae00-436a-b03d-64b54cc455f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116AD2FB980>]}
[0m15:58:50.530687 [info ] [Thread-1 (]: 10 of 10 OK created sql table model dev_silver.patients_by_age ................. [[32mOK[0m in 0.05s]
[0m15:58:50.532787 [debug] [Thread-1 (]: Finished running node model.takehome.patients_by_age
[0m15:58:50.535697 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:50.535697 [debug] [MainThread]: On master: BEGIN
[0m15:58:50.536692 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:50.537691 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:58:50.537691 [debug] [MainThread]: On master: COMMIT
[0m15:58:50.538689 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:50.538689 [debug] [MainThread]: On master: COMMIT
[0m15:58:50.539688 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:58:50.539688 [debug] [MainThread]: On master: Close
[0m15:58:50.540688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:50.540688 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m15:58:50.540688 [debug] [MainThread]: Connection 'create_takehome_dev_silver' was properly closed.
[0m15:58:50.541692 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m15:58:50.541692 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m15:58:50.541692 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m15:58:50.541692 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m15:58:50.542689 [debug] [MainThread]: Connection 'model.takehome.patients_by_age' was properly closed.
[0m15:58:50.542689 [debug] [MainThread]: Connection 'model.takehome.patients' was properly closed.
[0m15:58:50.542689 [debug] [MainThread]: Connection 'model.takehome.stg_patient_conditions' was properly closed.
[0m15:58:50.543692 [debug] [MainThread]: Connection 'model.takehome.stg_patients' was properly closed.
[0m15:58:50.543692 [info ] [MainThread]: 
[0m15:58:50.544688 [info ] [MainThread]: Finished running 2 table models, 8 view models in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m15:58:50.548700 [debug] [MainThread]: Command end result
[0m15:58:50.580303 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m15:58:50.586652 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m15:58:50.601180 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m15:58:50.601180 [info ] [MainThread]: 
[0m15:58:50.603642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:50.605652 [info ] [MainThread]: 
[0m15:58:50.605652 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m15:58:50.605652 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:50.605652 after 11.84 seconds
[0m15:58:50.605652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116A9E76ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116AD358950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000116A97494C0>]}
[0m15:58:50.609512 [debug] [MainThread]: Flushing usage events
[0m15:58:51.312602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:00.632608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ACB9F18B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ACBFF2C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ACC46F8F0>]}


============================== 15:59:00.644636 | 05fc325b-9a0c-4886-9c3c-952d5fe0adba ==============================
[0m15:59:00.644636 [info ] [MainThread]: Running with dbt=1.10.15
[0m15:59:00.645549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'no_print': 'None', 'invocation_command': 'dbt test', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:59:00.874401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05fc325b-9a0c-4886-9c3c-952d5fe0adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ACC46F5C0>]}
[0m15:59:01.003750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05fc325b-9a0c-4886-9c3c-952d5fe0adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ACD65A180>]}
[0m15:59:01.008758 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:59:01.349478 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m15:59:01.556573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:01.557572 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:01.628327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05fc325b-9a0c-4886-9c3c-952d5fe0adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ACDBB0E30>]}
[0m15:59:01.739799 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m15:59:01.743924 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m15:59:01.813364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05fc325b-9a0c-4886-9c3c-952d5fe0adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ACE08F0E0>]}
[0m15:59:01.814389 [info ] [MainThread]: Found 10 models, 8 data tests, 8 sources, 468 macros
[0m15:59:01.815517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05fc325b-9a0c-4886-9c3c-952d5fe0adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ACDBB0BC0>]}
[0m15:59:01.819368 [info ] [MainThread]: 
[0m15:59:01.819368 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:01.820388 [info ] [MainThread]: 
[0m15:59:01.821385 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:59:01.829537 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m15:59:01.851932 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m15:59:01.854929 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m15:59:01.948481 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m15:59:01.949486 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m15:59:01.949486 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m15:59:01.950512 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m15:59:01.950512 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m15:59:01.951517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:01.951517 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m15:59:01.951517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:01.952480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:01.996859 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m15:59:01.997830 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m15:59:01.997830 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m15:59:01.998910 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m15:59:02.000800 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m15:59:02.000800 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m15:59:02.001797 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m15:59:02.002796 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m15:59:02.002796 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m15:59:02.023796 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m15:59:02.025828 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m15:59:02.026901 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m15:59:02.029056 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m15:59:02.029056 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m15:59:02.031053 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m15:59:02.033292 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m15:59:02.034255 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m15:59:02.034255 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m15:59:02.035298 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m15:59:02.036327 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m15:59:02.037286 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m15:59:02.040217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05fc325b-9a0c-4886-9c3c-952d5fe0adba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ACDF51220>]}
[0m15:59:02.041221 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:02.041221 [debug] [MainThread]: On master: BEGIN
[0m15:59:02.041221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:02.042221 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:59:02.043219 [debug] [MainThread]: On master: COMMIT
[0m15:59:02.044221 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:02.045219 [debug] [MainThread]: On master: COMMIT
[0m15:59:02.045992 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:59:02.047028 [debug] [MainThread]: On master: Close
[0m15:59:02.054336 [debug] [Thread-1 (]: Began running node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m15:59:02.055334 [debug] [Thread-2 (]: Began running node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m15:59:02.055837 [debug] [Thread-3 (]: Began running node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m15:59:02.055837 [info ] [Thread-1 (]: 1 of 8 START test not_null_patients_patient_id ................................. [RUN]
[0m15:59:02.056845 [debug] [Thread-4 (]: Began running node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m15:59:02.057846 [info ] [Thread-2 (]: 2 of 8 START test not_null_stg_orders_order_id ................................. [RUN]
[0m15:59:02.058849 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.takehome.not_null_patients_patient_id.330c5fb3d9'
[0m15:59:02.060845 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.takehome.not_null_stg_orders_order_id.81cfe2fe64'
[0m15:59:02.057846 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_patients_patient_id ............................. [RUN]
[0m15:59:02.061909 [debug] [Thread-1 (]: Began compiling node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m15:59:02.061909 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m15:59:02.059930 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_visits_visit_id ................................. [RUN]
[0m15:59:02.062845 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.takehome.not_null_stg_patients_patient_id.e578180344'
[0m15:59:02.087208 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m15:59:02.093506 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:59:02.094505 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.takehome.not_null_stg_visits_visit_id.a2f537804c'
[0m15:59:02.095504 [debug] [Thread-3 (]: Began compiling node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m15:59:02.095504 [debug] [Thread-4 (]: Began compiling node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m15:59:02.102606 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m15:59:02.108638 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m15:59:02.109654 [debug] [Thread-1 (]: Began executing node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m15:59:02.130504 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m15:59:02.131536 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m15:59:02.133514 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:59:02.133514 [debug] [Thread-3 (]: Began executing node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m15:59:02.133514 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m15:59:02.133514 [debug] [Thread-4 (]: Began executing node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m15:59:02.133514 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m15:59:02.133514 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m15:59:02.133514 [debug] [Thread-1 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: BEGIN
[0m15:59:02.133514 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:59:02.133514 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m15:59:02.133514 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:59:02.133514 [debug] [Thread-2 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m15:59:02.133514 [debug] [Thread-3 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: BEGIN
[0m15:59:02.133514 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:59:02.147471 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m15:59:02.147780 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:59:02.148787 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:59:02.148787 [debug] [Thread-4 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: BEGIN
[0m15:59:02.150003 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:59:02.150521 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m15:59:02.150972 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:59:02.150972 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:59:02.151981 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:59:02.152996 [debug] [Thread-1 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_patient_id.330c5fb3d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_bronze"."patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m15:59:02.152996 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m15:59:02.154039 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:59:02.154039 [debug] [Thread-2 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "takehome"."dev_staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:59:02.155017 [debug] [Thread-3 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_patients_patient_id.e578180344"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_staging"."stg_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m15:59:02.156020 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m15:59:02.156020 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:59:02.157120 [debug] [Thread-4 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_visits_visit_id.a2f537804c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from "takehome"."dev_staging"."stg_visits"
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m15:59:02.162524 [debug] [Thread-1 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: ROLLBACK
[0m15:59:02.163522 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m15:59:02.164512 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:59:02.166493 [debug] [Thread-2 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m15:59:02.167539 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:59:02.168490 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.not_null_patients_patient_id.330c5fb3d9'
[0m15:59:02.169507 [debug] [Thread-3 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m15:59:02.170507 [debug] [Thread-1 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: Close
[0m15:59:02.171489 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_stg_orders_order_id.81cfe2fe64'
[0m15:59:02.172507 [debug] [Thread-4 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: ROLLBACK
[0m15:59:02.174494 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.not_null_stg_patients_patient_id.e578180344'
[0m15:59:02.175909 [debug] [Thread-2 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m15:59:02.175909 [info ] [Thread-1 (]: 1 of 8 PASS not_null_patients_patient_id ....................................... [[32mPASS[0m in 0.12s]
[0m15:59:02.176964 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.not_null_stg_visits_visit_id.a2f537804c'
[0m15:59:02.178022 [debug] [Thread-3 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: Close
[0m15:59:02.179005 [debug] [Thread-1 (]: Finished running node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m15:59:02.178022 [info ] [Thread-2 (]: 2 of 8 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.12s]
[0m15:59:02.179949 [debug] [Thread-4 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: Close
[0m15:59:02.180956 [debug] [Thread-1 (]: Began running node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m15:59:02.182528 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m15:59:02.180956 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_patients_patient_id ................................... [[32mPASS[0m in 0.12s]
[0m15:59:02.183393 [info ] [Thread-1 (]: 5 of 8 START test unique_patients_patient_id ................................... [RUN]
[0m15:59:02.185441 [debug] [Thread-2 (]: Began running node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m15:59:02.184839 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_visits_visit_id ....................................... [[32mPASS[0m in 0.09s]
[0m15:59:02.186587 [debug] [Thread-3 (]: Finished running node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m15:59:02.186587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patients_patient_id.330c5fb3d9, now test.takehome.unique_patients_patient_id.8d0f9eb60a)
[0m15:59:02.188104 [debug] [Thread-4 (]: Finished running node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m15:59:02.187646 [info ] [Thread-2 (]: 6 of 8 START test unique_stg_orders_order_id ................................... [RUN]
[0m15:59:02.188104 [debug] [Thread-3 (]: Began running node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m15:59:02.189148 [debug] [Thread-1 (]: Began compiling node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m15:59:02.190112 [debug] [Thread-4 (]: Began running node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m15:59:02.191113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_stg_orders_order_id.81cfe2fe64, now test.takehome.unique_stg_orders_order_id.e3b841c71a)
[0m15:59:02.192112 [info ] [Thread-3 (]: 7 of 8 START test unique_stg_patients_patient_id ............................... [RUN]
[0m15:59:02.202130 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m15:59:02.203163 [debug] [Thread-2 (]: Began compiling node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m15:59:02.204144 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_stg_patients_patient_id.e578180344, now test.takehome.unique_stg_patients_patient_id.8907d3ccf0)
[0m15:59:02.203163 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_visits_visit_id ................................... [RUN]
[0m15:59:02.212160 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m15:59:02.212160 [debug] [Thread-3 (]: Began compiling node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m15:59:02.213143 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_stg_visits_visit_id.a2f537804c, now test.takehome.unique_stg_visits_visit_id.17a0c34d8d)
[0m15:59:02.219728 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m15:59:02.219728 [debug] [Thread-4 (]: Began compiling node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m15:59:02.220713 [debug] [Thread-1 (]: Began executing node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m15:59:02.229714 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m15:59:02.233964 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m15:59:02.234967 [debug] [Thread-2 (]: Began executing node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m15:59:02.240969 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m15:59:02.241969 [debug] [Thread-3 (]: Began executing node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m15:59:02.246113 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m15:59:02.247201 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m15:59:02.247201 [debug] [Thread-4 (]: Began executing node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m15:59:02.248171 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m15:59:02.249116 [debug] [Thread-1 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: BEGIN
[0m15:59:02.252170 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m15:59:02.253149 [debug] [Thread-2 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m15:59:02.253149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:02.254146 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m15:59:02.254146 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:59:02.255171 [debug] [Thread-3 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: BEGIN
[0m15:59:02.256243 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:59:02.257114 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:59:02.258116 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m15:59:02.258116 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:59:02.259195 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m15:59:02.259195 [debug] [Thread-4 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: BEGIN
[0m15:59:02.260274 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m15:59:02.261172 [debug] [Thread-1 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_patients_patient_id.8d0f9eb60a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_bronze"."patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:59:02.262145 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:59:02.262145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:59:02.263150 [debug] [Thread-2 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "takehome"."dev_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:59:02.264138 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m15:59:02.264138 [debug] [Thread-3 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_staging"."stg_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:59:02.265109 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:59:02.266111 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m15:59:02.266111 [debug] [Thread-4 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    visit_id as unique_field,
    count(*) as n_records

from "takehome"."dev_staging"."stg_visits"
where visit_id is not null
group by visit_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:59:02.276114 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m15:59:02.277112 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m15:59:02.278128 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m15:59:02.279218 [debug] [Thread-2 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m15:59:02.280161 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m15:59:02.282511 [debug] [Thread-3 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: ROLLBACK
[0m15:59:02.282511 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.unique_stg_orders_order_id.e3b841c71a'
[0m15:59:02.284657 [debug] [Thread-1 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: ROLLBACK
[0m15:59:02.286744 [debug] [Thread-4 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: ROLLBACK
[0m15:59:02.287718 [debug] [Thread-2 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: Close
[0m15:59:02.288736 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.unique_stg_patients_patient_id.8907d3ccf0'
[0m15:59:02.289718 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.unique_patients_patient_id.8d0f9eb60a'
[0m15:59:02.291160 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.unique_stg_visits_visit_id.17a0c34d8d'
[0m15:59:02.291799 [debug] [Thread-3 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: Close
[0m15:59:02.291799 [info ] [Thread-2 (]: 6 of 8 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.10s]
[0m15:59:02.292846 [debug] [Thread-1 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: Close
[0m15:59:02.292846 [debug] [Thread-4 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: Close
[0m15:59:02.294806 [debug] [Thread-2 (]: Finished running node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m15:59:02.293838 [info ] [Thread-3 (]: 7 of 8 PASS unique_stg_patients_patient_id ..................................... [[32mPASS[0m in 0.09s]
[0m15:59:02.296474 [debug] [Thread-3 (]: Finished running node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m15:59:02.295433 [info ] [Thread-1 (]: 5 of 8 PASS unique_patients_patient_id ......................................... [[32mPASS[0m in 0.11s]
[0m15:59:02.297440 [debug] [Thread-1 (]: Finished running node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m15:59:02.295433 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_visits_visit_id ......................................... [[32mPASS[0m in 0.08s]
[0m15:59:02.298535 [debug] [Thread-4 (]: Finished running node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m15:59:02.301443 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:02.301443 [debug] [MainThread]: On master: BEGIN
[0m15:59:02.302440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:02.303437 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:59:02.303437 [debug] [MainThread]: On master: COMMIT
[0m15:59:02.303437 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:02.304457 [debug] [MainThread]: On master: COMMIT
[0m15:59:02.304457 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:59:02.305440 [debug] [MainThread]: On master: Close
[0m15:59:02.305440 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:02.305440 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m15:59:02.306439 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m15:59:02.306439 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m15:59:02.307439 [debug] [MainThread]: Connection 'test.takehome.unique_patients_patient_id.8d0f9eb60a' was properly closed.
[0m15:59:02.307439 [debug] [MainThread]: Connection 'test.takehome.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m15:59:02.307439 [debug] [MainThread]: Connection 'test.takehome.unique_stg_patients_patient_id.8907d3ccf0' was properly closed.
[0m15:59:02.308431 [debug] [MainThread]: Connection 'test.takehome.unique_stg_visits_visit_id.17a0c34d8d' was properly closed.
[0m15:59:02.308431 [info ] [MainThread]: 
[0m15:59:02.309472 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m15:59:02.310908 [debug] [MainThread]: Command end result
[0m15:59:02.343807 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m15:59:02.347794 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m15:59:02.356968 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m15:59:02.357905 [info ] [MainThread]: 
[0m15:59:02.359938 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:02.360902 [info ] [MainThread]: 
[0m15:59:02.361892 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m15:59:02.362980 [debug] [MainThread]: Command `dbt test` succeeded at 15:59:02.362980 after 1.88 seconds
[0m15:59:02.364021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AC7C5A240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ACD63A1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026ACB9B3E60>]}
[0m15:59:02.364021 [debug] [MainThread]: Flushing usage events
[0m15:59:02.941365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:45.821629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B739DB590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B76A63DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B76A63080>]}


============================== 16:19:45.827749 | a4c17db4-c94b-4c92-b90c-b03b91878e89 ==============================
[0m16:19:45.827749 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:19:45.829037 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:19:45.996858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B77DD29C0>]}
[0m16:19:46.040270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B77E58DD0>]}
[0m16:19:46.042239 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:19:46.165531 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:19:46.297919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m16:19:46.297919 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\summary\_mart_summary_models.yml
[0m16:19:46.298917 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\silver\_mart_silver_models.yml
[0m16:19:46.298917 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\summary\medications_per_month.sql
[0m16:19:46.298917 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\summary\patients_per_month.sql
[0m16:19:46.298917 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\summary\patients_by_age.sql
[0m16:19:46.543788 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m16:19:46.544583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B786920F0>]}
[0m16:19:46.611139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B788EEE10>]}
[0m16:19:46.664796 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m16:19:46.666746 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m16:19:46.737126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B709A08F0>]}
[0m16:19:46.737126 [info ] [MainThread]: Found 12 models, 16 data tests, 8 sources, 468 macros
[0m16:19:46.738239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7077C1D0>]}
[0m16:19:46.739122 [info ] [MainThread]: 
[0m16:19:46.740733 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:19:46.740733 [info ] [MainThread]: 
[0m16:19:46.741739 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:19:46.745788 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m16:19:46.753778 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m16:19:46.756785 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m16:19:46.793588 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m16:19:46.793588 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m16:19:46.794590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:46.794590 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m16:19:46.794590 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m16:19:46.795586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:46.795586 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m16:19:46.795586 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m16:19:46.795586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:46.808566 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m16:19:46.808566 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m16:19:46.808566 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m16:19:46.810787 [debug] [ThreadPool]: On list_takehome: Close
[0m16:19:46.810787 [debug] [ThreadPool]: On list_takehome: Close
[0m16:19:46.810787 [debug] [ThreadPool]: On list_takehome: Close
[0m16:19:46.810787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_silver)
[0m16:19:46.810787 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_silver"
"
[0m16:19:46.810787 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:19:46.810787 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m16:19:46.810787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m16:19:46.810787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:46.820499 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m16:19:46.822234 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:19:46.823234 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m16:19:46.823234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:46.823234 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:19:46.825233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m16:19:46.826240 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:19:46.826240 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m16:19:46.827279 [debug] [ThreadPool]: On create_takehome_dev_silver: BEGIN
[0m16:19:46.827279 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:19:46.828922 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:19:46.828922 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:19:46.828922 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m16:19:46.830431 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:19:46.830431 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m16:19:46.831141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:46.831141 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:19:46.832193 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:19:46.832193 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
    
        create schema if not exists "takehome"."dev_silver"
    
[0m16:19:46.832193 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:19:46.833147 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:19:46.834147 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:19:46.834601 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:19:46.834601 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m16:19:46.834601 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m16:19:46.835613 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m16:19:46.835613 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:19:46.836617 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:19:46.836617 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:19:46.837641 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m16:19:46.837641 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:19:46.837641 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m16:19:46.837641 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:19:46.838615 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m16:19:46.838615 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m16:19:46.838615 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:19:46.839612 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:19:46.839612 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m16:19:46.839612 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:19:46.840612 [debug] [ThreadPool]: On create_takehome_dev_silver: Close
[0m16:19:46.840612 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:19:46.840612 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m16:19:46.841690 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m16:19:46.841690 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:19:46.841690 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m16:19:46.844263 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m16:19:46.844263 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m16:19:46.848288 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m16:19:46.849272 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m16:19:46.849272 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m16:19:46.850778 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m16:19:46.851783 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m16:19:46.851783 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m16:19:46.852783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:46.852783 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m16:19:46.853152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:46.853152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:46.853152 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:19:46.854153 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:19:46.854153 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m16:19:46.855154 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:19:46.855154 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m16:19:46.855154 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m16:19:46.855154 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m16:19:46.855154 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m16:19:46.855154 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m16:19:46.864709 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m16:19:46.867604 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m16:19:46.868367 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m16:19:46.869414 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:19:46.869775 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m16:19:46.870724 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m16:19:46.873063 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m16:19:46.873063 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m16:19:46.875063 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m16:19:46.875063 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m16:19:46.876064 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m16:19:46.876064 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m16:19:46.877090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B788EE9C0>]}
[0m16:19:46.878063 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:46.878063 [debug] [MainThread]: On master: BEGIN
[0m16:19:46.878063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:46.878063 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:19:46.879211 [debug] [MainThread]: On master: COMMIT
[0m16:19:46.879211 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:46.879211 [debug] [MainThread]: On master: COMMIT
[0m16:19:46.879211 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:19:46.879211 [debug] [MainThread]: On master: Close
[0m16:19:46.880734 [debug] [Thread-1 (]: Began running node model.takehome.stg_conditions
[0m16:19:46.880734 [debug] [Thread-2 (]: Began running node model.takehome.stg_documents
[0m16:19:46.880734 [debug] [Thread-3 (]: Began running node model.takehome.stg_med_admins
[0m16:19:46.880734 [debug] [Thread-4 (]: Began running node model.takehome.stg_medications
[0m16:19:46.880734 [info ] [Thread-1 (]: 1 of 12 START sql view model dev_staging.stg_conditions ........................ [RUN]
[0m16:19:46.880734 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_conditions'
[0m16:19:46.880734 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_conditions
[0m16:19:46.880734 [info ] [Thread-2 (]: 2 of 12 START sql view model dev_staging.stg_documents ......................... [RUN]
[0m16:19:46.891171 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.takehome.stg_documents'
[0m16:19:46.891171 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_documents
[0m16:19:46.894180 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_documents"
[0m16:19:46.897179 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_conditions"
[0m16:19:46.880734 [info ] [Thread-3 (]: 3 of 12 START sql view model dev_staging.stg_med_admins ........................ [RUN]
[0m16:19:46.897179 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.stg_med_admins'
[0m16:19:46.898177 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_med_admins
[0m16:19:46.880734 [info ] [Thread-4 (]: 4 of 12 START sql view model dev_staging.stg_medications ....................... [RUN]
[0m16:19:46.900687 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_med_admins"
[0m16:19:46.900687 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.takehome.stg_medications'
[0m16:19:46.901694 [debug] [Thread-2 (]: Began executing node model.takehome.stg_documents
[0m16:19:46.902693 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_medications
[0m16:19:46.910717 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_medications"
[0m16:19:46.910717 [debug] [Thread-1 (]: Began executing node model.takehome.stg_conditions
[0m16:19:46.933833 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_conditions"
[0m16:19:46.934829 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_documents"
[0m16:19:46.935833 [debug] [Thread-4 (]: Began executing node model.takehome.stg_medications
[0m16:19:46.939832 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_medications"
[0m16:19:46.940832 [debug] [Thread-3 (]: Began executing node model.takehome.stg_med_admins
[0m16:19:46.942024 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:19:46.945026 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_med_admins"
[0m16:19:46.945026 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:19:46.946038 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:19:46.946038 [debug] [Thread-1 (]: On model.takehome.stg_conditions: BEGIN
[0m16:19:46.946038 [debug] [Thread-2 (]: On model.takehome.stg_documents: BEGIN
[0m16:19:46.947015 [debug] [Thread-4 (]: On model.takehome.stg_medications: BEGIN
[0m16:19:46.947015 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:19:46.948012 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:19:46.948012 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:19:46.949010 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:19:46.949010 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: BEGIN
[0m16:19:46.949010 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:19:46.950519 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:19:46.950519 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:19:46.950519 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:19:46.951525 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:19:46.951525 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:19:46.952525 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:19:46.952525 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

  
  create view "takehome"."dev_staging"."stg_conditions__dbt_tmp" as (
    select
    id   as condition_id,
    name as condition_name
from "takehome"."raw"."conditions"
  );

[0m16:19:46.952525 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:19:46.953524 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

  
  create view "takehome"."dev_staging"."stg_documents__dbt_tmp" as (
    select
    document_id,
    patient_id,
    visit_id,
    document_line,
    document_text
from "takehome"."raw"."documents"
  );

[0m16:19:46.953524 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

  
  create view "takehome"."dev_staging"."stg_medications__dbt_tmp" as (
    select
    id   as medication_id,
    name as medication_name
from "takehome"."raw"."medications"
  );

[0m16:19:46.953524 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:19:46.954527 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:46.954527 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

  
  create view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" as (
    select
    patient_id,
    patient_condition_id,
    medication_id,
    coalesce(date_stopped, date_started) as updated_at,
    date_started,
    date_stopped,
    dosage
from "takehome"."raw"."med_admins"
  );

[0m16:19:46.955526 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:19:46.956527 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:19:46.962097 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:19:46.964089 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:19:46.964089 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:19:46.966091 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:19:46.967078 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions" rename to "stg_conditions__dbt_backup"
[0m16:19:46.967405 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents" rename to "stg_documents__dbt_backup"
[0m16:19:46.968517 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:19:46.969523 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications" rename to "stg_medications__dbt_backup"
[0m16:19:46.969523 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:19:46.970417 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins" rename to "stg_med_admins__dbt_backup"
[0m16:19:46.970417 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:19:46.972715 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:19:46.973551 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:19:46.975551 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:19:46.975551 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:19:46.976310 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions__dbt_tmp" rename to "stg_conditions"
[0m16:19:46.978409 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:19:46.978682 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents__dbt_tmp" rename to "stg_documents"
[0m16:19:46.980806 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:19:46.980806 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications__dbt_tmp" rename to "stg_medications"
[0m16:19:46.980806 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:46.980806 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" rename to "stg_med_admins"
[0m16:19:46.980806 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:19:46.990982 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m16:19:46.991991 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m16:19:46.992988 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m16:19:46.993491 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:19:46.993491 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:19:46.994513 [debug] [Thread-4 (]: On model.takehome.stg_medications: COMMIT
[0m16:19:46.995510 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:19:46.995510 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: COMMIT
[0m16:19:46.996510 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m16:19:46.996510 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:19:46.997509 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m16:19:46.997509 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:19:46.997509 [debug] [Thread-4 (]: On model.takehome.stg_medications: COMMIT
[0m16:19:46.998516 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: COMMIT
[0m16:19:47.001744 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:19:47.005967 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:19:47.005967 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_conditions__dbt_backup" cascade
    
[0m16:19:47.005967 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m16:19:47.005967 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m16:19:47.005967 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m16:19:47.008739 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:19:47.010898 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:19:47.010898 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:19:47.010898 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

      drop view if exists "takehome"."dev_staging"."stg_med_admins__dbt_backup" cascade
    
[0m16:19:47.010898 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:19:47.010898 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

      drop view if exists "takehome"."dev_staging"."stg_medications__dbt_backup" cascade
    
[0m16:19:47.010898 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

      drop view if exists "takehome"."dev_staging"."stg_documents__dbt_backup" cascade
    
[0m16:19:47.010898 [debug] [Thread-1 (]: On model.takehome.stg_conditions: Close
[0m16:19:47.010898 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:19:47.010898 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: Close
[0m16:19:47.020715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B787E7230>]}
[0m16:19:47.020715 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:19:47.020715 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B79CB2E40>]}
[0m16:19:47.023610 [debug] [Thread-4 (]: On model.takehome.stg_medications: Close
[0m16:19:47.023610 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m16:19:47.021738 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dev_staging.stg_conditions ................... [[32mOK[0m in 0.13s]
[0m16:19:47.024722 [info ] [Thread-3 (]: 3 of 12 OK created sql view model dev_staging.stg_med_admins ................... [[32mOK[0m in 0.11s]
[0m16:19:47.025214 [debug] [Thread-2 (]: On model.takehome.stg_documents: Close
[0m16:19:47.026222 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B79CFEE40>]}
[0m16:19:47.026222 [debug] [Thread-1 (]: Finished running node model.takehome.stg_conditions
[0m16:19:47.027249 [debug] [Thread-3 (]: Finished running node model.takehome.stg_med_admins
[0m16:19:47.028220 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B78C16D50>]}
[0m16:19:47.028220 [debug] [Thread-1 (]: Began running node model.takehome.stg_orders
[0m16:19:47.028220 [info ] [Thread-4 (]: 4 of 12 OK created sql view model dev_staging.stg_medications .................. [[32mOK[0m in 0.13s]
[0m16:19:47.029418 [debug] [Thread-3 (]: Began running node model.takehome.stg_patient_conditions
[0m16:19:47.029418 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dev_staging.stg_documents .................... [[32mOK[0m in 0.14s]
[0m16:19:47.030581 [debug] [Thread-4 (]: Finished running node model.takehome.stg_medications
[0m16:19:47.029418 [info ] [Thread-1 (]: 5 of 12 START sql view model dev_staging.stg_orders ............................ [RUN]
[0m16:19:47.031705 [debug] [Thread-2 (]: Finished running node model.takehome.stg_documents
[0m16:19:47.031705 [debug] [Thread-4 (]: Began running node model.takehome.stg_patients
[0m16:19:47.030581 [info ] [Thread-3 (]: 6 of 12 START sql view model dev_staging.stg_patient_conditions ................ [RUN]
[0m16:19:47.032705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_conditions, now model.takehome.stg_orders)
[0m16:19:47.033698 [debug] [Thread-2 (]: Began running node model.takehome.stg_visits
[0m16:19:47.035540 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_med_admins, now model.takehome.stg_patient_conditions)
[0m16:19:47.033698 [info ] [Thread-4 (]: 7 of 12 START sql view model dev_staging.stg_patients .......................... [RUN]
[0m16:19:47.035540 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_orders
[0m16:19:47.037680 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_patient_conditions
[0m16:19:47.038549 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_medications, now model.takehome.stg_patients)
[0m16:19:47.040616 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_orders"
[0m16:19:47.036625 [info ] [Thread-2 (]: 8 of 12 START sql view model dev_staging.stg_visits ............................ [RUN]
[0m16:19:47.044715 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_patient_conditions"
[0m16:19:47.044715 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_patients
[0m16:19:47.045661 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_documents, now model.takehome.stg_visits)
[0m16:19:47.049049 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m16:19:47.049049 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_visits
[0m16:19:47.050561 [debug] [Thread-1 (]: Began executing node model.takehome.stg_orders
[0m16:19:47.054796 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_visits"
[0m16:19:47.058041 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_orders"
[0m16:19:47.059041 [debug] [Thread-3 (]: Began executing node model.takehome.stg_patient_conditions
[0m16:19:47.059041 [debug] [Thread-4 (]: Began executing node model.takehome.stg_patients
[0m16:19:47.064575 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_patient_conditions"
[0m16:19:47.066562 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m16:19:47.068561 [debug] [Thread-2 (]: Began executing node model.takehome.stg_visits
[0m16:19:47.069563 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:19:47.072599 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_visits"
[0m16:19:47.073597 [debug] [Thread-1 (]: On model.takehome.stg_orders: BEGIN
[0m16:19:47.074598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:47.075606 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:19:47.076598 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:19:47.077604 [debug] [Thread-4 (]: On model.takehome.stg_patients: BEGIN
[0m16:19:47.077604 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:19:47.078604 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: BEGIN
[0m16:19:47.078919 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:19:47.078919 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:47.079923 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:19:47.079923 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:47.080438 [debug] [Thread-2 (]: On model.takehome.stg_visits: BEGIN
[0m16:19:47.081450 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

  
  create view "takehome"."dev_staging"."stg_orders__dbt_tmp" as (
    select
    id            as order_id,
    patient_id,
    condition_id,
    order_date    as updated_at,
    order_date
from "takehome"."raw"."orders"
  );

[0m16:19:47.081450 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:19:47.081450 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:47.083284 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:19:47.084557 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:19:47.084557 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:19:47.085554 [debug] [Thread-4 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id as patient_id,
    coalesce(
        date_deactivated,
        date_activated,
        date_of_death,
        date_of_birth
    )                                    as updated_at,
    first_name,
    last_name,
    ssn,
    date_of_birth,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_death,
    date_activated,
    date_deactivated
from "takehome"."raw"."patients"
  );

[0m16:19:47.085554 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:19:47.086556 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:19:47.089551 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:19:47.090551 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:19:47.091869 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

  
  create view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" as (
    select
    id                     as patient_condition_id,
    patient_id,
    condition_id,
    coalesce(date_ended, date_started) as updated_at,
    date_started,
    date_ended
from "takehome"."raw"."patient_conditions"
  );

[0m16:19:47.091869 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:19:47.092908 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m16:19:47.092908 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

  
  create view "takehome"."dev_staging"."stg_visits__dbt_tmp" as (
    select
    id                    as visit_id,
    visit_date            as updated_at,
    patient_condition_id,
    visit_date
from "takehome"."raw"."visits"
  );

[0m16:19:47.095884 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:19:47.096884 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:19:47.096884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:47.097888 [debug] [Thread-4 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m16:19:47.097888 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:19:47.101431 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:19:47.104440 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:19:47.107550 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:19:47.108546 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions" rename to "stg_patient_conditions__dbt_backup"
[0m16:19:47.108546 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m16:19:47.108546 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:19:47.109699 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits" rename to "stg_visits__dbt_backup"
[0m16:19:47.113704 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:19:47.114351 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:19:47.114993 [debug] [Thread-4 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m16:19:47.117892 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:19:47.118498 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:19:47.119030 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:19:47.119575 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:19:47.120143 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" rename to "stg_patient_conditions"
[0m16:19:47.121711 [debug] [Thread-1 (]: On model.takehome.stg_orders: COMMIT
[0m16:19:47.125317 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:19:47.127457 [debug] [Thread-4 (]: On model.takehome.stg_patients: COMMIT
[0m16:19:47.128803 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:19:47.129340 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits__dbt_tmp" rename to "stg_visits"
[0m16:19:47.129863 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:19:47.130411 [debug] [Thread-1 (]: On model.takehome.stg_orders: COMMIT
[0m16:19:47.131171 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:19:47.132275 [debug] [Thread-4 (]: On model.takehome.stg_patients: COMMIT
[0m16:19:47.134650 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m16:19:47.135907 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:19:47.136442 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m16:19:47.137245 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:19:47.139011 [debug] [Thread-2 (]: On model.takehome.stg_visits: COMMIT
[0m16:19:47.139539 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:19:47.139539 [debug] [Thread-2 (]: On model.takehome.stg_visits: COMMIT
[0m16:19:47.140071 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:19:47.141196 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:19:47.143644 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:19:47.145683 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:19:47.145683 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m16:19:47.146707 [debug] [Thread-4 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

      drop view if exists "takehome"."dev_staging"."stg_patients__dbt_backup" cascade
    
[0m16:19:47.146707 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:19:47.147666 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

      drop view if exists "takehome"."dev_staging"."stg_orders__dbt_backup" cascade
    
[0m16:19:47.148682 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:19:47.150410 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:19:47.151433 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_patient_conditions__dbt_backup" cascade
    
[0m16:19:47.152419 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

      drop view if exists "takehome"."dev_staging"."stg_visits__dbt_backup" cascade
    
[0m16:19:47.153417 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:19:47.153898 [debug] [Thread-4 (]: On model.takehome.stg_patients: Close
[0m16:19:47.154926 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B787434A0>]}
[0m16:19:47.154926 [info ] [Thread-4 (]: 7 of 12 OK created sql view model dev_staging.stg_patients ..................... [[32mOK[0m in 0.12s]
[0m16:19:47.156202 [debug] [Thread-4 (]: Finished running node model.takehome.stg_patients
[0m16:19:47.156202 [debug] [Thread-4 (]: Began running node model.takehome.medications_per_month
[0m16:19:47.157294 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:19:47.159300 [debug] [Thread-3 (]: On model.takehome.stg_patient_conditions: Close
[0m16:19:47.159300 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:19:47.156202 [info ] [Thread-4 (]: 9 of 12 START sql table model dev_silver.medications_per_month ................. [RUN]
[0m16:19:47.159300 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:19:47.160805 [debug] [Thread-1 (]: On model.takehome.stg_orders: Close
[0m16:19:47.161811 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patients, now model.takehome.medications_per_month)
[0m16:19:47.161811 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B79D87B30>]}
[0m16:19:47.162811 [debug] [Thread-2 (]: On model.takehome.stg_visits: Close
[0m16:19:47.163815 [debug] [Thread-4 (]: Began compiling node model.takehome.medications_per_month
[0m16:19:47.163815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B79D7A2A0>]}
[0m16:19:47.165814 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B79CB3650>]}
[0m16:19:47.164812 [info ] [Thread-3 (]: 6 of 12 OK created sql view model dev_staging.stg_patient_conditions ........... [[32mOK[0m in 0.13s]
[0m16:19:47.168815 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.medications_per_month"
[0m16:19:47.169823 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dev_staging.stg_orders ....................... [[32mOK[0m in 0.13s]
[0m16:19:47.172282 [debug] [Thread-3 (]: Finished running node model.takehome.stg_patient_conditions
[0m16:19:47.170817 [info ] [Thread-2 (]: 8 of 12 OK created sql view model dev_staging.stg_visits ....................... [[32mOK[0m in 0.12s]
[0m16:19:47.173290 [debug] [Thread-1 (]: Finished running node model.takehome.stg_orders
[0m16:19:47.173290 [debug] [Thread-3 (]: Began running node model.takehome.patients
[0m16:19:47.174283 [debug] [Thread-2 (]: Finished running node model.takehome.stg_visits
[0m16:19:47.176289 [debug] [Thread-4 (]: Began executing node model.takehome.medications_per_month
[0m16:19:47.175284 [info ] [Thread-3 (]: 10 of 12 START sql table model dev_bronze.patients ............................. [RUN]
[0m16:19:47.192250 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.medications_per_month"
[0m16:19:47.193440 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patient_conditions, now model.takehome.patients)
[0m16:19:47.194223 [debug] [Thread-3 (]: Began compiling node model.takehome.patients
[0m16:19:47.196334 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.patients"
[0m16:19:47.197229 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:19:47.197229 [debug] [Thread-4 (]: On model.takehome.medications_per_month: BEGIN
[0m16:19:47.197229 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:19:47.198229 [debug] [Thread-3 (]: Began executing node model.takehome.patients
[0m16:19:47.200547 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.patients"
[0m16:19:47.202556 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:19:47.202556 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:19:47.202556 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."medications_per_month__dbt_tmp"
  
    as (
      with med_admins as (
    select
        patient_id,
        medication_id,
        date_started
    from "takehome"."dev_staging"."stg_med_admins"
    where date_started is not null
),

meds as (
    select
        medication_id,
        medication_name
    from "takehome"."dev_staging"."stg_medications"
),

med_admins_month as (
    select
        date_trunc('month', date_started) as month,
        medication_id,
        patient_id
    from med_admins
)

select
    m.month,
    med.medication_id,
    med.medication_name,
    count(*)                          as administrations,
    count(distinct m.patient_id)      as patients_treated
from med_admins_month m
join meds med
    on m.medication_id = med.medication_id
group by 1,2,3
order by 1,2;
    );
  
  
[0m16:19:47.219228 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."medications_per_month__dbt_tmp"
  
    as (
      with med_admins as (
    select
        patient_id,
        medication_id,
        date_started
    from "takehome"."dev_staging"."stg_med_admins"
    where date_started is not null
),

meds as (
    select
        medication_id,
        medication_name
    from "takehome"."dev_staging"."stg_medications"
),

med_admins_month as (
    select
        date_trunc('month', date_started) as month,
        medication_id,
        patient_id
    from med_admins
)

select
    m.month,
    med.medication_id,
    med.medication_name,
    count(*)                          as administrations,
    count(distinct m.patient_id)      as patients_treated
from med_admins_month m
join meds med
    on m.medication_id = med.medication_id
group by 1,2,3
order by 1,2;
    );
  
  
[0m16:19:47.219228 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m16:19:47.220758 [debug] [Thread-4 (]: On model.takehome.medications_per_month: ROLLBACK
[0m16:19:47.221777 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:19:47.222777 [debug] [Thread-3 (]: On model.takehome.patients: BEGIN
[0m16:19:47.222777 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:19:47.222777 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:19:47.223773 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:19:47.223773 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      

with 

pt as ( select * from "takehome"."dev_staging"."stg_patients" )

select
    *
    
from pt

qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m16:19:47.238782 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m16:19:47.243331 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:19:47.243331 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m16:19:47.244332 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:19:47.245316 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:19:47.245316 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m16:19:47.246313 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:19:47.248447 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:19:47.249337 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients" rename to "patients__dbt_backup"
[0m16:19:47.249337 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m16:19:47.253037 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:19:47.253037 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients__dbt_tmp" rename to "patients"
[0m16:19:47.254464 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m16:19:47.258055 [debug] [Thread-3 (]: On model.takehome.patients: COMMIT
[0m16:19:47.258055 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:19:47.258055 [debug] [Thread-3 (]: On model.takehome.patients: COMMIT
[0m16:19:47.262472 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:19:47.264606 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:19:47.265606 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

      drop table if exists "takehome"."dev_bronze"."patients__dbt_backup" cascade
    
[0m16:19:47.267547 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:19:47.268513 [debug] [Thread-3 (]: On model.takehome.patients: Close
[0m16:19:47.269470 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B79E0E3F0>]}
[0m16:19:47.269470 [info ] [Thread-3 (]: 10 of 12 OK created sql table model dev_bronze.patients ........................ [[32mOK[0m in 0.08s]
[0m16:19:47.270504 [debug] [Thread-3 (]: Finished running node model.takehome.patients
[0m16:19:47.270504 [debug] [Thread-1 (]: Began running node model.takehome.patients_by_age
[0m16:19:47.271890 [debug] [Thread-2 (]: Began running node model.takehome.patients_per_month
[0m16:19:47.271890 [info ] [Thread-1 (]: 11 of 12 START sql table model dev_silver.patients_by_age ...................... [RUN]
[0m16:19:47.273843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_orders, now model.takehome.patients_by_age)
[0m16:19:47.273843 [debug] [Thread-1 (]: Began compiling node model.takehome.patients_by_age
[0m16:19:47.275896 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.patients_by_age"
[0m16:19:47.272887 [info ] [Thread-2 (]: 12 of 12 START sql table model dev_silver.patients_per_month ................... [RUN]
[0m16:19:47.276905 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_visits, now model.takehome.patients_per_month)
[0m16:19:47.277911 [debug] [Thread-2 (]: Began compiling node model.takehome.patients_per_month
[0m16:19:47.280904 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.patients_per_month"
[0m16:19:47.280904 [debug] [Thread-1 (]: Began executing node model.takehome.patients_by_age
[0m16:19:47.285036 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.patients_by_age"
[0m16:19:47.285966 [debug] [Thread-2 (]: Began executing node model.takehome.patients_per_month
[0m16:19:47.289275 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.patients_per_month"
[0m16:19:47.290856 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:19:47.291936 [debug] [Thread-1 (]: On model.takehome.patients_by_age: BEGIN
[0m16:19:47.291936 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:47.292916 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:19:47.292916 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:19:47.293935 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_by_age__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_of_birth,
        gender,
        race,
        ethnicity,
        smoker,
        drinks_per_week,
        date_activated,
        date_deactivated,
        date_of_death
    from "takehome"."dev_bronze"."patients"      -- modelo intermedio deduplicado
)

select
    patient_id,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_birth,
    date_activated,
    date_deactivated,
    date_of_death,
    date_diff('year', date_of_birth, current_date) as age,
    case
        when date_of_birth is null then 'unknown'
        when date_diff('year', date_of_birth, current_date) < 18 then '0-17'
        when date_diff('year', date_of_birth, current_date) between 18 and 34 then '18-34'
        when date_diff('year', date_of_birth, current_date) between 35 and 49 then '35-49'
        when date_diff('year', date_of_birth, current_date) between 50 and 64 then '50-64'
        else '65+'
    end as age_group
from patients;
    );
  
  
[0m16:19:47.295002 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_by_age__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_of_birth,
        gender,
        race,
        ethnicity,
        smoker,
        drinks_per_week,
        date_activated,
        date_deactivated,
        date_of_death
    from "takehome"."dev_bronze"."patients"      -- modelo intermedio deduplicado
)

select
    patient_id,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_birth,
    date_activated,
    date_deactivated,
    date_of_death,
    date_diff('year', date_of_birth, current_date) as age,
    case
        when date_of_birth is null then 'unknown'
        when date_diff('year', date_of_birth, current_date) < 18 then '0-17'
        when date_diff('year', date_of_birth, current_date) between 18 and 34 then '18-34'
        when date_diff('year', date_of_birth, current_date) between 35 and 49 then '35-49'
        when date_diff('year', date_of_birth, current_date) between 50 and 64 then '50-64'
        else '65+'
    end as age_group
from patients;
    );
  
  
[0m16:19:47.295002 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:19:47.295002 [debug] [Thread-1 (]: On model.takehome.patients_by_age: ROLLBACK
[0m16:19:47.296008 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:19:47.296961 [debug] [Thread-2 (]: On model.takehome.patients_per_month: BEGIN
[0m16:19:47.296961 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:19:47.297934 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:19:47.297934 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:19:47.297934 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_per_month__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_activated,
        gender
    from "takehome"."dev_bronze"."patients"
    where date_activated is not null
),

patients_by_month as (
    select
        date_trunc('month', date_activated)                           as month,
        count(*)                                                      as new_patients,
        count(distinct case when gender = 'M' then patient_id end)    as new_patients_male,
        count(distinct case when gender = 'F' then patient_id end)    as new_patients_female
    from patients
    group by 1
)

select *
from patients_by_month
order by month;
    );
  
  
[0m16:19:47.298960 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_per_month__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_activated,
        gender
    from "takehome"."dev_bronze"."patients"
    where date_activated is not null
),

patients_by_month as (
    select
        date_trunc('month', date_activated)                           as month,
        count(*)                                                      as new_patients,
        count(distinct case when gender = 'M' then patient_id end)    as new_patients_male,
        count(distinct case when gender = 'F' then patient_id end)    as new_patients_female
    from patients
    group by 1
)

select *
from patients_by_month
order by month;
    );
  
  
[0m16:19:47.298960 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m16:19:47.298960 [debug] [Thread-2 (]: On model.takehome.patients_per_month: ROLLBACK
[0m16:19:47.380490 [debug] [Thread-1 (]: Failed to rollback 'model.takehome.patients_by_age'
[0m16:19:47.380490 [debug] [Thread-1 (]: On model.takehome.patients_by_age: Close
[0m16:19:47.380490 [debug] [Thread-4 (]: Failed to rollback 'model.takehome.medications_per_month'
[0m16:19:47.380490 [debug] [Thread-4 (]: On model.takehome.medications_per_month: Close
[0m16:19:47.380490 [debug] [Thread-2 (]: Failed to rollback 'model.takehome.patients_per_month'
[0m16:19:47.380490 [debug] [Thread-1 (]: Runtime Error in model patients_by_age (dbt/models\marts\summary\patients_by_age.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 46: from patients;
                        ^
[0m16:19:47.380490 [debug] [Thread-2 (]: On model.takehome.patients_per_month: Close
[0m16:19:47.390575 [debug] [Thread-4 (]: Runtime Error in model medications_per_month (dbt/models\marts\summary\medications_per_month.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 45: order by 1,2;
                       ^
[0m16:19:47.390575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B79E1E3C0>]}
[0m16:19:47.390575 [debug] [Thread-2 (]: Runtime Error in model patients_per_month (dbt/models\marts\summary\patients_per_month.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 32: order by month;
                         ^
[0m16:19:47.390575 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B79E597F0>]}
[0m16:19:47.390575 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4c17db4-c94b-4c92-b90c-b03b91878e89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B79E5A090>]}
[0m16:19:47.390575 [error] [Thread-1 (]: 11 of 12 ERROR creating sql table model dev_silver.patients_by_age ............. [[31mERROR[0m in 0.12s]
[0m16:19:47.390575 [error] [Thread-4 (]: 9 of 12 ERROR creating sql table model dev_silver.medications_per_month ........ [[31mERROR[0m in 0.23s]
[0m16:19:47.396573 [debug] [Thread-1 (]: Finished running node model.takehome.patients_by_age
[0m16:19:47.397572 [debug] [Thread-4 (]: Finished running node model.takehome.medications_per_month
[0m16:19:47.396573 [error] [Thread-2 (]: 12 of 12 ERROR creating sql table model dev_silver.patients_per_month .......... [[31mERROR[0m in 0.11s]
[0m16:19:47.398572 [debug] [Thread-7 (]: Marking all children of 'model.takehome.patients_by_age' to be skipped because of status 'error'.  Reason: Runtime Error in model patients_by_age (dbt/models\marts\summary\patients_by_age.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 46: from patients;
                        ^.
[0m16:19:47.399572 [debug] [Thread-2 (]: Finished running node model.takehome.patients_per_month
[0m16:19:47.400572 [debug] [Thread-7 (]: Marking all children of 'model.takehome.medications_per_month' to be skipped because of status 'error'.  Reason: Runtime Error in model medications_per_month (dbt/models\marts\summary\medications_per_month.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 45: order by 1,2;
                       ^.
[0m16:19:47.401076 [debug] [Thread-7 (]: Marking all children of 'model.takehome.patients_per_month' to be skipped because of status 'error'.  Reason: Runtime Error in model patients_per_month (dbt/models\marts\summary\patients_per_month.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 32: order by month;
                         ^.
[0m16:19:47.403078 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:47.403078 [debug] [MainThread]: On master: BEGIN
[0m16:19:47.403078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:47.404237 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:19:47.404237 [debug] [MainThread]: On master: COMMIT
[0m16:19:47.404237 [debug] [MainThread]: Using duckdb connection "master"
[0m16:19:47.404237 [debug] [MainThread]: On master: COMMIT
[0m16:19:47.405347 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:19:47.405347 [debug] [MainThread]: On master: Close
[0m16:19:47.406700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:47.406700 [debug] [MainThread]: Connection 'create_takehome_dev_silver' was properly closed.
[0m16:19:47.406700 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m16:19:47.407597 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m16:19:47.407597 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m16:19:47.407597 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m16:19:47.407597 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m16:19:47.407597 [debug] [MainThread]: Connection 'model.takehome.patients_by_age' was properly closed.
[0m16:19:47.407597 [debug] [MainThread]: Connection 'model.takehome.patients_per_month' was properly closed.
[0m16:19:47.407597 [debug] [MainThread]: Connection 'model.takehome.patients' was properly closed.
[0m16:19:47.407597 [debug] [MainThread]: Connection 'model.takehome.medications_per_month' was properly closed.
[0m16:19:47.409103 [info ] [MainThread]: 
[0m16:19:47.409103 [info ] [MainThread]: Finished running 4 table models, 8 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m16:19:47.411770 [debug] [MainThread]: Command end result
[0m16:19:47.429290 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m16:19:47.432804 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m16:19:47.438821 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m16:19:47.439818 [info ] [MainThread]: 
[0m16:19:47.440814 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:19:47.442018 [info ] [MainThread]: 
[0m16:19:47.442018 [error] [MainThread]: [31mFailure in model patients_by_age (dbt/models\marts\summary\patients_by_age.sql)[0m
[0m16:19:47.444040 [error] [MainThread]:   Runtime Error in model patients_by_age (dbt/models\marts\summary\patients_by_age.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 46: from patients;
                        ^
[0m16:19:47.445016 [info ] [MainThread]: 
[0m16:19:47.446038 [info ] [MainThread]:   compiled code at target\compiled\takehome\dbt/models\marts\summary\patients_by_age.sql
[0m16:19:47.447016 [info ] [MainThread]: 
[0m16:19:47.448014 [error] [MainThread]: [31mFailure in model medications_per_month (dbt/models\marts\summary\medications_per_month.sql)[0m
[0m16:19:47.449017 [error] [MainThread]:   Runtime Error in model medications_per_month (dbt/models\marts\summary\medications_per_month.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 45: order by 1,2;
                       ^
[0m16:19:47.450529 [info ] [MainThread]: 
[0m16:19:47.452545 [info ] [MainThread]:   compiled code at target\compiled\takehome\dbt/models\marts\summary\medications_per_month.sql
[0m16:19:47.453977 [info ] [MainThread]: 
[0m16:19:47.453977 [error] [MainThread]: [31mFailure in model patients_per_month (dbt/models\marts\summary\patients_per_month.sql)[0m
[0m16:19:47.454976 [error] [MainThread]:   Runtime Error in model patients_per_month (dbt/models\marts\summary\patients_per_month.sql)
  Parser Error: syntax error at or near ";"
  
  LINE 32: order by month;
                         ^
[0m16:19:47.455980 [info ] [MainThread]: 
[0m16:19:47.456975 [info ] [MainThread]:   compiled code at target\compiled\takehome\dbt/models\marts\summary\patients_per_month.sql
[0m16:19:47.457976 [info ] [MainThread]: 
[0m16:19:47.458975 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=12
[0m16:19:47.458975 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:19:47.461501 [debug] [MainThread]: Command `dbt run` failed at 16:19:47.461501 after 1.94 seconds
[0m16:19:47.461501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B76C00A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7697EB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B7697EAE0>]}
[0m16:19:47.462492 [debug] [MainThread]: Flushing usage events
[0m16:19:48.217146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:21.741521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E2FBE090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E036D760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E03200B0>]}


============================== 16:22:21.754054 | 9a0aea93-9d62-4919-8407-4d3f4279a471 ==============================
[0m16:22:21.754054 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:22:21.755053 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:22:21.979935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E48CAFF0>]}
[0m16:22:22.028411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E4676FC0>]}
[0m16:22:22.030415 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:22:22.157057 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:22:22.362803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m16:22:22.362803 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\silver\_mart_silver_models.yml
[0m16:22:22.363803 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\summary\patients_per_month.sql
[0m16:22:22.363803 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\summary\patients_by_age.sql
[0m16:22:22.363803 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\summary\medications_per_month.sql
[0m16:22:22.680486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E509E210>]}
[0m16:22:22.740982 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m16:22:22.743356 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m16:22:22.824618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E5211970>]}
[0m16:22:22.825557 [info ] [MainThread]: Found 12 models, 16 data tests, 8 sources, 468 macros
[0m16:22:22.826584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E5356810>]}
[0m16:22:22.829028 [info ] [MainThread]: 
[0m16:22:22.829028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:22:22.829028 [info ] [MainThread]: 
[0m16:22:22.829028 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:22:22.834122 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m16:22:22.844769 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m16:22:22.849757 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m16:22:22.885194 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m16:22:22.885194 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m16:22:22.885194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:22.885194 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m16:22:22.885194 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m16:22:22.885194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:22.891463 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m16:22:22.891463 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m16:22:22.892553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:22.929818 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m16:22:22.930771 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m16:22:22.930771 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m16:22:22.931983 [debug] [ThreadPool]: On list_takehome: Close
[0m16:22:22.932821 [debug] [ThreadPool]: On list_takehome: Close
[0m16:22:22.933828 [debug] [ThreadPool]: On list_takehome: Close
[0m16:22:22.935827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m16:22:22.935827 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m16:22:22.940827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m16:22:22.940827 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m16:22:22.940827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_silver)
[0m16:22:22.942956 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:22:22.945066 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:22:22.945431 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_silver"
"
[0m16:22:22.946001 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m16:22:22.946388 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m16:22:22.947499 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:22:22.947499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:22.948397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:22.948397 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m16:22:22.949416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:22.949416 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:22:22.951649 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:22:22.951649 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:22:22.951649 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m16:22:22.952650 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:22:22.953696 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:22:22.954817 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:22:22.954817 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:22:22.955815 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m16:22:22.955815 [debug] [ThreadPool]: On create_takehome_dev_silver: BEGIN
[0m16:22:22.955815 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:22:22.955815 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:22:22.955815 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m16:22:22.955815 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:22:22.955815 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:22:22.955815 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:22:22.955815 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m16:22:22.955815 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
    
        create schema if not exists "takehome"."dev_silver"
    
[0m16:22:22.959235 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:22:22.959740 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m16:22:22.961023 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:22:22.961023 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:22:22.961023 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m16:22:22.962104 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m16:22:22.963114 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:22:22.963114 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:22:22.963114 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m16:22:22.964223 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:22:22.964223 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m16:22:22.964223 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:22:22.965227 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m16:22:22.965227 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m16:22:22.965227 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:22:22.966157 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m16:22:22.966157 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:22:22.966157 [debug] [ThreadPool]: On create_takehome_dev_silver: Close
[0m16:22:22.969148 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m16:22:22.969148 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m16:22:22.969148 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m16:22:22.974796 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m16:22:22.975796 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m16:22:22.977795 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m16:22:22.977795 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m16:22:22.978343 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m16:22:22.978343 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m16:22:22.978343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:22.978343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:22.979350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:22.979350 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:22:22.979350 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m16:22:22.979350 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m16:22:22.980855 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:22:22.980855 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m16:22:22.980855 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m16:22:22.980855 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:22:22.980855 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m16:22:22.980855 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m16:22:22.990778 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:22:22.992618 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m16:22:22.993631 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:22:22.994625 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m16:22:22.994625 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m16:22:22.994625 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:22:22.995624 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m16:22:22.996732 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m16:22:22.997625 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m16:22:22.997625 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m16:22:22.997625 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m16:22:22.998731 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m16:22:23.000789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E23FD850>]}
[0m16:22:23.001795 [debug] [MainThread]: Using duckdb connection "master"
[0m16:22:23.001795 [debug] [MainThread]: On master: BEGIN
[0m16:22:23.001795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:23.002841 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:22:23.002841 [debug] [MainThread]: On master: COMMIT
[0m16:22:23.002841 [debug] [MainThread]: Using duckdb connection "master"
[0m16:22:23.002841 [debug] [MainThread]: On master: COMMIT
[0m16:22:23.002841 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:22:23.004001 [debug] [MainThread]: On master: Close
[0m16:22:23.009376 [debug] [Thread-1 (]: Began running node model.takehome.stg_conditions
[0m16:22:23.011894 [debug] [Thread-2 (]: Began running node model.takehome.stg_documents
[0m16:22:23.011894 [debug] [Thread-3 (]: Began running node model.takehome.stg_med_admins
[0m16:22:23.012888 [debug] [Thread-4 (]: Began running node model.takehome.stg_medications
[0m16:22:23.010882 [info ] [Thread-1 (]: 1 of 12 START sql view model dev_staging.stg_conditions ........................ [RUN]
[0m16:22:23.011894 [info ] [Thread-2 (]: 2 of 12 START sql view model dev_staging.stg_documents ......................... [RUN]
[0m16:22:23.013889 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_conditions'
[0m16:22:23.013889 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.takehome.stg_documents'
[0m16:22:23.012888 [info ] [Thread-3 (]: 3 of 12 START sql view model dev_staging.stg_med_admins ........................ [RUN]
[0m16:22:23.014886 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_conditions
[0m16:22:23.014886 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_documents
[0m16:22:23.012888 [info ] [Thread-4 (]: 4 of 12 START sql view model dev_staging.stg_medications ....................... [RUN]
[0m16:22:23.014886 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.stg_med_admins'
[0m16:22:23.020558 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_conditions"
[0m16:22:23.022373 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_documents"
[0m16:22:23.023381 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.takehome.stg_medications'
[0m16:22:23.023381 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_med_admins
[0m16:22:23.024378 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_medications
[0m16:22:23.027384 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_med_admins"
[0m16:22:23.029391 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_medications"
[0m16:22:23.032221 [debug] [Thread-1 (]: Began executing node model.takehome.stg_conditions
[0m16:22:23.032221 [debug] [Thread-2 (]: Began executing node model.takehome.stg_documents
[0m16:22:23.060780 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_conditions"
[0m16:22:23.062933 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_documents"
[0m16:22:23.063988 [debug] [Thread-4 (]: Began executing node model.takehome.stg_medications
[0m16:22:23.064413 [debug] [Thread-3 (]: Began executing node model.takehome.stg_med_admins
[0m16:22:23.066891 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_medications"
[0m16:22:23.068786 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_med_admins"
[0m16:22:23.069788 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:22:23.069788 [debug] [Thread-2 (]: On model.takehome.stg_documents: BEGIN
[0m16:22:23.070852 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:22:23.072093 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:22:23.072093 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:22:23.073084 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:22:23.075079 [debug] [Thread-1 (]: On model.takehome.stg_conditions: BEGIN
[0m16:22:23.075079 [debug] [Thread-4 (]: On model.takehome.stg_medications: BEGIN
[0m16:22:23.076084 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: BEGIN
[0m16:22:23.077085 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:22:23.078079 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:22:23.078079 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:22:23.078079 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:22:23.078079 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:22:23.079286 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.079286 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.079286 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

  
  create view "takehome"."dev_staging"."stg_documents__dbt_tmp" as (
    select
    document_id,
    patient_id,
    visit_id,
    document_line,
    document_text
from "takehome"."raw"."documents"
  );

[0m16:22:23.079286 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.080790 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:22:23.080790 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:22:23.080790 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:22:23.080790 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

  
  create view "takehome"."dev_staging"."stg_conditions__dbt_tmp" as (
    select
    id   as condition_id,
    name as condition_name
from "takehome"."raw"."conditions"
  );

[0m16:22:23.080790 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

  
  create view "takehome"."dev_staging"."stg_medications__dbt_tmp" as (
    select
    id   as medication_id,
    name as medication_name
from "takehome"."raw"."medications"
  );

[0m16:22:23.080790 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.080790 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

  
  create view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" as (
    select
    patient_id,
    patient_condition_id,
    medication_id,
    coalesce(date_stopped, date_started) as updated_at,
    date_started,
    date_stopped,
    dosage
from "takehome"."raw"."med_admins"
  );

[0m16:22:23.087706 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:22:23.088705 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m16:22:23.089789 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents" rename to "stg_documents__dbt_backup"
[0m16:22:23.091348 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:22:23.092350 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m16:22:23.092350 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:22:23.093423 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications" rename to "stg_medications__dbt_backup"
[0m16:22:23.095536 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:22:23.096538 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.098536 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:22:23.098536 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions" rename to "stg_conditions__dbt_backup"
[0m16:22:23.100537 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:22:23.100537 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.101765 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins" rename to "stg_med_admins__dbt_backup"
[0m16:22:23.101765 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents__dbt_tmp" rename to "stg_documents"
[0m16:22:23.103809 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:22:23.103809 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.104767 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications__dbt_tmp" rename to "stg_medications"
[0m16:22:23.106808 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:22:23.106808 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.107745 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.107745 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions__dbt_tmp" rename to "stg_conditions"
[0m16:22:23.107745 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.115992 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m16:22:23.115992 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:22:23.120624 [debug] [Thread-4 (]: On model.takehome.stg_medications: COMMIT
[0m16:22:23.121246 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:22:23.121246 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.122263 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" rename to "stg_med_admins"
[0m16:22:23.122623 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:22:23.122965 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m16:22:23.124083 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m16:22:23.124083 [debug] [Thread-4 (]: On model.takehome.stg_medications: COMMIT
[0m16:22:23.124977 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.124977 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:22:23.126979 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: COMMIT
[0m16:22:23.126979 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m16:22:23.127975 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:22:23.127975 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.128971 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.128971 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: COMMIT
[0m16:22:23.132881 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:22:23.134880 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:22:23.134880 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:22:23.135778 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

      drop view if exists "takehome"."dev_staging"."stg_documents__dbt_backup" cascade
    
[0m16:22:23.135778 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

      drop view if exists "takehome"."dev_staging"."stg_medications__dbt_backup" cascade
    
[0m16:22:23.137889 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:22:23.138776 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.138776 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_conditions__dbt_backup" cascade
    
[0m16:22:23.140778 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:22:23.141292 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.141292 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

      drop view if exists "takehome"."dev_staging"."stg_med_admins__dbt_backup" cascade
    
[0m16:22:23.142293 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.143530 [debug] [Thread-2 (]: On model.takehome.stg_documents: Close
[0m16:22:23.144402 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.145414 [debug] [Thread-4 (]: On model.takehome.stg_medications: Close
[0m16:22:23.147415 [debug] [Thread-1 (]: On model.takehome.stg_conditions: Close
[0m16:22:23.147749 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.148761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E5146D80>]}
[0m16:22:23.148761 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E55CEA80>]}
[0m16:22:23.149790 [debug] [Thread-3 (]: On model.takehome.stg_med_admins: Close
[0m16:22:23.149790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E65E7830>]}
[0m16:22:23.150760 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E55CF1D0>]}
[0m16:22:23.149790 [info ] [Thread-2 (]: 2 of 12 OK created sql view model dev_staging.stg_documents .................... [[32mOK[0m in 0.13s]
[0m16:22:23.150760 [info ] [Thread-4 (]: 4 of 12 OK created sql view model dev_staging.stg_medications .................. [[32mOK[0m in 0.12s]
[0m16:22:23.151899 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dev_staging.stg_conditions ................... [[32mOK[0m in 0.13s]
[0m16:22:23.152899 [info ] [Thread-3 (]: 3 of 12 OK created sql view model dev_staging.stg_med_admins ................... [[32mOK[0m in 0.14s]
[0m16:22:23.152899 [debug] [Thread-2 (]: Finished running node model.takehome.stg_documents
[0m16:22:23.154137 [debug] [Thread-4 (]: Finished running node model.takehome.stg_medications
[0m16:22:23.154137 [debug] [Thread-1 (]: Finished running node model.takehome.stg_conditions
[0m16:22:23.155109 [debug] [Thread-3 (]: Finished running node model.takehome.stg_med_admins
[0m16:22:23.155109 [debug] [Thread-2 (]: Began running node model.takehome.stg_orders
[0m16:22:23.155109 [debug] [Thread-4 (]: Began running node model.takehome.stg_patient_conditions
[0m16:22:23.156207 [debug] [Thread-1 (]: Began running node model.takehome.stg_patients
[0m16:22:23.156207 [debug] [Thread-3 (]: Began running node model.takehome.stg_visits
[0m16:22:23.156207 [info ] [Thread-2 (]: 5 of 12 START sql view model dev_staging.stg_orders ............................ [RUN]
[0m16:22:23.157395 [info ] [Thread-4 (]: 6 of 12 START sql view model dev_staging.stg_patient_conditions ................ [RUN]
[0m16:22:23.159414 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_documents, now model.takehome.stg_orders)
[0m16:22:23.159414 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_medications, now model.takehome.stg_patient_conditions)
[0m16:22:23.160408 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_orders
[0m16:22:23.160408 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_patient_conditions
[0m16:22:23.162673 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_orders"
[0m16:22:23.157395 [info ] [Thread-1 (]: 7 of 12 START sql view model dev_staging.stg_patients .......................... [RUN]
[0m16:22:23.164682 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_patient_conditions"
[0m16:22:23.165686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_conditions, now model.takehome.stg_patients)
[0m16:22:23.158463 [info ] [Thread-3 (]: 8 of 12 START sql view model dev_staging.stg_visits ............................ [RUN]
[0m16:22:23.166586 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_patients
[0m16:22:23.167575 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_med_admins, now model.takehome.stg_visits)
[0m16:22:23.169047 [debug] [Thread-2 (]: Began executing node model.takehome.stg_orders
[0m16:22:23.170653 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m16:22:23.171661 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_visits
[0m16:22:23.171661 [debug] [Thread-4 (]: Began executing node model.takehome.stg_patient_conditions
[0m16:22:23.174670 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_orders"
[0m16:22:23.176670 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_visits"
[0m16:22:23.179201 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_patient_conditions"
[0m16:22:23.179201 [debug] [Thread-1 (]: Began executing node model.takehome.stg_patients
[0m16:22:23.181628 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:22:23.186707 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m16:22:23.186707 [debug] [Thread-2 (]: On model.takehome.stg_orders: BEGIN
[0m16:22:23.188713 [debug] [Thread-3 (]: Began executing node model.takehome.stg_visits
[0m16:22:23.189708 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:22:23.190708 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:22:23.193881 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_visits"
[0m16:22:23.194880 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: BEGIN
[0m16:22:23.196163 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:22:23.197183 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:22:23.197183 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:22:23.198183 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:22:23.199185 [debug] [Thread-1 (]: On model.takehome.stg_patients: BEGIN
[0m16:22:23.199185 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.200695 [debug] [Thread-2 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

  
  create view "takehome"."dev_staging"."stg_orders__dbt_tmp" as (
    select
    id            as order_id,
    patient_id,
    condition_id,
    order_date    as updated_at,
    order_date
from "takehome"."raw"."orders"
  );

[0m16:22:23.201711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:23.201711 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:22:23.202706 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:22:23.203872 [debug] [Thread-3 (]: On model.takehome.stg_visits: BEGIN
[0m16:22:23.203872 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

  
  create view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" as (
    select
    id                     as patient_condition_id,
    patient_id,
    condition_id,
    coalesce(date_ended, date_started) as updated_at,
    date_started,
    date_ended
from "takehome"."raw"."patient_conditions"
  );

[0m16:22:23.203872 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.204871 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.204871 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:22:23.204871 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:22:23.207987 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:22:23.209000 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id as patient_id,
    coalesce(
        date_deactivated,
        date_activated,
        date_of_death,
        date_of_birth
    )                                    as updated_at,
    first_name,
    last_name,
    ssn,
    date_of_birth,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_death,
    date_activated,
    date_deactivated
from "takehome"."raw"."patients"
  );

[0m16:22:23.209000 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:22:23.209000 [debug] [Thread-2 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m16:22:23.209000 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:22:23.212517 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:22:23.212517 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:22:23.213522 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.213522 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.213522 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions" rename to "stg_patient_conditions__dbt_backup"
[0m16:22:23.214523 [debug] [Thread-3 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

  
  create view "takehome"."dev_staging"."stg_visits__dbt_tmp" as (
    select
    id                    as visit_id,
    visit_date            as updated_at,
    patient_condition_id,
    visit_date
from "takehome"."raw"."visits"
  );

[0m16:22:23.216524 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:22:23.218232 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:22:23.219369 [debug] [Thread-2 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m16:22:23.219369 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m16:22:23.219369 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.219369 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.220880 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:22:23.222893 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:22:23.225909 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:22:23.226891 [debug] [Thread-2 (]: On model.takehome.stg_orders: COMMIT
[0m16:22:23.226891 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:22:23.227892 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" rename to "stg_patient_conditions"
[0m16:22:23.227892 [debug] [Thread-3 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits" rename to "stg_visits__dbt_backup"
[0m16:22:23.227892 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:22:23.230537 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:22:23.231544 [debug] [Thread-2 (]: On model.takehome.stg_orders: COMMIT
[0m16:22:23.231544 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.232545 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m16:22:23.232545 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.233133 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m16:22:23.238242 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:22:23.238242 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:22:23.238242 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m16:22:23.239244 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:22:23.239244 [debug] [Thread-3 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits__dbt_tmp" rename to "stg_visits"
[0m16:22:23.240836 [debug] [Thread-1 (]: On model.takehome.stg_patients: COMMIT
[0m16:22:23.242961 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:22:23.243846 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m16:22:23.243846 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:22:23.243846 [debug] [Thread-2 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

      drop view if exists "takehome"."dev_staging"."stg_orders__dbt_backup" cascade
    
[0m16:22:23.244898 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.244898 [debug] [Thread-1 (]: On model.takehome.stg_patients: COMMIT
[0m16:22:23.245890 [debug] [Thread-3 (]: On model.takehome.stg_visits: COMMIT
[0m16:22:23.246968 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.246968 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:22:23.250403 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:22:23.250403 [debug] [Thread-3 (]: On model.takehome.stg_visits: COMMIT
[0m16:22:23.250403 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:22:23.250403 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:22:23.251431 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_patient_conditions__dbt_backup" cascade
    
[0m16:22:23.252410 [debug] [Thread-2 (]: On model.takehome.stg_orders: Close
[0m16:22:23.254672 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:22:23.254672 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.254672 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E65AF200>]}
[0m16:22:23.255635 [debug] [Thread-1 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

      drop view if exists "takehome"."dev_staging"."stg_patients__dbt_backup" cascade
    
[0m16:22:23.258626 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:22:23.258626 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:22:23.259877 [debug] [Thread-3 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

      drop view if exists "takehome"."dev_staging"."stg_visits__dbt_backup" cascade
    
[0m16:22:23.259877 [info ] [Thread-2 (]: 5 of 12 OK created sql view model dev_staging.stg_orders ....................... [[32mOK[0m in 0.10s]
[0m16:22:23.261965 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: Close
[0m16:22:23.261965 [debug] [Thread-2 (]: Finished running node model.takehome.stg_orders
[0m16:22:23.262955 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.262955 [debug] [Thread-2 (]: Began running node model.takehome.medications_per_month
[0m16:22:23.263961 [debug] [Thread-1 (]: On model.takehome.stg_patients: Close
[0m16:22:23.264959 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E55C5400>]}
[0m16:22:23.265958 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:22:23.265958 [info ] [Thread-2 (]: 9 of 12 START sql table model dev_silver.medications_per_month ................. [RUN]
[0m16:22:23.266956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E661D460>]}
[0m16:22:23.268955 [debug] [Thread-3 (]: On model.takehome.stg_visits: Close
[0m16:22:23.267956 [info ] [Thread-4 (]: 6 of 12 OK created sql view model dev_staging.stg_patient_conditions ........... [[32mOK[0m in 0.11s]
[0m16:22:23.268955 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_orders, now model.takehome.medications_per_month)
[0m16:22:23.270461 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E55C6540>]}
[0m16:22:23.268955 [info ] [Thread-1 (]: 7 of 12 OK created sql view model dev_staging.stg_patients ..................... [[32mOK[0m in 0.10s]
[0m16:22:23.271467 [debug] [Thread-4 (]: Finished running node model.takehome.stg_patient_conditions
[0m16:22:23.271467 [debug] [Thread-2 (]: Began compiling node model.takehome.medications_per_month
[0m16:22:23.272522 [debug] [Thread-1 (]: Finished running node model.takehome.stg_patients
[0m16:22:23.271467 [info ] [Thread-3 (]: 8 of 12 OK created sql view model dev_staging.stg_visits ....................... [[32mOK[0m in 0.10s]
[0m16:22:23.275470 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.medications_per_month"
[0m16:22:23.277470 [debug] [Thread-3 (]: Finished running node model.takehome.stg_visits
[0m16:22:23.277470 [debug] [Thread-3 (]: Began running node model.takehome.patients
[0m16:22:23.278469 [debug] [Thread-2 (]: Began executing node model.takehome.medications_per_month
[0m16:22:23.278469 [info ] [Thread-3 (]: 10 of 12 START sql table model dev_bronze.patients ............................. [RUN]
[0m16:22:23.294297 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.medications_per_month"
[0m16:22:23.295298 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_visits, now model.takehome.patients)
[0m16:22:23.295298 [debug] [Thread-3 (]: Began compiling node model.takehome.patients
[0m16:22:23.297312 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.patients"
[0m16:22:23.298314 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:22:23.298314 [debug] [Thread-2 (]: On model.takehome.medications_per_month: BEGIN
[0m16:22:23.299314 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:22:23.299314 [debug] [Thread-3 (]: Began executing node model.takehome.patients
[0m16:22:23.301826 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.patients"
[0m16:22:23.302831 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:22:23.302831 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:22:23.302831 [debug] [Thread-2 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."medications_per_month__dbt_tmp"
  
    as (
      with med_admins as (
    select
        patient_id,
        medication_id,
        date_started
    from "takehome"."dev_staging"."stg_med_admins"
    where date_started is not null
),

meds as (
    select
        medication_id,
        medication_name
    from "takehome"."dev_staging"."stg_medications"
),

med_admins_month as (
    select
        date_trunc('month', date_started) as month,
        medication_id,
        patient_id
    from med_admins
)

select
    m.month,
    med.medication_id,
    med.medication_name,
    count(*)                     as administrations,
    count(distinct m.patient_id) as patients_treated
from med_admins_month m
join meds med
    on m.medication_id = med.medication_id
group by 1,2,3
order by 1,2
    );
  
  
[0m16:22:23.303831 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:22:23.303831 [debug] [Thread-3 (]: On model.takehome.patients: BEGIN
[0m16:22:23.304833 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:22:23.304833 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m16:22:23.304833 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:22:23.305832 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      

with 

pt as ( select * from "takehome"."dev_staging"."stg_patients" )

select
    *
    
from pt

qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m16:22:23.320460 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m16:22:23.326466 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:22:23.327468 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m16:22:23.331952 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:22:23.333949 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:22:23.333949 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m16:22:23.334951 [debug] [Thread-2 (]: SQL status: OK in 0.031 seconds
[0m16:22:23.336954 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:22:23.336954 [debug] [Thread-2 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month__dbt_tmp" rename to "medications_per_month"
[0m16:22:23.337955 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.337955 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.341471 [debug] [Thread-2 (]: On model.takehome.medications_per_month: COMMIT
[0m16:22:23.341471 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:22:23.341471 [debug] [Thread-2 (]: On model.takehome.medications_per_month: COMMIT
[0m16:22:23.345573 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:22:23.345573 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients" rename to "patients__dbt_backup"
[0m16:22:23.346469 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:22:23.348469 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:22:23.348469 [debug] [Thread-2 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

      drop table if exists "takehome"."dev_silver"."medications_per_month__dbt_backup" cascade
    
[0m16:22:23.349471 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.351036 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:22:23.352027 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients__dbt_tmp" rename to "patients"
[0m16:22:23.352027 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.353030 [debug] [Thread-2 (]: On model.takehome.medications_per_month: Close
[0m16:22:23.353030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E66325A0>]}
[0m16:22:23.354035 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.355028 [debug] [Thread-3 (]: On model.takehome.patients: COMMIT
[0m16:22:23.356026 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:22:23.356026 [debug] [Thread-3 (]: On model.takehome.patients: COMMIT
[0m16:22:23.354035 [info ] [Thread-2 (]: 9 of 12 OK created sql table model dev_silver.medications_per_month ............ [[32mOK[0m in 0.08s]
[0m16:22:23.356026 [debug] [Thread-2 (]: Finished running node model.takehome.medications_per_month
[0m16:22:23.359240 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:22:23.360772 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m16:22:23.361788 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

      drop table if exists "takehome"."dev_bronze"."patients__dbt_backup" cascade
    
[0m16:22:23.363789 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.364790 [debug] [Thread-3 (]: On model.takehome.patients: Close
[0m16:22:23.364790 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E66C8FB0>]}
[0m16:22:23.365788 [info ] [Thread-3 (]: 10 of 12 OK created sql table model dev_bronze.patients ........................ [[32mOK[0m in 0.07s]
[0m16:22:23.366796 [debug] [Thread-3 (]: Finished running node model.takehome.patients
[0m16:22:23.367461 [debug] [Thread-1 (]: Began running node model.takehome.patients_by_age
[0m16:22:23.368479 [debug] [Thread-4 (]: Began running node model.takehome.patients_per_month
[0m16:22:23.368479 [info ] [Thread-1 (]: 11 of 12 START sql table model dev_silver.patients_by_age ...................... [RUN]
[0m16:22:23.369771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patients, now model.takehome.patients_by_age)
[0m16:22:23.369771 [debug] [Thread-1 (]: Began compiling node model.takehome.patients_by_age
[0m16:22:23.369771 [info ] [Thread-4 (]: 12 of 12 START sql table model dev_silver.patients_per_month ................... [RUN]
[0m16:22:23.372783 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.patients_by_age"
[0m16:22:23.372783 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patient_conditions, now model.takehome.patients_per_month)
[0m16:22:23.373784 [debug] [Thread-4 (]: Began compiling node model.takehome.patients_per_month
[0m16:22:23.375822 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.patients_per_month"
[0m16:22:23.376787 [debug] [Thread-1 (]: Began executing node model.takehome.patients_by_age
[0m16:22:23.379147 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.patients_by_age"
[0m16:22:23.379147 [debug] [Thread-4 (]: Began executing node model.takehome.patients_per_month
[0m16:22:23.382107 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.patients_per_month"
[0m16:22:23.384108 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:22:23.384763 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:22:23.384763 [debug] [Thread-4 (]: On model.takehome.patients_per_month: BEGIN
[0m16:22:23.386067 [debug] [Thread-1 (]: On model.takehome.patients_by_age: BEGIN
[0m16:22:23.386067 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:22:23.387075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:23.388077 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.388077 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:22:23.388077 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.389124 [debug] [Thread-4 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_per_month__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_activated,
        gender
    from "takehome"."dev_bronze"."patients"
    where date_activated is not null
),

patients_by_month as (
    select
        date_trunc('month', date_activated)                           as month,
        count(*)                                                      as new_patients,
        count(distinct case when gender = 'M' then patient_id end)    as new_patients_male,
        count(distinct case when gender = 'F' then patient_id end)    as new_patients_female
    from patients
    group by 1
)

select *
from patients_by_month
order by month
    );
  
  
[0m16:22:23.389124 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:22:23.390635 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_by_age__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_of_birth,
        gender,
        race,
        ethnicity,
        smoker,
        drinks_per_week,
        date_activated,
        date_deactivated,
        date_of_death
    from "takehome"."dev_bronze"."patients"
)

select
    patient_id,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_birth,
    date_activated,
    date_deactivated,
    date_of_death,
    date_diff('year', date_of_birth, current_date) as age,
    case
        when date_of_birth is null then 'unknown'
        when date_diff('year', date_of_birth, current_date) < 18 then '0-17'
        when date_diff('year', date_of_birth, current_date) between 18 and 34 then '18-34'
        when date_diff('year', date_of_birth, current_date) between 35 and 49 then '35-49'
        when date_diff('year', date_of_birth, current_date) between 50 and 64 then '50-64'
        else '65+'
    end as age_group
from patients
    );
  
  
[0m16:22:23.398641 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:22:23.399644 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:22:23.400656 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m16:22:23.401868 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m16:22:23.402875 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:22:23.404133 [debug] [Thread-4 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month__dbt_tmp" rename to "patients_per_month"
[0m16:22:23.404133 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:22:23.405024 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.406028 [debug] [Thread-4 (]: On model.takehome.patients_per_month: COMMIT
[0m16:22:23.406028 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:22:23.406028 [debug] [Thread-4 (]: On model.takehome.patients_per_month: COMMIT
[0m16:22:23.407019 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:22:23.408023 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m16:22:23.409021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.409021 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.410527 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:22:23.410527 [debug] [Thread-4 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

      drop table if exists "takehome"."dev_silver"."patients_per_month__dbt_backup" cascade
    
[0m16:22:23.414535 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:22:23.414535 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age" rename to "patients_by_age__dbt_backup"
[0m16:22:23.415537 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.416644 [debug] [Thread-4 (]: On model.takehome.patients_per_month: Close
[0m16:22:23.416644 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E6706540>]}
[0m16:22:23.417577 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.419535 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:22:23.419535 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age__dbt_tmp" rename to "patients_by_age"
[0m16:22:23.416644 [info ] [Thread-4 (]: 12 of 12 OK created sql table model dev_silver.patients_per_month .............. [[32mOK[0m in 0.04s]
[0m16:22:23.420536 [debug] [Thread-4 (]: Finished running node model.takehome.patients_per_month
[0m16:22:23.421047 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.422053 [debug] [Thread-1 (]: On model.takehome.patients_by_age: COMMIT
[0m16:22:23.422053 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:22:23.422053 [debug] [Thread-1 (]: On model.takehome.patients_by_age: COMMIT
[0m16:22:23.423828 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:22:23.425847 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:22:23.425847 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

      drop table if exists "takehome"."dev_silver"."patients_by_age__dbt_backup" cascade
    
[0m16:22:23.427840 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:22:23.428948 [debug] [Thread-1 (]: On model.takehome.patients_by_age: Close
[0m16:22:23.428948 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0aea93-9d62-4919-8407-4d3f4279a471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E55CDF10>]}
[0m16:22:23.428948 [info ] [Thread-1 (]: 11 of 12 OK created sql table model dev_silver.patients_by_age ................. [[32mOK[0m in 0.06s]
[0m16:22:23.430455 [debug] [Thread-1 (]: Finished running node model.takehome.patients_by_age
[0m16:22:23.432350 [debug] [MainThread]: Using duckdb connection "master"
[0m16:22:23.433033 [debug] [MainThread]: On master: BEGIN
[0m16:22:23.433033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:23.434090 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:22:23.434090 [debug] [MainThread]: On master: COMMIT
[0m16:22:23.434090 [debug] [MainThread]: Using duckdb connection "master"
[0m16:22:23.435076 [debug] [MainThread]: On master: COMMIT
[0m16:22:23.435076 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:22:23.435076 [debug] [MainThread]: On master: Close
[0m16:22:23.436073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:23.436073 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m16:22:23.436073 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m16:22:23.436073 [debug] [MainThread]: Connection 'create_takehome_dev_silver' was properly closed.
[0m16:22:23.436073 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m16:22:23.437073 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m16:22:23.437073 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m16:22:23.437073 [debug] [MainThread]: Connection 'model.takehome.patients_by_age' was properly closed.
[0m16:22:23.437073 [debug] [MainThread]: Connection 'model.takehome.medications_per_month' was properly closed.
[0m16:22:23.437073 [debug] [MainThread]: Connection 'model.takehome.patients' was properly closed.
[0m16:22:23.437073 [debug] [MainThread]: Connection 'model.takehome.patients_per_month' was properly closed.
[0m16:22:23.438073 [info ] [MainThread]: 
[0m16:22:23.438073 [info ] [MainThread]: Finished running 4 table models, 8 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m16:22:23.440581 [debug] [MainThread]: Command end result
[0m16:22:23.458545 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m16:22:23.460541 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m16:22:23.483636 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m16:22:23.484627 [info ] [MainThread]: 
[0m16:22:23.486223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:22:23.486223 [info ] [MainThread]: 
[0m16:22:23.487256 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m16:22:23.487256 [debug] [MainThread]: Command `dbt run` succeeded at 16:22:23.487256 after 2.02 seconds
[0m16:22:23.488251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E0DD73E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E294D100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2E34B1DC0>]}
[0m16:22:23.488251 [debug] [MainThread]: Flushing usage events
[0m16:22:24.056977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:30.639618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F127FE2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1287B6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F125900AD0>]}


============================== 16:22:30.649147 | 156e89c8-4cc5-4073-ae79-20caad174ff6 ==============================
[0m16:22:30.649147 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:22:30.650662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:22:30.968779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '156e89c8-4cc5-4073-ae79-20caad174ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F129E5A300>]}
[0m16:22:31.018419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '156e89c8-4cc5-4073-ae79-20caad174ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F129D29220>]}
[0m16:22:31.020923 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:22:31.155238 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:22:31.308135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:22:31.308135 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:22:31.342939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '156e89c8-4cc5-4073-ae79-20caad174ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F129D131D0>]}
[0m16:22:31.402841 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m16:22:31.405126 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m16:22:31.437523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '156e89c8-4cc5-4073-ae79-20caad174ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12A2D4A70>]}
[0m16:22:31.437523 [info ] [MainThread]: Found 12 models, 16 data tests, 8 sources, 468 macros
[0m16:22:31.438523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '156e89c8-4cc5-4073-ae79-20caad174ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12A6F2ED0>]}
[0m16:22:31.440523 [info ] [MainThread]: 
[0m16:22:31.441029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:22:31.441029 [info ] [MainThread]: 
[0m16:22:31.442034 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:22:31.445035 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m16:22:31.456189 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m16:22:31.459190 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m16:22:31.495598 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m16:22:31.496615 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m16:22:31.496615 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m16:22:31.496615 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m16:22:31.497599 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m16:22:31.497599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:31.497599 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m16:22:31.497599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:31.498599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:31.529286 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m16:22:31.529286 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m16:22:31.529286 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m16:22:31.529286 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m16:22:31.530796 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m16:22:31.530796 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m16:22:31.531808 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m16:22:31.531808 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m16:22:31.532807 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m16:22:31.543322 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:22:31.544322 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m16:22:31.544322 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:22:31.545321 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m16:22:31.546321 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m16:22:31.547320 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m16:22:31.548321 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m16:22:31.548321 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m16:22:31.549324 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m16:22:31.549324 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m16:22:31.550833 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m16:22:31.551317 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m16:22:31.553322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '156e89c8-4cc5-4073-ae79-20caad174ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12A6DFEC0>]}
[0m16:22:31.553322 [debug] [MainThread]: Using duckdb connection "master"
[0m16:22:31.553322 [debug] [MainThread]: On master: BEGIN
[0m16:22:31.553322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:31.554323 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:22:31.554323 [debug] [MainThread]: On master: COMMIT
[0m16:22:31.554323 [debug] [MainThread]: Using duckdb connection "master"
[0m16:22:31.555324 [debug] [MainThread]: On master: COMMIT
[0m16:22:31.555647 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:22:31.555647 [debug] [MainThread]: On master: Close
[0m16:22:31.559442 [debug] [Thread-1 (]: Began running node test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f
[0m16:22:31.560442 [debug] [Thread-2 (]: Began running node test.takehome.not_null_medications_per_month_medication_id.0958d28b46
[0m16:22:31.560884 [debug] [Thread-3 (]: Began running node test.takehome.not_null_medications_per_month_month.4d739bac88
[0m16:22:31.561990 [debug] [Thread-4 (]: Began running node test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe
[0m16:22:31.560884 [info ] [Thread-1 (]: 1 of 16 START test accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown  [RUN]
[0m16:22:31.562326 [info ] [Thread-2 (]: 2 of 16 START test not_null_medications_per_month_medication_id ................ [RUN]
[0m16:22:31.563595 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f'
[0m16:22:31.563595 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.takehome.not_null_medications_per_month_medication_id.0958d28b46'
[0m16:22:31.562326 [info ] [Thread-3 (]: 3 of 16 START test not_null_medications_per_month_month ........................ [RUN]
[0m16:22:31.563595 [debug] [Thread-1 (]: Began compiling node test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f
[0m16:22:31.564594 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_medications_per_month_medication_id.0958d28b46
[0m16:22:31.564594 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.takehome.not_null_medications_per_month_month.4d739bac88'
[0m16:22:31.562326 [info ] [Thread-4 (]: 4 of 16 START test not_null_medications_per_month_patients_treated ............. [RUN]
[0m16:22:31.579414 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"
[0m16:22:31.584335 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"
[0m16:22:31.586169 [debug] [Thread-3 (]: Began compiling node test.takehome.not_null_medications_per_month_month.4d739bac88
[0m16:22:31.586618 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe'
[0m16:22:31.592044 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.not_null_medications_per_month_month.4d739bac88"
[0m16:22:31.593041 [debug] [Thread-4 (]: Began compiling node test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe
[0m16:22:31.598044 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"
[0m16:22:31.599047 [debug] [Thread-3 (]: Began executing node test.takehome.not_null_medications_per_month_month.4d739bac88
[0m16:22:31.600554 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_medications_per_month_medication_id.0958d28b46
[0m16:22:31.614801 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.not_null_medications_per_month_month.4d739bac88"
[0m16:22:31.615818 [debug] [Thread-4 (]: Began executing node test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe
[0m16:22:31.617438 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"
[0m16:22:31.618314 [debug] [Thread-1 (]: Began executing node test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f
[0m16:22:31.619316 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"
[0m16:22:31.621829 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"
[0m16:22:31.623845 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"
[0m16:22:31.624834 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe: BEGIN
[0m16:22:31.624834 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:22:31.625836 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"
[0m16:22:31.626840 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_month.4d739bac88"
[0m16:22:31.626840 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:22:31.627843 [debug] [Thread-2 (]: On test.takehome.not_null_medications_per_month_medication_id.0958d28b46: BEGIN
[0m16:22:31.627843 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"
[0m16:22:31.628947 [debug] [Thread-3 (]: On test.takehome.not_null_medications_per_month_month.4d739bac88: BEGIN
[0m16:22:31.628947 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"
[0m16:22:31.628947 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:22:31.628947 [debug] [Thread-1 (]: On test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f: BEGIN
[0m16:22:31.628947 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:22:31.630452 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patients_treated
from "takehome"."dev_silver"."medications_per_month"
where patients_treated is null



  
  
      
    ) dbt_internal_test
[0m16:22:31.630795 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:22:31.631827 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:22:31.631827 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:22:31.632811 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"
[0m16:22:31.632811 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:22:31.632811 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:22:31.633816 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_month.4d739bac88"
[0m16:22:31.633816 [debug] [Thread-2 (]: On test.takehome.not_null_medications_per_month_medication_id.0958d28b46: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select medication_id
from "takehome"."dev_silver"."medications_per_month"
where medication_id is null



  
  
      
    ) dbt_internal_test
[0m16:22:31.633816 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"
[0m16:22:31.634805 [debug] [Thread-3 (]: On test.takehome.not_null_medications_per_month_month.4d739bac88: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_medications_per_month_month.4d739bac88"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "takehome"."dev_silver"."medications_per_month"
where month is null



  
  
      
    ) dbt_internal_test
[0m16:22:31.638824 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe: ROLLBACK
[0m16:22:31.638824 [debug] [Thread-1 (]: On test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        age_group as value_field,
        count(*) as n_records

    from "takehome"."dev_silver"."patients_by_age"
    group by age_group

)

select *
from all_values
where value_field not in (
    '0-17','18-34','35-49','50-64','65+','unknown'
)



  
  
      
    ) dbt_internal_test
[0m16:22:31.640806 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe'
[0m16:22:31.640806 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:22:31.640806 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe: Close
[0m16:22:31.643033 [debug] [Thread-2 (]: On test.takehome.not_null_medications_per_month_medication_id.0958d28b46: ROLLBACK
[0m16:22:31.642035 [info ] [Thread-4 (]: 4 of 16 PASS not_null_medications_per_month_patients_treated ................... [[32mPASS[0m in 0.06s]
[0m16:22:31.644034 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_medications_per_month_medication_id.0958d28b46'
[0m16:22:31.644034 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:22:31.645052 [debug] [Thread-4 (]: Finished running node test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe
[0m16:22:31.645052 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:22:31.645780 [debug] [Thread-2 (]: On test.takehome.not_null_medications_per_month_medication_id.0958d28b46: Close
[0m16:22:31.645780 [debug] [Thread-4 (]: Began running node test.takehome.not_null_patients_by_age_patient_id.0646b9206a
[0m16:22:31.646792 [debug] [Thread-1 (]: On test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f: ROLLBACK
[0m16:22:31.647793 [debug] [Thread-3 (]: On test.takehome.not_null_medications_per_month_month.4d739bac88: ROLLBACK
[0m16:22:31.647793 [info ] [Thread-2 (]: 2 of 16 PASS not_null_medications_per_month_medication_id ...................... [[32mPASS[0m in 0.08s]
[0m16:22:31.649795 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f'
[0m16:22:31.648796 [info ] [Thread-4 (]: 5 of 16 START test not_null_patients_by_age_patient_id ......................... [RUN]
[0m16:22:31.651317 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.not_null_medications_per_month_month.4d739bac88'
[0m16:22:31.651317 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_medications_per_month_medication_id.0958d28b46
[0m16:22:31.652317 [debug] [Thread-1 (]: On test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f: Close
[0m16:22:31.652317 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe, now test.takehome.not_null_patients_by_age_patient_id.0646b9206a)
[0m16:22:31.653582 [debug] [Thread-3 (]: On test.takehome.not_null_medications_per_month_month.4d739bac88: Close
[0m16:22:31.653582 [debug] [Thread-2 (]: Began running node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m16:22:31.655581 [debug] [Thread-4 (]: Began compiling node test.takehome.not_null_patients_by_age_patient_id.0646b9206a
[0m16:22:31.654579 [info ] [Thread-1 (]: 1 of 16 PASS accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown  [[32mPASS[0m in 0.09s]
[0m16:22:31.656731 [info ] [Thread-3 (]: 3 of 16 PASS not_null_medications_per_month_month .............................. [[32mPASS[0m in 0.09s]
[0m16:22:31.662239 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"
[0m16:22:31.656731 [info ] [Thread-2 (]: 6 of 16 START test not_null_patients_patient_id ................................ [RUN]
[0m16:22:31.663244 [debug] [Thread-1 (]: Finished running node test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f
[0m16:22:31.664246 [debug] [Thread-3 (]: Finished running node test.takehome.not_null_medications_per_month_month.4d739bac88
[0m16:22:31.664246 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_medications_per_month_medication_id.0958d28b46, now test.takehome.not_null_patients_patient_id.330c5fb3d9)
[0m16:22:31.665243 [debug] [Thread-1 (]: Began running node test.takehome.not_null_patients_per_month_month.827712360f
[0m16:22:31.665243 [debug] [Thread-3 (]: Began running node test.takehome.not_null_patients_per_month_new_patients.3bbd15949c
[0m16:22:31.666247 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m16:22:31.666247 [info ] [Thread-1 (]: 7 of 16 START test not_null_patients_per_month_month ........................... [RUN]
[0m16:22:31.667246 [debug] [Thread-4 (]: Began executing node test.takehome.not_null_patients_by_age_patient_id.0646b9206a
[0m16:22:31.670751 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m16:22:31.671354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f, now test.takehome.not_null_patients_per_month_month.827712360f)
[0m16:22:31.667246 [info ] [Thread-3 (]: 8 of 16 START test not_null_patients_per_month_new_patients .................... [RUN]
[0m16:22:31.673860 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"
[0m16:22:31.674739 [debug] [Thread-1 (]: Began compiling node test.takehome.not_null_patients_per_month_month.827712360f
[0m16:22:31.674739 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_medications_per_month_month.4d739bac88, now test.takehome.not_null_patients_per_month_new_patients.3bbd15949c)
[0m16:22:31.678963 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.not_null_patients_per_month_month.827712360f"
[0m16:22:31.680761 [debug] [Thread-3 (]: Began compiling node test.takehome.not_null_patients_per_month_new_patients.3bbd15949c
[0m16:22:31.680761 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m16:22:31.681766 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"
[0m16:22:31.684770 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"
[0m16:22:31.687792 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m16:22:31.688791 [debug] [Thread-1 (]: Began executing node test.takehome.not_null_patients_per_month_month.827712360f
[0m16:22:31.689794 [debug] [Thread-4 (]: On test.takehome.not_null_patients_by_age_patient_id.0646b9206a: BEGIN
[0m16:22:31.693308 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.not_null_patients_per_month_month.827712360f"
[0m16:22:31.693308 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:22:31.695321 [debug] [Thread-3 (]: Began executing node test.takehome.not_null_patients_per_month_new_patients.3bbd15949c
[0m16:22:31.696308 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m16:22:31.699306 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"
[0m16:22:31.699306 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m16:22:31.700814 [debug] [Thread-2 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: BEGIN
[0m16:22:31.701821 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patients_per_month_month.827712360f"
[0m16:22:31.701821 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"
[0m16:22:31.702834 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:22:31.703830 [debug] [Thread-1 (]: On test.takehome.not_null_patients_per_month_month.827712360f: BEGIN
[0m16:22:31.704829 [debug] [Thread-4 (]: On test.takehome.not_null_patients_by_age_patient_id.0646b9206a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_silver"."patients_by_age"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m16:22:31.705830 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"
[0m16:22:31.705830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:31.706827 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:22:31.706827 [debug] [Thread-3 (]: On test.takehome.not_null_patients_per_month_new_patients.3bbd15949c: BEGIN
[0m16:22:31.706827 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:22:31.706827 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m16:22:31.709389 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:22:31.709389 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:22:31.710742 [debug] [Thread-4 (]: On test.takehome.not_null_patients_by_age_patient_id.0646b9206a: ROLLBACK
[0m16:22:31.711753 [debug] [Thread-2 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_patient_id.330c5fb3d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_bronze"."patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m16:22:31.712474 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patients_per_month_month.827712360f"
[0m16:22:31.712474 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.not_null_patients_by_age_patient_id.0646b9206a'
[0m16:22:31.712474 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:22:31.712474 [debug] [Thread-1 (]: On test.takehome.not_null_patients_per_month_month.827712360f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_per_month_month.827712360f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "takehome"."dev_silver"."patients_per_month"
where month is null



  
  
      
    ) dbt_internal_test
[0m16:22:31.712474 [debug] [Thread-4 (]: On test.takehome.not_null_patients_by_age_patient_id.0646b9206a: Close
[0m16:22:31.712474 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:22:31.712474 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"
[0m16:22:31.716414 [info ] [Thread-4 (]: 5 of 16 PASS not_null_patients_by_age_patient_id ............................... [[32mPASS[0m in 0.06s]
[0m16:22:31.717420 [debug] [Thread-3 (]: On test.takehome.not_null_patients_per_month_new_patients.3bbd15949c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select new_patients
from "takehome"."dev_silver"."patients_per_month"
where new_patients is null



  
  
      
    ) dbt_internal_test
[0m16:22:31.717420 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:22:31.719423 [debug] [Thread-2 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: ROLLBACK
[0m16:22:31.719423 [debug] [Thread-4 (]: Finished running node test.takehome.not_null_patients_by_age_patient_id.0646b9206a
[0m16:22:31.721506 [debug] [Thread-1 (]: On test.takehome.not_null_patients_per_month_month.827712360f: ROLLBACK
[0m16:22:31.721506 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:22:31.722504 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_patients_patient_id.330c5fb3d9'
[0m16:22:31.722874 [debug] [Thread-4 (]: Began running node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m16:22:31.722874 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.not_null_patients_per_month_month.827712360f'
[0m16:22:31.723920 [debug] [Thread-3 (]: On test.takehome.not_null_patients_per_month_new_patients.3bbd15949c: ROLLBACK
[0m16:22:31.724891 [debug] [Thread-2 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: Close
[0m16:22:31.724891 [debug] [Thread-1 (]: On test.takehome.not_null_patients_per_month_month.827712360f: Close
[0m16:22:31.724891 [info ] [Thread-4 (]: 9 of 16 START test not_null_stg_orders_order_id ................................ [RUN]
[0m16:22:31.725887 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.not_null_patients_per_month_new_patients.3bbd15949c'
[0m16:22:31.726887 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patients_by_age_patient_id.0646b9206a, now test.takehome.not_null_stg_orders_order_id.81cfe2fe64)
[0m16:22:31.725887 [info ] [Thread-2 (]: 6 of 16 PASS not_null_patients_patient_id ...................................... [[32mPASS[0m in 0.06s]
[0m16:22:31.727892 [debug] [Thread-3 (]: On test.takehome.not_null_patients_per_month_new_patients.3bbd15949c: Close
[0m16:22:31.728890 [debug] [Thread-4 (]: Began compiling node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m16:22:31.726887 [info ] [Thread-1 (]: 7 of 16 PASS not_null_patients_per_month_month ................................. [[32mPASS[0m in 0.06s]
[0m16:22:31.728890 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m16:22:31.735410 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:22:31.736411 [debug] [Thread-1 (]: Finished running node test.takehome.not_null_patients_per_month_month.827712360f
[0m16:22:31.737407 [debug] [Thread-2 (]: Began running node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m16:22:31.730398 [info ] [Thread-3 (]: 8 of 16 PASS not_null_patients_per_month_new_patients .......................... [[32mPASS[0m in 0.06s]
[0m16:22:31.738406 [debug] [Thread-1 (]: Began running node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m16:22:31.739405 [debug] [Thread-3 (]: Finished running node test.takehome.not_null_patients_per_month_new_patients.3bbd15949c
[0m16:22:31.740406 [debug] [Thread-4 (]: Began executing node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m16:22:31.738406 [info ] [Thread-2 (]: 10 of 16 START test not_null_stg_patients_patient_id ........................... [RUN]
[0m16:22:31.740851 [debug] [Thread-3 (]: Began running node test.takehome.unique_patients_by_age_patient_id.56061819f5
[0m16:22:31.740851 [info ] [Thread-1 (]: 11 of 16 START test not_null_stg_visits_visit_id ............................... [RUN]
[0m16:22:31.742884 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:22:31.743867 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patients_patient_id.330c5fb3d9, now test.takehome.not_null_stg_patients_patient_id.e578180344)
[0m16:22:31.744870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patients_per_month_month.827712360f, now test.takehome.not_null_stg_visits_visit_id.a2f537804c)
[0m16:22:31.743867 [info ] [Thread-3 (]: 12 of 16 START test unique_patients_by_age_patient_id .......................... [RUN]
[0m16:22:31.745869 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m16:22:31.745869 [debug] [Thread-1 (]: Began compiling node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m16:22:31.746869 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patients_per_month_new_patients.3bbd15949c, now test.takehome.unique_patients_by_age_patient_id.56061819f5)
[0m16:22:31.751392 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m16:22:31.755391 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m16:22:31.756391 [debug] [Thread-3 (]: Began compiling node test.takehome.unique_patients_by_age_patient_id.56061819f5
[0m16:22:31.756391 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:22:31.761922 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.unique_patients_by_age_patient_id.56061819f5"
[0m16:22:31.762915 [debug] [Thread-4 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m16:22:31.763915 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:22:31.764917 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m16:22:31.768914 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m16:22:31.770423 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m16:22:31.770423 [debug] [Thread-1 (]: Began executing node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m16:22:31.771430 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m16:22:31.830704 [debug] [Thread-4 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "takehome"."dev_staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:22:31.833710 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m16:22:31.834159 [debug] [Thread-3 (]: Began executing node test.takehome.unique_patients_by_age_patient_id.56061819f5
[0m16:22:31.835825 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m16:22:31.839834 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.unique_patients_by_age_patient_id.56061819f5"
[0m16:22:31.840841 [debug] [Thread-2 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: BEGIN
[0m16:22:31.841351 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m16:22:31.842837 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m16:22:31.842837 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:22:31.846837 [debug] [Thread-4 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m16:22:31.846837 [debug] [Thread-1 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: BEGIN
[0m16:22:31.848839 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_patients_by_age_patient_id.56061819f5"
[0m16:22:31.849843 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.not_null_stg_orders_order_id.81cfe2fe64'
[0m16:22:31.850836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:31.851345 [debug] [Thread-3 (]: On test.takehome.unique_patients_by_age_patient_id.56061819f5: BEGIN
[0m16:22:31.851345 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m16:22:31.852348 [debug] [Thread-4 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m16:22:31.854351 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:22:31.855347 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m16:22:31.855347 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:22:31.856347 [info ] [Thread-4 (]: 9 of 16 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.13s]
[0m16:22:31.857347 [debug] [Thread-2 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_patients_patient_id.e578180344"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_staging"."stg_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m16:22:31.858349 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:22:31.858349 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m16:22:31.859347 [debug] [Thread-4 (]: Finished running node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m16:22:31.859347 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_patients_by_age_patient_id.56061819f5"
[0m16:22:31.860858 [debug] [Thread-1 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_visits_visit_id.a2f537804c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from "takehome"."dev_staging"."stg_visits"
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m16:22:31.862868 [debug] [Thread-4 (]: Began running node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m16:22:31.862868 [debug] [Thread-3 (]: On test.takehome.unique_patients_by_age_patient_id.56061819f5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_patients_by_age_patient_id.56061819f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_silver"."patients_by_age"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:22:31.863875 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:22:31.864877 [info ] [Thread-4 (]: 13 of 16 START test unique_patients_patient_id ................................. [RUN]
[0m16:22:31.866876 [debug] [Thread-2 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m16:22:31.867877 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_stg_orders_order_id.81cfe2fe64, now test.takehome.unique_patients_patient_id.8d0f9eb60a)
[0m16:22:31.868878 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:22:31.869881 [debug] [Thread-4 (]: Began compiling node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m16:22:31.871381 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_stg_patients_patient_id.e578180344'
[0m16:22:31.873397 [debug] [Thread-1 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: ROLLBACK
[0m16:22:31.873397 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m16:22:31.878401 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m16:22:31.879396 [debug] [Thread-2 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: Close
[0m16:22:31.880395 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.not_null_stg_visits_visit_id.a2f537804c'
[0m16:22:31.881553 [debug] [Thread-3 (]: On test.takehome.unique_patients_by_age_patient_id.56061819f5: ROLLBACK
[0m16:22:31.883559 [debug] [Thread-1 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: Close
[0m16:22:31.882553 [info ] [Thread-2 (]: 10 of 16 PASS not_null_stg_patients_patient_id ................................. [[32mPASS[0m in 0.14s]
[0m16:22:31.885227 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.unique_patients_by_age_patient_id.56061819f5'
[0m16:22:31.887212 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m16:22:31.886239 [info ] [Thread-1 (]: 11 of 16 PASS not_null_stg_visits_visit_id ..................................... [[32mPASS[0m in 0.14s]
[0m16:22:31.888213 [debug] [Thread-4 (]: Began executing node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m16:22:31.889213 [debug] [Thread-3 (]: On test.takehome.unique_patients_by_age_patient_id.56061819f5: Close
[0m16:22:31.889213 [debug] [Thread-2 (]: Began running node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m16:22:31.889213 [debug] [Thread-1 (]: Finished running node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m16:22:31.892735 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m16:22:31.894734 [info ] [Thread-3 (]: 12 of 16 PASS unique_patients_by_age_patient_id ................................ [[32mPASS[0m in 0.15s]
[0m16:22:31.895736 [debug] [Thread-1 (]: Began running node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m16:22:31.897734 [debug] [Thread-3 (]: Finished running node test.takehome.unique_patients_by_age_patient_id.56061819f5
[0m16:22:31.894734 [info ] [Thread-2 (]: 14 of 16 START test unique_stg_orders_order_id ................................. [RUN]
[0m16:22:31.898732 [debug] [Thread-3 (]: Began running node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m16:22:31.899732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_stg_patients_patient_id.e578180344, now test.takehome.unique_stg_orders_order_id.e3b841c71a)
[0m16:22:31.898732 [info ] [Thread-1 (]: 15 of 16 START test unique_stg_patients_patient_id ............................. [RUN]
[0m16:22:31.901960 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m16:22:31.902972 [debug] [Thread-2 (]: Began compiling node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m16:22:31.900734 [info ] [Thread-3 (]: 16 of 16 START test unique_stg_visits_visit_id ................................. [RUN]
[0m16:22:31.903975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_stg_visits_visit_id.a2f537804c, now test.takehome.unique_stg_patients_patient_id.8907d3ccf0)
[0m16:22:31.904967 [debug] [Thread-4 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: BEGIN
[0m16:22:31.907967 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m16:22:31.909477 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.unique_patients_by_age_patient_id.56061819f5, now test.takehome.unique_stg_visits_visit_id.17a0c34d8d)
[0m16:22:31.910487 [debug] [Thread-1 (]: Began compiling node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m16:22:31.911001 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:22:31.912013 [debug] [Thread-3 (]: Began compiling node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m16:22:31.916003 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m16:22:31.922531 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m16:22:31.923538 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m16:22:31.924540 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m16:22:31.925539 [debug] [Thread-4 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_patients_patient_id.8d0f9eb60a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_bronze"."patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:22:31.926539 [debug] [Thread-2 (]: Began executing node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m16:22:31.931046 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m16:22:31.932055 [debug] [Thread-3 (]: Began executing node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m16:22:31.935069 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m16:22:31.935069 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m16:22:31.938074 [debug] [Thread-4 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: ROLLBACK
[0m16:22:31.939063 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m16:22:31.939063 [debug] [Thread-2 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m16:22:31.939063 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:22:31.940576 [debug] [Thread-1 (]: Began executing node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m16:22:31.941583 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.unique_patients_patient_id.8d0f9eb60a'
[0m16:22:31.944590 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m16:22:31.945585 [debug] [Thread-4 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: Close
[0m16:22:31.946584 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m16:22:31.946584 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:22:31.948587 [debug] [Thread-3 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: BEGIN
[0m16:22:31.947583 [info ] [Thread-4 (]: 13 of 16 PASS unique_patients_patient_id ....................................... [[32mPASS[0m in 0.08s]
[0m16:22:31.949584 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m16:22:31.949584 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m16:22:31.950585 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:22:31.951758 [debug] [Thread-4 (]: Finished running node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m16:22:31.952770 [debug] [Thread-1 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: BEGIN
[0m16:22:31.953761 [debug] [Thread-2 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "takehome"."dev_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:22:31.954759 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m16:22:31.954759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:31.956758 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m16:22:31.956758 [debug] [Thread-3 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    visit_id as unique_field,
    count(*) as n_records

from "takehome"."dev_staging"."stg_visits"
where visit_id is not null
group by visit_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:22:31.958011 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:22:31.958011 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m16:22:31.959015 [debug] [Thread-1 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_staging"."stg_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:22:31.960523 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:22:31.964531 [debug] [Thread-2 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m16:22:31.965531 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.unique_stg_orders_order_id.e3b841c71a'
[0m16:22:31.965531 [debug] [Thread-2 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: Close
[0m16:22:31.966536 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:22:31.967534 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m16:22:31.970535 [debug] [Thread-1 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: ROLLBACK
[0m16:22:31.968534 [info ] [Thread-2 (]: 14 of 16 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.07s]
[0m16:22:31.972740 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.unique_stg_patients_patient_id.8907d3ccf0'
[0m16:22:31.973754 [debug] [Thread-3 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: ROLLBACK
[0m16:22:31.974752 [debug] [Thread-2 (]: Finished running node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m16:22:31.975751 [debug] [Thread-1 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: Close
[0m16:22:31.976747 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.unique_stg_visits_visit_id.17a0c34d8d'
[0m16:22:31.977746 [debug] [Thread-3 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: Close
[0m16:22:31.978748 [info ] [Thread-1 (]: 15 of 16 PASS unique_stg_patients_patient_id ................................... [[32mPASS[0m in 0.07s]
[0m16:22:31.980752 [debug] [Thread-1 (]: Finished running node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m16:22:31.979748 [info ] [Thread-3 (]: 16 of 16 PASS unique_stg_visits_visit_id ....................................... [[32mPASS[0m in 0.07s]
[0m16:22:31.982271 [debug] [Thread-3 (]: Finished running node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m16:22:31.983858 [debug] [MainThread]: Using duckdb connection "master"
[0m16:22:31.985654 [debug] [MainThread]: On master: BEGIN
[0m16:22:31.986808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:31.986808 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:22:31.987810 [debug] [MainThread]: On master: COMMIT
[0m16:22:31.987810 [debug] [MainThread]: Using duckdb connection "master"
[0m16:22:31.987810 [debug] [MainThread]: On master: COMMIT
[0m16:22:31.988806 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:22:31.988806 [debug] [MainThread]: On master: Close
[0m16:22:31.988806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:31.989807 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m16:22:31.989807 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m16:22:31.989807 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m16:22:31.989807 [debug] [MainThread]: Connection 'test.takehome.unique_stg_patients_patient_id.8907d3ccf0' was properly closed.
[0m16:22:31.990805 [debug] [MainThread]: Connection 'test.takehome.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m16:22:31.990805 [debug] [MainThread]: Connection 'test.takehome.unique_stg_visits_visit_id.17a0c34d8d' was properly closed.
[0m16:22:31.990805 [debug] [MainThread]: Connection 'test.takehome.unique_patients_patient_id.8d0f9eb60a' was properly closed.
[0m16:22:31.990805 [info ] [MainThread]: 
[0m16:22:31.991833 [info ] [MainThread]: Finished running 16 data tests in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m16:22:31.993845 [debug] [MainThread]: Command end result
[0m16:22:32.015035 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m16:22:32.019037 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m16:22:32.026585 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m16:22:32.026585 [info ] [MainThread]: 
[0m16:22:32.027568 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:22:32.028579 [info ] [MainThread]: 
[0m16:22:32.029569 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m16:22:32.030569 [debug] [MainThread]: Command `dbt test` succeeded at 16:22:32.029569 after 1.55 seconds
[0m16:22:32.030569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F125900AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F126450FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12A255910>]}
[0m16:22:32.030569 [debug] [MainThread]: Flushing usage events
[0m16:22:32.561678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:45.850790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3EFF8FEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3EFF10320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F25D9880>]}


============================== 16:38:45.857930 | d073caf6-7eb8-4779-9a60-5f31c873dd1d ==============================
[0m16:38:45.857930 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:38:45.857930 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m16:38:46.025452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F2C14A40>]}
[0m16:38:46.071187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F01AFBF0>]}
[0m16:38:46.073237 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:38:46.194234 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:38:46.361164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m16:38:46.361164 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\staging\stg_lab_results.sql
[0m16:38:46.361164 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\staging\lab_results.sql
[0m16:38:46.362159 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\_stg_models.yml
[0m16:38:46.362159 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\silver\_mart_silver_models.yml
[0m16:38:46.646402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F4C020F0>]}
[0m16:38:46.700325 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m16:38:46.702374 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m16:38:46.730897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F4EA2C60>]}
[0m16:38:46.730897 [info ] [MainThread]: Found 14 models, 20 data tests, 8 sources, 468 macros
[0m16:38:46.730897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F4DBA7B0>]}
[0m16:38:46.733827 [info ] [MainThread]: 
[0m16:38:46.733827 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:38:46.733827 [info ] [MainThread]: 
[0m16:38:46.733827 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:38:46.738290 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m16:38:46.799995 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m16:38:46.805385 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m16:38:46.838248 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m16:38:46.838248 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m16:38:46.838248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:46.839797 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m16:38:46.839797 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m16:38:46.839797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:46.840807 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m16:38:46.840807 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m16:38:46.840807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:46.854529 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m16:38:46.854529 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m16:38:46.856317 [debug] [ThreadPool]: On list_takehome: Close
[0m16:38:46.857327 [debug] [ThreadPool]: On list_takehome: Close
[0m16:38:46.857327 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m16:38:46.858422 [debug] [ThreadPool]: On list_takehome: Close
[0m16:38:46.860042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_silver)
[0m16:38:46.861057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m16:38:46.861057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m16:38:46.861057 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_silver"
"
[0m16:38:46.862173 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m16:38:46.862173 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m16:38:46.867054 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:38:46.869606 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:38:46.871615 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:38:46.871615 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m16:38:46.871615 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m16:38:46.872613 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m16:38:46.872613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:46.872613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:46.873613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:46.874613 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:38:46.875613 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:38:46.875613 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m16:38:46.876620 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:38:46.876620 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:38:46.877613 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:38:46.877613 [debug] [ThreadPool]: On create_takehome_dev_silver: BEGIN
[0m16:38:46.877613 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:38:46.878847 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:38:46.879849 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:38:46.879849 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:38:46.881298 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m16:38:46.881298 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m16:38:46.882298 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:38:46.882805 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:38:46.882805 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
    
        create schema if not exists "takehome"."dev_silver"
    
[0m16:38:46.882805 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:38:46.882805 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:38:46.882805 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m16:38:46.882805 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m16:38:46.882805 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:38:46.882805 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:38:46.882805 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:38:46.882805 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m16:38:46.882805 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m16:38:46.882805 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m16:38:46.882805 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:38:46.882805 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:38:46.882805 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:38:46.889821 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m16:38:46.889821 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m16:38:46.889821 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m16:38:46.889821 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:38:46.889821 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m16:38:46.889821 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:38:46.889821 [debug] [ThreadPool]: On create_takehome_dev_silver: Close
[0m16:38:46.889821 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m16:38:46.898289 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m16:38:46.898289 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m16:38:46.898289 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m16:38:46.900813 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m16:38:46.900813 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m16:38:46.900813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:46.901823 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m16:38:46.902828 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m16:38:46.904079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:46.904079 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m16:38:46.904079 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:38:46.905078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:46.905078 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m16:38:46.905078 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:38:46.905078 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m16:38:46.906302 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m16:38:46.906302 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:38:46.907301 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m16:38:46.907301 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m16:38:46.908301 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m16:38:46.920337 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m16:38:46.922341 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m16:38:46.922341 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m16:38:46.924344 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m16:38:46.925339 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m16:38:46.925339 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m16:38:46.926344 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m16:38:46.928616 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m16:38:46.930130 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m16:38:46.930130 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m16:38:46.933136 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m16:38:46.933136 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m16:38:46.935138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F49E05C0>]}
[0m16:38:46.935138 [debug] [MainThread]: Using duckdb connection "master"
[0m16:38:46.936132 [debug] [MainThread]: On master: BEGIN
[0m16:38:46.936132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:46.937167 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:38:46.937167 [debug] [MainThread]: On master: COMMIT
[0m16:38:46.937167 [debug] [MainThread]: Using duckdb connection "master"
[0m16:38:46.937167 [debug] [MainThread]: On master: COMMIT
[0m16:38:46.938150 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:38:46.938150 [debug] [MainThread]: On master: Close
[0m16:38:46.947377 [debug] [Thread-1 (]: Began running node model.takehome.stg_conditions
[0m16:38:46.947945 [debug] [Thread-2 (]: Began running node model.takehome.stg_documents
[0m16:38:46.948583 [debug] [Thread-3 (]: Began running node model.takehome.stg_lab_results
[0m16:38:46.950843 [debug] [Thread-4 (]: Began running node model.takehome.stg_med_admins
[0m16:38:46.949724 [info ] [Thread-1 (]: 1 of 14 START sql view model dev_staging.stg_conditions ........................ [RUN]
[0m16:38:46.950292 [info ] [Thread-2 (]: 2 of 14 START sql view model dev_staging.stg_documents ......................... [RUN]
[0m16:38:46.953645 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_conditions'
[0m16:38:46.954279 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.takehome.stg_documents'
[0m16:38:46.952280 [info ] [Thread-3 (]: 3 of 14 START sql view model dev_staging.stg_lab_results ....................... [RUN]
[0m16:38:46.954948 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_conditions
[0m16:38:46.955510 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_documents
[0m16:38:46.953001 [info ] [Thread-4 (]: 4 of 14 START sql view model dev_staging.stg_med_admins ........................ [RUN]
[0m16:38:46.956904 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.stg_lab_results'
[0m16:38:46.964957 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_conditions"
[0m16:38:46.968476 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_documents"
[0m16:38:46.969100 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.takehome.stg_med_admins'
[0m16:38:46.970166 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_lab_results
[0m16:38:46.971804 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_med_admins
[0m16:38:46.975662 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_lab_results"
[0m16:38:46.979618 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_med_admins"
[0m16:38:46.980184 [debug] [Thread-1 (]: Began executing node model.takehome.stg_conditions
[0m16:38:47.010060 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_conditions"
[0m16:38:47.010060 [debug] [Thread-2 (]: Began executing node model.takehome.stg_documents
[0m16:38:47.012175 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_documents"
[0m16:38:47.013171 [debug] [Thread-4 (]: Began executing node model.takehome.stg_med_admins
[0m16:38:47.016066 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_med_admins"
[0m16:38:47.016066 [debug] [Thread-3 (]: Began executing node model.takehome.stg_lab_results
[0m16:38:47.019817 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_lab_results"
[0m16:38:47.019817 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:38:47.020824 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:38:47.020824 [debug] [Thread-2 (]: On model.takehome.stg_documents: BEGIN
[0m16:38:47.021823 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:38:47.021823 [debug] [Thread-1 (]: On model.takehome.stg_conditions: BEGIN
[0m16:38:47.021823 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:38:47.022825 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: BEGIN
[0m16:38:47.022825 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m16:38:47.023825 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:38:47.024824 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:38:47.024824 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: BEGIN
[0m16:38:47.024824 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.025976 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:38:47.026824 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:38:47.026824 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:38:47.027824 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.028160 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

  
  create view "takehome"."dev_staging"."stg_documents__dbt_tmp" as (
    select
    document_id,
    patient_id,
    visit_id,
    document_line,
    document_text
from "takehome"."raw"."documents"
  );

[0m16:38:47.028160 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:38:47.028160 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.028160 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:38:47.029306 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

  
  create view "takehome"."dev_staging"."stg_conditions__dbt_tmp" as (
    select
    id   as condition_id,
    name as condition_name
from "takehome"."raw"."conditions"
  );

[0m16:38:47.029867 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m16:38:47.029867 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.029867 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

  
  create view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" as (
    select
    patient_id,
    patient_condition_id,
    medication_id,
    coalesce(date_stopped, date_started) as updated_at,
    date_started,
    date_stopped,
    dosage
from "takehome"."raw"."med_admins"
  );

[0m16:38:47.030964 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    select *
    from read_json_auto('src_data/lab_results/*.json')
),
flattened as (
    select
        testId::bigint                   as test_id,
        orderId::bigint                  as order_id,
        patientId::bigint                as patient_id,
        cast(resultDate as date)         as result_date,
        tr.componentName                 as component_name,
        tr.componentRefHi::double        as component_ref_hi,
        tr.componentRefLo::double        as component_ref_lo,
        tr.componentUnits                as component_units,
        tr.resultValue::double           as result_value
    from raw_json
    cross join unnest(testResults) tr
)
select *
from flattened
  );

[0m16:38:47.035419 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:38:47.035419 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:38:47.036371 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents" rename to "stg_documents__dbt_backup"
[0m16:38:47.036371 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.038414 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:38:47.041097 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:38:47.041097 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions" rename to "stg_conditions__dbt_backup"
[0m16:38:47.041097 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins" rename to "stg_med_admins__dbt_backup"
[0m16:38:47.042661 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.045716 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:38:47.045716 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents__dbt_tmp" rename to "stg_documents"
[0m16:38:47.046747 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:38:47.049639 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:38:47.049639 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions__dbt_tmp" rename to "stg_conditions"
[0m16:38:47.049639 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:38:47.055229 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m16:38:47.055229 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:38:47.059671 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m16:38:47.059671 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m16:38:47.059671 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m16:38:47.059671 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m16:38:47.059671 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:38:47.059671 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:38:47.059671 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:38:47.059671 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" rename to "stg_med_admins"
[0m16:38:47.059671 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m16:38:47.070328 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:38:47.071420 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

      drop view if exists "takehome"."dev_staging"."stg_documents__dbt_backup" cascade
    
[0m16:38:47.071420 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.073443 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m16:38:47.073443 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:38:47.073443 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m16:38:47.074455 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.076399 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:38:47.076399 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_conditions__dbt_backup" cascade
    
[0m16:38:47.076399 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.078772 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:38:47.078772 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

      drop view if exists "takehome"."dev_staging"."stg_med_admins__dbt_backup" cascade
    
[0m16:38:47.078772 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:38:47.081061 [debug] [Thread-2 (]: On model.takehome.stg_documents: Close
[0m16:38:47.081061 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.082720 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: Close
[0m16:38:47.082720 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:38:47.082720 [debug] [Thread-1 (]: On model.takehome.stg_conditions: Close
[0m16:38:47.082720 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F6167590>]}
[0m16:38:47.082720 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F6173FB0>]}
[0m16:38:47.082720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F6179700>]}
[0m16:38:47.082720 [info ] [Thread-2 (]: 2 of 14 OK created sql view model dev_staging.stg_documents .................... [[32mOK[0m in 0.13s]
[0m16:38:47.082720 [debug] [Thread-2 (]: Finished running node model.takehome.stg_documents
[0m16:38:47.082720 [info ] [Thread-4 (]: 4 of 14 OK created sql view model dev_staging.stg_med_admins ................... [[32mOK[0m in 0.11s]
[0m16:38:47.082720 [debug] [Thread-2 (]: Began running node model.takehome.stg_medications
[0m16:38:47.082720 [debug] [Thread-4 (]: Finished running node model.takehome.stg_med_admins
[0m16:38:47.082720 [info ] [Thread-1 (]: 1 of 14 OK created sql view model dev_staging.stg_conditions ................... [[32mOK[0m in 0.13s]
[0m16:38:47.090908 [debug] [Thread-4 (]: Began running node model.takehome.stg_orders
[0m16:38:47.089633 [info ] [Thread-2 (]: 5 of 14 START sql view model dev_staging.stg_medications ....................... [RUN]
[0m16:38:47.091977 [debug] [Thread-1 (]: Finished running node model.takehome.stg_conditions
[0m16:38:47.092953 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_documents, now model.takehome.stg_medications)
[0m16:38:47.091977 [info ] [Thread-4 (]: 6 of 14 START sql view model dev_staging.stg_orders ............................ [RUN]
[0m16:38:47.092953 [debug] [Thread-1 (]: Began running node model.takehome.stg_patient_conditions
[0m16:38:47.094012 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_medications
[0m16:38:47.094012 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_med_admins, now model.takehome.stg_orders)
[0m16:38:47.097019 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_medications"
[0m16:38:47.094966 [info ] [Thread-1 (]: 7 of 14 START sql view model dev_staging.stg_patient_conditions ................ [RUN]
[0m16:38:47.098031 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_orders
[0m16:38:47.098031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_conditions, now model.takehome.stg_patient_conditions)
[0m16:38:47.099551 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_orders"
[0m16:38:47.100661 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_patient_conditions
[0m16:38:47.100661 [debug] [Thread-2 (]: Began executing node model.takehome.stg_medications
[0m16:38:47.102598 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_patient_conditions"
[0m16:38:47.105971 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_medications"
[0m16:38:47.106983 [debug] [Thread-4 (]: Began executing node model.takehome.stg_orders
[0m16:38:47.110574 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_orders"
[0m16:38:47.110574 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:38:47.111586 [debug] [Thread-2 (]: On model.takehome.stg_medications: BEGIN
[0m16:38:47.111586 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:47.112577 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.113587 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:38:47.114577 [debug] [Thread-1 (]: Began executing node model.takehome.stg_patient_conditions
[0m16:38:47.114577 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:38:47.115582 [debug] [Thread-4 (]: On model.takehome.stg_orders: BEGIN
[0m16:38:47.118587 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_patient_conditions"
[0m16:38:47.119577 [debug] [Thread-2 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

  
  create view "takehome"."dev_staging"."stg_medications__dbt_tmp" as (
    select
    id   as medication_id,
    name as medication_name
from "takehome"."raw"."medications"
  );

[0m16:38:47.119577 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:47.121639 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.122652 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:38:47.123654 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.123654 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:38:47.124675 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: BEGIN
[0m16:38:47.126664 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:38:47.126664 [debug] [Thread-4 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

  
  create view "takehome"."dev_staging"."stg_orders__dbt_tmp" as (
    select
    id            as order_id,
    patient_id,
    condition_id,
    order_date    as updated_at,
    order_date
from "takehome"."raw"."orders"
  );

[0m16:38:47.127647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:47.127647 [debug] [Thread-2 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications" rename to "stg_medications__dbt_backup"
[0m16:38:47.128916 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.132008 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:38:47.132008 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:38:47.133008 [debug] [Thread-4 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m16:38:47.133008 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:38:47.134014 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m16:38:47.135010 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

  
  create view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" as (
    select
    id                     as patient_condition_id,
    patient_id,
    condition_id,
    coalesce(date_ended, date_started) as updated_at,
    date_started,
    date_ended
from "takehome"."raw"."patient_conditions"
  );

[0m16:38:47.139523 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:38:47.140532 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m16:38:47.141253 [debug] [Thread-2 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications__dbt_tmp" rename to "stg_medications"
[0m16:38:47.143268 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:38:47.143268 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:38:47.144265 [debug] [Thread-4 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m16:38:47.146273 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:38:47.147269 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.147269 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions" rename to "stg_patient_conditions__dbt_backup"
[0m16:38:47.148266 [debug] [Thread-2 (]: On model.takehome.stg_medications: COMMIT
[0m16:38:47.148266 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.149770 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:38:47.150777 [debug] [Thread-4 (]: On model.takehome.stg_orders: COMMIT
[0m16:38:47.151792 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.151792 [debug] [Thread-2 (]: On model.takehome.stg_medications: COMMIT
[0m16:38:47.151792 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:38:47.154778 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:38:47.154778 [debug] [Thread-4 (]: On model.takehome.stg_orders: COMMIT
[0m16:38:47.154778 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" rename to "stg_patient_conditions"
[0m16:38:47.155779 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:38:47.156780 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m16:38:47.157781 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:38:47.157781 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m16:38:47.157781 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.160280 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:38:47.160280 [debug] [Thread-2 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

      drop view if exists "takehome"."dev_staging"."stg_medications__dbt_backup" cascade
    
[0m16:38:47.160280 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:38:47.162282 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:38:47.162282 [debug] [Thread-4 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

      drop view if exists "takehome"."dev_staging"."stg_orders__dbt_backup" cascade
    
[0m16:38:47.163282 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:38:47.164286 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:38:47.165286 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_patient_conditions__dbt_backup" cascade
    
[0m16:38:47.165286 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:38:47.166284 [debug] [Thread-2 (]: On model.takehome.stg_medications: Close
[0m16:38:47.167284 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.167284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F6139B20>]}
[0m16:38:47.167284 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.168502 [debug] [Thread-4 (]: On model.takehome.stg_orders: Close
[0m16:38:47.170624 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: Close
[0m16:38:47.169617 [info ] [Thread-2 (]: 5 of 14 OK created sql view model dev_staging.stg_medications .................. [[32mOK[0m in 0.07s]
[0m16:38:47.170624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F61C4B90>]}
[0m16:38:47.171684 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F61208C0>]}
[0m16:38:47.171684 [debug] [Thread-2 (]: Finished running node model.takehome.stg_medications
[0m16:38:47.172730 [info ] [Thread-1 (]: 7 of 14 OK created sql view model dev_staging.stg_patient_conditions ........... [[32mOK[0m in 0.07s]
[0m16:38:47.173630 [debug] [Thread-2 (]: Began running node model.takehome.stg_patients
[0m16:38:47.172730 [info ] [Thread-4 (]: 6 of 14 OK created sql view model dev_staging.stg_orders ....................... [[32mOK[0m in 0.08s]
[0m16:38:47.173630 [debug] [Thread-1 (]: Finished running node model.takehome.stg_patient_conditions
[0m16:38:47.175628 [debug] [Thread-4 (]: Finished running node model.takehome.stg_orders
[0m16:38:47.174626 [info ] [Thread-2 (]: 8 of 14 START sql view model dev_staging.stg_patients .......................... [RUN]
[0m16:38:47.175628 [debug] [Thread-1 (]: Began running node model.takehome.stg_visits
[0m16:38:47.176660 [debug] [Thread-4 (]: Began running node model.takehome.medications_per_month
[0m16:38:47.177625 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_medications, now model.takehome.stg_patients)
[0m16:38:47.178938 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_patients
[0m16:38:47.181477 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m16:38:47.177625 [info ] [Thread-1 (]: 9 of 14 START sql view model dev_staging.stg_visits ............................ [RUN]
[0m16:38:47.181477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patient_conditions, now model.takehome.stg_visits)
[0m16:38:47.183126 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_visits
[0m16:38:47.185681 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_visits"
[0m16:38:47.178625 [info ] [Thread-4 (]: 10 of 14 START sql table model dev_silver.medications_per_month ................ [RUN]
[0m16:38:47.187688 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_orders, now model.takehome.medications_per_month)
[0m16:38:47.187688 [debug] [Thread-4 (]: Began compiling node model.takehome.medications_per_month
[0m16:38:47.191906 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.medications_per_month"
[0m16:38:47.191906 [debug] [Thread-2 (]: Began executing node model.takehome.stg_patients
[0m16:38:47.196866 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m16:38:47.197866 [debug] [Thread-1 (]: Began executing node model.takehome.stg_visits
[0m16:38:47.201380 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_visits"
[0m16:38:47.202389 [debug] [Thread-4 (]: Began executing node model.takehome.medications_per_month
[0m16:38:47.218425 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.medications_per_month"
[0m16:38:47.219932 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:38:47.220941 [debug] [Thread-1 (]: On model.takehome.stg_visits: BEGIN
[0m16:38:47.221955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:47.221955 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:38:47.222961 [debug] [Thread-2 (]: On model.takehome.stg_patients: BEGIN
[0m16:38:47.222961 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:47.223948 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.224951 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:38:47.224951 [debug] [Thread-2 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id as patient_id,
    coalesce(
        date_deactivated,
        date_activated,
        date_of_death,
        date_of_birth
    )                                    as updated_at,
    first_name,
    last_name,
    ssn,
    date_of_birth,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_death,
    date_activated,
    date_deactivated
from "takehome"."raw"."patients"
  );

[0m16:38:47.226076 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:38:47.226947 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:38:47.226947 [debug] [Thread-1 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

  
  create view "takehome"."dev_staging"."stg_visits__dbt_tmp" as (
    select
    id                    as visit_id,
    visit_date            as updated_at,
    patient_condition_id,
    visit_date
from "takehome"."raw"."visits"
  );

[0m16:38:47.226947 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.227946 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:38:47.232231 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:38:47.233147 [debug] [Thread-4 (]: On model.takehome.medications_per_month: BEGIN
[0m16:38:47.233147 [debug] [Thread-2 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m16:38:47.233147 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:47.234160 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:38:47.235159 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.237106 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:38:47.238170 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:38:47.240859 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:38:47.240859 [debug] [Thread-1 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits" rename to "stg_visits__dbt_backup"
[0m16:38:47.241894 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:38:47.242146 [debug] [Thread-2 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m16:38:47.242146 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."medications_per_month__dbt_tmp"
  
    as (
      with med_admins as (
    select
        patient_id,
        medication_id,
        date_started
    from "takehome"."dev_staging"."stg_med_admins"
    where date_started is not null
),

meds as (
    select
        medication_id,
        medication_name
    from "takehome"."dev_staging"."stg_medications"
),

med_admins_month as (
    select
        date_trunc('month', date_started) as month,
        medication_id,
        patient_id
    from med_admins
)

select
    m.month,
    med.medication_id,
    med.medication_name,
    count(*)                     as administrations,
    count(distinct m.patient_id) as patients_treated
from med_admins_month m
join meds med
    on m.medication_id = med.medication_id
group by 1,2,3
order by 1,2
    );
  
  
[0m16:38:47.243176 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.246154 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:38:47.247156 [debug] [Thread-1 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits__dbt_tmp" rename to "stg_visits"
[0m16:38:47.248156 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:38:47.249661 [debug] [Thread-2 (]: On model.takehome.stg_patients: COMMIT
[0m16:38:47.250667 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:38:47.250667 [debug] [Thread-2 (]: On model.takehome.stg_patients: COMMIT
[0m16:38:47.250667 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.253668 [debug] [Thread-1 (]: On model.takehome.stg_visits: COMMIT
[0m16:38:47.253668 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:38:47.254877 [debug] [Thread-1 (]: On model.takehome.stg_visits: COMMIT
[0m16:38:47.255879 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:38:47.259876 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:38:47.260884 [debug] [Thread-2 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

      drop view if exists "takehome"."dev_staging"."stg_patients__dbt_backup" cascade
    
[0m16:38:47.260884 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:38:47.263895 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:38:47.264892 [debug] [Thread-4 (]: SQL status: OK in 0.022 seconds
[0m16:38:47.264892 [debug] [Thread-1 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

      drop view if exists "takehome"."dev_staging"."stg_visits__dbt_backup" cascade
    
[0m16:38:47.268888 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:38:47.269890 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m16:38:47.269890 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m16:38:47.272003 [debug] [Thread-2 (]: On model.takehome.stg_patients: Close
[0m16:38:47.272003 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.273061 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F628FEC0>]}
[0m16:38:47.274999 [debug] [Thread-1 (]: On model.takehome.stg_visits: Close
[0m16:38:47.275277 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.276409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F513EC60>]}
[0m16:38:47.275277 [info ] [Thread-2 (]: 8 of 14 OK created sql view model dev_staging.stg_patients ..................... [[32mOK[0m in 0.10s]
[0m16:38:47.277427 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:38:47.276409 [info ] [Thread-1 (]: 9 of 14 OK created sql view model dev_staging.stg_visits ....................... [[32mOK[0m in 0.09s]
[0m16:38:47.278819 [debug] [Thread-2 (]: Finished running node model.takehome.stg_patients
[0m16:38:47.278819 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m16:38:47.279963 [debug] [Thread-1 (]: Finished running node model.takehome.stg_visits
[0m16:38:47.279963 [debug] [Thread-2 (]: Began running node model.takehome.patients
[0m16:38:47.279963 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.279963 [info ] [Thread-2 (]: 11 of 14 START sql table model dev_bronze.patients ............................. [RUN]
[0m16:38:47.283408 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:38:47.283408 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patients, now model.takehome.patients)
[0m16:38:47.283408 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month" rename to "medications_per_month__dbt_backup"
[0m16:38:47.283408 [debug] [Thread-2 (]: Began compiling node model.takehome.patients
[0m16:38:47.289996 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.patients"
[0m16:38:47.289996 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:38:47.291990 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:38:47.291990 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month__dbt_tmp" rename to "medications_per_month"
[0m16:38:47.291990 [debug] [Thread-2 (]: Began executing node model.takehome.patients
[0m16:38:47.297752 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.patients"
[0m16:38:47.298748 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:38:47.302595 [debug] [Thread-4 (]: On model.takehome.medications_per_month: COMMIT
[0m16:38:47.302595 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:38:47.302595 [debug] [Thread-4 (]: On model.takehome.medications_per_month: COMMIT
[0m16:38:47.303605 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m16:38:47.304946 [debug] [Thread-2 (]: On model.takehome.patients: BEGIN
[0m16:38:47.304946 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:38:47.305892 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.307954 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:38:47.307954 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.307954 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

      drop table if exists "takehome"."dev_silver"."medications_per_month__dbt_backup" cascade
    
[0m16:38:47.307954 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m16:38:47.309460 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      

with 

pt as ( select * from "takehome"."dev_staging"."stg_patients" )

select
    *
    
from pt

qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m16:38:47.310480 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.311502 [debug] [Thread-4 (]: On model.takehome.medications_per_month: Close
[0m16:38:47.312476 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F62A0E30>]}
[0m16:38:47.312960 [info ] [Thread-4 (]: 10 of 14 OK created sql table model dev_silver.medications_per_month ........... [[32mOK[0m in 0.12s]
[0m16:38:47.315065 [debug] [Thread-4 (]: Finished running node model.takehome.medications_per_month
[0m16:38:47.323879 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m16:38:47.324876 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m16:38:47.324876 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m16:38:47.325860 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.327856 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m16:38:47.327856 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m16:38:47.329701 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.332956 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m16:38:47.332956 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients" rename to "patients__dbt_backup"
[0m16:38:47.333952 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:38:47.335951 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m16:38:47.335951 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients__dbt_tmp" rename to "patients"
[0m16:38:47.336951 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:38:47.337936 [debug] [Thread-2 (]: On model.takehome.patients: COMMIT
[0m16:38:47.338935 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m16:38:47.338935 [debug] [Thread-2 (]: On model.takehome.patients: COMMIT
[0m16:38:47.341615 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.343634 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m16:38:47.344637 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

      drop table if exists "takehome"."dev_bronze"."patients__dbt_backup" cascade
    
[0m16:38:47.345618 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.347703 [debug] [Thread-2 (]: On model.takehome.patients: Close
[0m16:38:47.347703 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F4CEE090>]}
[0m16:38:47.348738 [info ] [Thread-2 (]: 11 of 14 OK created sql table model dev_bronze.patients ........................ [[32mOK[0m in 0.06s]
[0m16:38:47.349669 [debug] [Thread-2 (]: Finished running node model.takehome.patients
[0m16:38:47.350294 [debug] [Thread-1 (]: Began running node model.takehome.patients_by_age
[0m16:38:47.350294 [debug] [Thread-4 (]: Began running node model.takehome.patients_per_month
[0m16:38:47.351355 [info ] [Thread-1 (]: 12 of 14 START sql table model dev_silver.patients_by_age ...................... [RUN]
[0m16:38:47.351355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_visits, now model.takehome.patients_by_age)
[0m16:38:47.352349 [debug] [Thread-1 (]: Began compiling node model.takehome.patients_by_age
[0m16:38:47.351355 [info ] [Thread-4 (]: 13 of 14 START sql table model dev_silver.patients_per_month ................... [RUN]
[0m16:38:47.354735 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.patients_by_age"
[0m16:38:47.354735 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.medications_per_month, now model.takehome.patients_per_month)
[0m16:38:47.354735 [debug] [Thread-4 (]: Began compiling node model.takehome.patients_per_month
[0m16:38:47.356756 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.patients_per_month"
[0m16:38:47.357751 [debug] [Thread-1 (]: Began executing node model.takehome.patients_by_age
[0m16:38:47.360265 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.patients_by_age"
[0m16:38:47.361356 [debug] [Thread-4 (]: Began executing node model.takehome.patients_per_month
[0m16:38:47.367306 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.patients_per_month"
[0m16:38:47.367306 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:38:47.368268 [debug] [Thread-1 (]: On model.takehome.patients_by_age: BEGIN
[0m16:38:47.368268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:47.368268 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.368268 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:38:47.369782 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:38:47.369782 [debug] [Thread-4 (]: On model.takehome.patients_per_month: BEGIN
[0m16:38:47.370802 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_by_age__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_of_birth,
        gender,
        race,
        ethnicity,
        smoker,
        drinks_per_week,
        date_activated,
        date_deactivated,
        date_of_death
    from "takehome"."dev_bronze"."patients"
)

select
    patient_id,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_birth,
    date_activated,
    date_deactivated,
    date_of_death,
    date_diff('year', date_of_birth, current_date) as age,
    case
        when date_of_birth is null then 'unknown'
        when date_diff('year', date_of_birth, current_date) < 18 then '0-17'
        when date_diff('year', date_of_birth, current_date) between 18 and 34 then '18-34'
        when date_diff('year', date_of_birth, current_date) between 35 and 49 then '35-49'
        when date_diff('year', date_of_birth, current_date) between 50 and 64 then '50-64'
        else '65+'
    end as age_group
from patients
    );
  
  
[0m16:38:47.370802 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:38:47.372797 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.372797 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:38:47.372797 [debug] [Thread-4 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_per_month__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_activated,
        gender
    from "takehome"."dev_bronze"."patients"
    where date_activated is not null
),

patients_by_month as (
    select
        date_trunc('month', date_activated)                           as month,
        count(*)                                                      as new_patients,
        count(distinct case when gender = 'M' then patient_id end)    as new_patients_male,
        count(distinct case when gender = 'F' then patient_id end)    as new_patients_female
    from patients
    group by 1
)

select *
from patients_by_month
order by month
    );
  
  
[0m16:38:47.374797 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.375800 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:38:47.375800 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m16:38:47.383335 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:38:47.385060 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:38:47.385060 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m16:38:47.385060 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m16:38:47.387073 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:38:47.388701 [debug] [Thread-4 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m16:38:47.388701 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.392199 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:38:47.392199 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age" rename to "patients_by_age__dbt_backup"
[0m16:38:47.392199 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:38:47.394233 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:38:47.394233 [debug] [Thread-4 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m16:38:47.395244 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.398224 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:38:47.398224 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age__dbt_tmp" rename to "patients_by_age"
[0m16:38:47.398224 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.400908 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:38:47.401960 [debug] [Thread-4 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month" rename to "patients_per_month__dbt_backup"
[0m16:38:47.401960 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.402903 [debug] [Thread-1 (]: On model.takehome.patients_by_age: COMMIT
[0m16:38:47.403886 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:38:47.403886 [debug] [Thread-1 (]: On model.takehome.patients_by_age: COMMIT
[0m16:38:47.403886 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.406944 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:38:47.406944 [debug] [Thread-4 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month__dbt_tmp" rename to "patients_per_month"
[0m16:38:47.407947 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:38:47.410542 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:38:47.410542 [debug] [Thread-1 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

      drop table if exists "takehome"."dev_silver"."patients_by_age__dbt_backup" cascade
    
[0m16:38:47.410542 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:38:47.412559 [debug] [Thread-4 (]: On model.takehome.patients_per_month: COMMIT
[0m16:38:47.412559 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:38:47.412559 [debug] [Thread-4 (]: On model.takehome.patients_per_month: COMMIT
[0m16:38:47.413566 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.414576 [debug] [Thread-1 (]: On model.takehome.patients_by_age: Close
[0m16:38:47.414576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F62C3E00>]}
[0m16:38:47.415551 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:38:47.417600 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:38:47.415551 [info ] [Thread-1 (]: 12 of 14 OK created sql table model dev_silver.patients_by_age ................. [[32mOK[0m in 0.06s]
[0m16:38:47.417600 [debug] [Thread-4 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

      drop table if exists "takehome"."dev_silver"."patients_per_month__dbt_backup" cascade
    
[0m16:38:47.418532 [debug] [Thread-1 (]: Finished running node model.takehome.patients_by_age
[0m16:38:47.419524 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:38:47.420686 [debug] [Thread-4 (]: On model.takehome.patients_per_month: Close
[0m16:38:47.421796 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F611F5C0>]}
[0m16:38:47.421796 [info ] [Thread-4 (]: 13 of 14 OK created sql table model dev_silver.patients_per_month .............. [[32mOK[0m in 0.07s]
[0m16:38:47.422798 [debug] [Thread-4 (]: Finished running node model.takehome.patients_per_month
[0m16:38:47.589729 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    select *
    from read_json_auto('src_data/lab_results/*.json')
),
flattened as (
    select
        testId::bigint                   as test_id,
        orderId::bigint                  as order_id,
        patientId::bigint                as patient_id,
        cast(resultDate as date)         as result_date,
        tr.componentName                 as component_name,
        tr.componentRefHi::double        as component_ref_hi,
        tr.componentRefLo::double        as component_ref_lo,
        tr.componentUnits                as component_units,
        tr.resultValue::double           as result_value
    from raw_json
    cross join unnest(testResults) tr
)
select *
from flattened
  );

[0m16:38:47.590233 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m16:38:47.590233 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: ROLLBACK
[0m16:38:47.594243 [debug] [Thread-3 (]: Failed to rollback 'model.takehome.stg_lab_results'
[0m16:38:47.594243 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: Close
[0m16:38:47.596242 [debug] [Thread-3 (]: Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "tr" does not have a column named "componentName"
  
  Candidate bindings: : "unnest"
  
  LINE 15:         tr.componentName                 as component_name,
                   ^
[0m16:38:47.596242 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd073caf6-7eb8-4779-9a60-5f31c873dd1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F4CD7C50>]}
[0m16:38:47.597243 [error] [Thread-3 (]: 3 of 14 ERROR creating sql view model dev_staging.stg_lab_results .............. [[31mERROR[0m in 0.64s]
[0m16:38:47.598242 [debug] [Thread-3 (]: Finished running node model.takehome.stg_lab_results
[0m16:38:47.598242 [debug] [Thread-7 (]: Marking all children of 'model.takehome.stg_lab_results' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "tr" does not have a column named "componentName"
  
  Candidate bindings: : "unnest"
  
  LINE 15:         tr.componentName                 as component_name,
                   ^.
[0m16:38:47.599487 [debug] [Thread-2 (]: Began running node model.takehome.lab_results
[0m16:38:47.599487 [info ] [Thread-2 (]: 14 of 14 SKIP relation dev_staging.lab_results ................................. [[33mSKIP[0m]
[0m16:38:47.600768 [debug] [Thread-2 (]: Finished running node model.takehome.lab_results
[0m16:38:47.601772 [debug] [MainThread]: Using duckdb connection "master"
[0m16:38:47.601772 [debug] [MainThread]: On master: BEGIN
[0m16:38:47.601772 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:38:47.602789 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:38:47.602789 [debug] [MainThread]: On master: COMMIT
[0m16:38:47.602789 [debug] [MainThread]: Using duckdb connection "master"
[0m16:38:47.602789 [debug] [MainThread]: On master: COMMIT
[0m16:38:47.604082 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:38:47.604082 [debug] [MainThread]: On master: Close
[0m16:38:47.604960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:47.604960 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m16:38:47.604960 [debug] [MainThread]: Connection 'create_takehome_dev_silver' was properly closed.
[0m16:38:47.604960 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m16:38:47.606116 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m16:38:47.606116 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m16:38:47.606116 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m16:38:47.606116 [debug] [MainThread]: Connection 'model.takehome.patients_by_age' was properly closed.
[0m16:38:47.606116 [debug] [MainThread]: Connection 'model.takehome.patients' was properly closed.
[0m16:38:47.606116 [debug] [MainThread]: Connection 'model.takehome.stg_lab_results' was properly closed.
[0m16:38:47.607113 [debug] [MainThread]: Connection 'model.takehome.patients_per_month' was properly closed.
[0m16:38:47.607113 [info ] [MainThread]: 
[0m16:38:47.608112 [info ] [MainThread]: Finished running 4 table models, 10 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m16:38:47.609619 [debug] [MainThread]: Command end result
[0m16:38:47.629485 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m16:38:47.632687 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m16:38:47.637983 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m16:38:47.639490 [info ] [MainThread]: 
[0m16:38:47.639490 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:38:47.640498 [info ] [MainThread]: 
[0m16:38:47.641497 [error] [MainThread]: [31mFailure in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)[0m
[0m16:38:47.642497 [error] [MainThread]:   Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "tr" does not have a column named "componentName"
  
  Candidate bindings: : "unnest"
  
  LINE 15:         tr.componentName                 as component_name,
                   ^
[0m16:38:47.644135 [info ] [MainThread]: 
[0m16:38:47.644135 [info ] [MainThread]:   compiled code at target\compiled\takehome\dbt/models\staging\stg_lab_results.sql
[0m16:38:47.645792 [info ] [MainThread]: 
[0m16:38:47.646801 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=14
[0m16:38:47.648800 [debug] [MainThread]: Command `dbt run` failed at 16:38:47.647803 after 2.11 seconds
[0m16:38:47.648800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F31CEAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F2A8A840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3F2C16060>]}
[0m16:38:47.648800 [debug] [MainThread]: Flushing usage events
[0m16:38:48.397281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:41:15.555262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACBB77E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACBB75730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACBB77530>]}


============================== 16:41:15.559877 | 03e9f65e-b190-4bdf-97aa-2cd7a1e4236b ==============================
[0m16:41:15.559877 [info ] [MainThread]: Running with dbt=1.10.15
[0m16:41:15.559877 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'use_colors': 'True', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m16:41:15.734441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACCD939B0>]}
[0m16:41:15.778417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACBD3BDA0>]}
[0m16:41:15.781329 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m16:41:15.901923 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m16:41:16.055073 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m16:41:16.055073 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\marts\silver\lab_results.sql
[0m16:41:16.055073 [debug] [MainThread]: Partial parsing: deleted file: takehome://dbt/models\staging\lab_results.sql
[0m16:41:16.055073 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\stg_lab_results.sql
[0m16:41:16.345604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACD9A2840>]}
[0m16:41:16.399706 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m16:41:16.401757 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m16:41:16.480672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACD921CD0>]}
[0m16:41:16.480672 [info ] [MainThread]: Found 14 models, 20 data tests, 8 sources, 468 macros
[0m16:41:16.480672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACDA5E9C0>]}
[0m16:41:16.480672 [info ] [MainThread]: 
[0m16:41:16.480672 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:41:16.480672 [info ] [MainThread]: 
[0m16:41:16.480672 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:41:16.480672 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m16:41:16.498247 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m16:41:16.501801 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m16:41:16.541244 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m16:41:16.541244 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m16:41:16.542220 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m16:41:16.542641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:16.542641 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m16:41:16.542641 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m16:41:16.543668 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m16:41:16.543668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:16.543668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:16.579546 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m16:41:16.580556 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m16:41:16.581557 [debug] [ThreadPool]: On list_takehome: Close
[0m16:41:16.581557 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m16:41:16.581557 [debug] [ThreadPool]: On list_takehome: Close
[0m16:41:16.581557 [debug] [ThreadPool]: On list_takehome: Close
[0m16:41:16.581557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m16:41:16.581557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_silver)
[0m16:41:16.581557 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m16:41:16.581557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m16:41:16.581557 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_silver"
"
[0m16:41:16.591318 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:41:16.592316 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m16:41:16.595317 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:41:16.595317 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m16:41:16.597413 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:41:16.597876 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m16:41:16.598196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:16.598196 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m16:41:16.598196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:16.598196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:16.599701 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m16:41:16.600706 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:41:16.600706 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m16:41:16.601707 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:41:16.602819 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:41:16.602819 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m16:41:16.603397 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:41:16.603397 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:41:16.603397 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m16:41:16.603397 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m16:41:16.604422 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:41:16.604422 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:41:16.605426 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:41:16.605426 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:41:16.605426 [debug] [ThreadPool]: On create_takehome_dev_silver: BEGIN
[0m16:41:16.605426 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m16:41:16.606676 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m16:41:16.606676 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:41:16.606676 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m16:41:16.607678 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:41:16.607678 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:41:16.607678 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m16:41:16.607678 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
    
        create schema if not exists "takehome"."dev_silver"
    
[0m16:41:16.608678 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m16:41:16.608678 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:41:16.609679 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m16:41:16.609679 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:41:16.610188 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m16:41:16.610188 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m16:41:16.611190 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m16:41:16.611190 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m16:41:16.612192 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m16:41:16.612192 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:41:16.612192 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m16:41:16.612192 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:41:16.613396 [debug] [ThreadPool]: On create_takehome_dev_silver: Close
[0m16:41:16.615501 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m16:41:16.618511 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m16:41:16.618511 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m16:41:16.620119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:16.621210 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m16:41:16.622145 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m16:41:16.623223 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m16:41:16.623223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:16.624126 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m16:41:16.624126 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m16:41:16.624126 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m16:41:16.624126 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:41:16.625126 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m16:41:16.625126 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m16:41:16.626127 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m16:41:16.628223 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m16:41:16.628551 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m16:41:16.628551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:16.629623 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m16:41:16.629623 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m16:41:16.629623 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m16:41:16.635053 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m16:41:16.635053 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m16:41:16.636594 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m16:41:16.637696 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m16:41:16.638863 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m16:41:16.638863 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m16:41:16.640925 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m16:41:16.640925 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m16:41:16.641877 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m16:41:16.642876 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m16:41:16.642876 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m16:41:16.642876 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m16:41:16.645056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACAFDA090>]}
[0m16:41:16.646063 [debug] [MainThread]: Using duckdb connection "master"
[0m16:41:16.646063 [debug] [MainThread]: On master: BEGIN
[0m16:41:16.646063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:16.647063 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:41:16.647063 [debug] [MainThread]: On master: COMMIT
[0m16:41:16.647063 [debug] [MainThread]: Using duckdb connection "master"
[0m16:41:16.647063 [debug] [MainThread]: On master: COMMIT
[0m16:41:16.648063 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:41:16.648063 [debug] [MainThread]: On master: Close
[0m16:41:16.652575 [debug] [Thread-1 (]: Began running node model.takehome.stg_conditions
[0m16:41:16.652575 [debug] [Thread-2 (]: Began running node model.takehome.stg_documents
[0m16:41:16.653576 [debug] [Thread-3 (]: Began running node model.takehome.stg_lab_results
[0m16:41:16.653576 [debug] [Thread-4 (]: Began running node model.takehome.stg_med_admins
[0m16:41:16.653576 [info ] [Thread-1 (]: 1 of 14 START sql view model dev_staging.stg_conditions ........................ [RUN]
[0m16:41:16.654764 [info ] [Thread-2 (]: 2 of 14 START sql view model dev_staging.stg_documents ......................... [RUN]
[0m16:41:16.654764 [info ] [Thread-3 (]: 3 of 14 START sql view model dev_staging.stg_lab_results ....................... [RUN]
[0m16:41:16.655763 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_conditions'
[0m16:41:16.656973 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.takehome.stg_documents'
[0m16:41:16.655763 [info ] [Thread-4 (]: 4 of 14 START sql view model dev_staging.stg_med_admins ........................ [RUN]
[0m16:41:16.656973 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.stg_lab_results'
[0m16:41:16.657975 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_conditions
[0m16:41:16.657975 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_documents
[0m16:41:16.657975 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.takehome.stg_med_admins'
[0m16:41:16.658971 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_lab_results
[0m16:41:16.663486 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_conditions"
[0m16:41:16.665189 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_documents"
[0m16:41:16.666119 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_med_admins
[0m16:41:16.667447 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_lab_results"
[0m16:41:16.670015 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_med_admins"
[0m16:41:16.672021 [debug] [Thread-1 (]: Began executing node model.takehome.stg_conditions
[0m16:41:16.684801 [debug] [Thread-2 (]: Began executing node model.takehome.stg_documents
[0m16:41:16.686311 [debug] [Thread-3 (]: Began executing node model.takehome.stg_lab_results
[0m16:41:16.701176 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_conditions"
[0m16:41:16.704187 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_documents"
[0m16:41:16.707175 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_lab_results"
[0m16:41:16.708174 [debug] [Thread-4 (]: Began executing node model.takehome.stg_med_admins
[0m16:41:16.708174 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:41:16.710689 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_med_admins"
[0m16:41:16.710689 [debug] [Thread-1 (]: On model.takehome.stg_conditions: BEGIN
[0m16:41:16.710689 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:41:16.710689 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m16:41:16.710689 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: BEGIN
[0m16:41:16.710689 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:41:16.710689 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:41:16.710689 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:41:16.718214 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:41:16.718715 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:41:16.719179 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: BEGIN
[0m16:41:16.719684 [debug] [Thread-2 (]: On model.takehome.stg_documents: BEGIN
[0m16:41:16.719684 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:41:16.720690 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

  
  create view "takehome"."dev_staging"."stg_conditions__dbt_tmp" as (
    select
    id   as condition_id,
    name as condition_name
from "takehome"."raw"."conditions"
  );

[0m16:41:16.721271 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:41:16.721271 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:41:16.722247 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m16:41:16.723339 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    -- lee todos los JSON
    select *
    from read_json_auto('src_data/lab_results/*.json')
),

flattened as (
    select
        testId::bigint           as test_id,
        orderId::bigint          as order_id,
        patientId::bigint        as patient_id,
        cast(resultDate as date) as result_date,
        tr.componentName         as component_name,
        tr.componentRefHi::double  as component_ref_hi,
        tr.componentRefLo::double  as component_ref_lo,
        tr.componentUnits        as component_units,
        tr.resultValue::double   as result_value
    from raw_json
    cross join unnest(testResults) as tr(
        componentName,
        componentRefHi,
        componentRefLo,
        componentUnits,
        resultValue
    )
)

select *
from flattened
  );

[0m16:41:16.723339 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:41:16.724348 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:41:16.724348 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

  
  create view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" as (
    select
    patient_id,
    patient_condition_id,
    medication_id,
    coalesce(date_stopped, date_started) as updated_at,
    date_started,
    date_stopped,
    dosage
from "takehome"."raw"."med_admins"
  );

[0m16:41:16.725348 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:41:16.725348 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:41:16.725348 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:41:16.726347 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m16:41:16.731124 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:41:16.731124 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

  
  create view "takehome"."dev_staging"."stg_documents__dbt_tmp" as (
    select
    document_id,
    patient_id,
    visit_id,
    document_line,
    document_text
from "takehome"."raw"."documents"
  );

[0m16:41:16.731124 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:41:16.731124 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions" rename to "stg_conditions__dbt_backup"
[0m16:41:16.731124 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins" rename to "stg_med_admins__dbt_backup"
[0m16:41:16.731124 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:41:16.736849 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:41:16.739892 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents" rename to "stg_documents__dbt_backup"
[0m16:41:16.739892 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:41:16.743623 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:41:16.744633 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions__dbt_tmp" rename to "stg_conditions"
[0m16:41:16.744633 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m16:41:16.745631 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:41:16.747632 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:41:16.748631 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:41:16.751267 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:41:16.751267 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    -- lee todos los JSON
    select *
    from read_json_auto('src_data/lab_results/*.json')
),

flattened as (
    select
        testId::bigint           as test_id,
        orderId::bigint          as order_id,
        patientId::bigint        as patient_id,
        cast(resultDate as date) as result_date,
        tr.componentName         as component_name,
        tr.componentRefHi::double  as component_ref_hi,
        tr.componentRefLo::double  as component_ref_lo,
        tr.componentUnits        as component_units,
        tr.resultValue::double   as result_value
    from raw_json
    cross join unnest(testResults) as tr(
        componentName,
        componentRefHi,
        componentRefLo,
        componentUnits,
        resultValue
    )
)

select *
from flattened
  );

[0m16:41:16.752262 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" rename to "stg_med_admins"
[0m16:41:16.759811 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m16:41:16.760822 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents__dbt_tmp" rename to "stg_documents"
[0m16:41:16.760822 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m16:41:16.760822 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:41:16.761821 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: ROLLBACK
[0m16:41:16.762755 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:41:16.763123 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m16:41:16.763720 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m16:41:16.765106 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m16:41:16.767106 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m16:41:16.768222 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:41:16.768222 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:41:16.769727 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m16:41:16.769727 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m16:41:16.770735 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:41:16.776747 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m16:41:16.776747 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_conditions__dbt_backup" cascade
    
[0m16:41:16.776747 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:41:16.777732 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m16:41:16.779752 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m16:41:16.781290 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m16:41:16.781290 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

      drop view if exists "takehome"."dev_staging"."stg_documents__dbt_backup" cascade
    
[0m16:41:16.781290 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m16:41:16.781290 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

      drop view if exists "takehome"."dev_staging"."stg_med_admins__dbt_backup" cascade
    
[0m16:41:16.781290 [debug] [Thread-1 (]: On model.takehome.stg_conditions: Close
[0m16:41:16.781290 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:41:16.781290 [debug] [Thread-2 (]: On model.takehome.stg_documents: Close
[0m16:41:16.789611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACED0ADB0>]}
[0m16:41:16.789611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACED08380>]}
[0m16:41:16.790910 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:41:16.789611 [info ] [Thread-2 (]: 2 of 14 OK created sql view model dev_staging.stg_documents .................... [[32mOK[0m in 0.12s]
[0m16:41:16.791919 [info ] [Thread-1 (]: 1 of 14 OK created sql view model dev_staging.stg_conditions ................... [[32mOK[0m in 0.13s]
[0m16:41:16.792945 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: Close
[0m16:41:16.792945 [debug] [Thread-2 (]: Finished running node model.takehome.stg_documents
[0m16:41:16.793936 [debug] [Thread-3 (]: Failed to rollback 'model.takehome.stg_lab_results'
[0m16:41:16.794921 [debug] [Thread-1 (]: Finished running node model.takehome.stg_conditions
[0m16:41:16.794921 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACDCDEE10>]}
[0m16:41:16.795919 [debug] [Thread-2 (]: Began running node model.takehome.stg_medications
[0m16:41:16.795919 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: Close
[0m16:41:16.795919 [debug] [Thread-1 (]: Began running node model.takehome.stg_orders
[0m16:41:16.796915 [info ] [Thread-4 (]: 4 of 14 OK created sql view model dev_staging.stg_med_admins ................... [[32mOK[0m in 0.14s]
[0m16:41:16.796915 [info ] [Thread-2 (]: 5 of 14 START sql view model dev_staging.stg_medications ....................... [RUN]
[0m16:41:16.798916 [debug] [Thread-4 (]: Finished running node model.takehome.stg_med_admins
[0m16:41:16.798916 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_documents, now model.takehome.stg_medications)
[0m16:41:16.798916 [debug] [Thread-4 (]: Began running node model.takehome.stg_patient_conditions
[0m16:41:16.797915 [info ] [Thread-1 (]: 6 of 14 START sql view model dev_staging.stg_orders ............................ [RUN]
[0m16:41:16.799918 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_medications
[0m16:41:16.799918 [info ] [Thread-4 (]: 7 of 14 START sql view model dev_staging.stg_patient_conditions ................ [RUN]
[0m16:41:16.800993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_conditions, now model.takehome.stg_orders)
[0m16:41:16.803010 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_medications"
[0m16:41:16.803010 [debug] [Thread-3 (]: Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "tr" does not have a column named "componentRefHi"
  
  Candidate bindings: : "componentName"
  
  LINE 18:         tr.componentRefHi::double  as component_ref_hi,
                   ^
[0m16:41:16.804247 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_med_admins, now model.takehome.stg_patient_conditions)
[0m16:41:16.804247 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_orders
[0m16:41:16.805602 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACD876840>]}
[0m16:41:16.805602 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_patient_conditions
[0m16:41:16.810127 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_orders"
[0m16:41:16.810127 [debug] [Thread-2 (]: Began executing node model.takehome.stg_medications
[0m16:41:16.814137 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_patient_conditions"
[0m16:41:16.811135 [error] [Thread-3 (]: 3 of 14 ERROR creating sql view model dev_staging.stg_lab_results .............. [[31mERROR[0m in 0.15s]
[0m16:41:16.818149 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_medications"
[0m16:41:16.818149 [debug] [Thread-3 (]: Finished running node model.takehome.stg_lab_results
[0m16:41:16.819661 [debug] [Thread-1 (]: Began executing node model.takehome.stg_orders
[0m16:41:16.820671 [debug] [Thread-4 (]: Began executing node model.takehome.stg_patient_conditions
[0m16:41:16.821670 [debug] [Thread-3 (]: Began running node model.takehome.stg_patients
[0m16:41:16.826670 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_orders"
[0m16:41:16.827673 [debug] [Thread-7 (]: Marking all children of 'model.takehome.stg_lab_results' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "tr" does not have a column named "componentRefHi"
  
  Candidate bindings: : "componentName"
  
  LINE 18:         tr.componentRefHi::double  as component_ref_hi,
                   ^.
[0m16:41:16.831081 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_patient_conditions"
[0m16:41:16.832387 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:41:16.832387 [info ] [Thread-3 (]: 8 of 14 START sql view model dev_staging.stg_patients .......................... [RUN]
[0m16:41:16.834361 [debug] [Thread-2 (]: On model.takehome.stg_medications: BEGIN
[0m16:41:16.835356 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_lab_results, now model.takehome.stg_patients)
[0m16:41:16.835356 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:16.835356 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:41:16.836862 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_patients
[0m16:41:16.837874 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:41:16.837874 [debug] [Thread-1 (]: On model.takehome.stg_orders: BEGIN
[0m16:41:16.841391 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m16:41:16.842391 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m16:41:16.842391 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: BEGIN
[0m16:41:16.843395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:16.843395 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:41:16.844391 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:16.844391 [debug] [Thread-2 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

  
  create view "takehome"."dev_staging"."stg_medications__dbt_tmp" as (
    select
    id   as medication_id,
    name as medication_name
from "takehome"."raw"."medications"
  );

[0m16:41:16.845396 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:41:16.846400 [debug] [Thread-3 (]: Began executing node model.takehome.stg_patients
[0m16:41:16.847391 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:41:16.848396 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:41:16.851956 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m16:41:16.851956 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:41:16.853563 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

  
  create view "takehome"."dev_staging"."stg_orders__dbt_tmp" as (
    select
    id            as order_id,
    patient_id,
    condition_id,
    order_date    as updated_at,
    order_date
from "takehome"."raw"."orders"
  );

[0m16:41:16.853563 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:41:16.857101 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:41:16.858084 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

  
  create view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" as (
    select
    id                     as patient_condition_id,
    patient_id,
    condition_id,
    coalesce(date_ended, date_started) as updated_at,
    date_started,
    date_ended
from "takehome"."raw"."patient_conditions"
  );

[0m16:41:16.858084 [debug] [Thread-2 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications" rename to "stg_medications__dbt_backup"
[0m16:41:16.858084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:41:16.859594 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:41:16.863610 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:41:16.864608 [debug] [Thread-3 (]: On model.takehome.stg_patients: BEGIN
[0m16:41:16.864608 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:41:16.865603 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:41:16.865603 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m16:41:16.865603 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:16.868600 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:41:16.872104 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:41:16.873101 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions" rename to "stg_patient_conditions__dbt_backup"
[0m16:41:16.874099 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:41:16.874099 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m16:41:16.875100 [debug] [Thread-2 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications__dbt_tmp" rename to "stg_medications"
[0m16:41:16.877097 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:41:16.878098 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:41:16.878098 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:41:16.878098 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m16:41:16.879845 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id as patient_id,
    coalesce(
        date_deactivated,
        date_activated,
        date_of_death,
        date_of_birth
    )                                    as updated_at,
    first_name,
    last_name,
    ssn,
    date_of_birth,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_death,
    date_activated,
    date_deactivated
from "takehome"."raw"."patients"
  );

[0m16:41:16.880855 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:41:16.880855 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:41:16.880855 [debug] [Thread-2 (]: On model.takehome.stg_medications: COMMIT
[0m16:41:16.880855 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m16:41:16.880855 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" rename to "stg_patient_conditions"
[0m16:41:16.887057 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m16:41:16.888067 [debug] [Thread-1 (]: On model.takehome.stg_orders: COMMIT
[0m16:41:16.887057 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:41:16.892588 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:41:16.892588 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:41:16.893672 [debug] [Thread-2 (]: On model.takehome.stg_medications: COMMIT
[0m16:41:16.894690 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:41:16.894690 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m16:41:16.895693 [debug] [Thread-1 (]: On model.takehome.stg_orders: COMMIT
[0m16:41:16.897745 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m16:41:16.898695 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:41:16.900196 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:41:16.900196 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:41:16.903040 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m16:41:16.903040 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m16:41:16.906053 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:41:16.907333 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m16:41:16.908338 [debug] [Thread-2 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

      drop view if exists "takehome"."dev_staging"."stg_medications__dbt_backup" cascade
    
[0m16:41:16.908338 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m16:41:16.911859 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m16:41:16.912864 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m16:41:16.913865 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

      drop view if exists "takehome"."dev_staging"."stg_orders__dbt_backup" cascade
    
[0m16:41:16.917883 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m16:41:16.918450 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:41:16.919135 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:41:16.919793 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_patient_conditions__dbt_backup" cascade
    
[0m16:41:16.922080 [debug] [Thread-2 (]: On model.takehome.stg_medications: Close
[0m16:41:16.924398 [debug] [Thread-3 (]: On model.takehome.stg_patients: COMMIT
[0m16:41:16.924973 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m16:41:16.926050 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A80026B40>]}
[0m16:41:16.926626 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:41:16.928214 [debug] [Thread-1 (]: On model.takehome.stg_orders: Close
[0m16:41:16.929888 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:41:16.930981 [debug] [Thread-3 (]: On model.takehome.stg_patients: COMMIT
[0m16:41:16.928759 [info ] [Thread-2 (]: 5 of 14 OK created sql view model dev_staging.stg_medications .................. [[32mOK[0m in 0.13s]
[0m16:41:16.933069 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: Close
[0m16:41:16.933613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A80027A70>]}
[0m16:41:16.935237 [debug] [Thread-2 (]: Finished running node model.takehome.stg_medications
[0m16:41:16.936897 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A80026B10>]}
[0m16:41:16.938060 [debug] [Thread-2 (]: Began running node model.takehome.stg_visits
[0m16:41:16.936387 [info ] [Thread-1 (]: 6 of 14 OK created sql view model dev_staging.stg_orders ....................... [[32mOK[0m in 0.13s]
[0m16:41:16.939141 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m16:41:16.940748 [info ] [Thread-4 (]: 7 of 14 OK created sql view model dev_staging.stg_patient_conditions ........... [[32mOK[0m in 0.13s]
[0m16:41:16.942425 [debug] [Thread-1 (]: Finished running node model.takehome.stg_orders
[0m16:41:16.941890 [info ] [Thread-2 (]: 9 of 14 START sql view model dev_staging.stg_visits ............................ [RUN]
[0m16:41:16.945628 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m16:41:16.946337 [debug] [Thread-4 (]: Finished running node model.takehome.stg_patient_conditions
[0m16:41:16.947560 [debug] [Thread-1 (]: Began running node model.takehome.lab_results
[0m16:41:16.948213 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_medications, now model.takehome.stg_visits)
[0m16:41:16.949368 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

      drop view if exists "takehome"."dev_staging"."stg_patients__dbt_backup" cascade
    
[0m16:41:16.950497 [debug] [Thread-4 (]: Began running node model.takehome.medications_per_month
[0m16:41:16.951803 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_visits
[0m16:41:16.951229 [info ] [Thread-1 (]: 10 of 14 SKIP relation dev_silver.lab_results .................................. [[33mSKIP[0m]
[0m16:41:16.956857 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_visits"
[0m16:41:16.952760 [info ] [Thread-4 (]: 11 of 14 START sql table model dev_silver.medications_per_month ................ [RUN]
[0m16:41:16.957852 [debug] [Thread-1 (]: Finished running node model.takehome.lab_results
[0m16:41:16.958852 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patient_conditions, now model.takehome.medications_per_month)
[0m16:41:16.958852 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m16:41:16.959915 [debug] [Thread-4 (]: Began compiling node model.takehome.medications_per_month
[0m16:41:16.961371 [debug] [Thread-3 (]: On model.takehome.stg_patients: Close
[0m16:41:16.965375 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.medications_per_month"
[0m16:41:16.965375 [debug] [Thread-2 (]: Began executing node model.takehome.stg_visits
[0m16:41:16.966374 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACD875A90>]}
[0m16:41:16.969899 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_visits"
[0m16:41:16.970907 [info ] [Thread-3 (]: 8 of 14 OK created sql view model dev_staging.stg_patients ..................... [[32mOK[0m in 0.13s]
[0m16:41:16.971913 [debug] [Thread-3 (]: Finished running node model.takehome.stg_patients
[0m16:41:16.972908 [debug] [Thread-4 (]: Began executing node model.takehome.medications_per_month
[0m16:41:16.988553 [debug] [Thread-1 (]: Began running node model.takehome.patients
[0m16:41:16.988180 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.medications_per_month"
[0m16:41:16.990869 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:41:16.990869 [debug] [Thread-2 (]: On model.takehome.stg_visits: BEGIN
[0m16:41:16.990869 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:16.988553 [info ] [Thread-1 (]: 12 of 14 START sql table model dev_bronze.patients ............................. [RUN]
[0m16:41:16.991864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_orders, now model.takehome.patients)
[0m16:41:16.992928 [debug] [Thread-1 (]: Began compiling node model.takehome.patients
[0m16:41:16.994877 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.patients"
[0m16:41:16.995867 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m16:41:16.996866 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:41:16.997868 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

  
  create view "takehome"."dev_staging"."stg_visits__dbt_tmp" as (
    select
    id                    as visit_id,
    visit_date            as updated_at,
    patient_condition_id,
    visit_date
from "takehome"."raw"."visits"
  );

[0m16:41:16.998875 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:41:16.998875 [debug] [Thread-1 (]: Began executing node model.takehome.patients
[0m16:41:16.999865 [debug] [Thread-4 (]: On model.takehome.medications_per_month: BEGIN
[0m16:41:17.002961 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.patients"
[0m16:41:17.004193 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m16:41:17.004764 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:17.008537 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:41:17.009433 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits" rename to "stg_visits__dbt_backup"
[0m16:41:17.009953 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m16:41:17.009953 [debug] [Thread-1 (]: On model.takehome.patients: BEGIN
[0m16:41:17.009953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:17.010961 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m16:41:17.011962 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:41:17.011962 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."medications_per_month__dbt_tmp"
  
    as (
      with med_admins as (
    select
        patient_id,
        medication_id,
        date_started
    from "takehome"."dev_staging"."stg_med_admins"
    where date_started is not null
),

meds as (
    select
        medication_id,
        medication_name
    from "takehome"."dev_staging"."stg_medications"
),

med_admins_month as (
    select
        date_trunc('month', date_started) as month,
        medication_id,
        patient_id
    from med_admins
)

select
    m.month,
    med.medication_id,
    med.medication_name,
    count(*)                     as administrations,
    count(distinct m.patient_id) as patients_treated
from med_admins_month m
join meds med
    on m.medication_id = med.medication_id
group by 1,2,3
order by 1,2
    );
  
  
[0m16:41:17.012965 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:41:17.015965 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:41:17.016971 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits__dbt_tmp" rename to "stg_visits"
[0m16:41:17.017963 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m16:41:17.017963 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m16:41:17.018960 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      

with 

pt as ( select * from "takehome"."dev_staging"."stg_patients" )

select
    *
    
from pt

qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m16:41:17.018960 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:41:17.022487 [debug] [Thread-2 (]: On model.takehome.stg_visits: COMMIT
[0m16:41:17.022487 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:41:17.023487 [debug] [Thread-2 (]: On model.takehome.stg_visits: COMMIT
[0m16:41:17.027622 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:41:17.032060 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m16:41:17.033065 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m16:41:17.033065 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

      drop view if exists "takehome"."dev_staging"."stg_visits__dbt_backup" cascade
    
[0m16:41:17.038574 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:41:17.039576 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m16:41:17.040091 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m16:41:17.041198 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m16:41:17.042168 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m16:41:17.043093 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m16:41:17.044091 [debug] [Thread-2 (]: On model.takehome.stg_visits: Close
[0m16:41:17.044091 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A8008FDA0>]}
[0m16:41:17.045090 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:41:17.046091 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m16:41:17.046091 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m16:41:17.045090 [info ] [Thread-2 (]: 9 of 14 OK created sql view model dev_staging.stg_visits ....................... [[32mOK[0m in 0.10s]
[0m16:41:17.047091 [debug] [Thread-2 (]: Finished running node model.takehome.stg_visits
[0m16:41:17.048092 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m16:41:17.049614 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:41:17.049614 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m16:41:17.049614 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:41:17.052632 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m16:41:17.052632 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients" rename to "patients__dbt_backup"
[0m16:41:17.053886 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:41:17.056910 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:41:17.056910 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month" rename to "medications_per_month__dbt_backup"
[0m16:41:17.056910 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:41:17.058884 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m16:41:17.059883 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients__dbt_tmp" rename to "patients"
[0m16:41:17.060388 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:41:17.062410 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:41:17.062410 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month__dbt_tmp" rename to "medications_per_month"
[0m16:41:17.062410 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:41:17.068036 [debug] [Thread-1 (]: On model.takehome.patients: COMMIT
[0m16:41:17.068036 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m16:41:17.069552 [debug] [Thread-1 (]: On model.takehome.patients: COMMIT
[0m16:41:17.069552 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m16:41:17.072580 [debug] [Thread-4 (]: On model.takehome.medications_per_month: COMMIT
[0m16:41:17.072580 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:41:17.073560 [debug] [Thread-4 (]: On model.takehome.medications_per_month: COMMIT
[0m16:41:17.073560 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:41:17.075560 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m16:41:17.075560 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

      drop table if exists "takehome"."dev_bronze"."patients__dbt_backup" cascade
    
[0m16:41:17.076558 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m16:41:17.077676 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m16:41:17.077676 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

      drop table if exists "takehome"."dev_silver"."medications_per_month__dbt_backup" cascade
    
[0m16:41:17.079940 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m16:41:17.082233 [debug] [Thread-1 (]: On model.takehome.patients: Close
[0m16:41:17.082233 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m16:41:17.083232 [debug] [Thread-4 (]: On model.takehome.medications_per_month: Close
[0m16:41:17.083232 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACD86B830>]}
[0m16:41:17.084335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACD9C0260>]}
[0m16:41:17.084335 [info ] [Thread-4 (]: 11 of 14 OK created sql table model dev_silver.medications_per_month ........... [[32mOK[0m in 0.12s]
[0m16:41:17.085233 [debug] [Thread-4 (]: Finished running node model.takehome.medications_per_month
[0m16:41:17.085233 [info ] [Thread-1 (]: 12 of 14 OK created sql table model dev_bronze.patients ........................ [[32mOK[0m in 0.09s]
[0m16:41:17.086257 [debug] [Thread-1 (]: Finished running node model.takehome.patients
[0m16:41:17.087232 [debug] [Thread-3 (]: Began running node model.takehome.patients_by_age
[0m16:41:17.088233 [debug] [Thread-2 (]: Began running node model.takehome.patients_per_month
[0m16:41:17.087232 [info ] [Thread-3 (]: 13 of 14 START sql table model dev_silver.patients_by_age ...................... [RUN]
[0m16:41:17.089737 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patients, now model.takehome.patients_by_age)
[0m16:41:17.088233 [info ] [Thread-2 (]: 14 of 14 START sql table model dev_silver.patients_per_month ................... [RUN]
[0m16:41:17.089737 [debug] [Thread-3 (]: Began compiling node model.takehome.patients_by_age
[0m16:41:17.090743 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_visits, now model.takehome.patients_per_month)
[0m16:41:17.093744 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.patients_by_age"
[0m16:41:17.093744 [debug] [Thread-2 (]: Began compiling node model.takehome.patients_per_month
[0m16:41:17.095745 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.patients_per_month"
[0m16:41:17.096753 [debug] [Thread-3 (]: Began executing node model.takehome.patients_by_age
[0m16:41:17.100252 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.patients_by_age"
[0m16:41:17.101257 [debug] [Thread-2 (]: Began executing node model.takehome.patients_per_month
[0m16:41:17.105562 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.patients_per_month"
[0m16:41:17.105562 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:41:17.105562 [debug] [Thread-3 (]: On model.takehome.patients_by_age: BEGIN
[0m16:41:17.105562 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:17.105562 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:41:17.105562 [debug] [Thread-2 (]: On model.takehome.patients_per_month: BEGIN
[0m16:41:17.105562 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:17.105562 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:41:17.105562 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m16:41:17.105562 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:41:17.109999 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:41:17.109999 [debug] [Thread-3 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_by_age__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_of_birth,
        gender,
        race,
        ethnicity,
        smoker,
        drinks_per_week,
        date_activated,
        date_deactivated,
        date_of_death
    from "takehome"."dev_bronze"."patients"
)

select
    patient_id,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_birth,
    date_activated,
    date_deactivated,
    date_of_death,
    date_diff('year', date_of_birth, current_date) as age,
    case
        when date_of_birth is null then 'unknown'
        when date_diff('year', date_of_birth, current_date) < 18 then '0-17'
        when date_diff('year', date_of_birth, current_date) between 18 and 34 then '18-34'
        when date_diff('year', date_of_birth, current_date) between 35 and 49 then '35-49'
        when date_diff('year', date_of_birth, current_date) between 50 and 64 then '50-64'
        else '65+'
    end as age_group
from patients
    );
  
  
[0m16:41:17.109999 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_per_month__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_activated,
        gender
    from "takehome"."dev_bronze"."patients"
    where date_activated is not null
),

patients_by_month as (
    select
        date_trunc('month', date_activated)                           as month,
        count(*)                                                      as new_patients,
        count(distinct case when gender = 'M' then patient_id end)    as new_patients_male,
        count(distinct case when gender = 'F' then patient_id end)    as new_patients_female
    from patients
    group by 1
)

select *
from patients_by_month
order by month
    );
  
  
[0m16:41:17.117062 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m16:41:17.118067 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:41:17.119575 [debug] [Thread-3 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m16:41:17.121583 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m16:41:17.123590 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:41:17.123590 [debug] [Thread-3 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m16:41:17.123590 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m16:41:17.124589 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:41:17.125590 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m16:41:17.125590 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:41:17.127590 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:41:17.127590 [debug] [Thread-3 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age" rename to "patients_by_age__dbt_backup"
[0m16:41:17.128825 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m16:41:17.131118 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:41:17.132119 [debug] [Thread-3 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age__dbt_tmp" rename to "patients_by_age"
[0m16:41:17.132119 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m16:41:17.133124 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:41:17.134121 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m16:41:17.134121 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m16:41:17.135120 [debug] [Thread-3 (]: On model.takehome.patients_by_age: COMMIT
[0m16:41:17.136197 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:41:17.136197 [debug] [Thread-3 (]: On model.takehome.patients_by_age: COMMIT
[0m16:41:17.136197 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:41:17.138640 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:41:17.138640 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month" rename to "patients_per_month__dbt_backup"
[0m16:41:17.140150 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m16:41:17.142159 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:41:17.142159 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month__dbt_tmp" rename to "patients_per_month"
[0m16:41:17.142159 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m16:41:17.144269 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m16:41:17.144269 [debug] [Thread-3 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

      drop table if exists "takehome"."dev_silver"."patients_by_age__dbt_backup" cascade
    
[0m16:41:17.145157 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:41:17.146269 [debug] [Thread-2 (]: On model.takehome.patients_per_month: COMMIT
[0m16:41:17.146269 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:41:17.147158 [debug] [Thread-2 (]: On model.takehome.patients_per_month: COMMIT
[0m16:41:17.148227 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m16:41:17.150782 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m16:41:17.151782 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

      drop table if exists "takehome"."dev_silver"."patients_per_month__dbt_backup" cascade
    
[0m16:41:17.151782 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m16:41:17.152782 [debug] [Thread-3 (]: On model.takehome.patients_by_age: Close
[0m16:41:17.152782 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACDC26630>]}
[0m16:41:17.153783 [info ] [Thread-3 (]: 13 of 14 OK created sql table model dev_silver.patients_by_age ................. [[32mOK[0m in 0.06s]
[0m16:41:17.154781 [debug] [Thread-3 (]: Finished running node model.takehome.patients_by_age
[0m16:41:17.155822 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m16:41:17.157040 [debug] [Thread-2 (]: On model.takehome.patients_per_month: Close
[0m16:41:17.157040 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03e9f65e-b190-4bdf-97aa-2cd7a1e4236b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A800C4860>]}
[0m16:41:17.158021 [info ] [Thread-2 (]: 14 of 14 OK created sql table model dev_silver.patients_per_month .............. [[32mOK[0m in 0.07s]
[0m16:41:17.158401 [debug] [Thread-2 (]: Finished running node model.takehome.patients_per_month
[0m16:41:17.159956 [debug] [MainThread]: Using duckdb connection "master"
[0m16:41:17.159956 [debug] [MainThread]: On master: BEGIN
[0m16:41:17.159956 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:41:17.160966 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m16:41:17.160966 [debug] [MainThread]: On master: COMMIT
[0m16:41:17.161965 [debug] [MainThread]: Using duckdb connection "master"
[0m16:41:17.161965 [debug] [MainThread]: On master: COMMIT
[0m16:41:17.161965 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:41:17.162967 [debug] [MainThread]: On master: Close
[0m16:41:17.162967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:17.162967 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m16:41:17.162967 [debug] [MainThread]: Connection 'create_takehome_dev_silver' was properly closed.
[0m16:41:17.163963 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m16:41:17.163963 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m16:41:17.163963 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m16:41:17.163963 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m16:41:17.163963 [debug] [MainThread]: Connection 'model.takehome.patients' was properly closed.
[0m16:41:17.163963 [debug] [MainThread]: Connection 'model.takehome.patients_per_month' was properly closed.
[0m16:41:17.164993 [debug] [MainThread]: Connection 'model.takehome.patients_by_age' was properly closed.
[0m16:41:17.164993 [debug] [MainThread]: Connection 'model.takehome.medications_per_month' was properly closed.
[0m16:41:17.164993 [info ] [MainThread]: 
[0m16:41:17.165962 [info ] [MainThread]: Finished running 5 table models, 9 view models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m16:41:17.166991 [debug] [MainThread]: Command end result
[0m16:41:17.182518 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m16:41:17.189607 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m16:41:17.194614 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m16:41:17.194614 [info ] [MainThread]: 
[0m16:41:17.195615 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:41:17.196615 [info ] [MainThread]: 
[0m16:41:17.196615 [error] [MainThread]: [31mFailure in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)[0m
[0m16:41:17.197615 [error] [MainThread]:   Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "tr" does not have a column named "componentRefHi"
  
  Candidate bindings: : "componentName"
  
  LINE 18:         tr.componentRefHi::double  as component_ref_hi,
                   ^
[0m16:41:17.198613 [info ] [MainThread]: 
[0m16:41:17.198613 [info ] [MainThread]:   compiled code at target\compiled\takehome\dbt/models\staging\stg_lab_results.sql
[0m16:41:17.199613 [info ] [MainThread]: 
[0m16:41:17.199613 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=14
[0m16:41:17.201079 [debug] [MainThread]: Command `dbt run` failed at 16:41:17.201079 after 1.81 seconds
[0m16:41:17.201079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AC94A3EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACB774B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACB7770B0>]}
[0m16:41:17.202079 [debug] [MainThread]: Flushing usage events
[0m16:41:18.059777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:06.644180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A97F1F380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A94F15760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A982DDDC0>]}


============================== 20:33:06.660954 | b7cdd67f-c6c8-40b7-82a5-dbd181ad1732 ==============================
[0m20:33:06.660954 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:33:06.660954 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m20:33:07.252888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A99D428D0>]}
[0m20:33:07.301235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A99BFC560>]}
[0m20:33:07.321634 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:33:07.536286 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:33:07.758677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:33:07.758677 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\silver\lab_results.sql
[0m20:33:08.157521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9A7BA7B0>]}
[0m20:33:08.220828 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:33:08.239747 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:33:08.300645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9A798560>]}
[0m20:33:08.300645 [info ] [MainThread]: Found 14 models, 20 data tests, 8 sources, 468 macros
[0m20:33:08.300645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9A7B9FA0>]}
[0m20:33:08.304842 [info ] [MainThread]: 
[0m20:33:08.304842 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:33:08.304842 [info ] [MainThread]: 
[0m20:33:08.304842 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:33:08.309928 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:33:08.373762 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:33:08.382051 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:33:08.564142 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:33:08.564142 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:33:08.566150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:08.566150 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:33:08.566150 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:33:08.566150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:08.566150 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:33:08.566150 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:33:08.566150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:08.656361 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m20:33:08.656989 [debug] [ThreadPool]: On list_takehome: Close
[0m20:33:08.656989 [debug] [ThreadPool]: SQL status: OK in 0.090 seconds
[0m20:33:08.660184 [debug] [ThreadPool]: On list_takehome: Close
[0m20:33:08.660184 [debug] [ThreadPool]: SQL status: OK in 0.093 seconds
[0m20:33:08.662192 [debug] [ThreadPool]: On list_takehome: Close
[0m20:33:08.662192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m20:33:08.662192 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m20:33:08.665954 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:33:08.665954 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:33:08.665954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:08.665954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_silver)
[0m20:33:08.665954 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_silver"
"
[0m20:33:08.665954 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m20:33:08.671173 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:33:08.675189 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:33:08.673181 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m20:33:08.677198 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:33:08.677198 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:33:08.677198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:08.673181 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m20:33:08.675189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:08.677198 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:33:08.677198 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:33:08.677198 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m20:33:08.681630 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:33:08.681630 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m20:33:08.681630 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:33:08.681630 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m20:33:08.681630 [debug] [ThreadPool]: On create_takehome_dev_silver: BEGIN
[0m20:33:08.681630 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:33:08.681630 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:33:08.681630 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:33:08.681630 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:33:08.681630 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:33:08.681630 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m20:33:08.681630 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:33:08.681630 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m20:33:08.681630 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
    
        create schema if not exists "takehome"."dev_silver"
    
[0m20:33:08.681630 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:33:08.690311 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:33:08.690311 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:33:08.690311 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:33:08.690311 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:33:08.690311 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m20:33:08.690311 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m20:33:08.690311 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:33:08.690311 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:33:08.690311 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:33:08.690311 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m20:33:08.690311 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m20:33:08.690311 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:33:08.690311 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:33:08.690311 [debug] [ThreadPool]: On create_takehome_dev_silver: Close
[0m20:33:08.690311 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:33:08.690311 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m20:33:08.690311 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m20:33:08.698150 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m20:33:08.703679 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:33:08.703679 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m20:33:08.703679 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m20:33:08.703679 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:33:08.703679 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m20:33:08.703679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:08.703679 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m20:33:08.703679 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:33:08.703679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:08.703679 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m20:33:08.703679 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:33:08.703679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:08.703679 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:33:08.703679 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:33:08.703679 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m20:33:08.712956 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:33:08.712956 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:33:08.712956 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m20:33:08.714334 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:33:08.714334 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m20:33:08.744634 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m20:33:08.744634 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m20:33:08.744634 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m20:33:08.744634 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m20:33:08.744634 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m20:33:08.744634 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m20:33:08.744634 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m20:33:08.744634 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m20:33:08.744634 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m20:33:08.744634 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m20:33:08.744634 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m20:33:08.744634 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m20:33:08.744634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A98B72E70>]}
[0m20:33:08.744634 [debug] [MainThread]: Using duckdb connection "master"
[0m20:33:08.744634 [debug] [MainThread]: On master: BEGIN
[0m20:33:08.744634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:08.744634 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:33:08.744634 [debug] [MainThread]: On master: COMMIT
[0m20:33:08.744634 [debug] [MainThread]: Using duckdb connection "master"
[0m20:33:08.744634 [debug] [MainThread]: On master: COMMIT
[0m20:33:08.744634 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:33:08.744634 [debug] [MainThread]: On master: Close
[0m20:33:08.760627 [debug] [Thread-1 (]: Began running node model.takehome.stg_conditions
[0m20:33:08.760627 [debug] [Thread-2 (]: Began running node model.takehome.stg_documents
[0m20:33:08.760627 [info ] [Thread-1 (]: 1 of 14 START sql view model dev_staging.stg_conditions ........................ [RUN]
[0m20:33:08.760627 [debug] [Thread-3 (]: Began running node model.takehome.stg_lab_results
[0m20:33:08.760627 [info ] [Thread-2 (]: 2 of 14 START sql view model dev_staging.stg_documents ......................... [RUN]
[0m20:33:08.760627 [debug] [Thread-4 (]: Began running node model.takehome.stg_med_admins
[0m20:33:08.760627 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_conditions'
[0m20:33:08.760627 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.takehome.stg_documents'
[0m20:33:08.760627 [info ] [Thread-3 (]: 3 of 14 START sql view model dev_staging.stg_lab_results ....................... [RUN]
[0m20:33:08.760627 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_conditions
[0m20:33:08.760627 [info ] [Thread-4 (]: 4 of 14 START sql view model dev_staging.stg_med_admins ........................ [RUN]
[0m20:33:08.760627 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_documents
[0m20:33:08.760627 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.stg_lab_results'
[0m20:33:08.781372 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_conditions"
[0m20:33:08.781372 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.takehome.stg_med_admins'
[0m20:33:08.781372 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_documents"
[0m20:33:08.781372 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_lab_results
[0m20:33:08.781372 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_med_admins
[0m20:33:08.781372 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_lab_results"
[0m20:33:08.793767 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_med_admins"
[0m20:33:08.793767 [debug] [Thread-1 (]: Began executing node model.takehome.stg_conditions
[0m20:33:08.793767 [debug] [Thread-3 (]: Began executing node model.takehome.stg_lab_results
[0m20:33:08.793767 [debug] [Thread-2 (]: Began executing node model.takehome.stg_documents
[0m20:33:08.793767 [debug] [Thread-4 (]: Began executing node model.takehome.stg_med_admins
[0m20:33:08.841399 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_documents"
[0m20:33:08.841399 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_lab_results"
[0m20:33:08.841399 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_conditions"
[0m20:33:08.852061 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_med_admins"
[0m20:33:08.852061 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:33:08.857520 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: BEGIN
[0m20:33:08.857520 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:33:08.852061 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:33:08.859533 [debug] [Thread-2 (]: On model.takehome.stg_documents: BEGIN
[0m20:33:08.859533 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:33:08.859533 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:33:08.859533 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:33:08.859533 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    -- lee todos los JSON
    select *
    from read_json_auto('src_data/lab_results/*.json')
),

flattened as (
    select
        testId::bigint           as test_id,
        orderId::bigint          as order_id,
        patientId::bigint        as patient_id,
        cast(resultDate as date) as result_date,
        tr.componentName         as component_name,
        tr.componentRefHi::double  as component_ref_hi,
        tr.componentRefLo::double  as component_ref_lo,
        tr.componentUnits        as component_units,
        tr.resultValue::double   as result_value
    from raw_json
    cross join unnest(testResults) as tr(
        componentName,
        componentRefHi,
        componentRefLo,
        componentUnits,
        resultValue
    )
)

select *
from flattened
  );

[0m20:33:08.859533 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:33:08.859533 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: BEGIN
[0m20:33:08.859533 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:33:08.859533 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:33:08.859533 [debug] [Thread-1 (]: On model.takehome.stg_conditions: BEGIN
[0m20:33:08.859533 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:33:08.859533 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:33:08.859533 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:33:08.859533 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:33:08.859533 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:33:08.859533 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:33:08.859533 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

  
  create view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" as (
    select
    patient_id,
    patient_condition_id,
    medication_id,
    coalesce(date_stopped, date_started) as updated_at,
    date_started,
    date_stopped,
    dosage
from "takehome"."raw"."med_admins"
  );

[0m20:33:08.859533 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

  
  create view "takehome"."dev_staging"."stg_documents__dbt_tmp" as (
    select
    document_id,
    patient_id,
    visit_id,
    document_line,
    document_text
from "takehome"."raw"."documents"
  );

[0m20:33:08.859533 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:33:08.859533 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

  
  create view "takehome"."dev_staging"."stg_conditions__dbt_tmp" as (
    select
    id   as condition_id,
    name as condition_name
from "takehome"."raw"."conditions"
  );

[0m20:33:08.859533 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:33:08.859533 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:33:08.873537 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:33:08.873537 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:33:08.873537 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:33:08.873537 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:33:08.873537 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents" rename to "stg_documents__dbt_backup"
[0m20:33:08.873537 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins" rename to "stg_med_admins__dbt_backup"
[0m20:33:08.873537 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions" rename to "stg_conditions__dbt_backup"
[0m20:33:08.873537 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:33:08.886239 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:33:08.888253 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" rename to "stg_med_admins"
[0m20:33:08.888253 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:33:08.889265 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:33:08.889265 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:33:08.889265 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:33:08.889265 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:33:08.889265 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents__dbt_tmp" rename to "stg_documents"
[0m20:33:08.905093 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m20:33:08.905093 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions__dbt_tmp" rename to "stg_conditions"
[0m20:33:08.907160 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:33:08.907160 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:33:08.907160 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m20:33:08.907160 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m20:33:08.907160 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:33:08.907160 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:33:08.907160 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m20:33:08.907160 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m20:33:08.907160 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:33:08.907160 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:33:08.907160 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:33:08.907160 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m20:33:08.921203 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

      drop view if exists "takehome"."dev_staging"."stg_med_admins__dbt_backup" cascade
    
[0m20:33:08.921732 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m20:33:08.921732 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:33:08.921732 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

      drop view if exists "takehome"."dev_staging"."stg_documents__dbt_backup" cascade
    
[0m20:33:08.921732 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:33:08.921732 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:33:08.921732 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_conditions__dbt_backup" cascade
    
[0m20:33:08.921732 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:33:08.930452 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: Close
[0m20:33:08.930452 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:33:08.930452 [debug] [Thread-2 (]: On model.takehome.stg_documents: Close
[0m20:33:08.930452 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:33:08.930452 [debug] [Thread-1 (]: On model.takehome.stg_conditions: Close
[0m20:33:08.936877 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9A6D2D50>]}
[0m20:33:08.938153 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9A6C32F0>]}
[0m20:33:08.938153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9A6D3380>]}
[0m20:33:08.938153 [info ] [Thread-4 (]: 4 of 14 OK created sql view model dev_staging.stg_med_admins ................... [[32mOK[0m in 0.15s]
[0m20:33:08.938153 [info ] [Thread-2 (]: 2 of 14 OK created sql view model dev_staging.stg_documents .................... [[32mOK[0m in 0.17s]
[0m20:33:08.938153 [debug] [Thread-4 (]: Finished running node model.takehome.stg_med_admins
[0m20:33:08.938153 [debug] [Thread-2 (]: Finished running node model.takehome.stg_documents
[0m20:33:08.938153 [info ] [Thread-1 (]: 1 of 14 OK created sql view model dev_staging.stg_conditions ................... [[32mOK[0m in 0.17s]
[0m20:33:08.938153 [debug] [Thread-4 (]: Began running node model.takehome.stg_medications
[0m20:33:08.938153 [debug] [Thread-2 (]: Began running node model.takehome.stg_orders
[0m20:33:08.938153 [debug] [Thread-1 (]: Finished running node model.takehome.stg_conditions
[0m20:33:08.938153 [info ] [Thread-4 (]: 5 of 14 START sql view model dev_staging.stg_medications ....................... [RUN]
[0m20:33:08.944893 [debug] [Thread-1 (]: Began running node model.takehome.stg_patient_conditions
[0m20:33:08.938153 [info ] [Thread-2 (]: 6 of 14 START sql view model dev_staging.stg_orders ............................ [RUN]
[0m20:33:08.944893 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_med_admins, now model.takehome.stg_medications)
[0m20:33:08.944893 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_documents, now model.takehome.stg_orders)
[0m20:33:08.944893 [info ] [Thread-1 (]: 7 of 14 START sql view model dev_staging.stg_patient_conditions ................ [RUN]
[0m20:33:08.944893 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_medications
[0m20:33:08.944893 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_orders
[0m20:33:08.944893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_conditions, now model.takehome.stg_patient_conditions)
[0m20:33:08.944893 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_medications"
[0m20:33:08.952838 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_patient_conditions
[0m20:33:08.955032 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_orders"
[0m20:33:08.961219 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_patient_conditions"
[0m20:33:08.963272 [debug] [Thread-4 (]: Began executing node model.takehome.stg_medications
[0m20:33:08.965284 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_medications"
[0m20:33:08.968431 [debug] [Thread-2 (]: Began executing node model.takehome.stg_orders
[0m20:33:08.969439 [debug] [Thread-1 (]: Began executing node model.takehome.stg_patient_conditions
[0m20:33:08.973203 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_orders"
[0m20:33:08.978578 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_patient_conditions"
[0m20:33:08.978578 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:33:08.978578 [debug] [Thread-4 (]: On model.takehome.stg_medications: BEGIN
[0m20:33:08.978578 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:08.978578 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:33:08.983489 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:33:08.983489 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:33:08.983489 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:33:08.985483 [debug] [Thread-2 (]: On model.takehome.stg_orders: BEGIN
[0m20:33:08.985483 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: BEGIN
[0m20:33:08.985483 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

  
  create view "takehome"."dev_staging"."stg_medications__dbt_tmp" as (
    select
    id   as medication_id,
    name as medication_name
from "takehome"."raw"."medications"
  );

[0m20:33:08.985483 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:08.985483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:08.985483 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:33:08.985483 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:33:08.985483 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:33:08.985483 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:33:08.993973 [debug] [Thread-2 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

  
  create view "takehome"."dev_staging"."stg_orders__dbt_tmp" as (
    select
    id            as order_id,
    patient_id,
    condition_id,
    order_date    as updated_at,
    order_date
from "takehome"."raw"."orders"
  );

[0m20:33:08.993973 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:33:08.993973 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:33:08.993973 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications" rename to "stg_medications__dbt_backup"
[0m20:33:08.993973 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

  
  create view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" as (
    select
    id                     as patient_condition_id,
    patient_id,
    condition_id,
    coalesce(date_ended, date_started) as updated_at,
    date_started,
    date_ended
from "takehome"."raw"."patient_conditions"
  );

[0m20:33:08.993973 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:33:08.993973 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:33:09.001881 [debug] [Thread-2 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:33:09.002450 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:33:09.002450 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:33:09.002450 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:33:09.002450 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:33:09.002450 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications__dbt_tmp" rename to "stg_medications"
[0m20:33:09.002450 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:33:09.010862 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:33:09.010862 [debug] [Thread-2 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:33:09.010862 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions" rename to "stg_patient_conditions__dbt_backup"
[0m20:33:09.010862 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:33:09.010862 [debug] [Thread-4 (]: On model.takehome.stg_medications: COMMIT
[0m20:33:09.010862 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:33:09.010862 [debug] [Thread-4 (]: On model.takehome.stg_medications: COMMIT
[0m20:33:09.018457 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:33:09.018457 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:33:09.019811 [debug] [Thread-2 (]: On model.takehome.stg_orders: COMMIT
[0m20:33:09.019811 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:33:09.019811 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:33:09.019811 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:33:09.019811 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" rename to "stg_patient_conditions"
[0m20:33:09.027558 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:33:09.027558 [debug] [Thread-2 (]: On model.takehome.stg_orders: COMMIT
[0m20:33:09.027558 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

      drop view if exists "takehome"."dev_staging"."stg_medications__dbt_backup" cascade
    
[0m20:33:09.027558 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:33:09.027558 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m20:33:09.027558 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:33:09.027558 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m20:33:09.027558 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:33:09.035962 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:33:09.035962 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m20:33:09.035962 [debug] [Thread-2 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

      drop view if exists "takehome"."dev_staging"."stg_orders__dbt_backup" cascade
    
[0m20:33:09.035962 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:33:09.035962 [debug] [Thread-4 (]: On model.takehome.stg_medications: Close
[0m20:33:09.035962 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:33:09.035962 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9BB87DA0>]}
[0m20:33:09.043229 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_patient_conditions__dbt_backup" cascade
    
[0m20:33:09.044340 [info ] [Thread-4 (]: 5 of 14 OK created sql view model dev_staging.stg_medications .................. [[32mOK[0m in 0.09s]
[0m20:33:09.044812 [debug] [Thread-4 (]: Finished running node model.takehome.stg_medications
[0m20:33:09.044812 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:33:09.044812 [debug] [Thread-4 (]: Began running node model.takehome.stg_patients
[0m20:33:09.044812 [debug] [Thread-2 (]: On model.takehome.stg_orders: Close
[0m20:33:09.044812 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9BB872C0>]}
[0m20:33:09.044812 [info ] [Thread-4 (]: 8 of 14 START sql view model dev_staging.stg_patients .......................... [RUN]
[0m20:33:09.044812 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:33:09.044812 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_medications, now model.takehome.stg_patients)
[0m20:33:09.044812 [info ] [Thread-2 (]: 6 of 14 OK created sql view model dev_staging.stg_orders ....................... [[32mOK[0m in 0.10s]
[0m20:33:09.053325 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: Close
[0m20:33:09.053325 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_patients
[0m20:33:09.055730 [debug] [Thread-2 (]: Finished running node model.takehome.stg_orders
[0m20:33:09.055730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9BB93F80>]}
[0m20:33:09.059993 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m20:33:09.061752 [debug] [Thread-2 (]: Began running node model.takehome.stg_visits
[0m20:33:09.061752 [info ] [Thread-1 (]: 7 of 14 OK created sql view model dev_staging.stg_patient_conditions ........... [[32mOK[0m in 0.11s]
[0m20:33:09.061752 [info ] [Thread-2 (]: 9 of 14 START sql view model dev_staging.stg_visits ............................ [RUN]
[0m20:33:09.065687 [debug] [Thread-1 (]: Finished running node model.takehome.stg_patient_conditions
[0m20:33:09.065687 [debug] [Thread-4 (]: Began executing node model.takehome.stg_patients
[0m20:33:09.068347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_orders, now model.takehome.stg_visits)
[0m20:33:09.068347 [debug] [Thread-1 (]: Began running node model.takehome.medications_per_month
[0m20:33:09.071852 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m20:33:09.071852 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_visits
[0m20:33:09.071852 [info ] [Thread-1 (]: 10 of 14 START sql table model dev_silver.medications_per_month ................ [RUN]
[0m20:33:09.076723 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_visits"
[0m20:33:09.076723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patient_conditions, now model.takehome.medications_per_month)
[0m20:33:09.076723 [debug] [Thread-1 (]: Began compiling node model.takehome.medications_per_month
[0m20:33:09.085010 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:33:09.086704 [debug] [Thread-4 (]: On model.takehome.stg_patients: BEGIN
[0m20:33:09.086704 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:09.086704 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.medications_per_month"
[0m20:33:09.086704 [debug] [Thread-2 (]: Began executing node model.takehome.stg_visits
[0m20:33:09.086704 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:33:09.093547 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:33:09.093547 [debug] [Thread-4 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id as patient_id,
    coalesce(
        date_deactivated,
        date_activated,
        date_of_death,
        date_of_birth
    )                                    as updated_at,
    first_name,
    last_name,
    ssn,
    date_of_birth,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_death,
    date_activated,
    date_deactivated
from "takehome"."raw"."patients"
  );

[0m20:33:09.093547 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_visits"
[0m20:33:09.096441 [debug] [Thread-1 (]: Began executing node model.takehome.medications_per_month
[0m20:33:09.110058 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.medications_per_month"
[0m20:33:09.110058 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m20:33:09.118681 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:33:09.118681 [debug] [Thread-4 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:33:09.118681 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:33:09.118681 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:09.118681 [debug] [Thread-2 (]: On model.takehome.stg_visits: BEGIN
[0m20:33:09.118681 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:33:09.118681 [debug] [Thread-1 (]: On model.takehome.medications_per_month: BEGIN
[0m20:33:09.118681 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:09.126333 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:33:09.126333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:09.126333 [debug] [Thread-4 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:33:09.126333 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:33:09.126333 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:33:09.126333 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:33:09.126333 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:09.126333 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:33:09.126333 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

  
  create view "takehome"."dev_staging"."stg_visits__dbt_tmp" as (
    select
    id                    as visit_id,
    visit_date            as updated_at,
    patient_condition_id,
    visit_date
from "takehome"."raw"."visits"
  );

[0m20:33:09.126333 [debug] [Thread-1 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."medications_per_month__dbt_tmp"
  
    as (
      with med_admins as (
    select
        patient_id,
        medication_id,
        date_started
    from "takehome"."dev_staging"."stg_med_admins"
    where date_started is not null
),

meds as (
    select
        medication_id,
        medication_name
    from "takehome"."dev_staging"."stg_medications"
),

med_admins_month as (
    select
        date_trunc('month', date_started) as month,
        medication_id,
        patient_id
    from med_admins
)

select
    m.month,
    med.medication_id,
    med.medication_name,
    count(*)                     as administrations,
    count(distinct m.patient_id) as patients_treated
from med_admins_month m
join meds med
    on m.medication_id = med.medication_id
group by 1,2,3
order by 1,2
    );
  
  
[0m20:33:09.126333 [debug] [Thread-4 (]: On model.takehome.stg_patients: COMMIT
[0m20:33:09.126333 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:33:09.134416 [debug] [Thread-4 (]: On model.takehome.stg_patients: COMMIT
[0m20:33:09.134416 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:33:09.134416 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:33:09.134416 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits" rename to "stg_visits__dbt_backup"
[0m20:33:09.134416 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:33:09.134416 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:33:09.134416 [debug] [Thread-4 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

      drop view if exists "takehome"."dev_staging"."stg_patients__dbt_backup" cascade
    
[0m20:33:09.134416 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:33:09.134416 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:33:09.134416 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:33:09.134416 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits__dbt_tmp" rename to "stg_visits"
[0m20:33:09.134416 [debug] [Thread-4 (]: On model.takehome.stg_patients: Close
[0m20:33:09.134416 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9BADFBC0>]}
[0m20:33:09.134416 [info ] [Thread-4 (]: 8 of 14 OK created sql view model dev_staging.stg_patients ..................... [[32mOK[0m in 0.09s]
[0m20:33:09.134416 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:33:09.134416 [debug] [Thread-4 (]: Finished running node model.takehome.stg_patients
[0m20:33:09.150469 [debug] [Thread-2 (]: On model.takehome.stg_visits: COMMIT
[0m20:33:09.150469 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:33:09.150469 [debug] [Thread-2 (]: On model.takehome.stg_visits: COMMIT
[0m20:33:09.150469 [debug] [Thread-4 (]: Began running node model.takehome.patients
[0m20:33:09.150469 [info ] [Thread-4 (]: 11 of 14 START sql table model dev_bronze.patients ............................. [RUN]
[0m20:33:09.150469 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patients, now model.takehome.patients)
[0m20:33:09.150469 [debug] [Thread-4 (]: Began compiling node model.takehome.patients
[0m20:33:09.157188 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.patients"
[0m20:33:09.157188 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:33:09.161724 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:33:09.161724 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

      drop view if exists "takehome"."dev_staging"."stg_visits__dbt_backup" cascade
    
[0m20:33:09.161724 [debug] [Thread-4 (]: Began executing node model.takehome.patients
[0m20:33:09.173399 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.patients"
[0m20:33:09.173399 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m20:33:09.177773 [debug] [Thread-2 (]: On model.takehome.stg_visits: Close
[0m20:33:09.178079 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9BC03350>]}
[0m20:33:09.178079 [info ] [Thread-2 (]: 9 of 14 OK created sql view model dev_staging.stg_visits ....................... [[32mOK[0m in 0.11s]
[0m20:33:09.178079 [debug] [Thread-2 (]: Finished running node model.takehome.stg_visits
[0m20:33:09.178079 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:09.178079 [debug] [Thread-4 (]: On model.takehome.patients: BEGIN
[0m20:33:09.178079 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:09.178079 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:33:09.185209 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:09.185510 [debug] [Thread-4 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      

with 

pt as ( select * from "takehome"."dev_staging"."stg_patients" )

select
    *
    
from pt

qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m20:33:09.185510 [debug] [Thread-1 (]: SQL status: OK in 0.054 seconds
[0m20:33:09.192478 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:09.193486 [debug] [Thread-1 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m20:33:09.195150 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:33:09.195150 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:09.199231 [debug] [Thread-1 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m20:33:09.203848 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:33:09.207513 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:09.210263 [debug] [Thread-1 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month" rename to "medications_per_month__dbt_backup"
[0m20:33:09.211701 [debug] [Thread-4 (]: SQL status: OK in 0.025 seconds
[0m20:33:09.211701 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:09.211701 [debug] [Thread-4 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m20:33:09.211701 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:33:09.217141 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:09.217141 [debug] [Thread-1 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month__dbt_tmp" rename to "medications_per_month"
[0m20:33:09.218410 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:33:09.218410 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:09.218410 [debug] [Thread-4 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m20:33:09.218410 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:33:09.226550 [debug] [Thread-1 (]: On model.takehome.medications_per_month: COMMIT
[0m20:33:09.227331 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:33:09.227331 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:09.227331 [debug] [Thread-1 (]: On model.takehome.medications_per_month: COMMIT
[0m20:33:09.227331 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:09.227331 [debug] [Thread-4 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients" rename to "patients__dbt_backup"
[0m20:33:09.227331 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:33:09.234624 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:09.234624 [debug] [Thread-4 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients__dbt_tmp" rename to "patients"
[0m20:33:09.234624 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:33:09.239095 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:09.239095 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:33:09.239095 [debug] [Thread-1 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

      drop table if exists "takehome"."dev_silver"."medications_per_month__dbt_backup" cascade
    
[0m20:33:09.239095 [debug] [Thread-4 (]: On model.takehome.patients: COMMIT
[0m20:33:09.242662 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:09.242662 [debug] [Thread-4 (]: On model.takehome.patients: COMMIT
[0m20:33:09.242662 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:33:09.242662 [debug] [Thread-1 (]: On model.takehome.medications_per_month: Close
[0m20:33:09.242662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9BC08D70>]}
[0m20:33:09.242662 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:33:09.242662 [info ] [Thread-1 (]: 10 of 14 OK created sql table model dev_silver.medications_per_month ........... [[32mOK[0m in 0.17s]
[0m20:33:09.251214 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:09.251214 [debug] [Thread-1 (]: Finished running node model.takehome.medications_per_month
[0m20:33:09.251214 [debug] [Thread-4 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

      drop table if exists "takehome"."dev_bronze"."patients__dbt_backup" cascade
    
[0m20:33:09.251214 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:33:09.251214 [debug] [Thread-4 (]: On model.takehome.patients: Close
[0m20:33:09.256299 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9BC44D40>]}
[0m20:33:09.256299 [info ] [Thread-4 (]: 11 of 14 OK created sql table model dev_bronze.patients ........................ [[32mOK[0m in 0.11s]
[0m20:33:09.256299 [debug] [Thread-4 (]: Finished running node model.takehome.patients
[0m20:33:09.259090 [debug] [Thread-2 (]: Began running node model.takehome.patients_by_age
[0m20:33:09.260294 [debug] [Thread-1 (]: Began running node model.takehome.patients_per_month
[0m20:33:09.259090 [info ] [Thread-2 (]: 12 of 14 START sql table model dev_silver.patients_by_age ...................... [RUN]
[0m20:33:09.261408 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_visits, now model.takehome.patients_by_age)
[0m20:33:09.261408 [info ] [Thread-1 (]: 13 of 14 START sql table model dev_silver.patients_per_month ................... [RUN]
[0m20:33:09.261408 [debug] [Thread-2 (]: Began compiling node model.takehome.patients_by_age
[0m20:33:09.263772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.medications_per_month, now model.takehome.patients_per_month)
[0m20:33:09.263772 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.patients_by_age"
[0m20:33:09.268512 [debug] [Thread-1 (]: Began compiling node model.takehome.patients_per_month
[0m20:33:09.268949 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.patients_per_month"
[0m20:33:09.273152 [debug] [Thread-2 (]: Began executing node model.takehome.patients_by_age
[0m20:33:09.276757 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.patients_by_age"
[0m20:33:09.276757 [debug] [Thread-1 (]: Began executing node model.takehome.patients_per_month
[0m20:33:09.282795 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.patients_per_month"
[0m20:33:09.285218 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:09.285218 [debug] [Thread-2 (]: On model.takehome.patients_by_age: BEGIN
[0m20:33:09.287081 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:09.287081 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:09.287081 [debug] [Thread-1 (]: On model.takehome.patients_per_month: BEGIN
[0m20:33:09.289092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:09.289092 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:33:09.291038 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:33:09.291038 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:09.291038 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:09.293407 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_by_age__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_of_birth,
        gender,
        race,
        ethnicity,
        smoker,
        drinks_per_week,
        date_activated,
        date_deactivated,
        date_of_death
    from "takehome"."dev_bronze"."patients"
)

select
    patient_id,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_birth,
    date_activated,
    date_deactivated,
    date_of_death,
    date_diff('year', date_of_birth, current_date) as age,
    case
        when date_of_birth is null then 'unknown'
        when date_diff('year', date_of_birth, current_date) < 18 then '0-17'
        when date_diff('year', date_of_birth, current_date) between 18 and 34 then '18-34'
        when date_diff('year', date_of_birth, current_date) between 35 and 49 then '35-49'
        when date_diff('year', date_of_birth, current_date) between 50 and 64 then '50-64'
        else '65+'
    end as age_group
from patients
    );
  
  
[0m20:33:09.293407 [debug] [Thread-1 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_per_month__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_activated,
        gender
    from "takehome"."dev_bronze"."patients"
    where date_activated is not null
),

patients_by_month as (
    select
        date_trunc('month', date_activated)                           as month,
        count(*)                                                      as new_patients,
        count(distinct case when gender = 'M' then patient_id end)    as new_patients_male,
        count(distinct case when gender = 'F' then patient_id end)    as new_patients_female
    from patients
    group by 1
)

select *
from patients_by_month
order by month
    );
  
  
[0m20:33:09.301715 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:33:09.307176 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:09.307176 [debug] [Thread-1 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m20:33:09.308969 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:33:09.310353 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:09.310353 [debug] [Thread-1 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m20:33:09.310353 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m20:33:09.310353 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:09.310353 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:33:09.310353 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m20:33:09.316261 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:09.316261 [debug] [Thread-1 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month" rename to "patients_per_month__dbt_backup"
[0m20:33:09.317998 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:33:09.320006 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:09.320006 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:33:09.320006 [debug] [Thread-1 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month__dbt_tmp" rename to "patients_per_month"
[0m20:33:09.320006 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:09.320006 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m20:33:09.320006 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:33:09.320006 [debug] [Thread-1 (]: On model.takehome.patients_per_month: COMMIT
[0m20:33:09.320006 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:09.320006 [debug] [Thread-1 (]: On model.takehome.patients_per_month: COMMIT
[0m20:33:09.320006 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:33:09.320006 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:09.320006 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age" rename to "patients_by_age__dbt_backup"
[0m20:33:09.320006 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:33:09.320006 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:09.333720 [debug] [Thread-1 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

      drop table if exists "takehome"."dev_silver"."patients_per_month__dbt_backup" cascade
    
[0m20:33:09.333720 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:33:09.336639 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:09.336639 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age__dbt_tmp" rename to "patients_by_age"
[0m20:33:09.338647 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:33:09.338647 [debug] [Thread-2 (]: On model.takehome.patients_by_age: COMMIT
[0m20:33:09.338647 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:33:09.338647 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:09.338647 [debug] [Thread-1 (]: On model.takehome.patients_per_month: Close
[0m20:33:09.338647 [debug] [Thread-2 (]: On model.takehome.patients_by_age: COMMIT
[0m20:33:09.338647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9BBC07A0>]}
[0m20:33:09.338647 [info ] [Thread-1 (]: 13 of 14 OK created sql table model dev_silver.patients_per_month .............. [[32mOK[0m in 0.07s]
[0m20:33:09.338647 [debug] [Thread-1 (]: Finished running node model.takehome.patients_per_month
[0m20:33:09.338647 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:33:09.338647 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:09.338647 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

      drop table if exists "takehome"."dev_silver"."patients_by_age__dbt_backup" cascade
    
[0m20:33:09.351121 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:33:09.351121 [debug] [Thread-2 (]: On model.takehome.patients_by_age: Close
[0m20:33:09.351121 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9BADFFB0>]}
[0m20:33:09.351121 [info ] [Thread-2 (]: 12 of 14 OK created sql table model dev_silver.patients_by_age ................. [[32mOK[0m in 0.09s]
[0m20:33:09.351121 [debug] [Thread-2 (]: Finished running node model.takehome.patients_by_age
[0m20:33:09.493278 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    -- lee todos los JSON
    select *
    from read_json_auto('src_data/lab_results/*.json')
),

flattened as (
    select
        testId::bigint           as test_id,
        orderId::bigint          as order_id,
        patientId::bigint        as patient_id,
        cast(resultDate as date) as result_date,
        tr.componentName         as component_name,
        tr.componentRefHi::double  as component_ref_hi,
        tr.componentRefLo::double  as component_ref_lo,
        tr.componentUnits        as component_units,
        tr.resultValue::double   as result_value
    from raw_json
    cross join unnest(testResults) as tr(
        componentName,
        componentRefHi,
        componentRefLo,
        componentUnits,
        resultValue
    )
)

select *
from flattened
  );

[0m20:33:09.493278 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m20:33:09.493278 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: ROLLBACK
[0m20:33:09.505982 [debug] [Thread-3 (]: Failed to rollback 'model.takehome.stg_lab_results'
[0m20:33:09.509995 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: Close
[0m20:33:09.515087 [debug] [Thread-3 (]: Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "tr" does not have a column named "componentRefHi"
  
  Candidate bindings: : "componentName"
  
  LINE 18:         tr.componentRefHi::double  as component_ref_hi,
                   ^
[0m20:33:09.515087 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7cdd67f-c6c8-40b7-82a5-dbd181ad1732', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9BC08E30>]}
[0m20:33:09.515087 [error] [Thread-3 (]: 3 of 14 ERROR creating sql view model dev_staging.stg_lab_results .............. [[31mERROR[0m in 0.75s]
[0m20:33:09.518265 [debug] [Thread-3 (]: Finished running node model.takehome.stg_lab_results
[0m20:33:09.518265 [debug] [Thread-7 (]: Marking all children of 'model.takehome.stg_lab_results' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "tr" does not have a column named "componentRefHi"
  
  Candidate bindings: : "componentName"
  
  LINE 18:         tr.componentRefHi::double  as component_ref_hi,
                   ^.
[0m20:33:09.518265 [debug] [Thread-4 (]: Began running node model.takehome.lab_results
[0m20:33:09.522454 [info ] [Thread-4 (]: 14 of 14 SKIP relation dev_silver.lab_results .................................. [[33mSKIP[0m]
[0m20:33:09.523243 [debug] [Thread-4 (]: Finished running node model.takehome.lab_results
[0m20:33:09.526514 [debug] [MainThread]: Using duckdb connection "master"
[0m20:33:09.528070 [debug] [MainThread]: On master: BEGIN
[0m20:33:09.529279 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:09.529279 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:33:09.531293 [debug] [MainThread]: On master: COMMIT
[0m20:33:09.531293 [debug] [MainThread]: Using duckdb connection "master"
[0m20:33:09.531293 [debug] [MainThread]: On master: COMMIT
[0m20:33:09.531293 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:33:09.533303 [debug] [MainThread]: On master: Close
[0m20:33:09.533303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:09.533303 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m20:33:09.533303 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m20:33:09.534929 [debug] [MainThread]: Connection 'create_takehome_dev_silver' was properly closed.
[0m20:33:09.534929 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m20:33:09.534929 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m20:33:09.536938 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m20:33:09.536938 [debug] [MainThread]: Connection 'model.takehome.patients_per_month' was properly closed.
[0m20:33:09.536938 [debug] [MainThread]: Connection 'model.takehome.patients_by_age' was properly closed.
[0m20:33:09.536938 [debug] [MainThread]: Connection 'model.takehome.stg_lab_results' was properly closed.
[0m20:33:09.536938 [debug] [MainThread]: Connection 'model.takehome.patients' was properly closed.
[0m20:33:09.536938 [info ] [MainThread]: 
[0m20:33:09.538950 [info ] [MainThread]: Finished running 5 table models, 9 view models in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m20:33:09.540964 [debug] [MainThread]: Command end result
[0m20:33:09.581816 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:33:09.587093 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:33:09.602625 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m20:33:09.602625 [info ] [MainThread]: 
[0m20:33:09.606648 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:33:09.607217 [info ] [MainThread]: 
[0m20:33:09.607217 [error] [MainThread]: [31mFailure in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)[0m
[0m20:33:09.610093 [error] [MainThread]:   Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "tr" does not have a column named "componentRefHi"
  
  Candidate bindings: : "componentName"
  
  LINE 18:         tr.componentRefHi::double  as component_ref_hi,
                   ^
[0m20:33:09.610093 [info ] [MainThread]: 
[0m20:33:09.612160 [info ] [MainThread]:   compiled code at target\compiled\takehome\dbt/models\staging\stg_lab_results.sql
[0m20:33:09.612160 [info ] [MainThread]: 
[0m20:33:09.612160 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=14
[0m20:33:09.616215 [debug] [MainThread]: Command `dbt run` failed at 20:33:09.612160 after 3.19 seconds
[0m20:33:09.616215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A98B87080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A98B86EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A98B875C0>]}
[0m20:33:09.617956 [debug] [MainThread]: Flushing usage events
[0m20:33:17.697589 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:39.937805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2DC795760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2DF6A71D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2DF6A4C80>]}


============================== 20:33:39.937805 | 4ac91a6c-1097-4de2-add8-67553b48a040 ==============================
[0m20:33:39.937805 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:33:39.937805 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m20:33:40.167588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E0CC88F0>]}
[0m20:33:40.240212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2DC7E18B0>]}
[0m20:33:40.240212 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:33:40.395811 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:33:40.547768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:33:40.547768 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:33:40.595596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E12AE720>]}
[0m20:33:40.686238 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:33:40.688245 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:33:40.721797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E16D0B90>]}
[0m20:33:40.721797 [info ] [MainThread]: Found 14 models, 20 data tests, 8 sources, 468 macros
[0m20:33:40.721797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E1235850>]}
[0m20:33:40.721797 [info ] [MainThread]: 
[0m20:33:40.721797 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:33:40.721797 [info ] [MainThread]: 
[0m20:33:40.721797 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:33:40.731956 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:33:40.739272 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:33:40.748716 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:33:40.794562 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:33:40.794562 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:33:40.794562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:40.794562 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:33:40.794562 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:33:40.794562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:40.794562 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:33:40.794562 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:33:40.802970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:40.834876 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m20:33:40.834876 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m20:33:40.851009 [debug] [ThreadPool]: On list_takehome: Close
[0m20:33:40.851009 [debug] [ThreadPool]: On list_takehome: Close
[0m20:33:40.851009 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m20:33:40.851009 [debug] [ThreadPool]: On list_takehome: Close
[0m20:33:40.851009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_silver)
[0m20:33:40.851009 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_silver"
"
[0m20:33:40.851009 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:33:40.851009 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:33:40.851009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:40.851009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m20:33:40.851009 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m20:33:40.851009 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m20:33:40.851009 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:33:40.851009 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:33:40.851009 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m20:33:40.851009 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:33:40.866782 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:33:40.866782 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:33:40.866782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:40.866782 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:33:40.866782 [debug] [ThreadPool]: On create_takehome_dev_silver: BEGIN
[0m20:33:40.866782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:40.866782 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:33:40.866782 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:33:40.866782 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:33:40.866782 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m20:33:40.866782 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:33:40.866782 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:33:40.866782 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:33:40.866782 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m20:33:40.866782 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:33:40.866782 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
    
        create schema if not exists "takehome"."dev_silver"
    
[0m20:33:40.866782 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:33:40.866782 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:33:40.866782 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m20:33:40.866782 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:33:40.866782 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:33:40.866782 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:33:40.866782 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m20:33:40.866782 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:33:40.866782 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:33:40.866782 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:33:40.882862 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m20:33:40.882862 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:33:40.884305 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:33:40.884305 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m20:33:40.885761 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:33:40.885761 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m20:33:40.886509 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:33:40.886872 [debug] [ThreadPool]: On create_takehome_dev_silver: Close
[0m20:33:40.886872 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m20:33:40.886872 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:33:40.886872 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m20:33:40.886872 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:33:40.886872 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m20:33:40.886872 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m20:33:40.894894 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:33:40.894894 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m20:33:40.894894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:40.894894 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m20:33:40.898670 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:33:40.898670 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m20:33:40.898670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:40.898670 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m20:33:40.898670 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:33:40.902733 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m20:33:40.902733 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m20:33:40.902733 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:33:40.904263 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:33:40.904794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:40.905343 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:33:40.905890 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m20:33:40.905890 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m20:33:40.905890 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:33:40.905890 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:33:40.905890 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m20:33:40.922809 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:33:40.922809 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:33:40.922809 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:33:40.922809 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m20:33:40.922809 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m20:33:40.922809 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m20:33:40.929149 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m20:33:40.929149 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m20:33:40.929149 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m20:33:40.929149 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m20:33:40.929149 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m20:33:40.929149 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m20:33:40.936938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2DF7EF290>]}
[0m20:33:40.936938 [debug] [MainThread]: Using duckdb connection "master"
[0m20:33:40.936938 [debug] [MainThread]: On master: BEGIN
[0m20:33:40.936938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:40.938926 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:33:40.938926 [debug] [MainThread]: On master: COMMIT
[0m20:33:40.938926 [debug] [MainThread]: Using duckdb connection "master"
[0m20:33:40.938926 [debug] [MainThread]: On master: COMMIT
[0m20:33:40.938926 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:33:40.938926 [debug] [MainThread]: On master: Close
[0m20:33:40.944226 [debug] [Thread-1 (]: Began running node model.takehome.stg_conditions
[0m20:33:40.944226 [debug] [Thread-2 (]: Began running node model.takehome.stg_documents
[0m20:33:40.944226 [info ] [Thread-1 (]: 1 of 14 START sql view model dev_staging.stg_conditions ........................ [RUN]
[0m20:33:40.944226 [debug] [Thread-3 (]: Began running node model.takehome.stg_lab_results
[0m20:33:40.944226 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_conditions'
[0m20:33:40.944226 [debug] [Thread-4 (]: Began running node model.takehome.stg_med_admins
[0m20:33:40.951811 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_conditions
[0m20:33:40.944226 [info ] [Thread-2 (]: 2 of 14 START sql view model dev_staging.stg_documents ......................... [RUN]
[0m20:33:40.951811 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_conditions"
[0m20:33:40.951811 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.takehome.stg_documents'
[0m20:33:40.944226 [info ] [Thread-3 (]: 3 of 14 START sql view model dev_staging.stg_lab_results ....................... [RUN]
[0m20:33:40.951811 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_documents
[0m20:33:40.951811 [info ] [Thread-4 (]: 4 of 14 START sql view model dev_staging.stg_med_admins ........................ [RUN]
[0m20:33:40.951811 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.stg_lab_results'
[0m20:33:40.951811 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_documents"
[0m20:33:40.951811 [debug] [Thread-1 (]: Began executing node model.takehome.stg_conditions
[0m20:33:40.951811 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.takehome.stg_med_admins'
[0m20:33:40.951811 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_lab_results
[0m20:33:40.985264 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_med_admins
[0m20:33:40.994729 [debug] [Thread-2 (]: Began executing node model.takehome.stg_documents
[0m20:33:40.994729 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_lab_results"
[0m20:33:41.003587 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_conditions"
[0m20:33:41.003587 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_med_admins"
[0m20:33:41.010547 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_documents"
[0m20:33:41.010547 [debug] [Thread-3 (]: Began executing node model.takehome.stg_lab_results
[0m20:33:41.016026 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_lab_results"
[0m20:33:41.016026 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:33:41.018217 [debug] [Thread-1 (]: On model.takehome.stg_conditions: BEGIN
[0m20:33:41.018217 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:33:41.018217 [debug] [Thread-4 (]: Began executing node model.takehome.stg_med_admins
[0m20:33:41.018217 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.018217 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:33:41.018217 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_med_admins"
[0m20:33:41.018217 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:33:41.018217 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:33:41.026408 [debug] [Thread-2 (]: On model.takehome.stg_documents: BEGIN
[0m20:33:41.026408 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: BEGIN
[0m20:33:41.026408 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

  
  create view "takehome"."dev_staging"."stg_conditions__dbt_tmp" as (
    select
    id   as condition_id,
    name as condition_name
from "takehome"."raw"."conditions"
  );

[0m20:33:41.026408 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:33:41.026408 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:33:41.026408 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:33:41.026408 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: BEGIN
[0m20:33:41.026408 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:33:41.026408 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.026408 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:33:41.026408 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:33:41.026408 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:33:41.026408 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:33:41.026408 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:33:41.026408 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions" rename to "stg_conditions__dbt_backup"
[0m20:33:41.026408 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

  
  create view "takehome"."dev_staging"."stg_documents__dbt_tmp" as (
    select
    document_id,
    patient_id,
    visit_id,
    document_line,
    document_text
from "takehome"."raw"."documents"
  );

[0m20:33:41.042065 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    -- lee todos los JSON
    select *
    from read_json_auto('src_data/lab_results/*.json')
),

flattened as (
    select
        testId::bigint           as test_id,
        orderId::bigint          as order_id,
        patientId::bigint        as patient_id,
        cast(resultDate as date) as result_date,
        tr.componentName         as component_name,
        tr.componentRefHi::double  as component_ref_hi,
        tr.componentRefLo::double  as component_ref_lo,
        tr.componentUnits        as component_units,
        tr.resultValue::double   as result_value
    from raw_json
    cross join unnest(testResults) as tr(
        componentName,
        componentRefHi,
        componentRefLo,
        componentUnits,
        resultValue
    )
)

select *
from flattened
  );

[0m20:33:41.042065 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m20:33:41.042065 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:33:41.042065 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:33:41.048103 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:33:41.048103 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:33:41.048103 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

  
  create view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" as (
    select
    patient_id,
    patient_condition_id,
    medication_id,
    coalesce(date_stopped, date_started) as updated_at,
    date_started,
    date_stopped,
    dosage
from "takehome"."raw"."med_admins"
  );

[0m20:33:41.050109 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions__dbt_tmp" rename to "stg_conditions"
[0m20:33:41.052117 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:33:41.052117 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents" rename to "stg_documents__dbt_backup"
[0m20:33:41.054125 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:33:41.056133 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:33:41.056133 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.057884 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins" rename to "stg_med_admins__dbt_backup"
[0m20:33:41.057884 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.076075 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:33:41.076075 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m20:33:41.076075 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents__dbt_tmp" rename to "stg_documents"
[0m20:33:41.076075 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:33:41.076075 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:33:41.082213 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:33:41.082213 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m20:33:41.082213 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.082213 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" rename to "stg_med_admins"
[0m20:33:41.082213 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    -- lee todos los JSON
    select *
    from read_json_auto('src_data/lab_results/*.json')
),

flattened as (
    select
        testId::bigint           as test_id,
        orderId::bigint          as order_id,
        patientId::bigint        as patient_id,
        cast(resultDate as date) as result_date,
        tr.componentName         as component_name,
        tr.componentRefHi::double  as component_ref_hi,
        tr.componentRefLo::double  as component_ref_lo,
        tr.componentUnits        as component_units,
        tr.resultValue::double   as result_value
    from raw_json
    cross join unnest(testResults) as tr(
        componentName,
        componentRefHi,
        componentRefLo,
        componentUnits,
        resultValue
    )
)

select *
from flattened
  );

[0m20:33:41.082213 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m20:33:41.082213 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m20:33:41.090593 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: ROLLBACK
[0m20:33:41.090593 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:33:41.090593 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m20:33:41.090593 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:33:41.098809 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:33:41.098809 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_conditions__dbt_backup" cascade
    
[0m20:33:41.098809 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m20:33:41.098809 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m20:33:41.098809 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:33:41.098809 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m20:33:41.098809 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m20:33:41.098809 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:33:41.098809 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

      drop view if exists "takehome"."dev_staging"."stg_documents__dbt_backup" cascade
    
[0m20:33:41.107258 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:33:41.107258 [debug] [Thread-1 (]: On model.takehome.stg_conditions: Close
[0m20:33:41.107258 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m20:33:41.154450 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:33:41.154450 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

      drop view if exists "takehome"."dev_staging"."stg_med_admins__dbt_backup" cascade
    
[0m20:33:41.154450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2DCB0C410>]}
[0m20:33:41.154450 [debug] [Thread-2 (]: SQL status: OK in 0.063 seconds
[0m20:33:41.154450 [info ] [Thread-1 (]: 1 of 14 OK created sql view model dev_staging.stg_conditions ................... [[32mOK[0m in 0.16s]
[0m20:33:41.170345 [debug] [Thread-2 (]: On model.takehome.stg_documents: Close
[0m20:33:41.170345 [debug] [Thread-1 (]: Finished running node model.takehome.stg_conditions
[0m20:33:41.170345 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:33:41.170345 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E159CFE0>]}
[0m20:33:41.170345 [debug] [Thread-1 (]: Began running node model.takehome.stg_medications
[0m20:33:41.170345 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: Close
[0m20:33:41.170345 [info ] [Thread-2 (]: 2 of 14 OK created sql view model dev_staging.stg_documents .................... [[32mOK[0m in 0.22s]
[0m20:33:41.170345 [debug] [Thread-2 (]: Finished running node model.takehome.stg_documents
[0m20:33:41.170345 [debug] [Thread-2 (]: Began running node model.takehome.stg_orders
[0m20:33:41.170345 [info ] [Thread-1 (]: 5 of 14 START sql view model dev_staging.stg_medications ....................... [RUN]
[0m20:33:41.170345 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2DCCD9670>]}
[0m20:33:41.170345 [info ] [Thread-2 (]: 6 of 14 START sql view model dev_staging.stg_orders ............................ [RUN]
[0m20:33:41.170345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_conditions, now model.takehome.stg_medications)
[0m20:33:41.170345 [info ] [Thread-4 (]: 4 of 14 OK created sql view model dev_staging.stg_med_admins ................... [[32mOK[0m in 0.22s]
[0m20:33:41.170345 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_documents, now model.takehome.stg_orders)
[0m20:33:41.186466 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_orders
[0m20:33:41.170345 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_medications
[0m20:33:41.186466 [debug] [Thread-4 (]: Finished running node model.takehome.stg_med_admins
[0m20:33:41.170345 [debug] [Thread-3 (]: Failed to rollback 'model.takehome.stg_lab_results'
[0m20:33:41.190924 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_orders"
[0m20:33:41.191879 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_medications"
[0m20:33:41.191879 [debug] [Thread-4 (]: Began running node model.takehome.stg_patient_conditions
[0m20:33:41.191879 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: Close
[0m20:33:41.191879 [info ] [Thread-4 (]: 7 of 14 START sql view model dev_staging.stg_patient_conditions ................ [RUN]
[0m20:33:41.191879 [debug] [Thread-2 (]: Began executing node model.takehome.stg_orders
[0m20:33:41.191879 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_med_admins, now model.takehome.stg_patient_conditions)
[0m20:33:41.204469 [debug] [Thread-1 (]: Began executing node model.takehome.stg_medications
[0m20:33:41.204469 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_patient_conditions
[0m20:33:41.204469 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_orders"
[0m20:33:41.210848 [debug] [Thread-3 (]: Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "tr" does not have a column named "componentRefHi"
  
  Candidate bindings: : "componentName"
  
  LINE 18:         tr.componentRefHi::double  as component_ref_hi,
                   ^
[0m20:33:41.212856 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_medications"
[0m20:33:41.216415 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_patient_conditions"
[0m20:33:41.216415 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E11F31A0>]}
[0m20:33:41.218804 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:33:41.219301 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:33:41.219301 [debug] [Thread-2 (]: On model.takehome.stg_orders: BEGIN
[0m20:33:41.219301 [error] [Thread-3 (]: 3 of 14 ERROR creating sql view model dev_staging.stg_lab_results .............. [[31mERROR[0m in 0.26s]
[0m20:33:41.219301 [debug] [Thread-1 (]: On model.takehome.stg_medications: BEGIN
[0m20:33:41.219301 [debug] [Thread-4 (]: Began executing node model.takehome.stg_patient_conditions
[0m20:33:41.219301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:41.219301 [debug] [Thread-3 (]: Finished running node model.takehome.stg_lab_results
[0m20:33:41.219301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:41.227585 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_patient_conditions"
[0m20:33:41.227585 [debug] [Thread-3 (]: Began running node model.takehome.stg_patients
[0m20:33:41.227585 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m20:33:41.227585 [debug] [Thread-7 (]: Marking all children of 'model.takehome.stg_lab_results' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "tr" does not have a column named "componentRefHi"
  
  Candidate bindings: : "componentName"
  
  LINE 18:         tr.componentRefHi::double  as component_ref_hi,
                   ^.
[0m20:33:41.227585 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:33:41.227585 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:33:41.227585 [info ] [Thread-3 (]: 8 of 14 START sql view model dev_staging.stg_patients .......................... [RUN]
[0m20:33:41.236063 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:33:41.236063 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:33:41.238548 [debug] [Thread-2 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

  
  create view "takehome"."dev_staging"."stg_orders__dbt_tmp" as (
    select
    id            as order_id,
    patient_id,
    condition_id,
    order_date    as updated_at,
    order_date
from "takehome"."raw"."orders"
  );

[0m20:33:41.238548 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_lab_results, now model.takehome.stg_patients)
[0m20:33:41.238548 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: BEGIN
[0m20:33:41.238548 [debug] [Thread-1 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

  
  create view "takehome"."dev_staging"."stg_medications__dbt_tmp" as (
    select
    id   as medication_id,
    name as medication_name
from "takehome"."raw"."medications"
  );

[0m20:33:41.238548 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_patients
[0m20:33:41.238548 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:41.238548 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.246312 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m20:33:41.246312 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:33:41.246312 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:33:41.246312 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m20:33:41.252313 [debug] [Thread-2 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:33:41.252821 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:33:41.252821 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:33:41.252821 [debug] [Thread-1 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications" rename to "stg_medications__dbt_backup"
[0m20:33:41.252821 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

  
  create view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" as (
    select
    id                     as patient_condition_id,
    patient_id,
    condition_id,
    coalesce(date_ended, date_started) as updated_at,
    date_started,
    date_ended
from "takehome"."raw"."patient_conditions"
  );

[0m20:33:41.252821 [debug] [Thread-3 (]: Began executing node model.takehome.stg_patients
[0m20:33:41.252821 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.261123 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.261123 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m20:33:41.261123 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:33:41.261123 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:33:41.269362 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:33:41.269362 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:33:41.269362 [debug] [Thread-2 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:33:41.269362 [debug] [Thread-1 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications__dbt_tmp" rename to "stg_medications"
[0m20:33:41.269362 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions" rename to "stg_patient_conditions__dbt_backup"
[0m20:33:41.277109 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:33:41.277523 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:33:41.277523 [debug] [Thread-3 (]: On model.takehome.stg_patients: BEGIN
[0m20:33:41.277523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:33:41.277523 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.277523 [debug] [Thread-2 (]: On model.takehome.stg_orders: COMMIT
[0m20:33:41.277523 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:41.277523 [debug] [Thread-1 (]: On model.takehome.stg_medications: COMMIT
[0m20:33:41.286104 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:33:41.286104 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:33:41.286104 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:33:41.286104 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m20:33:41.286104 [debug] [Thread-2 (]: On model.takehome.stg_orders: COMMIT
[0m20:33:41.286104 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" rename to "stg_patient_conditions"
[0m20:33:41.286104 [debug] [Thread-1 (]: On model.takehome.stg_medications: COMMIT
[0m20:33:41.286104 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:33:41.286104 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id as patient_id,
    coalesce(
        date_deactivated,
        date_activated,
        date_of_death,
        date_of_birth
    )                                    as updated_at,
    first_name,
    last_name,
    ssn,
    date_of_birth,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_death,
    date_activated,
    date_deactivated
from "takehome"."raw"."patients"
  );

[0m20:33:41.286104 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:33:41.293817 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m20:33:41.294702 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:33:41.294702 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.294702 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.294702 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m20:33:41.294702 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:33:41.294702 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:33:41.303093 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:33:41.303093 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:33:41.303093 [debug] [Thread-2 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

      drop view if exists "takehome"."dev_staging"."stg_orders__dbt_backup" cascade
    
[0m20:33:41.303093 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:33:41.303093 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.303093 [debug] [Thread-1 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

      drop view if exists "takehome"."dev_staging"."stg_medications__dbt_backup" cascade
    
[0m20:33:41.311462 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:33:41.311462 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_patient_conditions__dbt_backup" cascade
    
[0m20:33:41.311462 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.311462 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.311462 [debug] [Thread-2 (]: On model.takehome.stg_orders: Close
[0m20:33:41.311462 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:33:41.318853 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:33:41.319699 [debug] [Thread-1 (]: On model.takehome.stg_medications: Close
[0m20:33:41.319699 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m20:33:41.319699 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:33:41.319699 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E1552150>]}
[0m20:33:41.319699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E1B31250>]}
[0m20:33:41.319699 [debug] [Thread-4 (]: On model.takehome.stg_patient_conditions: Close
[0m20:33:41.319699 [info ] [Thread-2 (]: 6 of 14 OK created sql view model dev_staging.stg_orders ....................... [[32mOK[0m in 0.15s]
[0m20:33:41.319699 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.319699 [info ] [Thread-1 (]: 5 of 14 OK created sql view model dev_staging.stg_medications .................. [[32mOK[0m in 0.15s]
[0m20:33:41.327939 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E1642000>]}
[0m20:33:41.327939 [debug] [Thread-2 (]: Finished running node model.takehome.stg_orders
[0m20:33:41.327939 [debug] [Thread-3 (]: On model.takehome.stg_patients: COMMIT
[0m20:33:41.327939 [debug] [Thread-1 (]: Finished running node model.takehome.stg_medications
[0m20:33:41.327939 [info ] [Thread-4 (]: 7 of 14 OK created sql view model dev_staging.stg_patient_conditions ........... [[32mOK[0m in 0.14s]
[0m20:33:41.327939 [debug] [Thread-2 (]: Began running node model.takehome.stg_visits
[0m20:33:41.327939 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:33:41.327939 [debug] [Thread-1 (]: Began running node model.takehome.lab_results
[0m20:33:41.327939 [debug] [Thread-4 (]: Finished running node model.takehome.stg_patient_conditions
[0m20:33:41.335447 [debug] [Thread-3 (]: On model.takehome.stg_patients: COMMIT
[0m20:33:41.327939 [info ] [Thread-2 (]: 9 of 14 START sql view model dev_staging.stg_visits ............................ [RUN]
[0m20:33:41.335447 [debug] [Thread-4 (]: Began running node model.takehome.medications_per_month
[0m20:33:41.335447 [info ] [Thread-1 (]: 10 of 14 SKIP relation dev_silver.lab_results .................................. [[33mSKIP[0m]
[0m20:33:41.335447 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_orders, now model.takehome.stg_visits)
[0m20:33:41.335447 [debug] [Thread-1 (]: Finished running node model.takehome.lab_results
[0m20:33:41.335447 [info ] [Thread-4 (]: 11 of 14 START sql table model dev_silver.medications_per_month ................ [RUN]
[0m20:33:41.339689 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_visits
[0m20:33:41.339689 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:33:41.339689 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patient_conditions, now model.takehome.medications_per_month)
[0m20:33:41.343818 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_visits"
[0m20:33:41.349004 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:33:41.349004 [debug] [Thread-4 (]: Began compiling node model.takehome.medications_per_month
[0m20:33:41.349004 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

      drop view if exists "takehome"."dev_staging"."stg_patients__dbt_backup" cascade
    
[0m20:33:41.353984 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.medications_per_month"
[0m20:33:41.353984 [debug] [Thread-2 (]: Began executing node model.takehome.stg_visits
[0m20:33:41.353984 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_visits"
[0m20:33:41.353984 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.360390 [debug] [Thread-3 (]: On model.takehome.stg_patients: Close
[0m20:33:41.360390 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E2BE8A10>]}
[0m20:33:41.360390 [info ] [Thread-3 (]: 8 of 14 OK created sql view model dev_staging.stg_patients ..................... [[32mOK[0m in 0.12s]
[0m20:33:41.360390 [debug] [Thread-3 (]: Finished running node model.takehome.stg_patients
[0m20:33:41.363756 [debug] [Thread-1 (]: Began running node model.takehome.patients
[0m20:33:41.363756 [info ] [Thread-1 (]: 12 of 14 START sql table model dev_bronze.patients ............................. [RUN]
[0m20:33:41.363756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_medications, now model.takehome.patients)
[0m20:33:41.363756 [debug] [Thread-1 (]: Began compiling node model.takehome.patients
[0m20:33:41.363756 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.patients"
[0m20:33:41.368603 [debug] [Thread-4 (]: Began executing node model.takehome.medications_per_month
[0m20:33:41.376748 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:33:41.376748 [debug] [Thread-2 (]: On model.takehome.stg_visits: BEGIN
[0m20:33:41.376748 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:41.391028 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.medications_per_month"
[0m20:33:41.391028 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m20:33:41.391028 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:33:41.393751 [debug] [Thread-1 (]: Began executing node model.takehome.patients
[0m20:33:41.393751 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

  
  create view "takehome"."dev_staging"."stg_visits__dbt_tmp" as (
    select
    id                    as visit_id,
    visit_date            as updated_at,
    patient_condition_id,
    visit_date
from "takehome"."raw"."visits"
  );

[0m20:33:41.393751 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:41.397736 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.patients"
[0m20:33:41.399749 [debug] [Thread-4 (]: On model.takehome.medications_per_month: BEGIN
[0m20:33:41.399749 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:33:41.399749 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.405098 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:33:41.405098 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits" rename to "stg_visits__dbt_backup"
[0m20:33:41.405098 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:41.405098 [debug] [Thread-1 (]: On model.takehome.patients: BEGIN
[0m20:33:41.405098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:41.405098 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m20:33:41.405098 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:41.405098 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.405098 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."medications_per_month__dbt_tmp"
  
    as (
      with med_admins as (
    select
        patient_id,
        medication_id,
        date_started
    from "takehome"."dev_staging"."stg_med_admins"
    where date_started is not null
),

meds as (
    select
        medication_id,
        medication_name
    from "takehome"."dev_staging"."stg_medications"
),

med_admins_month as (
    select
        date_trunc('month', date_started) as month,
        medication_id,
        patient_id
    from med_admins
)

select
    m.month,
    med.medication_id,
    med.medication_name,
    count(*)                     as administrations,
    count(distinct m.patient_id) as patients_treated
from med_admins_month m
join meds med
    on m.medication_id = med.medication_id
group by 1,2,3
order by 1,2
    );
  
  
[0m20:33:41.405098 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.410382 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:33:41.410382 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:41.410382 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits__dbt_tmp" rename to "stg_visits"
[0m20:33:41.410382 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      

with 

pt as ( select * from "takehome"."dev_staging"."stg_patients" )

select
    *
    
from pt

qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m20:33:41.410382 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:33:41.417223 [debug] [Thread-2 (]: On model.takehome.stg_visits: COMMIT
[0m20:33:41.417223 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:33:41.418731 [debug] [Thread-2 (]: On model.takehome.stg_visits: COMMIT
[0m20:33:41.418731 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.427012 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:33:41.427012 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

      drop view if exists "takehome"."dev_staging"."stg_visits__dbt_backup" cascade
    
[0m20:33:41.427012 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m20:33:41.427012 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:33:41.433882 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:41.435392 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:41.435392 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m20:33:41.435392 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m20:33:41.435392 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m20:33:41.435392 [debug] [Thread-2 (]: On model.takehome.stg_visits: Close
[0m20:33:41.435392 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E1B31790>]}
[0m20:33:41.435392 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.435392 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.435392 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:41.435392 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:41.435392 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m20:33:41.435392 [info ] [Thread-2 (]: 9 of 14 OK created sql view model dev_staging.stg_visits ....................... [[32mOK[0m in 0.10s]
[0m20:33:41.435392 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m20:33:41.435392 [debug] [Thread-2 (]: Finished running node model.takehome.stg_visits
[0m20:33:41.435392 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:33:41.435392 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:41.435392 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month" rename to "medications_per_month__dbt_backup"
[0m20:33:41.435392 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.451369 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:33:41.455210 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:41.455210 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month__dbt_tmp" rename to "medications_per_month"
[0m20:33:41.455210 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:41.460532 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients" rename to "patients__dbt_backup"
[0m20:33:41.460532 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.461618 [debug] [Thread-4 (]: On model.takehome.medications_per_month: COMMIT
[0m20:33:41.461618 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:41.461618 [debug] [Thread-4 (]: On model.takehome.medications_per_month: COMMIT
[0m20:33:41.461618 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:33:41.470679 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:41.470679 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients__dbt_tmp" rename to "patients"
[0m20:33:41.470679 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:33:41.470679 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:33:41.470679 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

      drop table if exists "takehome"."dev_silver"."medications_per_month__dbt_backup" cascade
    
[0m20:33:41.470679 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:33:41.476933 [debug] [Thread-1 (]: On model.takehome.patients: COMMIT
[0m20:33:41.477498 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:41.477498 [debug] [Thread-1 (]: On model.takehome.patients: COMMIT
[0m20:33:41.477498 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:33:41.482769 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:33:41.482769 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

      drop table if exists "takehome"."dev_bronze"."patients__dbt_backup" cascade
    
[0m20:33:41.482769 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m20:33:41.485275 [debug] [Thread-4 (]: On model.takehome.medications_per_month: Close
[0m20:33:41.485275 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E1A70B90>]}
[0m20:33:41.485275 [info ] [Thread-4 (]: 11 of 14 OK created sql table model dev_silver.medications_per_month ........... [[32mOK[0m in 0.15s]
[0m20:33:41.485275 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:33:41.485275 [debug] [Thread-4 (]: Finished running node model.takehome.medications_per_month
[0m20:33:41.485275 [debug] [Thread-1 (]: On model.takehome.patients: Close
[0m20:33:41.485275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E2BB3710>]}
[0m20:33:41.485275 [info ] [Thread-1 (]: 12 of 14 OK created sql table model dev_bronze.patients ........................ [[32mOK[0m in 0.12s]
[0m20:33:41.485275 [debug] [Thread-1 (]: Finished running node model.takehome.patients
[0m20:33:41.492015 [debug] [Thread-3 (]: Began running node model.takehome.patients_by_age
[0m20:33:41.493365 [debug] [Thread-2 (]: Began running node model.takehome.patients_per_month
[0m20:33:41.492015 [info ] [Thread-3 (]: 13 of 14 START sql table model dev_silver.patients_by_age ...................... [RUN]
[0m20:33:41.494429 [info ] [Thread-2 (]: 14 of 14 START sql table model dev_silver.patients_per_month ................... [RUN]
[0m20:33:41.494429 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patients, now model.takehome.patients_by_age)
[0m20:33:41.496241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_visits, now model.takehome.patients_per_month)
[0m20:33:41.496241 [debug] [Thread-3 (]: Began compiling node model.takehome.patients_by_age
[0m20:33:41.496241 [debug] [Thread-2 (]: Began compiling node model.takehome.patients_per_month
[0m20:33:41.496241 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.patients_by_age"
[0m20:33:41.502743 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.patients_per_month"
[0m20:33:41.502743 [debug] [Thread-2 (]: Began executing node model.takehome.patients_per_month
[0m20:33:41.502743 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.patients_per_month"
[0m20:33:41.502743 [debug] [Thread-3 (]: Began executing node model.takehome.patients_by_age
[0m20:33:41.510970 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.patients_by_age"
[0m20:33:41.512980 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:41.512980 [debug] [Thread-2 (]: On model.takehome.patients_per_month: BEGIN
[0m20:33:41.514322 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:41.514322 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:41.514322 [debug] [Thread-3 (]: On model.takehome.patients_by_age: BEGIN
[0m20:33:41.514322 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:33:41.514322 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:33:41.514322 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:41.514322 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_per_month__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_activated,
        gender
    from "takehome"."dev_bronze"."patients"
    where date_activated is not null
),

patients_by_month as (
    select
        date_trunc('month', date_activated)                           as month,
        count(*)                                                      as new_patients,
        count(distinct case when gender = 'M' then patient_id end)    as new_patients_male,
        count(distinct case when gender = 'F' then patient_id end)    as new_patients_female
    from patients
    group by 1
)

select *
from patients_by_month
order by month
    );
  
  
[0m20:33:41.518871 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.518871 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:41.518871 [debug] [Thread-3 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_by_age__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_of_birth,
        gender,
        race,
        ethnicity,
        smoker,
        drinks_per_week,
        date_activated,
        date_deactivated,
        date_of_death
    from "takehome"."dev_bronze"."patients"
)

select
    patient_id,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_birth,
    date_activated,
    date_deactivated,
    date_of_death,
    date_diff('year', date_of_birth, current_date) as age,
    case
        when date_of_birth is null then 'unknown'
        when date_diff('year', date_of_birth, current_date) < 18 then '0-17'
        when date_diff('year', date_of_birth, current_date) between 18 and 34 then '18-34'
        when date_diff('year', date_of_birth, current_date) between 35 and 49 then '35-49'
        when date_diff('year', date_of_birth, current_date) between 50 and 64 then '50-64'
        else '65+'
    end as age_group
from patients
    );
  
  
[0m20:33:41.523199 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:33:41.523199 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:41.523199 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m20:33:41.527120 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m20:33:41.528196 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:41.528196 [debug] [Thread-3 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m20:33:41.528196 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:33:41.528196 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:41.528196 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m20:33:41.528196 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.528196 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:41.528196 [debug] [Thread-3 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m20:33:41.528196 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:33:41.537377 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:33:41.537377 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:41.537377 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month" rename to "patients_per_month__dbt_backup"
[0m20:33:41.537377 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:41.537377 [debug] [Thread-3 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age" rename to "patients_by_age__dbt_backup"
[0m20:33:41.543859 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:33:41.543859 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:41.543859 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month__dbt_tmp" rename to "patients_per_month"
[0m20:33:41.543859 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.543859 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:41.543859 [debug] [Thread-3 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age__dbt_tmp" rename to "patients_by_age"
[0m20:33:41.543859 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:33:41.543859 [debug] [Thread-2 (]: On model.takehome.patients_per_month: COMMIT
[0m20:33:41.552257 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:41.552257 [debug] [Thread-2 (]: On model.takehome.patients_per_month: COMMIT
[0m20:33:41.552257 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:33:41.552257 [debug] [Thread-3 (]: On model.takehome.patients_by_age: COMMIT
[0m20:33:41.552257 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:41.552257 [debug] [Thread-3 (]: On model.takehome.patients_by_age: COMMIT
[0m20:33:41.552257 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:33:41.557916 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:33:41.557916 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

      drop table if exists "takehome"."dev_silver"."patients_per_month__dbt_backup" cascade
    
[0m20:33:41.557916 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:33:41.560385 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:33:41.560385 [debug] [Thread-3 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

      drop table if exists "takehome"."dev_silver"."patients_by_age__dbt_backup" cascade
    
[0m20:33:41.560385 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:33:41.565832 [debug] [Thread-2 (]: On model.takehome.patients_per_month: Close
[0m20:33:41.565832 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E1B31190>]}
[0m20:33:41.565832 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:33:41.565832 [info ] [Thread-2 (]: 14 of 14 OK created sql table model dev_silver.patients_per_month .............. [[32mOK[0m in 0.07s]
[0m20:33:41.568204 [debug] [Thread-3 (]: On model.takehome.patients_by_age: Close
[0m20:33:41.568204 [debug] [Thread-2 (]: Finished running node model.takehome.patients_per_month
[0m20:33:41.568204 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac91a6c-1097-4de2-add8-67553b48a040', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E1793E00>]}
[0m20:33:41.571126 [info ] [Thread-3 (]: 13 of 14 OK created sql table model dev_silver.patients_by_age ................. [[32mOK[0m in 0.07s]
[0m20:33:41.571126 [debug] [Thread-3 (]: Finished running node model.takehome.patients_by_age
[0m20:33:41.571126 [debug] [MainThread]: Using duckdb connection "master"
[0m20:33:41.571126 [debug] [MainThread]: On master: BEGIN
[0m20:33:41.571126 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:41.575483 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:33:41.575483 [debug] [MainThread]: On master: COMMIT
[0m20:33:41.575483 [debug] [MainThread]: Using duckdb connection "master"
[0m20:33:41.575483 [debug] [MainThread]: On master: COMMIT
[0m20:33:41.577492 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:33:41.577492 [debug] [MainThread]: On master: Close
[0m20:33:41.577492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:41.577492 [debug] [MainThread]: Connection 'create_takehome_dev_silver' was properly closed.
[0m20:33:41.577492 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m20:33:41.577492 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m20:33:41.579500 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m20:33:41.579500 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m20:33:41.579500 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m20:33:41.579500 [debug] [MainThread]: Connection 'model.takehome.patients' was properly closed.
[0m20:33:41.579500 [debug] [MainThread]: Connection 'model.takehome.patients_per_month' was properly closed.
[0m20:33:41.581510 [debug] [MainThread]: Connection 'model.takehome.patients_by_age' was properly closed.
[0m20:33:41.581510 [debug] [MainThread]: Connection 'model.takehome.medications_per_month' was properly closed.
[0m20:33:41.581510 [info ] [MainThread]: 
[0m20:33:41.581510 [info ] [MainThread]: Finished running 5 table models, 9 view models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m20:33:41.585520 [debug] [MainThread]: Command end result
[0m20:33:41.612838 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:33:41.616857 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:33:41.623377 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m20:33:41.623377 [info ] [MainThread]: 
[0m20:33:41.623377 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:33:41.623377 [info ] [MainThread]: 
[0m20:33:41.627025 [error] [MainThread]: [31mFailure in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)[0m
[0m20:33:41.627025 [error] [MainThread]:   Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "tr" does not have a column named "componentRefHi"
  
  Candidate bindings: : "componentName"
  
  LINE 18:         tr.componentRefHi::double  as component_ref_hi,
                   ^
[0m20:33:41.627025 [info ] [MainThread]: 
[0m20:33:41.627025 [info ] [MainThread]:   compiled code at target\compiled\takehome\dbt/models\staging\stg_lab_results.sql
[0m20:33:41.627025 [info ] [MainThread]: 
[0m20:33:41.627025 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=14
[0m20:33:41.627025 [debug] [MainThread]: Command `dbt run` failed at 20:33:41.627025 after 1.81 seconds
[0m20:33:41.627025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2DF45EFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2E2B2D0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2DEFEC860>]}
[0m20:33:41.627025 [debug] [MainThread]: Flushing usage events
[0m20:33:43.210535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:35:44.090311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409B252B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409858FEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409850C6E0>]}


============================== 20:35:44.090311 | 1ebd3adc-330a-4cd8-947d-179b59e9a107 ==============================
[0m20:35:44.090311 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:35:44.090311 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run -s stg_lab_results lab_results', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m20:35:44.330087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ebd3adc-330a-4cd8-947d-179b59e9a107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409C888680>]}
[0m20:35:44.392820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ebd3adc-330a-4cd8-947d-179b59e9a107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024098A27D70>]}
[0m20:35:44.392820 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:35:44.554203 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:35:44.706521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:35:44.706521 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\stg_lab_results.sql
[0m20:35:45.090846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ebd3adc-330a-4cd8-947d-179b59e9a107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409AC1A000>]}
[0m20:35:45.165969 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:35:45.165969 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:35:45.213252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ebd3adc-330a-4cd8-947d-179b59e9a107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409CF743E0>]}
[0m20:35:45.215261 [info ] [MainThread]: Found 14 models, 20 data tests, 8 sources, 468 macros
[0m20:35:45.215261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ebd3adc-330a-4cd8-947d-179b59e9a107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409D25C260>]}
[0m20:35:45.217023 [info ] [MainThread]: 
[0m20:35:45.217023 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:35:45.217023 [info ] [MainThread]: 
[0m20:35:45.217023 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:35:45.223676 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:35:45.295011 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:35:45.326995 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:35:45.326995 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:35:45.326995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:45.326995 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:35:45.342807 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:35:45.342807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:45.379913 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m20:35:45.379913 [debug] [ThreadPool]: On list_takehome: Close
[0m20:35:45.379913 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m20:35:45.379913 [debug] [ThreadPool]: On list_takehome: Close
[0m20:35:45.379913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m20:35:45.379913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_silver)
[0m20:35:45.379913 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m20:35:45.379913 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_silver"
"
[0m20:35:45.390514 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:35:45.397062 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:35:45.397062 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:35:45.397867 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:35:45.399013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:45.399013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:45.399013 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:35:45.399013 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:35:45.399013 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:35:45.399013 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:35:45.399013 [debug] [ThreadPool]: On create_takehome_dev_silver: BEGIN
[0m20:35:45.399013 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m20:35:45.399013 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:35:45.399013 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:35:45.399013 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:35:45.399013 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
    
        create schema if not exists "takehome"."dev_silver"
    
[0m20:35:45.399013 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:35:45.406509 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m20:35:45.408516 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:35:45.408516 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:35:45.408516 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:35:45.408516 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:35:45.408516 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m20:35:45.408516 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:35:45.408516 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:35:45.408516 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m20:35:45.408516 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:35:45.408516 [debug] [ThreadPool]: On create_takehome_dev_silver: Close
[0m20:35:45.408516 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:35:45.408516 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m20:35:45.414381 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m20:35:45.414381 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:35:45.414381 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m20:35:45.414381 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m20:35:45.422831 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:35:45.422831 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m20:35:45.422831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:45.422831 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m20:35:45.422831 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:35:45.422831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:45.422831 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m20:35:45.422831 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:35:45.422831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:45.422831 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:35:45.422831 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:35:45.422831 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m20:35:45.422831 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:35:45.422831 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m20:35:45.422831 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:35:45.437368 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:35:45.437368 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m20:35:45.446908 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:35:45.448915 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m20:35:45.448915 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:35:45.448915 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:35:45.448915 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m20:35:45.448915 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m20:35:45.448915 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m20:35:45.448915 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m20:35:45.454740 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m20:35:45.454740 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m20:35:45.454740 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m20:35:45.454740 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m20:35:45.454740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ebd3adc-330a-4cd8-947d-179b59e9a107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409B81C200>]}
[0m20:35:45.454740 [debug] [MainThread]: Using duckdb connection "master"
[0m20:35:45.454740 [debug] [MainThread]: On master: BEGIN
[0m20:35:45.454740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:45.454740 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:35:45.454740 [debug] [MainThread]: On master: COMMIT
[0m20:35:45.454740 [debug] [MainThread]: Using duckdb connection "master"
[0m20:35:45.454740 [debug] [MainThread]: On master: COMMIT
[0m20:35:45.454740 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:35:45.454740 [debug] [MainThread]: On master: Close
[0m20:35:45.454740 [debug] [Thread-1 (]: Began running node model.takehome.stg_lab_results
[0m20:35:45.454740 [info ] [Thread-1 (]: 1 of 2 START sql view model dev_staging.stg_lab_results ........................ [RUN]
[0m20:35:45.454740 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_lab_results'
[0m20:35:45.454740 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_lab_results
[0m20:35:45.470751 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_lab_results"
[0m20:35:45.470751 [debug] [Thread-1 (]: Began executing node model.takehome.stg_lab_results
[0m20:35:45.505408 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_lab_results"
[0m20:35:45.507417 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:35:45.507417 [debug] [Thread-1 (]: On model.takehome.stg_lab_results: BEGIN
[0m20:35:45.507417 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:35:45.509426 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:35:45.509426 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:35:45.509426 [debug] [Thread-1 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    -- leer todos los JSON de src_data/lab_results
    select *
    from read_json_auto('src_data/lab_results/*.json')
),

flattened as (
    select
        testId::bigint           as test_id,
        orderId::bigint          as order_id,
        patientId::bigint        as patient_id,
        cast(resultDate as date) as result_date,
        comp.componentName       as component_name,
        comp.componentRefHi::double  as component_ref_hi,
        comp.componentRefLo::double  as component_ref_lo,
        comp.componentUnits      as component_units,
        comp.resultValue::double as result_value
    from raw_json
    cross join unnest(testResults) as comp(
        componentName,
        componentRefHi,
        componentRefLo,
        componentUnits,
        resultValue
    )
)

select *
from flattened
  );

[0m20:35:45.536105 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    -- leer todos los JSON de src_data/lab_results
    select *
    from read_json_auto('src_data/lab_results/*.json')
),

flattened as (
    select
        testId::bigint           as test_id,
        orderId::bigint          as order_id,
        patientId::bigint        as patient_id,
        cast(resultDate as date) as result_date,
        comp.componentName       as component_name,
        comp.componentRefHi::double  as component_ref_hi,
        comp.componentRefLo::double  as component_ref_lo,
        comp.componentUnits      as component_units,
        comp.resultValue::double as result_value
    from raw_json
    cross join unnest(testResults) as comp(
        componentName,
        componentRefHi,
        componentRefLo,
        componentUnits,
        resultValue
    )
)

select *
from flattened
  );

[0m20:35:45.544134 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m20:35:45.544134 [debug] [Thread-1 (]: On model.takehome.stg_lab_results: ROLLBACK
[0m20:35:45.544134 [debug] [Thread-1 (]: Failed to rollback 'model.takehome.stg_lab_results'
[0m20:35:45.544134 [debug] [Thread-1 (]: On model.takehome.stg_lab_results: Close
[0m20:35:45.544134 [debug] [Thread-1 (]: Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "comp" does not have a column named "componentRefHi"
  
  Candidate bindings: : "componentName"
  
  LINE 18:         comp.componentRefHi::double  as component_ref_hi,
                   ^
[0m20:35:45.544134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ebd3adc-330a-4cd8-947d-179b59e9a107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409D4EC6E0>]}
[0m20:35:45.544134 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model dev_staging.stg_lab_results ............... [[31mERROR[0m in 0.09s]
[0m20:35:45.544134 [debug] [Thread-1 (]: Finished running node model.takehome.stg_lab_results
[0m20:35:45.544134 [debug] [Thread-7 (]: Marking all children of 'model.takehome.stg_lab_results' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "comp" does not have a column named "componentRefHi"
  
  Candidate bindings: : "componentName"
  
  LINE 18:         comp.componentRefHi::double  as component_ref_hi,
                   ^.
[0m20:35:45.544134 [debug] [Thread-3 (]: Began running node model.takehome.lab_results
[0m20:35:45.544134 [info ] [Thread-3 (]: 2 of 2 SKIP relation dev_silver.lab_results .................................... [[33mSKIP[0m]
[0m20:35:45.544134 [debug] [Thread-3 (]: Finished running node model.takehome.lab_results
[0m20:35:45.544134 [debug] [MainThread]: Using duckdb connection "master"
[0m20:35:45.560084 [debug] [MainThread]: On master: BEGIN
[0m20:35:45.560639 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:45.561117 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:35:45.561117 [debug] [MainThread]: On master: COMMIT
[0m20:35:45.561117 [debug] [MainThread]: Using duckdb connection "master"
[0m20:35:45.561117 [debug] [MainThread]: On master: COMMIT
[0m20:35:45.561117 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:35:45.561117 [debug] [MainThread]: On master: Close
[0m20:35:45.561117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:45.561117 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m20:35:45.561117 [debug] [MainThread]: Connection 'create_takehome_dev_silver' was properly closed.
[0m20:35:45.561117 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m20:35:45.561117 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m20:35:45.561117 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m20:35:45.561117 [debug] [MainThread]: Connection 'model.takehome.stg_lab_results' was properly closed.
[0m20:35:45.561117 [info ] [MainThread]: 
[0m20:35:45.561117 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m20:35:45.561117 [debug] [MainThread]: Command end result
[0m20:35:45.590599 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:35:45.596655 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:35:45.604375 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m20:35:45.604375 [info ] [MainThread]: 
[0m20:35:45.604375 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:35:45.604375 [info ] [MainThread]: 
[0m20:35:45.604375 [error] [MainThread]: [31mFailure in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)[0m
[0m20:35:45.604375 [error] [MainThread]:   Runtime Error in model stg_lab_results (dbt/models\staging\stg_lab_results.sql)
  Binder Error: Table "comp" does not have a column named "componentRefHi"
  
  Candidate bindings: : "componentName"
  
  LINE 18:         comp.componentRefHi::double  as component_ref_hi,
                   ^
[0m20:35:45.604375 [info ] [MainThread]: 
[0m20:35:45.604375 [info ] [MainThread]:   compiled code at target\compiled\takehome\dbt/models\staging\stg_lab_results.sql
[0m20:35:45.611539 [info ] [MainThread]: 
[0m20:35:45.611539 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m20:35:45.611539 [debug] [MainThread]: Command `dbt run` failed at 20:35:45.611539 after 1.69 seconds
[0m20:35:45.614245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409B69DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409D20E180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002409D322F00>]}
[0m20:35:45.614245 [debug] [MainThread]: Flushing usage events
[0m20:35:47.301680 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:01.909585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F59AE5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F59E400B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F59E40C50>]}


============================== 20:39:01.917987 | fbd06f92-6f0f-4182-92f2-a25bef1ce1ca ==============================
[0m20:39:01.917987 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:39:01.917987 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_lab_results lab_results', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m20:39:02.145820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbd06f92-6f0f-4182-92f2-a25bef1ce1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5BB6F4A0>]}
[0m20:39:02.193836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbd06f92-6f0f-4182-92f2-a25bef1ce1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5BB8BE00>]}
[0m20:39:02.209692 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:39:02.383922 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:39:02.535890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:39:02.535890 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\stg_lab_results.sql
[0m20:39:02.913515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbd06f92-6f0f-4182-92f2-a25bef1ce1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5C538FB0>]}
[0m20:39:02.989330 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:39:02.989330 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:39:03.020487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbd06f92-6f0f-4182-92f2-a25bef1ce1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5C827D70>]}
[0m20:39:03.020487 [info ] [MainThread]: Found 14 models, 20 data tests, 8 sources, 468 macros
[0m20:39:03.020487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbd06f92-6f0f-4182-92f2-a25bef1ce1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5C5DC470>]}
[0m20:39:03.020487 [info ] [MainThread]: 
[0m20:39:03.020487 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:39:03.020487 [info ] [MainThread]: 
[0m20:39:03.020487 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:39:03.044905 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:39:03.102156 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:39:03.163159 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:39:03.163159 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:39:03.163159 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:39:03.163159 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:39:03.163159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:03.163159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:03.182249 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:39:03.182249 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:39:03.182249 [debug] [ThreadPool]: On list_takehome: Close
[0m20:39:03.182249 [debug] [ThreadPool]: On list_takehome: Close
[0m20:39:03.182249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_silver)
[0m20:39:03.182249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m20:39:03.182249 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_silver"
"
[0m20:39:03.182249 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m20:39:03.191762 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:39:03.193770 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:39:03.193770 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:39:03.193770 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:39:03.193770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:03.193770 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:03.193770 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:39:03.199137 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:39:03.199137 [debug] [ThreadPool]: On create_takehome_dev_silver: BEGIN
[0m20:39:03.199137 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:39:03.199137 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:39:03.201143 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
    
        create schema if not exists "takehome"."dev_silver"
    
[0m20:39:03.201143 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:39:03.203149 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:39:03.203149 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:39:03.203149 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:39:03.203149 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:39:03.203149 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:39:03.203149 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:39:03.203149 [debug] [ThreadPool]: On create_takehome_dev_silver: Close
[0m20:39:03.203149 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m20:39:03.203149 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:39:03.203149 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:39:03.203149 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m20:39:03.203149 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:39:03.203149 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m20:39:03.203149 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:39:03.203149 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m20:39:03.203149 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:39:03.203149 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m20:39:03.203149 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m20:39:03.213057 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:39:03.213057 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m20:39:03.213057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:03.213057 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m20:39:03.221268 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:39:03.221268 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:39:03.221268 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:39:03.221268 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m20:39:03.221268 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m20:39:03.221268 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m20:39:03.221268 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:39:03.221268 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m20:39:03.221268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:03.221268 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:39:03.228000 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:39:03.228000 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m20:39:03.221268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:03.229586 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:39:03.229586 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:39:03.229586 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m20:39:03.242718 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:39:03.242718 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:39:03.244725 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m20:39:03.244725 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m20:39:03.244725 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:39:03.244725 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m20:39:03.244725 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m20:39:03.244725 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m20:39:03.244725 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m20:39:03.244725 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m20:39:03.244725 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m20:39:03.244725 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m20:39:03.244725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbd06f92-6f0f-4182-92f2-a25bef1ce1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5AB1DC10>]}
[0m20:39:03.244725 [debug] [MainThread]: Using duckdb connection "master"
[0m20:39:03.244725 [debug] [MainThread]: On master: BEGIN
[0m20:39:03.244725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:03.244725 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:39:03.244725 [debug] [MainThread]: On master: COMMIT
[0m20:39:03.244725 [debug] [MainThread]: Using duckdb connection "master"
[0m20:39:03.244725 [debug] [MainThread]: On master: COMMIT
[0m20:39:03.244725 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:39:03.244725 [debug] [MainThread]: On master: Close
[0m20:39:03.260908 [debug] [Thread-1 (]: Began running node model.takehome.stg_lab_results
[0m20:39:03.260908 [info ] [Thread-1 (]: 1 of 2 START sql view model dev_staging.stg_lab_results ........................ [RUN]
[0m20:39:03.260908 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_lab_results'
[0m20:39:03.260908 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_lab_results
[0m20:39:03.260908 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_lab_results"
[0m20:39:03.260908 [debug] [Thread-1 (]: Began executing node model.takehome.stg_lab_results
[0m20:39:03.304754 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_lab_results"
[0m20:39:03.304754 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:39:03.304754 [debug] [Thread-1 (]: On model.takehome.stg_lab_results: BEGIN
[0m20:39:03.304754 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:39:03.304754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:39:03.304754 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:39:03.304754 [debug] [Thread-1 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    -- Leer todos los JSON de src_data/lab_results
    select *
    from read_json_auto('src_data/lab_results/*.json')
),

flattened as (
    select
        testId::bigint            as test_id,
        orderId::bigint           as order_id,
        patientId::bigint         as patient_id,
        cast(resultDate as date)  as result_date,
        json_extract(value, '$.componentName')::varchar   as component_name,
        json_extract(value, '$.componentRefHi')::double   as component_ref_hi,
        json_extract(value, '$.componentRefLo')::double   as component_ref_lo,
        json_extract(value, '$.componentUnits')::varchar  as component_units,
        json_extract(value, '$.resultValue')::double      as result_value
    from raw_json
    -- testResults es un array; json_each lo explota en filas (key, value)
    cross join json_each(testResults)
)

select *
from flattened
  );

[0m20:39:03.336542 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m20:39:03.336542 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:39:03.336542 [debug] [Thread-1 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */
alter view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" rename to "stg_lab_results"
[0m20:39:03.336542 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:39:03.355103 [debug] [Thread-1 (]: On model.takehome.stg_lab_results: COMMIT
[0m20:39:03.355103 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:39:03.355103 [debug] [Thread-1 (]: On model.takehome.stg_lab_results: COMMIT
[0m20:39:03.360981 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:39:03.363243 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:39:03.363243 [debug] [Thread-1 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

      drop view if exists "takehome"."dev_staging"."stg_lab_results__dbt_backup" cascade
    
[0m20:39:03.363243 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:39:03.369152 [debug] [Thread-1 (]: On model.takehome.stg_lab_results: Close
[0m20:39:03.371598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd06f92-6f0f-4182-92f2-a25bef1ce1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5C6B0710>]}
[0m20:39:03.371598 [info ] [Thread-1 (]: 1 of 2 OK created sql view model dev_staging.stg_lab_results ................... [[32mOK[0m in 0.11s]
[0m20:39:03.371598 [debug] [Thread-1 (]: Finished running node model.takehome.stg_lab_results
[0m20:39:03.371598 [debug] [Thread-3 (]: Began running node model.takehome.lab_results
[0m20:39:03.371598 [info ] [Thread-3 (]: 2 of 2 START sql table model dev_silver.lab_results ............................ [RUN]
[0m20:39:03.371598 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.lab_results'
[0m20:39:03.371598 [debug] [Thread-3 (]: Began compiling node model.takehome.lab_results
[0m20:39:03.371598 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.lab_results"
[0m20:39:03.371598 [debug] [Thread-3 (]: Began executing node model.takehome.lab_results
[0m20:39:03.396886 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.lab_results"
[0m20:39:03.396886 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:39:03.396886 [debug] [Thread-3 (]: On model.takehome.lab_results: BEGIN
[0m20:39:03.396886 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:39:03.405128 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:39:03.405128 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:39:03.405128 [debug] [Thread-3 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

  
    
    

    create  table
      "takehome"."dev_silver"."lab_results__dbt_tmp"
  
    as (
      select *
from "takehome"."dev_staging"."stg_lab_results"
    );
  
  
[0m20:40:46.864585 [debug] [Thread-3 (]: SQL status: OK in 103.459 seconds
[0m20:40:46.868600 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:40:46.868600 [debug] [Thread-3 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */
alter table "takehome"."dev_silver"."lab_results__dbt_tmp" rename to "lab_results"
[0m20:40:46.870607 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:40:46.876376 [debug] [Thread-3 (]: On model.takehome.lab_results: COMMIT
[0m20:40:46.876376 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:40:46.876376 [debug] [Thread-3 (]: On model.takehome.lab_results: COMMIT
[0m20:40:46.878384 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:40:46.885083 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:40:46.885083 [debug] [Thread-3 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

      drop table if exists "takehome"."dev_silver"."lab_results__dbt_backup" cascade
    
[0m20:40:46.885083 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:40:46.887092 [debug] [Thread-3 (]: On model.takehome.lab_results: Close
[0m20:40:46.887092 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbd06f92-6f0f-4182-92f2-a25bef1ce1ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F5DB021B0>]}
[0m20:40:46.887092 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev_silver.lab_results ....................... [[32mOK[0m in 103.52s]
[0m20:40:46.890108 [debug] [Thread-3 (]: Finished running node model.takehome.lab_results
[0m20:40:46.890108 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:46.890108 [debug] [MainThread]: On master: BEGIN
[0m20:40:46.890108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:40:46.890108 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:40:46.893236 [debug] [MainThread]: On master: COMMIT
[0m20:40:46.893236 [debug] [MainThread]: Using duckdb connection "master"
[0m20:40:46.893236 [debug] [MainThread]: On master: COMMIT
[0m20:40:46.893236 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:40:46.893236 [debug] [MainThread]: On master: Close
[0m20:40:46.893236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:46.893236 [debug] [MainThread]: Connection 'create_takehome_dev_silver' was properly closed.
[0m20:40:46.895244 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m20:40:46.895244 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m20:40:46.895244 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m20:40:46.895244 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m20:40:46.895244 [debug] [MainThread]: Connection 'model.takehome.stg_lab_results' was properly closed.
[0m20:40:46.895244 [debug] [MainThread]: Connection 'model.takehome.lab_results' was properly closed.
[0m20:40:46.895244 [info ] [MainThread]: 
[0m20:40:46.895244 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 1 minutes and 43.87 seconds (103.87s).
[0m20:40:46.895244 [debug] [MainThread]: Command end result
[0m20:40:46.923399 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:40:46.923399 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:40:46.938830 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m20:40:46.940018 [info ] [MainThread]: 
[0m20:40:46.940018 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:40:46.940018 [info ] [MainThread]: 
[0m20:40:46.940018 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m20:40:46.940018 [debug] [MainThread]: Command `dbt run` succeeded at 20:40:46.940018 after 105.24 seconds
[0m20:40:46.940018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F59E400B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F59E27E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F59E26F00>]}
[0m20:40:46.940018 [debug] [MainThread]: Flushing usage events
[0m20:40:48.362615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:12.224957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35AFCDC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35AEED820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35A4C3680>]}


============================== 20:41:12.232569 | 40d707d4-48c0-41dd-8e79-232b11f2a035 ==============================
[0m20:41:12.232569 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:41:12.232569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'warn_error': 'None', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test -s stg_lab_results lab_results', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m20:41:12.468504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40d707d4-48c0-41dd-8e79-232b11f2a035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35B51F440>]}
[0m20:41:12.527330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40d707d4-48c0-41dd-8e79-232b11f2a035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35C7D4C20>]}
[0m20:41:12.529345 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:41:12.701973 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:41:12.848374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:12.848374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:12.875979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40d707d4-48c0-41dd-8e79-232b11f2a035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35CE0A1B0>]}
[0m20:41:12.963384 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:41:12.967398 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:41:13.014915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40d707d4-48c0-41dd-8e79-232b11f2a035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35CE09C70>]}
[0m20:41:13.014915 [info ] [MainThread]: Found 14 models, 20 data tests, 8 sources, 468 macros
[0m20:41:13.014915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40d707d4-48c0-41dd-8e79-232b11f2a035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35AD824B0>]}
[0m20:41:13.019506 [info ] [MainThread]: 
[0m20:41:13.019506 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:41:13.019506 [info ] [MainThread]: 
[0m20:41:13.019506 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:41:13.019506 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m20:41:13.035203 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m20:41:13.043687 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m20:41:13.101427 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:41:13.101427 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m20:41:13.101427 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:41:13.101427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:13.101427 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:41:13.101427 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m20:41:13.101427 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m20:41:13.101427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:13.101427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:13.142626 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m20:41:13.142626 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m20:41:13.142626 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:41:13.142626 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m20:41:13.142626 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:41:13.142626 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m20:41:13.142626 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:41:13.142626 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m20:41:13.142626 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m20:41:13.164514 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:41:13.164514 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:41:13.164514 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m20:41:13.164514 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:41:13.164514 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m20:41:13.164514 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m20:41:13.164514 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m20:41:13.164514 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m20:41:13.164514 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m20:41:13.174643 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m20:41:13.174643 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m20:41:13.174643 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m20:41:13.181596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40d707d4-48c0-41dd-8e79-232b11f2a035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35D24F440>]}
[0m20:41:13.185928 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:13.185928 [debug] [MainThread]: On master: BEGIN
[0m20:41:13.185928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:13.185928 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:41:13.185928 [debug] [MainThread]: On master: COMMIT
[0m20:41:13.189405 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:13.189405 [debug] [MainThread]: On master: COMMIT
[0m20:41:13.189405 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:41:13.190423 [debug] [MainThread]: On master: Close
[0m20:41:13.196132 [debug] [Thread-1 (]: Began running node test.takehome.not_null_lab_results_patient_id.d81edf6925
[0m20:41:13.198147 [info ] [Thread-1 (]: 1 of 4 START test not_null_lab_results_patient_id .............................. [RUN]
[0m20:41:13.198147 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.takehome.not_null_lab_results_patient_id.d81edf6925'
[0m20:41:13.199487 [debug] [Thread-1 (]: Began compiling node test.takehome.not_null_lab_results_patient_id.d81edf6925
[0m20:41:13.206137 [debug] [Thread-2 (]: Began running node test.takehome.not_null_lab_results_result_date.09687ad6ea
[0m20:41:13.206137 [debug] [Thread-3 (]: Began running node test.takehome.not_null_stg_lab_results_patient_id.71c57600ae
[0m20:41:13.217087 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.not_null_lab_results_patient_id.d81edf6925"
[0m20:41:13.219094 [debug] [Thread-4 (]: Began running node test.takehome.not_null_stg_lab_results_test_id.298faf8b41
[0m20:41:13.219094 [info ] [Thread-2 (]: 2 of 4 START test not_null_lab_results_result_date ............................. [RUN]
[0m20:41:13.219094 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_lab_results_patient_id .......................... [RUN]
[0m20:41:13.219094 [info ] [Thread-4 (]: 4 of 4 START test not_null_stg_lab_results_test_id ............................. [RUN]
[0m20:41:13.219094 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.takehome.not_null_lab_results_result_date.09687ad6ea'
[0m20:41:13.222119 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.takehome.not_null_stg_lab_results_patient_id.71c57600ae'
[0m20:41:13.222980 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.takehome.not_null_stg_lab_results_test_id.298faf8b41'
[0m20:41:13.223582 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_lab_results_result_date.09687ad6ea
[0m20:41:13.223582 [debug] [Thread-1 (]: Began executing node test.takehome.not_null_lab_results_patient_id.d81edf6925
[0m20:41:13.225570 [debug] [Thread-3 (]: Began compiling node test.takehome.not_null_stg_lab_results_patient_id.71c57600ae
[0m20:41:13.225570 [debug] [Thread-4 (]: Began compiling node test.takehome.not_null_stg_lab_results_test_id.298faf8b41
[0m20:41:13.231644 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_lab_results_result_date.09687ad6ea"
[0m20:41:13.259430 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"
[0m20:41:13.263473 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.not_null_lab_results_patient_id.d81edf6925"
[0m20:41:13.267726 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"
[0m20:41:13.267726 [debug] [Thread-3 (]: Began executing node test.takehome.not_null_stg_lab_results_patient_id.71c57600ae
[0m20:41:13.270879 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_lab_results_patient_id.d81edf6925"
[0m20:41:13.273894 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"
[0m20:41:13.273894 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_lab_results_result_date.09687ad6ea
[0m20:41:13.273894 [debug] [Thread-1 (]: On test.takehome.not_null_lab_results_patient_id.d81edf6925: BEGIN
[0m20:41:13.273894 [debug] [Thread-4 (]: Began executing node test.takehome.not_null_stg_lab_results_test_id.298faf8b41
[0m20:41:13.278358 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_lab_results_result_date.09687ad6ea"
[0m20:41:13.278358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:41:13.278358 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"
[0m20:41:13.278358 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"
[0m20:41:13.278358 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:41:13.278358 [debug] [Thread-3 (]: On test.takehome.not_null_stg_lab_results_patient_id.71c57600ae: BEGIN
[0m20:41:13.278358 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_lab_results_patient_id.d81edf6925"
[0m20:41:13.278358 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:41:13.278358 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"
[0m20:41:13.286443 [debug] [Thread-1 (]: On test.takehome.not_null_lab_results_patient_id.d81edf6925: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_lab_results_patient_id.d81edf6925"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_silver"."lab_results"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m20:41:13.286443 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_lab_results_result_date.09687ad6ea"
[0m20:41:13.287950 [debug] [Thread-4 (]: On test.takehome.not_null_stg_lab_results_test_id.298faf8b41: BEGIN
[0m20:41:13.287950 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:41:13.287950 [debug] [Thread-2 (]: On test.takehome.not_null_lab_results_result_date.09687ad6ea: BEGIN
[0m20:41:13.287950 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:41:13.287950 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:13.287950 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"
[0m20:41:13.287950 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:41:13.294334 [debug] [Thread-1 (]: On test.takehome.not_null_lab_results_patient_id.d81edf6925: ROLLBACK
[0m20:41:13.296343 [debug] [Thread-3 (]: On test.takehome.not_null_stg_lab_results_patient_id.71c57600ae: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_staging"."stg_lab_results"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m20:41:13.296343 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:41:13.296343 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.not_null_lab_results_patient_id.d81edf6925'
[0m20:41:13.296343 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m20:41:13.296343 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"
[0m20:41:13.296343 [debug] [Thread-1 (]: On test.takehome.not_null_lab_results_patient_id.d81edf6925: Close
[0m20:41:13.296343 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_lab_results_result_date.09687ad6ea"
[0m20:41:13.296343 [debug] [Thread-4 (]: On test.takehome.not_null_stg_lab_results_test_id.298faf8b41: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select test_id
from "takehome"."dev_staging"."stg_lab_results"
where test_id is null



  
  
      
    ) dbt_internal_test
[0m20:41:13.296343 [info ] [Thread-1 (]: 1 of 4 PASS not_null_lab_results_patient_id .................................... [[32mPASS[0m in 0.10s]
[0m20:41:13.296343 [debug] [Thread-2 (]: On test.takehome.not_null_lab_results_result_date.09687ad6ea: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_lab_results_result_date.09687ad6ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select result_date
from "takehome"."dev_silver"."lab_results"
where result_date is null



  
  
      
    ) dbt_internal_test
[0m20:41:13.303771 [debug] [Thread-1 (]: Finished running node test.takehome.not_null_lab_results_patient_id.d81edf6925
[0m20:41:13.303771 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:41:13.307556 [debug] [Thread-2 (]: On test.takehome.not_null_lab_results_result_date.09687ad6ea: ROLLBACK
[0m20:41:13.307556 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_lab_results_result_date.09687ad6ea'
[0m20:41:13.307556 [debug] [Thread-2 (]: On test.takehome.not_null_lab_results_result_date.09687ad6ea: Close
[0m20:41:13.307556 [info ] [Thread-2 (]: 2 of 4 PASS not_null_lab_results_result_date ................................... [[32mPASS[0m in 0.09s]
[0m20:41:13.307556 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_lab_results_result_date.09687ad6ea
[0m20:41:16.913127 [debug] [Thread-4 (]: SQL status: OK in 3.615 seconds
[0m20:41:16.929092 [debug] [Thread-4 (]: On test.takehome.not_null_stg_lab_results_test_id.298faf8b41: ROLLBACK
[0m20:41:16.931100 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.not_null_stg_lab_results_test_id.298faf8b41'
[0m20:41:16.931100 [debug] [Thread-4 (]: On test.takehome.not_null_stg_lab_results_test_id.298faf8b41: Close
[0m20:41:16.931100 [info ] [Thread-4 (]: 4 of 4 PASS not_null_stg_lab_results_test_id ................................... [[32mPASS[0m in 3.71s]
[0m20:41:16.933108 [debug] [Thread-4 (]: Finished running node test.takehome.not_null_stg_lab_results_test_id.298faf8b41
[0m20:41:17.027552 [debug] [Thread-3 (]: SQL status: OK in 3.729 seconds
[0m20:41:17.035576 [debug] [Thread-3 (]: On test.takehome.not_null_stg_lab_results_patient_id.71c57600ae: ROLLBACK
[0m20:41:17.037324 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.not_null_stg_lab_results_patient_id.71c57600ae'
[0m20:41:17.037324 [debug] [Thread-3 (]: On test.takehome.not_null_stg_lab_results_patient_id.71c57600ae: Close
[0m20:41:17.039334 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_lab_results_patient_id ................................ [[32mPASS[0m in 3.82s]
[0m20:41:17.039334 [debug] [Thread-3 (]: Finished running node test.takehome.not_null_stg_lab_results_patient_id.71c57600ae
[0m20:41:17.039334 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:17.039334 [debug] [MainThread]: On master: BEGIN
[0m20:41:17.039334 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:17.039334 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:41:17.039334 [debug] [MainThread]: On master: COMMIT
[0m20:41:17.039334 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:17.039334 [debug] [MainThread]: On master: COMMIT
[0m20:41:17.039334 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:41:17.039334 [debug] [MainThread]: On master: Close
[0m20:41:17.039334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:17.039334 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m20:41:17.039334 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m20:41:17.039334 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m20:41:17.039334 [debug] [MainThread]: Connection 'test.takehome.not_null_lab_results_patient_id.d81edf6925' was properly closed.
[0m20:41:17.039334 [debug] [MainThread]: Connection 'test.takehome.not_null_lab_results_result_date.09687ad6ea' was properly closed.
[0m20:41:17.039334 [debug] [MainThread]: Connection 'test.takehome.not_null_stg_lab_results_patient_id.71c57600ae' was properly closed.
[0m20:41:17.039334 [debug] [MainThread]: Connection 'test.takehome.not_null_stg_lab_results_test_id.298faf8b41' was properly closed.
[0m20:41:17.039334 [info ] [MainThread]: 
[0m20:41:17.039334 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m20:41:17.039334 [debug] [MainThread]: Command end result
[0m20:41:17.075100 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:41:17.078243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:41:17.087523 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m20:41:17.091194 [info ] [MainThread]: 
[0m20:41:17.091194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:17.091194 [info ] [MainThread]: 
[0m20:41:17.091194 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:41:17.094656 [debug] [MainThread]: Command `dbt test` succeeded at 20:41:17.094656 after 5.03 seconds
[0m20:41:17.094656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35C7D6840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35B30EF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F35AB526C0>]}
[0m20:41:17.094656 [debug] [MainThread]: Flushing usage events
[0m20:41:19.076394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:37.764499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CFFE80890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C832A7530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C832A4500>]}


============================== 20:41:37.776791 | 7ffc9f77-fb76-4dc1-af17-039d916c1377 ==============================
[0m20:41:37.776791 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:41:37.776791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m20:41:38.026613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C809508F0>]}
[0m20:41:38.089827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C82D87DA0>]}
[0m20:41:38.089827 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:41:38.302586 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:41:38.427991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:41:38.427991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:41:38.461649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C84F90D10>]}
[0m20:41:38.541022 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:41:38.541022 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:41:38.587202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C85401790>]}
[0m20:41:38.587202 [info ] [MainThread]: Found 14 models, 20 data tests, 8 sources, 468 macros
[0m20:41:38.587202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C84FDE270>]}
[0m20:41:38.587202 [info ] [MainThread]: 
[0m20:41:38.587202 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:41:38.587202 [info ] [MainThread]: 
[0m20:41:38.587202 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:41:38.603072 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:41:38.614553 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:41:38.631092 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:41:38.674824 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:41:38.674824 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:41:38.674824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:38.674824 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:41:38.678399 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:41:38.678399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:38.678399 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:41:38.678399 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:41:38.678399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:38.696244 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m20:41:38.698253 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:41:38.698253 [debug] [ThreadPool]: On list_takehome: Close
[0m20:41:38.698253 [debug] [ThreadPool]: On list_takehome: Close
[0m20:41:38.698253 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:41:38.698253 [debug] [ThreadPool]: On list_takehome: Close
[0m20:41:38.698253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_silver)
[0m20:41:38.698253 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_silver"
"
[0m20:41:38.709612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m20:41:38.709612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m20:41:38.709612 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:41:38.709612 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m20:41:38.709612 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m20:41:38.709612 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:41:38.709612 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:41:38.715110 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:41:38.715110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:38.715110 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:41:38.715110 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:41:38.715110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:38.715110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:38.715110 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:41:38.715110 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:41:38.715110 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:41:38.715110 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:41:38.715110 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:41:38.725289 [debug] [ThreadPool]: On create_takehome_dev_silver: BEGIN
[0m20:41:38.726481 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:41:38.727578 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m20:41:38.728084 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m20:41:38.728084 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:38.728084 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:38.728084 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:41:38.728084 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:38.728084 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:41:38.728084 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
    
        create schema if not exists "takehome"."dev_silver"
    
[0m20:41:38.728084 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:41:38.728084 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m20:41:38.728084 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m20:41:38.728084 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:38.728084 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:38.728084 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:41:38.728084 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:38.728084 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m20:41:38.728084 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:41:38.728084 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m20:41:38.728084 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:41:38.728084 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:41:38.728084 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:41:38.728084 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m20:41:38.728084 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m20:41:38.740966 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:41:38.740966 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:41:38.740966 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m20:41:38.740966 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:41:38.742443 [debug] [ThreadPool]: On create_takehome_dev_silver: Close
[0m20:41:38.742443 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m20:41:38.742443 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m20:41:38.751457 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:41:38.751457 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m20:41:38.751457 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m20:41:38.755096 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:41:38.755096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:38.755096 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m20:41:38.757019 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m20:41:38.758959 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:41:38.758959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:38.758959 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:41:38.758959 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m20:41:38.758959 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:41:38.761770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:38.761770 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:41:38.761770 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m20:41:38.761770 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:41:38.763776 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:41:38.763776 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m20:41:38.763776 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:41:38.765525 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m20:41:38.784245 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m20:41:38.784245 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:41:38.784245 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m20:41:38.788781 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m20:41:38.788781 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m20:41:38.788781 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m20:41:38.788781 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m20:41:38.788781 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m20:41:38.788781 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m20:41:38.788781 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m20:41:38.796477 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m20:41:38.796477 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m20:41:38.799775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C858086B0>]}
[0m20:41:38.799775 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:38.799775 [debug] [MainThread]: On master: BEGIN
[0m20:41:38.799775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:38.803056 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:41:38.803056 [debug] [MainThread]: On master: COMMIT
[0m20:41:38.803056 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:38.803056 [debug] [MainThread]: On master: COMMIT
[0m20:41:38.803056 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:41:38.803056 [debug] [MainThread]: On master: Close
[0m20:41:38.810175 [debug] [Thread-1 (]: Began running node model.takehome.stg_conditions
[0m20:41:38.811045 [debug] [Thread-2 (]: Began running node model.takehome.stg_documents
[0m20:41:38.811045 [debug] [Thread-3 (]: Began running node model.takehome.stg_lab_results
[0m20:41:38.811045 [debug] [Thread-4 (]: Began running node model.takehome.stg_med_admins
[0m20:41:38.811045 [info ] [Thread-1 (]: 1 of 14 START sql view model dev_staging.stg_conditions ........................ [RUN]
[0m20:41:38.811045 [info ] [Thread-2 (]: 2 of 14 START sql view model dev_staging.stg_documents ......................... [RUN]
[0m20:41:38.813752 [info ] [Thread-3 (]: 3 of 14 START sql view model dev_staging.stg_lab_results ....................... [RUN]
[0m20:41:38.813752 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_conditions'
[0m20:41:38.813752 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.takehome.stg_documents'
[0m20:41:38.813752 [info ] [Thread-4 (]: 4 of 14 START sql view model dev_staging.stg_med_admins ........................ [RUN]
[0m20:41:38.813752 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.stg_lab_results'
[0m20:41:38.813752 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_conditions
[0m20:41:38.813752 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_documents
[0m20:41:38.813752 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.takehome.stg_med_admins'
[0m20:41:38.813752 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_lab_results
[0m20:41:38.826012 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_conditions"
[0m20:41:38.829778 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_documents"
[0m20:41:38.829778 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_med_admins
[0m20:41:38.833521 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_lab_results"
[0m20:41:38.836527 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_med_admins"
[0m20:41:38.839516 [debug] [Thread-1 (]: Began executing node model.takehome.stg_conditions
[0m20:41:38.841043 [debug] [Thread-2 (]: Began executing node model.takehome.stg_documents
[0m20:41:38.843598 [debug] [Thread-3 (]: Began executing node model.takehome.stg_lab_results
[0m20:41:38.880701 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_lab_results"
[0m20:41:38.894813 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_documents"
[0m20:41:38.894813 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_conditions"
[0m20:41:38.894813 [debug] [Thread-4 (]: Began executing node model.takehome.stg_med_admins
[0m20:41:38.894813 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_med_admins"
[0m20:41:38.894813 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:41:38.894813 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: BEGIN
[0m20:41:38.904479 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:41:38.904479 [debug] [Thread-2 (]: On model.takehome.stg_documents: BEGIN
[0m20:41:38.904479 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:41:38.894813 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:41:38.907067 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:41:38.907067 [debug] [Thread-1 (]: On model.takehome.stg_conditions: BEGIN
[0m20:41:38.907067 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:41:38.907067 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:41:38.907067 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:41:38.907067 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:41:38.907067 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: BEGIN
[0m20:41:38.907067 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:41:38.907067 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:41:38.907067 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:41:38.907067 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:38.907067 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    -- Leer todos los JSON de src_data/lab_results
    select *
    from read_json_auto('src_data/lab_results/*.json')
),

flattened as (
    select
        testId::bigint            as test_id,
        orderId::bigint           as order_id,
        patientId::bigint         as patient_id,
        cast(resultDate as date)  as result_date,
        json_extract(value, '$.componentName')::varchar   as component_name,
        json_extract(value, '$.componentRefHi')::double   as component_ref_hi,
        json_extract(value, '$.componentRefLo')::double   as component_ref_lo,
        json_extract(value, '$.componentUnits')::varchar  as component_units,
        json_extract(value, '$.resultValue')::double      as result_value
    from raw_json
    -- testResults es un array; json_each lo explota en filas (key, value)
    cross join json_each(testResults)
)

select *
from flattened
  );

[0m20:41:38.907067 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

  
  create view "takehome"."dev_staging"."stg_documents__dbt_tmp" as (
    select
    document_id,
    patient_id,
    visit_id,
    document_line,
    document_text
from "takehome"."raw"."documents"
  );

[0m20:41:38.907067 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:41:38.907067 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:41:38.907067 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

  
  create view "takehome"."dev_staging"."stg_conditions__dbt_tmp" as (
    select
    id   as condition_id,
    name as condition_name
from "takehome"."raw"."conditions"
  );

[0m20:41:38.907067 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:41:38.915726 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

  
  create view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" as (
    select
    patient_id,
    patient_condition_id,
    medication_id,
    coalesce(date_stopped, date_started) as updated_at,
    date_started,
    date_stopped,
    dosage
from "takehome"."raw"."med_admins"
  );

[0m20:41:38.915726 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:41:38.915726 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:41:38.923034 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:41:38.928082 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:41:38.930650 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m20:41:38.931000 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents" rename to "stg_documents__dbt_backup"
[0m20:41:38.931000 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions" rename to "stg_conditions__dbt_backup"
[0m20:41:38.931000 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:41:38.931000 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins" rename to "stg_med_admins__dbt_backup"
[0m20:41:38.936543 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:41:38.939150 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:41:38.939150 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents__dbt_tmp" rename to "stg_documents"
[0m20:41:38.939150 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:41:38.945567 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:41:38.945567 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions__dbt_tmp" rename to "stg_conditions"
[0m20:41:38.945567 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m20:41:38.945567 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m20:41:38.958137 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m20:41:38.958137 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:41:38.958137 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m20:41:38.958137 [debug] [Thread-3 (]: SQL status: OK in 0.052 seconds
[0m20:41:38.958137 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:41:38.958137 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" rename to "stg_med_admins"
[0m20:41:38.968239 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m20:41:38.968239 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:41:38.968239 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m20:41:38.968239 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:41:38.968239 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */
alter view "takehome"."dev_staging"."stg_lab_results" rename to "stg_lab_results__dbt_backup"
[0m20:41:38.968239 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:41:38.968239 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m20:41:38.968239 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m20:41:38.968239 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:41:38.968239 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m20:41:38.968239 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:41:38.968239 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:41:38.983187 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:41:38.983187 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:41:38.984233 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:41:39.032414 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */
alter view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" rename to "stg_lab_results"
[0m20:41:39.037254 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:41:39.037254 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:41:39.041904 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:41:39.041904 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

      drop view if exists "takehome"."dev_staging"."stg_documents__dbt_backup" cascade
    
[0m20:41:39.041904 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:41:39.041904 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_conditions__dbt_backup" cascade
    
[0m20:41:39.041904 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

      drop view if exists "takehome"."dev_staging"."stg_med_admins__dbt_backup" cascade
    
[0m20:41:39.041904 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: COMMIT
[0m20:41:39.048232 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:41:39.048232 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: COMMIT
[0m20:41:39.048232 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:41:39.052279 [debug] [Thread-2 (]: On model.takehome.stg_documents: Close
[0m20:41:39.052279 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:41:39.052279 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: Close
[0m20:41:39.052279 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m20:41:39.059816 [debug] [Thread-1 (]: On model.takehome.stg_conditions: Close
[0m20:41:39.062003 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m20:41:39.064678 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:41:39.064678 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

      drop view if exists "takehome"."dev_staging"."stg_lab_results__dbt_backup" cascade
    
[0m20:41:39.064678 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C84CD8110>]}
[0m20:41:39.064678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8690F6B0>]}
[0m20:41:39.064678 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C84CD8A40>]}
[0m20:41:39.064678 [info ] [Thread-4 (]: 4 of 14 OK created sql view model dev_staging.stg_med_admins ................... [[32mOK[0m in 0.24s]
[0m20:41:39.064678 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:41:39.064678 [info ] [Thread-1 (]: 1 of 14 OK created sql view model dev_staging.stg_conditions ................... [[32mOK[0m in 0.25s]
[0m20:41:39.064678 [info ] [Thread-2 (]: 2 of 14 OK created sql view model dev_staging.stg_documents .................... [[32mOK[0m in 0.25s]
[0m20:41:39.071102 [debug] [Thread-4 (]: Finished running node model.takehome.stg_med_admins
[0m20:41:39.071102 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: Close
[0m20:41:39.071102 [debug] [Thread-1 (]: Finished running node model.takehome.stg_conditions
[0m20:41:39.071102 [debug] [Thread-2 (]: Finished running node model.takehome.stg_documents
[0m20:41:39.071102 [debug] [Thread-4 (]: Began running node model.takehome.stg_medications
[0m20:41:39.071102 [debug] [Thread-1 (]: Began running node model.takehome.stg_orders
[0m20:41:39.071102 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C84D2D160>]}
[0m20:41:39.071102 [debug] [Thread-2 (]: Began running node model.takehome.stg_patient_conditions
[0m20:41:39.071102 [info ] [Thread-4 (]: 5 of 14 START sql view model dev_staging.stg_medications ....................... [RUN]
[0m20:41:39.071102 [info ] [Thread-1 (]: 6 of 14 START sql view model dev_staging.stg_orders ............................ [RUN]
[0m20:41:39.083276 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_med_admins, now model.takehome.stg_medications)
[0m20:41:39.080931 [info ] [Thread-3 (]: 3 of 14 OK created sql view model dev_staging.stg_lab_results .................. [[32mOK[0m in 0.26s]
[0m20:41:39.084353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_conditions, now model.takehome.stg_orders)
[0m20:41:39.084353 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_medications
[0m20:41:39.084353 [debug] [Thread-3 (]: Finished running node model.takehome.stg_lab_results
[0m20:41:39.082112 [info ] [Thread-2 (]: 7 of 14 START sql view model dev_staging.stg_patient_conditions ................ [RUN]
[0m20:41:39.084353 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_orders
[0m20:41:39.090274 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_medications"
[0m20:41:39.093634 [debug] [Thread-3 (]: Began running node model.takehome.stg_patients
[0m20:41:39.093634 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_documents, now model.takehome.stg_patient_conditions)
[0m20:41:39.095366 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_orders"
[0m20:41:39.095366 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_patient_conditions
[0m20:41:39.095366 [info ] [Thread-3 (]: 8 of 14 START sql view model dev_staging.stg_patients .......................... [RUN]
[0m20:41:39.106766 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_patient_conditions"
[0m20:41:39.108781 [debug] [Thread-4 (]: Began executing node model.takehome.stg_medications
[0m20:41:39.108781 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_lab_results, now model.takehome.stg_patients)
[0m20:41:39.118373 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_medications"
[0m20:41:39.120376 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_patients
[0m20:41:39.122175 [debug] [Thread-1 (]: Began executing node model.takehome.stg_orders
[0m20:41:39.124616 [debug] [Thread-2 (]: Began executing node model.takehome.stg_patient_conditions
[0m20:41:39.132358 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m20:41:39.137121 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_orders"
[0m20:41:39.146204 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_patient_conditions"
[0m20:41:39.146204 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:41:39.150637 [debug] [Thread-4 (]: On model.takehome.stg_medications: BEGIN
[0m20:41:39.150637 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:39.154178 [debug] [Thread-3 (]: Began executing node model.takehome.stg_patients
[0m20:41:39.154945 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:41:39.154945 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:41:39.162506 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:41:39.162506 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m20:41:39.167085 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:41:39.167085 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: BEGIN
[0m20:41:39.167085 [debug] [Thread-1 (]: On model.takehome.stg_orders: BEGIN
[0m20:41:39.170320 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

  
  create view "takehome"."dev_staging"."stg_medications__dbt_tmp" as (
    select
    id   as medication_id,
    name as medication_name
from "takehome"."raw"."medications"
  );

[0m20:41:39.170320 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:39.173551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:39.175368 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:41:39.177905 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:41:39.178782 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:41:39.180366 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:41:39.187039 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:41:39.189896 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:41:39.189896 [debug] [Thread-3 (]: On model.takehome.stg_patients: BEGIN
[0m20:41:39.189896 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

  
  create view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" as (
    select
    id                     as patient_condition_id,
    patient_id,
    condition_id,
    coalesce(date_ended, date_started) as updated_at,
    date_started,
    date_ended
from "takehome"."raw"."patient_conditions"
  );

[0m20:41:39.189896 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications" rename to "stg_medications__dbt_backup"
[0m20:41:39.189896 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:41:39.195475 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:39.196501 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

  
  create view "takehome"."dev_staging"."stg_orders__dbt_tmp" as (
    select
    id            as order_id,
    patient_id,
    condition_id,
    order_date    as updated_at,
    order_date
from "takehome"."raw"."orders"
  );

[0m20:41:39.199292 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:41:39.199292 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:41:39.199292 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m20:41:39.207980 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:41:39.207980 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:41:39.212833 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:41:39.212833 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:41:39.212833 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions" rename to "stg_patient_conditions__dbt_backup"
[0m20:41:39.217564 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:41:39.217564 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications__dbt_tmp" rename to "stg_medications"
[0m20:41:39.217564 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id as patient_id,
    coalesce(
        date_deactivated,
        date_activated,
        date_of_death,
        date_of_birth
    )                                    as updated_at,
    first_name,
    last_name,
    ssn,
    date_of_birth,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_death,
    date_activated,
    date_deactivated
from "takehome"."raw"."patients"
  );

[0m20:41:39.220437 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:41:39.222406 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:41:39.224421 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:41:39.226436 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:41:39.230364 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:41:39.230364 [debug] [Thread-4 (]: On model.takehome.stg_medications: COMMIT
[0m20:41:39.230364 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:41:39.238272 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:41:39.238272 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" rename to "stg_patient_conditions"
[0m20:41:39.238272 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:41:39.246018 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:41:39.246018 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:41:39.246018 [debug] [Thread-4 (]: On model.takehome.stg_medications: COMMIT
[0m20:41:39.246018 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:41:39.246018 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:41:39.253739 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m20:41:39.253739 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:41:39.255860 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:41:39.255860 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:41:39.255860 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m20:41:39.260591 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:41:39.262051 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m20:41:39.263963 [debug] [Thread-1 (]: On model.takehome.stg_orders: COMMIT
[0m20:41:39.266153 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:41:39.266153 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:41:39.270448 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:41:39.270448 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:41:39.272309 [debug] [Thread-4 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

      drop view if exists "takehome"."dev_staging"."stg_medications__dbt_backup" cascade
    
[0m20:41:39.272309 [debug] [Thread-1 (]: On model.takehome.stg_orders: COMMIT
[0m20:41:39.272309 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:41:39.278875 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:41:39.280563 [debug] [Thread-3 (]: On model.takehome.stg_patients: COMMIT
[0m20:41:39.280563 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_patient_conditions__dbt_backup" cascade
    
[0m20:41:39.280563 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:41:39.280563 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:41:39.280563 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:41:39.280563 [debug] [Thread-3 (]: On model.takehome.stg_patients: COMMIT
[0m20:41:39.289168 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:41:39.289168 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:41:39.289168 [debug] [Thread-4 (]: On model.takehome.stg_medications: Close
[0m20:41:39.289168 [debug] [Thread-1 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

      drop view if exists "takehome"."dev_staging"."stg_orders__dbt_backup" cascade
    
[0m20:41:39.295468 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: Close
[0m20:41:39.295468 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:41:39.295468 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C857C4D40>]}
[0m20:41:39.300611 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8542A240>]}
[0m20:41:39.303760 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:41:39.303760 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:41:39.303760 [info ] [Thread-4 (]: 5 of 14 OK created sql view model dev_staging.stg_medications .................. [[32mOK[0m in 0.21s]
[0m20:41:39.303760 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

      drop view if exists "takehome"."dev_staging"."stg_patients__dbt_backup" cascade
    
[0m20:41:39.303760 [debug] [Thread-1 (]: On model.takehome.stg_orders: Close
[0m20:41:39.303760 [info ] [Thread-2 (]: 7 of 14 OK created sql view model dev_staging.stg_patient_conditions ........... [[32mOK[0m in 0.21s]
[0m20:41:39.303760 [debug] [Thread-4 (]: Finished running node model.takehome.stg_medications
[0m20:41:39.312418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C85878D40>]}
[0m20:41:39.312418 [debug] [Thread-2 (]: Finished running node model.takehome.stg_patient_conditions
[0m20:41:39.315572 [debug] [Thread-4 (]: Began running node model.takehome.stg_visits
[0m20:41:39.315572 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m20:41:39.315572 [debug] [Thread-2 (]: Began running node model.takehome.lab_results
[0m20:41:39.315572 [info ] [Thread-1 (]: 6 of 14 OK created sql view model dev_staging.stg_orders ....................... [[32mOK[0m in 0.23s]
[0m20:41:39.321153 [debug] [Thread-3 (]: On model.takehome.stg_patients: Close
[0m20:41:39.321153 [info ] [Thread-4 (]: 9 of 14 START sql view model dev_staging.stg_visits ............................ [RUN]
[0m20:41:39.321153 [debug] [Thread-1 (]: Finished running node model.takehome.stg_orders
[0m20:41:39.321153 [info ] [Thread-2 (]: 10 of 14 START sql table model dev_silver.lab_results .......................... [RUN]
[0m20:41:39.321153 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_medications, now model.takehome.stg_visits)
[0m20:41:39.329116 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C857B7350>]}
[0m20:41:39.329116 [debug] [Thread-1 (]: Began running node model.takehome.medications_per_month
[0m20:41:39.329116 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patient_conditions, now model.takehome.lab_results)
[0m20:41:39.329116 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_visits
[0m20:41:39.329116 [info ] [Thread-3 (]: 8 of 14 OK created sql view model dev_staging.stg_patients ..................... [[32mOK[0m in 0.22s]
[0m20:41:39.329116 [debug] [Thread-2 (]: Began compiling node model.takehome.lab_results
[0m20:41:39.329116 [info ] [Thread-1 (]: 11 of 14 START sql table model dev_silver.medications_per_month ................ [RUN]
[0m20:41:39.337856 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_visits"
[0m20:41:39.337856 [debug] [Thread-3 (]: Finished running node model.takehome.stg_patients
[0m20:41:39.346286 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.lab_results"
[0m20:41:39.346286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_orders, now model.takehome.medications_per_month)
[0m20:41:39.346286 [debug] [Thread-3 (]: Began running node model.takehome.patients
[0m20:41:39.346286 [debug] [Thread-1 (]: Began compiling node model.takehome.medications_per_month
[0m20:41:39.346286 [debug] [Thread-4 (]: Began executing node model.takehome.stg_visits
[0m20:41:39.354396 [debug] [Thread-2 (]: Began executing node model.takehome.lab_results
[0m20:41:39.357500 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.medications_per_month"
[0m20:41:39.346286 [info ] [Thread-3 (]: 12 of 14 START sql table model dev_bronze.patients ............................. [RUN]
[0m20:41:39.362051 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_visits"
[0m20:41:39.387627 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.lab_results"
[0m20:41:39.387627 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patients, now model.takehome.patients)
[0m20:41:39.387627 [debug] [Thread-3 (]: Began compiling node model.takehome.patients
[0m20:41:39.387627 [debug] [Thread-1 (]: Began executing node model.takehome.medications_per_month
[0m20:41:39.387627 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.patients"
[0m20:41:39.395361 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.medications_per_month"
[0m20:41:39.395361 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:41:39.395361 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:41:39.395361 [debug] [Thread-4 (]: On model.takehome.stg_visits: BEGIN
[0m20:41:39.395361 [debug] [Thread-3 (]: Began executing node model.takehome.patients
[0m20:41:39.395361 [debug] [Thread-2 (]: On model.takehome.lab_results: BEGIN
[0m20:41:39.395361 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:39.406487 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.patients"
[0m20:41:39.406487 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:41:39.406487 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:41:39.406487 [debug] [Thread-1 (]: On model.takehome.medications_per_month: BEGIN
[0m20:41:39.406487 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m20:41:39.406487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:39.406487 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:41:39.411800 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:41:39.411800 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m20:41:39.411800 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:41:39.411800 [debug] [Thread-4 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

  
  create view "takehome"."dev_staging"."stg_visits__dbt_tmp" as (
    select
    id                    as visit_id,
    visit_date            as updated_at,
    patient_condition_id,
    visit_date
from "takehome"."raw"."visits"
  );

[0m20:41:39.411800 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:41:39.411800 [debug] [Thread-3 (]: On model.takehome.patients: BEGIN
[0m20:41:39.411800 [debug] [Thread-2 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

  
    
    

    create  table
      "takehome"."dev_silver"."lab_results__dbt_tmp"
  
    as (
      select *
from "takehome"."dev_staging"."stg_lab_results"
    );
  
  
[0m20:41:39.411800 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:41:39.411800 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:39.411800 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:41:39.411800 [debug] [Thread-1 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."medications_per_month__dbt_tmp"
  
    as (
      with med_admins as (
    select
        patient_id,
        medication_id,
        date_started
    from "takehome"."dev_staging"."stg_med_admins"
    where date_started is not null
),

meds as (
    select
        medication_id,
        medication_name
    from "takehome"."dev_staging"."stg_medications"
),

med_admins_month as (
    select
        date_trunc('month', date_started) as month,
        medication_id,
        patient_id
    from med_admins
)

select
    m.month,
    med.medication_id,
    med.medication_name,
    count(*)                     as administrations,
    count(distinct m.patient_id) as patients_treated
from med_admins_month m
join meds med
    on m.medication_id = med.medication_id
group by 1,2,3
order by 1,2
    );
  
  
[0m20:41:39.411800 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:41:39.411800 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:41:39.411800 [debug] [Thread-4 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits" rename to "stg_visits__dbt_backup"
[0m20:41:39.411800 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m20:41:39.424306 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      

with 

pt as ( select * from "takehome"."dev_staging"."stg_patients" )

select
    *
    
from pt

qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m20:41:39.425148 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:41:39.430144 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:41:39.432520 [debug] [Thread-4 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits__dbt_tmp" rename to "stg_visits"
[0m20:41:39.432520 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:41:39.437105 [debug] [Thread-4 (]: On model.takehome.stg_visits: COMMIT
[0m20:41:39.437105 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:41:39.437105 [debug] [Thread-4 (]: On model.takehome.stg_visits: COMMIT
[0m20:41:39.440945 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:41:39.445195 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m20:41:39.445195 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:41:39.457034 [debug] [Thread-4 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

      drop view if exists "takehome"."dev_staging"."stg_visits__dbt_backup" cascade
    
[0m20:41:39.457034 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:41:39.457034 [debug] [Thread-1 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m20:41:39.457034 [debug] [Thread-3 (]: SQL status: OK in 0.036 seconds
[0m20:41:39.457034 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m20:41:39.457034 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m20:41:39.457034 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:41:39.466127 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:41:39.467563 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:41:39.467563 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m20:41:39.467563 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m20:41:39.467563 [debug] [Thread-1 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m20:41:39.467563 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m20:41:39.472669 [debug] [Thread-4 (]: On model.takehome.stg_visits: Close
[0m20:41:39.472669 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C86935DC0>]}
[0m20:41:39.472669 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:41:39.472669 [info ] [Thread-4 (]: 9 of 14 OK created sql view model dev_staging.stg_visits ....................... [[32mOK[0m in 0.15s]
[0m20:41:39.480240 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m20:41:39.482249 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:41:39.482249 [debug] [Thread-4 (]: Finished running node model.takehome.stg_visits
[0m20:41:39.482249 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients" rename to "patients__dbt_backup"
[0m20:41:39.488402 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:41:39.490469 [debug] [Thread-1 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month" rename to "medications_per_month__dbt_backup"
[0m20:41:39.491638 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:41:39.495708 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m20:41:39.495708 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients__dbt_tmp" rename to "patients"
[0m20:41:39.499801 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:41:39.499801 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:41:39.504565 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:41:39.510738 [debug] [Thread-3 (]: On model.takehome.patients: COMMIT
[0m20:41:39.512157 [debug] [Thread-1 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month__dbt_tmp" rename to "medications_per_month"
[0m20:41:39.512157 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m20:41:39.512157 [debug] [Thread-3 (]: On model.takehome.patients: COMMIT
[0m20:41:39.512157 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:39.512157 [debug] [Thread-1 (]: On model.takehome.medications_per_month: COMMIT
[0m20:41:39.518862 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:41:39.522909 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients"
[0m20:41:39.512157 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:41:39.522909 [debug] [Thread-3 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

      drop table if exists "takehome"."dev_bronze"."patients__dbt_backup" cascade
    
[0m20:41:39.522909 [debug] [Thread-1 (]: On model.takehome.medications_per_month: COMMIT
[0m20:41:39.522909 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:41:39.530720 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:41:39.530720 [debug] [Thread-1 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

      drop table if exists "takehome"."dev_silver"."medications_per_month__dbt_backup" cascade
    
[0m20:41:39.530720 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:41:39.530720 [debug] [Thread-3 (]: On model.takehome.patients: Close
[0m20:41:39.530720 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C85451AF0>]}
[0m20:41:39.535257 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:41:39.537801 [debug] [Thread-1 (]: On model.takehome.medications_per_month: Close
[0m20:41:39.535257 [info ] [Thread-3 (]: 12 of 14 OK created sql table model dev_bronze.patients ........................ [[32mOK[0m in 0.14s]
[0m20:41:39.537801 [debug] [Thread-3 (]: Finished running node model.takehome.patients
[0m20:41:39.537801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8547D190>]}
[0m20:41:39.537801 [info ] [Thread-1 (]: 11 of 14 OK created sql table model dev_silver.medications_per_month ........... [[32mOK[0m in 0.19s]
[0m20:41:39.537801 [debug] [Thread-1 (]: Finished running node model.takehome.medications_per_month
[0m20:41:39.537801 [debug] [Thread-4 (]: Began running node model.takehome.patients_by_age
[0m20:41:39.543480 [debug] [Thread-3 (]: Began running node model.takehome.patients_per_month
[0m20:41:39.537801 [info ] [Thread-4 (]: 13 of 14 START sql table model dev_silver.patients_by_age ...................... [RUN]
[0m20:41:39.544851 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_visits, now model.takehome.patients_by_age)
[0m20:41:39.545718 [debug] [Thread-4 (]: Began compiling node model.takehome.patients_by_age
[0m20:41:39.550703 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.patients_by_age"
[0m20:41:39.543480 [info ] [Thread-3 (]: 14 of 14 START sql table model dev_silver.patients_per_month ................... [RUN]
[0m20:41:39.555126 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.patients, now model.takehome.patients_per_month)
[0m20:41:39.555126 [debug] [Thread-3 (]: Began compiling node model.takehome.patients_per_month
[0m20:41:39.559156 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.patients_per_month"
[0m20:41:39.561165 [debug] [Thread-4 (]: Began executing node model.takehome.patients_by_age
[0m20:41:39.568818 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.patients_by_age"
[0m20:41:39.570380 [debug] [Thread-3 (]: Began executing node model.takehome.patients_per_month
[0m20:41:39.572765 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.patients_per_month"
[0m20:41:39.572765 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:41:39.579093 [debug] [Thread-4 (]: On model.takehome.patients_by_age: BEGIN
[0m20:41:39.579093 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:41:39.581925 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:41:39.581925 [debug] [Thread-3 (]: On model.takehome.patients_per_month: BEGIN
[0m20:41:39.581925 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:41:39.581925 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:41:39.581925 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:41:39.581925 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:41:39.587072 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:41:39.587072 [debug] [Thread-4 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_by_age__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_of_birth,
        gender,
        race,
        ethnicity,
        smoker,
        drinks_per_week,
        date_activated,
        date_deactivated,
        date_of_death
    from "takehome"."dev_bronze"."patients"
)

select
    patient_id,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_birth,
    date_activated,
    date_deactivated,
    date_of_death,
    date_diff('year', date_of_birth, current_date) as age,
    case
        when date_of_birth is null then 'unknown'
        when date_diff('year', date_of_birth, current_date) < 18 then '0-17'
        when date_diff('year', date_of_birth, current_date) between 18 and 34 then '18-34'
        when date_diff('year', date_of_birth, current_date) between 35 and 49 then '35-49'
        when date_diff('year', date_of_birth, current_date) between 50 and 64 then '50-64'
        else '65+'
    end as age_group
from patients
    );
  
  
[0m20:41:39.587072 [debug] [Thread-3 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_per_month__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_activated,
        gender
    from "takehome"."dev_bronze"."patients"
    where date_activated is not null
),

patients_by_month as (
    select
        date_trunc('month', date_activated)                           as month,
        count(*)                                                      as new_patients,
        count(distinct case when gender = 'M' then patient_id end)    as new_patients_male,
        count(distinct case when gender = 'F' then patient_id end)    as new_patients_female
    from patients
    group by 1
)

select *
from patients_by_month
order by month
    );
  
  
[0m20:41:39.594450 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:41:39.595459 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:41:39.595459 [debug] [Thread-4 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m20:41:39.595459 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:41:39.603920 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m20:41:39.605261 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:41:39.605261 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:41:39.605261 [debug] [Thread-4 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m20:41:39.605261 [debug] [Thread-3 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m20:41:39.605261 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:41:39.612395 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:41:39.612395 [debug] [Thread-4 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age" rename to "patients_by_age__dbt_backup"
[0m20:41:39.612395 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:41:39.612395 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:41:39.612395 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:41:39.620457 [debug] [Thread-4 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age__dbt_tmp" rename to "patients_by_age"
[0m20:41:39.620457 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:41:39.620457 [debug] [Thread-3 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m20:41:39.620457 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:41:39.620457 [debug] [Thread-4 (]: On model.takehome.patients_by_age: COMMIT
[0m20:41:39.620457 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:41:39.620457 [debug] [Thread-4 (]: On model.takehome.patients_by_age: COMMIT
[0m20:41:39.628471 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:41:39.628471 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:41:39.628471 [debug] [Thread-3 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month" rename to "patients_per_month__dbt_backup"
[0m20:41:39.628471 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:41:39.628471 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:41:39.628471 [debug] [Thread-4 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

      drop table if exists "takehome"."dev_silver"."patients_by_age__dbt_backup" cascade
    
[0m20:41:39.628471 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:41:39.628471 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:41:39.628471 [debug] [Thread-3 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month__dbt_tmp" rename to "patients_per_month"
[0m20:41:39.628471 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:41:39.644132 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m20:41:39.646465 [debug] [Thread-3 (]: On model.takehome.patients_per_month: COMMIT
[0m20:41:39.646465 [debug] [Thread-4 (]: On model.takehome.patients_by_age: Close
[0m20:41:39.646465 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:41:39.646465 [debug] [Thread-3 (]: On model.takehome.patients_per_month: COMMIT
[0m20:41:39.646465 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C868E91F0>]}
[0m20:41:39.651242 [info ] [Thread-4 (]: 13 of 14 OK created sql table model dev_silver.patients_by_age ................. [[32mOK[0m in 0.10s]
[0m20:41:39.651242 [debug] [Thread-4 (]: Finished running node model.takehome.patients_by_age
[0m20:41:39.653403 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:41:39.653403 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:41:39.653403 [debug] [Thread-3 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

      drop table if exists "takehome"."dev_silver"."patients_per_month__dbt_backup" cascade
    
[0m20:41:39.661165 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:41:39.662866 [debug] [Thread-3 (]: On model.takehome.patients_per_month: Close
[0m20:41:39.664876 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C85429610>]}
[0m20:41:39.666884 [info ] [Thread-3 (]: 14 of 14 OK created sql table model dev_silver.patients_per_month .............. [[32mOK[0m in 0.11s]
[0m20:41:39.666884 [debug] [Thread-3 (]: Finished running node model.takehome.patients_per_month
[0m20:41:42.635118 [debug] [Thread-2 (]: SQL status: OK in 3.221 seconds
[0m20:41:42.635118 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:41:42.635118 [debug] [Thread-2 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'lab_results'
  
[0m20:41:42.635118 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:41:42.635118 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:41:42.635118 [debug] [Thread-2 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'lab_results'
  
[0m20:41:42.635118 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:41:42.635118 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:41:42.635118 [debug] [Thread-2 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */
alter table "takehome"."dev_silver"."lab_results" rename to "lab_results__dbt_backup"
[0m20:41:42.635118 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:41:42.651048 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:41:42.651048 [debug] [Thread-2 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */
alter table "takehome"."dev_silver"."lab_results__dbt_tmp" rename to "lab_results"
[0m20:41:42.651048 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:41:42.656583 [debug] [Thread-2 (]: On model.takehome.lab_results: COMMIT
[0m20:41:42.656583 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:41:42.656583 [debug] [Thread-2 (]: On model.takehome.lab_results: COMMIT
[0m20:41:42.656583 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m20:41:42.666851 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:41:42.666851 [debug] [Thread-2 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

      drop table if exists "takehome"."dev_silver"."lab_results__dbt_backup" cascade
    
[0m20:41:42.666851 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:41:42.666851 [debug] [Thread-2 (]: On model.takehome.lab_results: Close
[0m20:41:42.666851 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ffc9f77-fb76-4dc1-af17-039d916c1377', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8693E180>]}
[0m20:41:42.666851 [info ] [Thread-2 (]: 10 of 14 OK created sql table model dev_silver.lab_results ..................... [[32mOK[0m in 3.34s]
[0m20:41:42.666851 [debug] [Thread-2 (]: Finished running node model.takehome.lab_results
[0m20:41:42.666851 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:42.666851 [debug] [MainThread]: On master: BEGIN
[0m20:41:42.666851 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:42.666851 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:41:42.666851 [debug] [MainThread]: On master: COMMIT
[0m20:41:42.666851 [debug] [MainThread]: Using duckdb connection "master"
[0m20:41:42.666851 [debug] [MainThread]: On master: COMMIT
[0m20:41:42.666851 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:41:42.682809 [debug] [MainThread]: On master: Close
[0m20:41:42.682809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:42.682809 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m20:41:42.682809 [debug] [MainThread]: Connection 'create_takehome_dev_silver' was properly closed.
[0m20:41:42.684543 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m20:41:42.684543 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m20:41:42.684543 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m20:41:42.684543 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m20:41:42.684543 [debug] [MainThread]: Connection 'model.takehome.medications_per_month' was properly closed.
[0m20:41:42.684543 [debug] [MainThread]: Connection 'model.takehome.lab_results' was properly closed.
[0m20:41:42.684543 [debug] [MainThread]: Connection 'model.takehome.patients_per_month' was properly closed.
[0m20:41:42.686619 [debug] [MainThread]: Connection 'model.takehome.patients_by_age' was properly closed.
[0m20:41:42.686619 [info ] [MainThread]: 
[0m20:41:42.686619 [info ] [MainThread]: Finished running 5 table models, 9 view models in 0 hours 0 minutes and 4.10 seconds (4.10s).
[0m20:41:42.690672 [debug] [MainThread]: Command end result
[0m20:41:42.734164 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:41:42.738379 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:41:42.746052 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m20:41:42.746721 [info ] [MainThread]: 
[0m20:41:42.747260 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:42.748510 [info ] [MainThread]: 
[0m20:41:42.749517 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m20:41:42.751233 [debug] [MainThread]: Command `dbt run` succeeded at 20:41:42.751233 after 5.10 seconds
[0m20:41:42.751772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C84A92AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C8513C380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C83A2FE00>]}
[0m20:41:42.752368 [debug] [MainThread]: Flushing usage events
[0m20:41:45.126448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:58.220555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002533C702E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002533BFEAAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002533BFEADB0>]}


============================== 20:56:58.231017 | 95a07502-0e00-4150-8fe0-ce8b435bbce8 ==============================
[0m20:56:58.231017 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:56:58.231017 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'printer_width': '80', 'invocation_command': 'dbt run -s patient_results patient_risk_flags', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m20:56:58.493933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95a07502-0e00-4150-8fe0-ce8b435bbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002533CAD4B00>]}
[0m20:56:58.557251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95a07502-0e00-4150-8fe0-ce8b435bbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002533E23DCD0>]}
[0m20:56:58.560105 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:56:58.724078 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:56:58.985415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 10 files changed.
[0m20:56:58.985415 [debug] [MainThread]: Partial parsing: added file: takehome://dbt/models\marts\summary\patient_risk_flags.sql
[0m20:56:58.985415 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\_stg_sources.yml
[0m20:56:58.985415 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\_stg_models.yml
[0m20:56:58.985415 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\summary\_mart_summary_models.yml
[0m20:56:58.985415 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\silver\_mart_silver_models.yml
[0m20:56:58.985415 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\intermediate\patient_results.sql
[0m20:56:58.985415 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\summary\patients_by_age.sql
[0m20:56:58.985415 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\summary\medications_per_month.sql
[0m20:56:58.985415 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\intermediate\patients.sql
[0m20:56:58.985415 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\staging\stg_lab_results.sql
[0m20:56:58.985415 [debug] [MainThread]: Partial parsing: updated file: takehome://dbt/models\marts\summary\patients_per_month.sql
[0m20:56:59.442623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95a07502-0e00-4150-8fe0-ce8b435bbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002533EAC2930>]}
[0m20:56:59.566579 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:56:59.566579 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:56:59.614780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95a07502-0e00-4150-8fe0-ce8b435bbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002533ED8B050>]}
[0m20:56:59.614780 [info ] [MainThread]: Found 16 models, 23 data tests, 8 sources, 468 macros
[0m20:56:59.614780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95a07502-0e00-4150-8fe0-ce8b435bbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002533ED51A30>]}
[0m20:56:59.614780 [info ] [MainThread]: 
[0m20:56:59.614780 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:56:59.614780 [info ] [MainThread]: 
[0m20:56:59.614780 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:56:59.631718 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:56:59.631718 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:56:59.696231 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:56:59.696231 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:56:59.696231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:59.696231 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:56:59.696231 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:56:59.696231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:59.727437 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m20:56:59.727437 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m20:56:59.727437 [debug] [ThreadPool]: On list_takehome: Close
[0m20:56:59.727437 [debug] [ThreadPool]: On list_takehome: Close
[0m20:56:59.727437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_silver)
[0m20:56:59.727437 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_silver"
"
[0m20:56:59.743310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m20:56:59.743310 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m20:56:59.743310 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:56:59.743310 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:56:59.748460 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:56:59.748460 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:56:59.748460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:59.748460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:59.748460 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:56:59.748460 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:56:59.748460 [debug] [ThreadPool]: On create_takehome_dev_silver: BEGIN
[0m20:56:59.748460 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:56:59.748460 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:56:59.748460 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m20:56:59.755811 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:56:59.755811 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:56:59.755811 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
    
        create schema if not exists "takehome"."dev_silver"
    
[0m20:56:59.755811 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:59.755811 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:56:59.755811 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m20:56:59.755811 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:59.758965 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:56:59.758965 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:56:59.760975 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:56:59.760975 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:56:59.760975 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m20:56:59.760975 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:56:59.760975 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m20:56:59.760975 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:56:59.760975 [debug] [ThreadPool]: On create_takehome_dev_silver: Close
[0m20:56:59.760975 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:56:59.760975 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m20:56:59.760975 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m20:56:59.771529 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:56:59.771529 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m20:56:59.771529 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m20:56:59.771529 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:56:59.775047 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m20:56:59.775047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:59.775047 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m20:56:59.775047 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:56:59.775047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:59.775047 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m20:56:59.775047 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:56:59.775047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:59.775047 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:56:59.775047 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:56:59.775047 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m20:56:59.775047 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:56:59.775047 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m20:56:59.775047 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:56:59.800800 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:56:59.800800 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m20:56:59.800800 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:56:59.800800 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m20:56:59.800800 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m20:56:59.800800 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m20:56:59.808494 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m20:56:59.808494 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m20:56:59.810521 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m20:56:59.810521 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m20:56:59.810521 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m20:56:59.814793 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m20:56:59.814793 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m20:56:59.814793 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m20:56:59.814793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95a07502-0e00-4150-8fe0-ce8b435bbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002533C499850>]}
[0m20:56:59.814793 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:59.814793 [debug] [MainThread]: On master: BEGIN
[0m20:56:59.814793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:59.814793 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:56:59.814793 [debug] [MainThread]: On master: COMMIT
[0m20:56:59.814793 [debug] [MainThread]: Using duckdb connection "master"
[0m20:56:59.814793 [debug] [MainThread]: On master: COMMIT
[0m20:56:59.814793 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:56:59.814793 [debug] [MainThread]: On master: Close
[0m20:56:59.823003 [debug] [Thread-1 (]: Began running node model.takehome.patient_results
[0m20:56:59.823003 [info ] [Thread-1 (]: 1 of 2 START sql incremental model dev_bronze.patient_results .................. [RUN]
[0m20:56:59.829670 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.patient_results'
[0m20:56:59.829670 [debug] [Thread-1 (]: Began compiling node model.takehome.patient_results
[0m20:56:59.838039 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.patient_results"
[0m20:56:59.839681 [debug] [Thread-1 (]: Began executing node model.takehome.patient_results
[0m20:56:59.879626 [debug] [Thread-1 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m20:56:59.895339 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.patient_results"
[0m20:56:59.895339 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patient_results"
[0m20:56:59.906220 [debug] [Thread-1 (]: On model.takehome.patient_results: BEGIN
[0m20:56:59.906220 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:56:59.906220 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:56:59.906220 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patient_results"
[0m20:56:59.906220 [debug] [Thread-1 (]: On model.takehome.patient_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_results"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patient_results"
  
    as (
      
with labs as (
    select
        lr.patient_id,
        lr.result_date,
        lr.component_name,
        lr.component_units,
        lr.result_value,
        lr.component_ref_lo,
        lr.component_ref_hi,
        case
            when lr.result_value < lr.component_ref_lo
              or lr.result_value > lr.component_ref_hi
            then true
            else false
        end as out_of_range
    from "takehome"."dev_staging"."stg_lab_results" lr

    
),

patients as (
    select
        patient_id,
        first_name,
        last_name,
        gender,
        date_of_birth
    from "takehome"."dev_staging"."stg_patients"
)

select
    p.patient_id,
    p.first_name,
    p.last_name,
    p.gender,
    p.date_of_birth,
    l.result_date,
    l.component_name,
    l.component_units,
    l.result_value,
    l.component_ref_lo,
    l.component_ref_hi,
    l.out_of_range
from labs l
left join patients p
    on p.patient_id = l.patient_id
    );
  
  
  
[0m20:57:03.013929 [debug] [Thread-1 (]: SQL status: OK in 3.104 seconds
[0m20:57:03.018031 [debug] [Thread-1 (]: On model.takehome.patient_results: COMMIT
[0m20:57:03.018031 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patient_results"
[0m20:57:03.018031 [debug] [Thread-1 (]: On model.takehome.patient_results: COMMIT
[0m20:57:03.027557 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:57:03.027557 [debug] [Thread-1 (]: On model.takehome.patient_results: Close
[0m20:57:03.027557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a07502-0e00-4150-8fe0-ce8b435bbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025339F0BCB0>]}
[0m20:57:03.027557 [info ] [Thread-1 (]: 1 of 2 OK created sql incremental model dev_bronze.patient_results ............. [[32mOK[0m in 3.20s]
[0m20:57:03.027557 [debug] [Thread-1 (]: Finished running node model.takehome.patient_results
[0m20:57:03.027557 [debug] [Thread-3 (]: Began running node model.takehome.patient_risk_flags
[0m20:57:03.043277 [info ] [Thread-3 (]: 2 of 2 START sql table model dev_silver.patient_risk_flags ..................... [RUN]
[0m20:57:03.043277 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.patient_risk_flags'
[0m20:57:03.043277 [debug] [Thread-3 (]: Began compiling node model.takehome.patient_risk_flags
[0m20:57:03.043277 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.patient_risk_flags"
[0m20:57:03.043277 [debug] [Thread-3 (]: Began executing node model.takehome.patient_risk_flags
[0m20:57:03.058954 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.patient_risk_flags"
[0m20:57:03.060124 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m20:57:03.061342 [debug] [Thread-3 (]: On model.takehome.patient_risk_flags: BEGIN
[0m20:57:03.062261 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:57:03.063650 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:57:03.063650 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m20:57:03.063650 [debug] [Thread-3 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patient_risk_flags__dbt_tmp"
  
    as (
      with conds as (
    select
        pc.patient_id,
        count(distinct pc.condition_id) as n_conditions
    from "takehome"."dev_staging"."stg_patient_conditions" pc
    group by pc.patient_id
),

labs as (
    select
        pr.patient_id,
        count(*) filter (where pr.out_of_range) as n_abnormal_labs
    from "takehome"."dev_bronze"."patient_results" pr
    group by pr.patient_id
),

base as (
    select
        coalesce(c.patient_id, l.patient_id) as patient_id,
        coalesce(c.n_conditions, 0)         as n_conditions,
        coalesce(l.n_abnormal_labs, 0)      as n_abnormal_labs
    from conds c
    full outer join labs l
      on c.patient_id = l.patient_id
)

select
    patient_id,
    n_conditions,
    n_abnormal_labs,
    case
        when n_abnormal_labs >= 3
          or n_conditions    >= 5
        then true
        else false
    end as high_risk_flag
from base
    );
  
  
[0m20:57:03.077114 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m20:57:03.092418 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m20:57:03.092418 [debug] [Thread-3 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */
alter table "takehome"."dev_silver"."patient_risk_flags__dbt_tmp" rename to "patient_risk_flags"
[0m20:57:03.092418 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:57:03.092418 [debug] [Thread-3 (]: On model.takehome.patient_risk_flags: COMMIT
[0m20:57:03.092418 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m20:57:03.092418 [debug] [Thread-3 (]: On model.takehome.patient_risk_flags: COMMIT
[0m20:57:03.100737 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:57:03.108732 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m20:57:03.108732 [debug] [Thread-3 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */

      drop table if exists "takehome"."dev_silver"."patient_risk_flags__dbt_backup" cascade
    
[0m20:57:03.108732 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:57:03.108732 [debug] [Thread-3 (]: On model.takehome.patient_risk_flags: Close
[0m20:57:03.108732 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a07502-0e00-4150-8fe0-ce8b435bbce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025340018140>]}
[0m20:57:03.108732 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev_silver.patient_risk_flags ................ [[32mOK[0m in 0.07s]
[0m20:57:03.113445 [debug] [Thread-3 (]: Finished running node model.takehome.patient_risk_flags
[0m20:57:03.113445 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:03.116939 [debug] [MainThread]: On master: BEGIN
[0m20:57:03.116939 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:57:03.116939 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:57:03.116939 [debug] [MainThread]: On master: COMMIT
[0m20:57:03.116939 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:03.116939 [debug] [MainThread]: On master: COMMIT
[0m20:57:03.116939 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:57:03.116939 [debug] [MainThread]: On master: Close
[0m20:57:03.116939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:03.116939 [debug] [MainThread]: Connection 'create_takehome_dev_silver' was properly closed.
[0m20:57:03.116939 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m20:57:03.116939 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m20:57:03.116939 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m20:57:03.116939 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m20:57:03.116939 [debug] [MainThread]: Connection 'model.takehome.patient_results' was properly closed.
[0m20:57:03.116939 [debug] [MainThread]: Connection 'model.takehome.patient_risk_flags' was properly closed.
[0m20:57:03.116939 [info ] [MainThread]: 
[0m20:57:03.116939 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m20:57:03.116939 [debug] [MainThread]: Command end result
[0m20:57:03.146731 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:57:03.152008 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:57:03.158704 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m20:57:03.158704 [info ] [MainThread]: 
[0m20:57:03.158704 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:03.158704 [info ] [MainThread]: 
[0m20:57:03.163858 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m20:57:03.163858 [debug] [MainThread]: Command `dbt run` succeeded at 20:57:03.163858 after 5.17 seconds
[0m20:57:03.166623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025339DA0170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025336A49700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002533BFC6750>]}
[0m20:57:03.167153 [debug] [MainThread]: Flushing usage events
[0m20:57:05.013174 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:39.890561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E28F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E16C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0D71A300>]}


============================== 20:57:39.892962 | e915c603-72df-4640-8edf-fcfef8df5de6 ==============================
[0m20:57:39.892962 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:57:39.892962 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt test -s patient_results patient_risk_flags', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m20:57:40.113899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e915c603-72df-4640-8edf-fcfef8df5de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E8AFC20>]}
[0m20:57:40.155578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e915c603-72df-4640-8edf-fcfef8df5de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0A762000>]}
[0m20:57:40.155578 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:57:40.317999 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:57:40.437921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:57:40.437921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:57:40.467260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e915c603-72df-4640-8edf-fcfef8df5de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0F912A80>]}
[0m20:57:40.547560 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:57:40.551581 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:57:40.578813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e915c603-72df-4640-8edf-fcfef8df5de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D10433B90>]}
[0m20:57:40.578813 [info ] [MainThread]: Found 16 models, 23 data tests, 8 sources, 468 macros
[0m20:57:40.578813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e915c603-72df-4640-8edf-fcfef8df5de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D1030AB40>]}
[0m20:57:40.578813 [info ] [MainThread]: 
[0m20:57:40.578813 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:57:40.578813 [info ] [MainThread]: 
[0m20:57:40.578813 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:57:40.597368 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m20:57:40.611094 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m20:57:40.612142 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m20:57:40.651761 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:57:40.651761 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m20:57:40.660265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:40.660265 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:57:40.660265 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m20:57:40.660265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:40.660265 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:57:40.660265 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m20:57:40.660265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:40.690757 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m20:57:40.690757 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:57:40.690757 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m20:57:40.690757 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m20:57:40.690757 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:57:40.690757 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m20:57:40.690757 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m20:57:40.690757 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:57:40.690757 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m20:57:40.710341 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:57:40.710341 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m20:57:40.712349 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:57:40.712349 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:57:40.712349 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m20:57:40.712349 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m20:57:40.716213 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m20:57:40.717727 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m20:57:40.717727 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m20:57:40.719211 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m20:57:40.719211 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m20:57:40.719211 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m20:57:40.719211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e915c603-72df-4640-8edf-fcfef8df5de6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0BB32B40>]}
[0m20:57:40.719211 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:40.719211 [debug] [MainThread]: On master: BEGIN
[0m20:57:40.719211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:40.725710 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:57:40.725710 [debug] [MainThread]: On master: COMMIT
[0m20:57:40.725710 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:40.725710 [debug] [MainThread]: On master: COMMIT
[0m20:57:40.725710 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:57:40.725710 [debug] [MainThread]: On master: Close
[0m20:57:40.731996 [debug] [Thread-1 (]: Began running node test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d
[0m20:57:40.731996 [debug] [Thread-2 (]: Began running node test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57
[0m20:57:40.731996 [info ] [Thread-1 (]: 1 of 3 START test not_null_patient_risk_flags_high_risk_flag ................... [RUN]
[0m20:57:40.731996 [debug] [Thread-3 (]: Began running node test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b
[0m20:57:40.731996 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d'
[0m20:57:40.731996 [info ] [Thread-2 (]: 2 of 3 START test not_null_patient_risk_flags_patient_id ....................... [RUN]
[0m20:57:40.731996 [info ] [Thread-3 (]: 3 of 3 START test unique_patient_risk_flags_patient_id ......................... [RUN]
[0m20:57:40.731996 [debug] [Thread-1 (]: Began compiling node test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d
[0m20:57:40.731996 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57'
[0m20:57:40.749042 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57
[0m20:57:40.731996 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b'
[0m20:57:40.761156 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"
[0m20:57:40.761156 [debug] [Thread-3 (]: Began compiling node test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b
[0m20:57:40.763869 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"
[0m20:57:40.763869 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"
[0m20:57:40.772526 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57
[0m20:57:40.789039 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"
[0m20:57:40.789039 [debug] [Thread-1 (]: Began executing node test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d
[0m20:57:40.795021 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"
[0m20:57:40.795021 [debug] [Thread-3 (]: Began executing node test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b
[0m20:57:40.796900 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"
[0m20:57:40.796900 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"
[0m20:57:40.796900 [debug] [Thread-2 (]: On test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57: BEGIN
[0m20:57:40.796900 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:57:40.796900 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"
[0m20:57:40.796900 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"
[0m20:57:40.796900 [debug] [Thread-1 (]: On test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d: BEGIN
[0m20:57:40.796900 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:57:40.796900 [debug] [Thread-3 (]: On test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b: BEGIN
[0m20:57:40.796900 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:57:40.796900 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"
[0m20:57:40.805663 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:57:40.805663 [debug] [Thread-2 (]: On test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_silver"."patient_risk_flags"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m20:57:40.805663 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:57:40.805663 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"
[0m20:57:40.805663 [debug] [Thread-1 (]: On test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select high_risk_flag
from "takehome"."dev_silver"."patient_risk_flags"
where high_risk_flag is null



  
  
      
    ) dbt_internal_test
[0m20:57:40.805663 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:57:40.805663 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"
[0m20:57:40.805663 [debug] [Thread-3 (]: On test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_silver"."patient_risk_flags"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:57:40.805663 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:57:40.805663 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:57:40.815772 [debug] [Thread-1 (]: On test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d: ROLLBACK
[0m20:57:40.817780 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d'
[0m20:57:40.817780 [debug] [Thread-1 (]: On test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d: Close
[0m20:57:40.817780 [debug] [Thread-2 (]: On test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57: ROLLBACK
[0m20:57:40.817780 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57'
[0m20:57:40.817780 [debug] [Thread-2 (]: On test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57: Close
[0m20:57:40.817780 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m20:57:40.817780 [debug] [Thread-3 (]: On test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b: ROLLBACK
[0m20:57:40.817780 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b'
[0m20:57:40.817780 [debug] [Thread-3 (]: On test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b: Close
[0m20:57:40.817780 [info ] [Thread-1 (]: 1 of 3 PASS not_null_patient_risk_flags_high_risk_flag ......................... [[32mPASS[0m in 0.09s]
[0m20:57:40.817780 [debug] [Thread-1 (]: Finished running node test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d
[0m20:57:40.817780 [info ] [Thread-2 (]: 2 of 3 PASS not_null_patient_risk_flags_patient_id ............................. [[32mPASS[0m in 0.09s]
[0m20:57:40.817780 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57
[0m20:57:40.817780 [info ] [Thread-3 (]: 3 of 3 PASS unique_patient_risk_flags_patient_id ............................... [[32mPASS[0m in 0.09s]
[0m20:57:40.827998 [debug] [Thread-3 (]: Finished running node test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b
[0m20:57:40.830404 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:40.832137 [debug] [MainThread]: On master: BEGIN
[0m20:57:40.832137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:57:40.832137 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:57:40.832137 [debug] [MainThread]: On master: COMMIT
[0m20:57:40.832137 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:40.834349 [debug] [MainThread]: On master: COMMIT
[0m20:57:40.835160 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:57:40.835160 [debug] [MainThread]: On master: Close
[0m20:57:40.835160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:40.837645 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m20:57:40.837645 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m20:57:40.837645 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m20:57:40.839593 [debug] [MainThread]: Connection 'test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d' was properly closed.
[0m20:57:40.839593 [debug] [MainThread]: Connection 'test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57' was properly closed.
[0m20:57:40.839593 [debug] [MainThread]: Connection 'test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b' was properly closed.
[0m20:57:40.839593 [info ] [MainThread]: 
[0m20:57:40.839593 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m20:57:40.839593 [debug] [MainThread]: Command end result
[0m20:57:40.875850 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:57:40.879120 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:57:40.881552 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m20:57:40.881552 [info ] [MainThread]: 
[0m20:57:40.881552 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:40.881552 [info ] [MainThread]: 
[0m20:57:40.889027 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m20:57:40.889027 [debug] [MainThread]: Command `dbt test` succeeded at 20:57:40.889027 after 1.13 seconds
[0m20:57:40.889027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E191BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0E2F4CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D0D6E72F0>]}
[0m20:57:40.889027 [debug] [MainThread]: Flushing usage events
[0m20:57:43.118953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:57:51.804666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A3F67F590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A41C63CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A400A2C30>]}


============================== 20:57:51.816785 | 8839fd0b-ff37-4816-8b79-2ffd2a017f86 ==============================
[0m20:57:51.816785 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:57:51.816785 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m20:57:52.066078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A3F840710>]}
[0m20:57:52.121542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A439988F0>]}
[0m20:57:52.121542 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:57:52.321343 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:57:52.449974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:57:52.449974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:57:52.480914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A439984A0>]}
[0m20:57:52.560500 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:57:52.560500 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:57:52.602252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4408D8E0>]}
[0m20:57:52.602252 [info ] [MainThread]: Found 16 models, 23 data tests, 8 sources, 468 macros
[0m20:57:52.602252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A442CA2D0>]}
[0m20:57:52.602252 [info ] [MainThread]: 
[0m20:57:52.602252 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:57:52.602252 [info ] [MainThread]: 
[0m20:57:52.608238 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:57:52.612322 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:57:52.624295 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:57:52.640527 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m20:57:52.682379 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:57:52.682379 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:57:52.682379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:52.682379 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:57:52.682379 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m20:57:52.682379 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:57:52.682379 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m20:57:52.682379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:52.682379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:52.710017 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m20:57:52.710017 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m20:57:52.710017 [debug] [ThreadPool]: On list_takehome: Close
[0m20:57:52.710017 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m20:57:52.713774 [debug] [ThreadPool]: On list_takehome: Close
[0m20:57:52.713774 [debug] [ThreadPool]: On list_takehome: Close
[0m20:57:52.713774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_silver)
[0m20:57:52.713774 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_silver"
"
[0m20:57:52.723096 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:57:52.723096 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:57:52.723096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:52.725104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m20:57:52.725104 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m20:57:52.725104 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:57:52.725104 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:57:52.725104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m20:57:52.725104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:52.725104 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m20:57:52.729510 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m20:57:52.730126 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:57:52.730126 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:57:52.730126 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m20:57:52.730126 [debug] [ThreadPool]: On create_takehome_dev_silver: BEGIN
[0m20:57:52.730126 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m20:57:52.730126 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:57:52.730126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:57:52.730126 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:57:52.730126 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m20:57:52.730126 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:57:52.730126 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
    
        create schema if not exists "takehome"."dev_silver"
    
[0m20:57:52.730126 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:57:52.730126 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:57:52.730126 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:57:52.730126 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:57:52.730126 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:57:52.730126 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m20:57:52.730126 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:57:52.730126 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m20:57:52.745549 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m20:57:52.745549 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m20:57:52.745549 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:57:52.747560 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:57:52.747560 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:57:52.747560 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m20:57:52.747560 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:57:52.747560 [debug] [ThreadPool]: On create_takehome_dev_silver: Close
[0m20:57:52.747560 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m20:57:52.747560 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m20:57:52.747560 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m20:57:52.747560 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:57:52.747560 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m20:57:52.747560 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m20:57:52.747560 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m20:57:52.747560 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:57:52.747560 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m20:57:52.747560 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:57:52.747560 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m20:57:52.747560 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m20:57:52.761402 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:57:52.761402 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m20:57:52.761402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:52.761402 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m20:57:52.761402 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:57:52.761402 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m20:57:52.761402 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m20:57:52.761402 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:57:52.761402 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:57:52.761402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:52.761402 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:57:52.761402 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m20:57:52.761402 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m20:57:52.761402 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:57:52.761402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:57:52.761402 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:57:52.761402 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m20:57:52.775162 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:57:52.775162 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:57:52.775162 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m20:57:52.792741 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:57:52.792741 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m20:57:52.792741 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m20:57:52.795749 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m20:57:52.795749 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m20:57:52.795749 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m20:57:52.795749 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m20:57:52.800915 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m20:57:52.803269 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m20:57:52.803269 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m20:57:52.803269 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m20:57:52.803269 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m20:57:52.803269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A43DDBA70>]}
[0m20:57:52.803269 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:52.803269 [debug] [MainThread]: On master: BEGIN
[0m20:57:52.803269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:57:52.809218 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:57:52.809218 [debug] [MainThread]: On master: COMMIT
[0m20:57:52.809218 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:52.809218 [debug] [MainThread]: On master: COMMIT
[0m20:57:52.809218 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:57:52.809218 [debug] [MainThread]: On master: Close
[0m20:57:52.816926 [debug] [Thread-1 (]: Began running node model.takehome.stg_conditions
[0m20:57:52.816926 [debug] [Thread-2 (]: Began running node model.takehome.stg_documents
[0m20:57:52.816926 [debug] [Thread-3 (]: Began running node model.takehome.stg_lab_results
[0m20:57:52.816926 [info ] [Thread-1 (]: 1 of 16 START sql view model dev_staging.stg_conditions ........................ [RUN]
[0m20:57:52.816926 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_conditions'
[0m20:57:52.816926 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_conditions
[0m20:57:52.816926 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_conditions"
[0m20:57:52.816926 [debug] [Thread-4 (]: Began running node model.takehome.stg_med_admins
[0m20:57:52.816926 [info ] [Thread-2 (]: 2 of 16 START sql view model dev_staging.stg_documents ......................... [RUN]
[0m20:57:52.816926 [info ] [Thread-3 (]: 3 of 16 START sql view model dev_staging.stg_lab_results ....................... [RUN]
[0m20:57:52.816926 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.takehome.stg_documents'
[0m20:57:52.832069 [debug] [Thread-1 (]: Began executing node model.takehome.stg_conditions
[0m20:57:52.833933 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.stg_lab_results'
[0m20:57:52.816926 [info ] [Thread-4 (]: 4 of 16 START sql view model dev_staging.stg_med_admins ........................ [RUN]
[0m20:57:52.834842 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_documents
[0m20:57:52.861975 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_lab_results
[0m20:57:52.869195 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.takehome.stg_med_admins'
[0m20:57:52.877605 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_conditions"
[0m20:57:52.877605 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_documents"
[0m20:57:52.877605 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_lab_results"
[0m20:57:52.883319 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_med_admins
[0m20:57:52.886291 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_med_admins"
[0m20:57:52.886291 [debug] [Thread-3 (]: Began executing node model.takehome.stg_lab_results
[0m20:57:52.891347 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_lab_results"
[0m20:57:52.891347 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:57:52.891347 [debug] [Thread-1 (]: On model.takehome.stg_conditions: BEGIN
[0m20:57:52.891347 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:57:52.891347 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:52.895595 [debug] [Thread-4 (]: Began executing node model.takehome.stg_med_admins
[0m20:57:52.895595 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:57:52.895595 [debug] [Thread-2 (]: Began executing node model.takehome.stg_documents
[0m20:57:52.900092 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_med_admins"
[0m20:57:52.900092 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

  
  create view "takehome"."dev_staging"."stg_conditions__dbt_tmp" as (
    select
    id   as condition_id,
    name as condition_name
from "takehome"."raw"."conditions"
  );

[0m20:57:52.900092 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:57:52.904644 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_documents"
[0m20:57:52.904644 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: BEGIN
[0m20:57:52.904644 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:52.904644 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:57:52.904644 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:57:52.904644 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:57:52.915136 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:57:52.915136 [debug] [Thread-2 (]: On model.takehome.stg_documents: BEGIN
[0m20:57:52.915136 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m20:57:52.915136 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: BEGIN
[0m20:57:52.915136 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions" rename to "stg_conditions__dbt_backup"
[0m20:57:52.915136 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:57:52.915136 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:57:52.915136 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:57:52.915136 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    select *
    from read_json_auto('src_data/lab_results/*.json')
),
flattened as (
    select
        testId::bigint            as test_id,
        orderId::bigint           as order_id,
        patientId::bigint         as patient_id,
        cast(resultDate as date)  as result_date,
        json_extract(value, '$.componentName')::varchar   as component_name,
        json_extract(value, '$.componentRefHi')::double   as component_ref_hi,
        json_extract(value, '$.componentRefLo')::double   as component_ref_lo,
        json_extract(value, '$.componentUnits')::varchar  as component_units,
        json_extract(value, '$.resultValue')::double      as result_value
    from raw_json
    cross join json_each(testResults)
)
select *
from flattened
  );

[0m20:57:52.915136 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:52.923130 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:57:52.927145 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:57:52.927145 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m20:57:52.927145 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:57:52.927145 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions__dbt_tmp" rename to "stg_conditions"
[0m20:57:52.929150 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:57:52.929150 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

  
  create view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" as (
    select
    patient_id,
    patient_condition_id,
    medication_id,
    coalesce(date_stopped, date_started) as updated_at,
    date_started,
    date_stopped,
    dosage
from "takehome"."raw"."med_admins"
  );

[0m20:57:52.929150 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

  
  create view "takehome"."dev_staging"."stg_documents__dbt_tmp" as (
    select
    document_id,
    patient_id,
    visit_id,
    document_line,
    document_text
from "takehome"."raw"."documents"
  );

[0m20:57:52.930898 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:52.940945 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m20:57:52.940945 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:57:52.947539 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m20:57:52.948230 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m20:57:52.949009 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m20:57:52.949009 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:57:52.956005 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:57:52.959511 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins" rename to "stg_med_admins__dbt_backup"
[0m20:57:52.962971 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents" rename to "stg_documents__dbt_backup"
[0m20:57:52.964338 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:57:52.969473 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m20:57:52.971483 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_conditions__dbt_backup" cascade
    
[0m20:57:52.971483 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m20:57:52.972801 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m20:57:52.972801 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:57:52.972801 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:57:52.972801 [debug] [Thread-3 (]: SQL status: OK in 0.057 seconds
[0m20:57:52.972801 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" rename to "stg_med_admins"
[0m20:57:52.981131 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents__dbt_tmp" rename to "stg_documents"
[0m20:57:52.985359 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:57:52.985359 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:57:52.985359 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */
alter view "takehome"."dev_staging"."stg_lab_results" rename to "stg_lab_results__dbt_backup"
[0m20:57:52.985359 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:57:52.985359 [debug] [Thread-1 (]: On model.takehome.stg_conditions: Close
[0m20:57:52.985359 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:57:52.985359 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m20:57:52.985359 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:57:52.996425 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m20:57:52.996425 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:57:53.044310 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:57:53.044310 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m20:57:53.044310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A41C863F0>]}
[0m20:57:53.044310 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:57:53.044310 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m20:57:53.044310 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */
alter view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" rename to "stg_lab_results"
[0m20:57:53.044310 [info ] [Thread-1 (]: 1 of 16 OK created sql view model dev_staging.stg_conditions ................... [[32mOK[0m in 0.17s]
[0m20:57:53.044310 [debug] [Thread-1 (]: Finished running node model.takehome.stg_conditions
[0m20:57:53.044310 [debug] [Thread-1 (]: Began running node model.takehome.stg_medications
[0m20:57:53.044310 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:57:53.057431 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:57:53.044310 [info ] [Thread-1 (]: 5 of 16 START sql view model dev_staging.stg_medications ....................... [RUN]
[0m20:57:53.059954 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m20:57:53.063010 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: COMMIT
[0m20:57:53.063010 [debug] [Thread-2 (]: SQL status: OK in 0.017 seconds
[0m20:57:53.063010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_conditions, now model.takehome.stg_medications)
[0m20:57:53.063010 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

      drop view if exists "takehome"."dev_staging"."stg_med_admins__dbt_backup" cascade
    
[0m20:57:53.063010 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:57:53.063010 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m20:57:53.063010 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_medications
[0m20:57:53.063010 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: COMMIT
[0m20:57:53.072728 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

      drop view if exists "takehome"."dev_staging"."stg_documents__dbt_backup" cascade
    
[0m20:57:53.073625 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_medications"
[0m20:57:53.073625 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:57:53.073625 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: Close
[0m20:57:53.080918 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A457C58B0>]}
[0m20:57:53.080918 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:57:53.080918 [debug] [Thread-1 (]: Began executing node model.takehome.stg_medications
[0m20:57:53.087192 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m20:57:53.080918 [info ] [Thread-4 (]: 4 of 16 OK created sql view model dev_staging.stg_med_admins ................... [[32mOK[0m in 0.21s]
[0m20:57:53.088488 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m20:57:53.090484 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_medications"
[0m20:57:53.090484 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

      drop view if exists "takehome"."dev_staging"."stg_lab_results__dbt_backup" cascade
    
[0m20:57:53.090484 [debug] [Thread-4 (]: Finished running node model.takehome.stg_med_admins
[0m20:57:53.090484 [debug] [Thread-2 (]: On model.takehome.stg_documents: Close
[0m20:57:53.097047 [debug] [Thread-4 (]: Began running node model.takehome.stg_orders
[0m20:57:53.099250 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A43DD9A00>]}
[0m20:57:53.099250 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:57:53.099250 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:57:53.099250 [info ] [Thread-4 (]: 6 of 16 START sql view model dev_staging.stg_orders ............................ [RUN]
[0m20:57:53.099250 [debug] [Thread-1 (]: On model.takehome.stg_medications: BEGIN
[0m20:57:53.105333 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: Close
[0m20:57:53.099250 [info ] [Thread-2 (]: 2 of 16 OK created sql view model dev_staging.stg_documents .................... [[32mOK[0m in 0.28s]
[0m20:57:53.105333 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_med_admins, now model.takehome.stg_orders)
[0m20:57:53.105333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:53.105333 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A43DD8D70>]}
[0m20:57:53.105333 [debug] [Thread-2 (]: Finished running node model.takehome.stg_documents
[0m20:57:53.105333 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_orders
[0m20:57:53.113502 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:57:53.113502 [info ] [Thread-3 (]: 3 of 16 OK created sql view model dev_staging.stg_lab_results .................. [[32mOK[0m in 0.27s]
[0m20:57:53.113502 [debug] [Thread-2 (]: Began running node model.takehome.stg_patient_conditions
[0m20:57:53.113502 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_orders"
[0m20:57:53.120852 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:57:53.122040 [debug] [Thread-3 (]: Finished running node model.takehome.stg_lab_results
[0m20:57:53.122040 [info ] [Thread-2 (]: 7 of 16 START sql view model dev_staging.stg_patient_conditions ................ [RUN]
[0m20:57:53.122040 [debug] [Thread-1 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

  
  create view "takehome"."dev_staging"."stg_medications__dbt_tmp" as (
    select
    id   as medication_id,
    name as medication_name
from "takehome"."raw"."medications"
  );

[0m20:57:53.122040 [debug] [Thread-3 (]: Began running node model.takehome.stg_patients
[0m20:57:53.128748 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_documents, now model.takehome.stg_patient_conditions)
[0m20:57:53.130187 [debug] [Thread-4 (]: Began executing node model.takehome.stg_orders
[0m20:57:53.130187 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:57:53.130187 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_patient_conditions
[0m20:57:53.130187 [info ] [Thread-3 (]: 8 of 16 START sql view model dev_staging.stg_patients .......................... [RUN]
[0m20:57:53.140298 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_orders"
[0m20:57:53.140298 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:57:53.151017 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_patient_conditions"
[0m20:57:53.153033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_lab_results, now model.takehome.stg_patients)
[0m20:57:53.155050 [debug] [Thread-1 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications" rename to "stg_medications__dbt_backup"
[0m20:57:53.156529 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_patients
[0m20:57:53.163738 [debug] [Thread-2 (]: Began executing node model.takehome.stg_patient_conditions
[0m20:57:53.172422 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m20:57:53.163738 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_patient_conditions"
[0m20:57:53.172422 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m20:57:53.172422 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:57:53.186704 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:57:53.188951 [debug] [Thread-4 (]: On model.takehome.stg_orders: BEGIN
[0m20:57:53.188951 [debug] [Thread-1 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications__dbt_tmp" rename to "stg_medications"
[0m20:57:53.191543 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:57:53.191543 [debug] [Thread-3 (]: Began executing node model.takehome.stg_patients
[0m20:57:53.195577 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:57:53.200278 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m20:57:53.205417 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m20:57:53.206677 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:57:53.207735 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: BEGIN
[0m20:57:53.207735 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:57:53.207735 [debug] [Thread-1 (]: On model.takehome.stg_medications: COMMIT
[0m20:57:53.207735 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:53.214351 [debug] [Thread-4 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

  
  create view "takehome"."dev_staging"."stg_orders__dbt_tmp" as (
    select
    id            as order_id,
    patient_id,
    condition_id,
    order_date    as updated_at,
    order_date
from "takehome"."raw"."orders"
  );

[0m20:57:53.214351 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:57:53.214351 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:57:53.217709 [debug] [Thread-1 (]: On model.takehome.stg_medications: COMMIT
[0m20:57:53.217709 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m20:57:53.217709 [debug] [Thread-3 (]: On model.takehome.stg_patients: BEGIN
[0m20:57:53.222403 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:57:53.222403 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:57:53.222403 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:57:53.231375 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:57:53.231375 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

  
  create view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" as (
    select
    id                     as patient_condition_id,
    patient_id,
    condition_id,
    coalesce(date_ended, date_started) as updated_at,
    date_started,
    date_ended
from "takehome"."raw"."patient_conditions"
  );

[0m20:57:53.231375 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:57:53.236023 [debug] [Thread-4 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m20:57:53.236023 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m20:57:53.243706 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_medications"
[0m20:57:53.243706 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:57:53.246982 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m20:57:53.248055 [debug] [Thread-1 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

      drop view if exists "takehome"."dev_staging"."stg_medications__dbt_backup" cascade
    
[0m20:57:53.249285 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id as patient_id,
    coalesce(
        date_deactivated,
        date_activated,
        date_of_death,
        date_of_birth
    )                                    as updated_at,
    first_name,
    last_name,
    ssn,
    date_of_birth,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_death,
    date_activated,
    date_deactivated
from "takehome"."raw"."patients"
  );

[0m20:57:53.251475 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:57:53.255379 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:57:53.263636 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:57:53.264913 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:57:53.264913 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions" rename to "stg_patient_conditions__dbt_backup"
[0m20:57:53.264913 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m20:57:53.264913 [debug] [Thread-1 (]: On model.takehome.stg_medications: Close
[0m20:57:53.264913 [debug] [Thread-4 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:57:53.273702 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:57:53.273702 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:57:53.273702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A43E75A30>]}
[0m20:57:53.273702 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:57:53.273702 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:57:53.281285 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:57:53.281285 [debug] [Thread-4 (]: On model.takehome.stg_orders: COMMIT
[0m20:57:53.281285 [info ] [Thread-1 (]: 5 of 16 OK created sql view model dev_staging.stg_medications .................. [[32mOK[0m in 0.21s]
[0m20:57:53.281285 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" rename to "stg_patient_conditions"
[0m20:57:53.281285 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:57:53.281285 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:57:53.281285 [debug] [Thread-1 (]: Finished running node model.takehome.stg_medications
[0m20:57:53.290160 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:57:53.290160 [debug] [Thread-4 (]: On model.takehome.stg_orders: COMMIT
[0m20:57:53.290160 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m20:57:53.290160 [debug] [Thread-1 (]: Began running node model.takehome.stg_visits
[0m20:57:53.290160 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:57:53.296982 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m20:57:53.296982 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:57:53.299315 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:57:53.303171 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m20:57:53.296982 [info ] [Thread-1 (]: 9 of 16 START sql view model dev_staging.stg_visits ............................ [RUN]
[0m20:57:53.305552 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:57:53.305552 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m20:57:53.308386 [debug] [Thread-4 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

      drop view if exists "takehome"."dev_staging"."stg_orders__dbt_backup" cascade
    
[0m20:57:53.308386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_medications, now model.takehome.stg_visits)
[0m20:57:53.308386 [debug] [Thread-3 (]: On model.takehome.stg_patients: COMMIT
[0m20:57:53.308386 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_visits
[0m20:57:53.313648 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:57:53.315834 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_visits"
[0m20:57:53.315834 [debug] [Thread-3 (]: On model.takehome.stg_patients: COMMIT
[0m20:57:53.315834 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m20:57:53.315834 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m20:57:53.321873 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m20:57:53.324710 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:57:53.324710 [debug] [Thread-4 (]: On model.takehome.stg_orders: Close
[0m20:57:53.324710 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_patient_conditions__dbt_backup" cascade
    
[0m20:57:53.332165 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m20:57:53.332165 [debug] [Thread-1 (]: Began executing node model.takehome.stg_visits
[0m20:57:53.334178 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A457922A0>]}
[0m20:57:53.334178 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

      drop view if exists "takehome"."dev_staging"."stg_patients__dbt_backup" cascade
    
[0m20:57:53.341321 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:57:53.341321 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_visits"
[0m20:57:53.341321 [info ] [Thread-4 (]: 6 of 16 OK created sql view model dev_staging.stg_orders ....................... [[32mOK[0m in 0.23s]
[0m20:57:53.347031 [debug] [Thread-2 (]: On model.takehome.stg_patient_conditions: Close
[0m20:57:53.347031 [debug] [Thread-4 (]: Finished running node model.takehome.stg_orders
[0m20:57:53.347031 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A41C63CE0>]}
[0m20:57:53.347031 [debug] [Thread-4 (]: Began running node model.takehome.lab_results
[0m20:57:53.347031 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m20:57:53.353825 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:57:53.355379 [debug] [Thread-3 (]: On model.takehome.stg_patients: Close
[0m20:57:53.352747 [info ] [Thread-2 (]: 7 of 16 OK created sql view model dev_staging.stg_patient_conditions ........... [[32mOK[0m in 0.22s]
[0m20:57:53.355379 [debug] [Thread-1 (]: On model.takehome.stg_visits: BEGIN
[0m20:57:53.359985 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A45826A80>]}
[0m20:57:53.359985 [debug] [Thread-2 (]: Finished running node model.takehome.stg_patient_conditions
[0m20:57:53.359985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:53.355379 [info ] [Thread-4 (]: 10 of 16 START sql table model dev_silver.lab_results .......................... [RUN]
[0m20:57:53.359985 [debug] [Thread-2 (]: Began running node model.takehome.medications_per_month
[0m20:57:53.359985 [info ] [Thread-3 (]: 8 of 16 OK created sql view model dev_staging.stg_patients ..................... [[32mOK[0m in 0.20s]
[0m20:57:53.363651 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_orders, now model.takehome.lab_results)
[0m20:57:53.366126 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:57:53.366126 [debug] [Thread-3 (]: Finished running node model.takehome.stg_patients
[0m20:57:53.366126 [info ] [Thread-2 (]: 11 of 16 START sql table model dev_silver.medications_per_month ................ [RUN]
[0m20:57:53.366126 [debug] [Thread-4 (]: Began compiling node model.takehome.lab_results
[0m20:57:53.366126 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:57:53.366126 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patient_conditions, now model.takehome.medications_per_month)
[0m20:57:53.366126 [debug] [Thread-3 (]: Began running node model.takehome.patient_results
[0m20:57:53.371870 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.lab_results"
[0m20:57:53.375874 [debug] [Thread-1 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

  
  create view "takehome"."dev_staging"."stg_visits__dbt_tmp" as (
    select
    id                    as visit_id,
    visit_date            as updated_at,
    patient_condition_id,
    visit_date
from "takehome"."raw"."visits"
  );

[0m20:57:53.375874 [debug] [Thread-2 (]: Began compiling node model.takehome.medications_per_month
[0m20:57:53.375874 [info ] [Thread-3 (]: 12 of 16 START sql incremental model dev_bronze.patient_results ................ [RUN]
[0m20:57:53.382258 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.medications_per_month"
[0m20:57:53.384483 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patients, now model.takehome.patient_results)
[0m20:57:53.384483 [debug] [Thread-4 (]: Began executing node model.takehome.lab_results
[0m20:57:53.384483 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:57:53.384483 [debug] [Thread-3 (]: Began compiling node model.takehome.patient_results
[0m20:57:53.407232 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:57:53.407232 [debug] [Thread-2 (]: Began executing node model.takehome.medications_per_month
[0m20:57:53.413627 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.lab_results"
[0m20:57:53.426032 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.patient_results"
[0m20:57:53.426032 [debug] [Thread-1 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits" rename to "stg_visits__dbt_backup"
[0m20:57:53.430258 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.medications_per_month"
[0m20:57:53.430258 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:53.430258 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:57:53.435261 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:57:53.435261 [debug] [Thread-3 (]: Began executing node model.takehome.patient_results
[0m20:57:53.435261 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:57:53.438568 [debug] [Thread-4 (]: On model.takehome.lab_results: BEGIN
[0m20:57:53.438568 [debug] [Thread-2 (]: On model.takehome.medications_per_month: BEGIN
[0m20:57:53.451683 [debug] [Thread-1 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits__dbt_tmp" rename to "stg_visits"
[0m20:57:53.454360 [debug] [Thread-3 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m20:57:53.454360 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:57:53.454360 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:53.470268 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m20:57:53.470268 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:57:53.470268 [debug] [Thread-3 (]: On model.takehome.patient_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_results"} */

    
  
    
    

    create temporary table
      "patient_results__dbt_tmp20251120205753454360"
  
    as (
      
with labs as (
    select
        lr.patient_id,
        lr.result_date,
        lr.component_name,
        lr.component_units,
        lr.result_value,
        lr.component_ref_lo,
        lr.component_ref_hi,
        case
            when lr.result_value < lr.component_ref_lo
              or lr.result_value > lr.component_ref_hi
            then true
            else false
        end as out_of_range
    from "takehome"."dev_staging"."stg_lab_results" lr

    
    -- sólo traer resultados nuevos
    where lr.result_date >
          (select coalesce(max(result_date), date '1900-01-01') from "takehome"."dev_bronze"."patient_results")
    
),

patients as (
    select
        patient_id,
        first_name,
        last_name,
        gender,
        date_of_birth
    from "takehome"."dev_staging"."stg_patients"
)

select
    p.patient_id,
    p.first_name,
    p.last_name,
    p.gender,
    p.date_of_birth,
    l.result_date,
    l.component_name,
    l.component_units,
    l.result_value,
    l.component_ref_lo,
    l.component_ref_hi,
    l.out_of_range
from labs l
left join patients p
    on p.patient_id = l.patient_id
    );
  
  
  
[0m20:57:53.470268 [debug] [Thread-1 (]: On model.takehome.stg_visits: COMMIT
[0m20:57:53.470268 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:57:53.470268 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:57:53.470268 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:57:53.470268 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:57:53.470268 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:57:53.470268 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:57:53.470268 [debug] [Thread-1 (]: On model.takehome.stg_visits: COMMIT
[0m20:57:53.478466 [debug] [Thread-4 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

  
    
    

    create  table
      "takehome"."dev_silver"."lab_results__dbt_tmp"
  
    as (
      select *
from "takehome"."dev_staging"."stg_lab_results"
    );
  
  
[0m20:57:53.478466 [debug] [Thread-2 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."medications_per_month__dbt_tmp"
  
    as (
      with med_admins as (
    select
        patient_id,
        medication_id,
        date_started
    from "takehome"."dev_staging"."stg_med_admins"
    where date_started is not null
),
meds as (
    select
        medication_id,
        medication_name
    from "takehome"."dev_staging"."stg_medications"
),
med_admins_month as (
    select
        date_trunc('month', date_started) as month,
        medication_id,
        patient_id
    from med_admins
)
select
    m.month,
    med.medication_id,
    med.medication_name,
    count(*)                     as administrations,
    count(distinct m.patient_id) as patients_treated
from med_admins_month m
join meds med
    on m.medication_id = med.medication_id
group by 1,2,3
order by 1,2
    );
  
  
[0m20:57:53.482482 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:57:53.486240 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_visits"
[0m20:57:53.486240 [debug] [Thread-1 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

      drop view if exists "takehome"."dev_staging"."stg_visits__dbt_backup" cascade
    
[0m20:57:53.488249 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:57:53.491597 [debug] [Thread-1 (]: On model.takehome.stg_visits: Close
[0m20:57:53.491597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A42772F00>]}
[0m20:57:53.495674 [info ] [Thread-1 (]: 9 of 16 OK created sql view model dev_staging.stg_visits ....................... [[32mOK[0m in 0.18s]
[0m20:57:53.495674 [debug] [Thread-1 (]: Finished running node model.takehome.stg_visits
[0m20:57:53.495674 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m20:57:53.495674 [debug] [Thread-1 (]: Began running node model.takehome.patients
[0m20:57:53.505508 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:57:53.507514 [debug] [Thread-2 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m20:57:53.510378 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:57:53.510378 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:57:53.507514 [info ] [Thread-1 (]: 13 of 16 START sql table model dev_bronze.patients ............................. [RUN]
[0m20:57:53.512385 [debug] [Thread-2 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m20:57:53.512385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_visits, now model.takehome.patients)
[0m20:57:53.514393 [debug] [Thread-1 (]: Began compiling node model.takehome.patients
[0m20:57:53.520166 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.patients"
[0m20:57:53.520166 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m20:57:53.527082 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:57:53.528244 [debug] [Thread-2 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month" rename to "medications_per_month__dbt_backup"
[0m20:57:53.528244 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:57:53.528244 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:57:53.528244 [debug] [Thread-2 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month__dbt_tmp" rename to "medications_per_month"
[0m20:57:53.536270 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:57:53.547439 [debug] [Thread-1 (]: Began executing node model.takehome.patients
[0m20:57:53.553772 [debug] [Thread-2 (]: On model.takehome.medications_per_month: COMMIT
[0m20:57:53.553772 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:57:53.553772 [debug] [Thread-2 (]: On model.takehome.medications_per_month: COMMIT
[0m20:57:53.559063 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.patients"
[0m20:57:53.560714 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:57:53.562926 [debug] [Thread-1 (]: On model.takehome.patients: BEGIN
[0m20:57:53.562926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:53.562926 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m20:57:53.569217 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m20:57:53.569217 [debug] [Thread-2 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

      drop table if exists "takehome"."dev_silver"."medications_per_month__dbt_backup" cascade
    
[0m20:57:53.569217 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:57:53.569217 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:57:53.569217 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      
with 
pt as ( select * from "takehome"."dev_staging"."stg_patients" )
select
    * 
from pt
qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m20:57:53.574120 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:57:53.577421 [debug] [Thread-2 (]: On model.takehome.medications_per_month: Close
[0m20:57:53.577421 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A4586B380>]}
[0m20:57:53.577421 [info ] [Thread-2 (]: 11 of 16 OK created sql table model dev_silver.medications_per_month ........... [[32mOK[0m in 0.21s]
[0m20:57:53.577421 [debug] [Thread-2 (]: Finished running node model.takehome.medications_per_month
[0m20:57:53.603908 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m20:57:53.603908 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:57:53.607848 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m20:57:53.609860 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:57:53.611652 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:57:53.614001 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m20:57:53.616013 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:57:53.619070 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:57:53.619070 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients" rename to "patients__dbt_backup"
[0m20:57:53.619070 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:53.627360 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:57:53.627943 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients__dbt_tmp" rename to "patients"
[0m20:57:53.627943 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:53.629839 [debug] [Thread-1 (]: On model.takehome.patients: COMMIT
[0m20:57:53.631850 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:57:53.631850 [debug] [Thread-1 (]: On model.takehome.patients: COMMIT
[0m20:57:53.635616 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:57:53.638402 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients"
[0m20:57:53.641552 [debug] [Thread-1 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

      drop table if exists "takehome"."dev_bronze"."patients__dbt_backup" cascade
    
[0m20:57:53.643605 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:57:53.645634 [debug] [Thread-1 (]: On model.takehome.patients: Close
[0m20:57:53.645634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A44795190>]}
[0m20:57:53.645634 [info ] [Thread-1 (]: 13 of 16 OK created sql table model dev_bronze.patients ........................ [[32mOK[0m in 0.13s]
[0m20:57:53.650619 [debug] [Thread-1 (]: Finished running node model.takehome.patients
[0m20:57:53.652629 [debug] [Thread-2 (]: Began running node model.takehome.patients_by_age
[0m20:57:53.652629 [debug] [Thread-1 (]: Began running node model.takehome.patients_per_month
[0m20:57:53.652629 [info ] [Thread-2 (]: 14 of 16 START sql table model dev_silver.patients_by_age ...................... [RUN]
[0m20:57:53.657915 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.medications_per_month, now model.takehome.patients_by_age)
[0m20:57:53.658813 [debug] [Thread-2 (]: Began compiling node model.takehome.patients_by_age
[0m20:57:53.663065 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.patients_by_age"
[0m20:57:53.652629 [info ] [Thread-1 (]: 15 of 16 START sql table model dev_silver.patients_per_month ................... [RUN]
[0m20:57:53.665994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.patients, now model.takehome.patients_per_month)
[0m20:57:53.668004 [debug] [Thread-1 (]: Began compiling node model.takehome.patients_per_month
[0m20:57:53.671359 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.patients_per_month"
[0m20:57:53.674313 [debug] [Thread-2 (]: Began executing node model.takehome.patients_by_age
[0m20:57:53.679137 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.patients_by_age"
[0m20:57:53.681465 [debug] [Thread-1 (]: Began executing node model.takehome.patients_per_month
[0m20:57:53.687858 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.patients_per_month"
[0m20:57:53.689875 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:57:53.691888 [debug] [Thread-2 (]: On model.takehome.patients_by_age: BEGIN
[0m20:57:53.691888 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:53.693772 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:57:53.693772 [debug] [Thread-1 (]: On model.takehome.patients_per_month: BEGIN
[0m20:57:53.693772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:57:53.696992 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:57:53.696992 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:57:53.696992 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_by_age__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_of_birth,
        gender,
        race,
        ethnicity,
        smoker,
        drinks_per_week,
        date_activated,
        date_deactivated,
        date_of_death
    from "takehome"."dev_bronze"."patients"
)
select
    patient_id,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_birth,
    date_activated,
    date_deactivated,
    date_of_death,
    date_diff('year', date_of_birth, current_date) as age,
    case
        when date_of_birth is null then 'unknown'
        when date_diff('year', date_of_birth, current_date) < 18 then '0-17'
        when date_diff('year', date_of_birth, current_date) between 18 and 34 then '18-34'
        when date_diff('year', date_of_birth, current_date) between 35 and 49 then '35-49'
        when date_diff('year', date_of_birth, current_date) between 50 and 64 then '50-64'
        else '65+'
    end as age_group
from patients
    );
  
  
[0m20:57:53.696992 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:57:53.700041 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:57:53.700041 [debug] [Thread-1 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_per_month__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_activated,
        gender
    from "takehome"."dev_bronze"."patients"
    where date_activated is not null
),
patients_by_month as (
    select
        date_trunc('month', date_activated)                           as month,
        count(*)                                                      as new_patients,
        count(distinct case when gender = 'M' then patient_id end)    as new_patients_male,
        count(distinct case when gender = 'F' then patient_id end)    as new_patients_female
    from patients
    group by 1
)
select *
from patients_by_month
order by month
    );
  
  
[0m20:57:53.702419 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:57:53.702419 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:57:53.702419 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m20:57:53.711509 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:57:53.714196 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:57:53.714196 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m20:57:53.714196 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m20:57:53.718782 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:57:53.718782 [debug] [Thread-1 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m20:57:53.720122 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:57:53.720122 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:57:53.720122 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:57:53.720122 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age" rename to "patients_by_age__dbt_backup"
[0m20:57:53.728009 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:57:53.728009 [debug] [Thread-1 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m20:57:53.728009 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:57:53.736319 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:57:53.736319 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age__dbt_tmp" rename to "patients_by_age"
[0m20:57:53.736319 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:57:53.744444 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:57:53.744444 [debug] [Thread-2 (]: On model.takehome.patients_by_age: COMMIT
[0m20:57:53.752191 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:57:53.752829 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:57:53.752829 [debug] [Thread-1 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month" rename to "patients_per_month__dbt_backup"
[0m20:57:53.752829 [debug] [Thread-2 (]: On model.takehome.patients_by_age: COMMIT
[0m20:57:53.752829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:57:53.760990 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:57:53.760990 [debug] [Thread-1 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month__dbt_tmp" rename to "patients_per_month"
[0m20:57:53.760990 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m20:57:53.769449 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m20:57:53.769449 [debug] [Thread-2 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

      drop table if exists "takehome"."dev_silver"."patients_by_age__dbt_backup" cascade
    
[0m20:57:53.769449 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:57:53.773668 [debug] [Thread-1 (]: On model.takehome.patients_per_month: COMMIT
[0m20:57:53.773668 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:57:53.773668 [debug] [Thread-1 (]: On model.takehome.patients_per_month: COMMIT
[0m20:57:53.775677 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:57:53.777736 [debug] [Thread-2 (]: On model.takehome.patients_by_age: Close
[0m20:57:53.777736 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A443E29C0>]}
[0m20:57:53.777736 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:57:53.786426 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m20:57:53.786426 [debug] [Thread-1 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

      drop table if exists "takehome"."dev_silver"."patients_per_month__dbt_backup" cascade
    
[0m20:57:53.777736 [info ] [Thread-2 (]: 14 of 16 OK created sql table model dev_silver.patients_by_age ................. [[32mOK[0m in 0.12s]
[0m20:57:53.788635 [debug] [Thread-2 (]: Finished running node model.takehome.patients_by_age
[0m20:57:53.791290 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:57:53.794573 [debug] [Thread-1 (]: On model.takehome.patients_per_month: Close
[0m20:57:53.794573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A00045CA0>]}
[0m20:57:53.797236 [info ] [Thread-1 (]: 15 of 16 OK created sql table model dev_silver.patients_per_month .............. [[32mOK[0m in 0.13s]
[0m20:57:53.797236 [debug] [Thread-1 (]: Finished running node model.takehome.patients_per_month
[0m20:57:57.719667 [debug] [Thread-4 (]: SQL status: OK in 4.249 seconds
[0m20:57:57.729789 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:57:57.729789 [debug] [Thread-4 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'lab_results'
  
[0m20:57:57.729789 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:57:57.729789 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:57:57.729789 [debug] [Thread-4 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'lab_results'
  
[0m20:57:57.729789 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:57:57.729789 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:57:57.729789 [debug] [Thread-4 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */
alter table "takehome"."dev_silver"."lab_results" rename to "lab_results__dbt_backup"
[0m20:57:57.738812 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:57:57.738812 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:57:57.743180 [debug] [Thread-4 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */
alter table "takehome"."dev_silver"."lab_results__dbt_tmp" rename to "lab_results"
[0m20:57:57.743180 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:57:57.745487 [debug] [Thread-4 (]: On model.takehome.lab_results: COMMIT
[0m20:57:57.747495 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:57:57.747495 [debug] [Thread-4 (]: On model.takehome.lab_results: COMMIT
[0m20:57:57.761143 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m20:57:57.761143 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.lab_results"
[0m20:57:57.761143 [debug] [Thread-4 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

      drop table if exists "takehome"."dev_silver"."lab_results__dbt_backup" cascade
    
[0m20:57:57.761143 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:57:57.761143 [debug] [Thread-4 (]: On model.takehome.lab_results: Close
[0m20:57:57.761143 [debug] [Thread-3 (]: SQL status: OK in 4.297 seconds
[0m20:57:57.761143 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A42375AF0>]}
[0m20:57:57.761143 [info ] [Thread-4 (]: 10 of 16 OK created sql table model dev_silver.lab_results ..................... [[32mOK[0m in 4.40s]
[0m20:57:57.779569 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m20:57:57.779569 [debug] [Thread-4 (]: Finished running node model.takehome.lab_results
[0m20:57:57.779569 [debug] [Thread-3 (]: On model.takehome.patient_results: BEGIN
[0m20:57:57.779569 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:57:57.779569 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m20:57:57.779569 [debug] [Thread-3 (]: On model.takehome.patient_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'patient_results__dbt_tmp20251120205753454360'
      
      
      order by ordinal_position

  
[0m20:57:57.785942 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:57:57.791971 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m20:57:57.791971 [debug] [Thread-3 (]: On model.takehome.patient_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'patient_results'
      
      and lower(table_schema) = 'dev_bronze'
      
      
      and lower(table_catalog) = 'takehome'
      
      order by ordinal_position

  
[0m20:57:57.797698 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:57:57.797698 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m20:57:57.797698 [debug] [Thread-3 (]: On model.takehome.patient_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'patient_results'
      
      and lower(table_schema) = 'dev_bronze'
      
      
      and lower(table_catalog) = 'takehome'
      
      order by ordinal_position

  
[0m20:57:57.812438 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:57:57.812438 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m20:57:57.812438 [debug] [Thread-3 (]: On model.takehome.patient_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_results"} */
SELECT version()
[0m20:57:57.812438 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:57:57.826013 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.patient_results"
[0m20:57:57.826013 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m20:57:57.826013 [debug] [Thread-3 (]: On model.takehome.patient_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_results"} */

        
            delete from "takehome"."dev_bronze"."patient_results" as DBT_INCREMENTAL_TARGET
            using "patient_results__dbt_tmp20251120205753454360"
            where (
                
                    "patient_results__dbt_tmp20251120205753454360".patient_id = DBT_INCREMENTAL_TARGET.patient_id
                    and 
                
                    "patient_results__dbt_tmp20251120205753454360".result_date = DBT_INCREMENTAL_TARGET.result_date
                    and 
                
                    "patient_results__dbt_tmp20251120205753454360".component_name = DBT_INCREMENTAL_TARGET.component_name
                    
                
                
            );
        
    

    insert into "takehome"."dev_bronze"."patient_results" ("patient_id", "first_name", "last_name", "gender", "date_of_birth", "result_date", "component_name", "component_units", "result_value", "component_ref_lo", "component_ref_hi", "out_of_range")
    (
        select "patient_id", "first_name", "last_name", "gender", "date_of_birth", "result_date", "component_name", "component_units", "result_value", "component_ref_lo", "component_ref_hi", "out_of_range"
        from "patient_results__dbt_tmp20251120205753454360"
    )
  
[0m20:57:57.833597 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:57:57.833597 [debug] [Thread-3 (]: On model.takehome.patient_results: COMMIT
[0m20:57:57.833597 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m20:57:57.833597 [debug] [Thread-3 (]: On model.takehome.patient_results: COMMIT
[0m20:57:57.833597 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:57:57.841864 [debug] [Thread-3 (]: On model.takehome.patient_results: Close
[0m20:57:57.841864 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A45804E90>]}
[0m20:57:57.841864 [info ] [Thread-3 (]: 12 of 16 OK created sql incremental model dev_bronze.patient_results ........... [[32mOK[0m in 4.46s]
[0m20:57:57.841864 [debug] [Thread-3 (]: Finished running node model.takehome.patient_results
[0m20:57:57.841864 [debug] [Thread-2 (]: Began running node model.takehome.patient_risk_flags
[0m20:57:57.841864 [info ] [Thread-2 (]: 16 of 16 START sql table model dev_silver.patient_risk_flags ................... [RUN]
[0m20:57:57.841864 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.patients_by_age, now model.takehome.patient_risk_flags)
[0m20:57:57.841864 [debug] [Thread-2 (]: Began compiling node model.takehome.patient_risk_flags
[0m20:57:57.841864 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.patient_risk_flags"
[0m20:57:57.841864 [debug] [Thread-2 (]: Began executing node model.takehome.patient_risk_flags
[0m20:57:57.841864 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.patient_risk_flags"
[0m20:57:57.841864 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m20:57:57.841864 [debug] [Thread-2 (]: On model.takehome.patient_risk_flags: BEGIN
[0m20:57:57.841864 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:57:57.857953 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:57:57.859079 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m20:57:57.859079 [debug] [Thread-2 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patient_risk_flags__dbt_tmp"
  
    as (
      with conds as (
    select
        pc.patient_id,
        count(distinct pc.condition_id) as n_conditions
    from "takehome"."dev_staging"."stg_patient_conditions" pc
    group by pc.patient_id
),

labs as (
    select
        pr.patient_id,
        count(*) filter (where pr.out_of_range) as n_abnormal_labs
    from "takehome"."dev_bronze"."patient_results" pr
    group by pr.patient_id
),

base as (
    select
        coalesce(c.patient_id, l.patient_id) as patient_id,
        coalesce(c.n_conditions, 0)         as n_conditions,
        coalesce(l.n_abnormal_labs, 0)      as n_abnormal_labs
    from conds c
    full outer join labs l
      on c.patient_id = l.patient_id
)

select
    patient_id,
    n_conditions,
    n_abnormal_labs,
    case
        when n_abnormal_labs >= 3
          or n_conditions    >= 5
        then true
        else false
    end as high_risk_flag
from base
    );
  
  
[0m20:57:57.870666 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m20:57:57.870666 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m20:57:57.875794 [debug] [Thread-2 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patient_risk_flags'
  
[0m20:57:57.875794 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:57:57.877713 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m20:57:57.877713 [debug] [Thread-2 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patient_risk_flags'
  
[0m20:57:57.877713 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:57:57.885642 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m20:57:57.885642 [debug] [Thread-2 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */
alter table "takehome"."dev_silver"."patient_risk_flags" rename to "patient_risk_flags__dbt_backup"
[0m20:57:57.887652 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:57:57.887652 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m20:57:57.887652 [debug] [Thread-2 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */
alter table "takehome"."dev_silver"."patient_risk_flags__dbt_tmp" rename to "patient_risk_flags"
[0m20:57:57.887652 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:57:57.892418 [debug] [Thread-2 (]: On model.takehome.patient_risk_flags: COMMIT
[0m20:57:57.892418 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m20:57:57.892418 [debug] [Thread-2 (]: On model.takehome.patient_risk_flags: COMMIT
[0m20:57:57.892418 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:57:57.892418 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m20:57:57.892418 [debug] [Thread-2 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */

      drop table if exists "takehome"."dev_silver"."patient_risk_flags__dbt_backup" cascade
    
[0m20:57:57.901047 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:57:57.901047 [debug] [Thread-2 (]: On model.takehome.patient_risk_flags: Close
[0m20:57:57.901047 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8839fd0b-ff37-4816-8b79-2ffd2a017f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A0006FDA0>]}
[0m20:57:57.901047 [info ] [Thread-2 (]: 16 of 16 OK created sql table model dev_silver.patient_risk_flags .............. [[32mOK[0m in 0.06s]
[0m20:57:57.901047 [debug] [Thread-2 (]: Finished running node model.takehome.patient_risk_flags
[0m20:57:57.901047 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:57.908794 [debug] [MainThread]: On master: BEGIN
[0m20:57:57.908794 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:57:57.908794 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:57:57.908794 [debug] [MainThread]: On master: COMMIT
[0m20:57:57.908794 [debug] [MainThread]: Using duckdb connection "master"
[0m20:57:57.908794 [debug] [MainThread]: On master: COMMIT
[0m20:57:57.911552 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:57:57.911552 [debug] [MainThread]: On master: Close
[0m20:57:57.911552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:57:57.911552 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m20:57:57.911552 [debug] [MainThread]: Connection 'create_takehome_dev_silver' was properly closed.
[0m20:57:57.911552 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m20:57:57.911552 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m20:57:57.911552 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m20:57:57.913560 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m20:57:57.913560 [debug] [MainThread]: Connection 'model.takehome.patients_per_month' was properly closed.
[0m20:57:57.913560 [debug] [MainThread]: Connection 'model.takehome.patient_risk_flags' was properly closed.
[0m20:57:57.913560 [debug] [MainThread]: Connection 'model.takehome.patient_results' was properly closed.
[0m20:57:57.913560 [debug] [MainThread]: Connection 'model.takehome.lab_results' was properly closed.
[0m20:57:57.913560 [info ] [MainThread]: 
[0m20:57:57.913560 [info ] [MainThread]: Finished running 1 incremental model, 6 table models, 9 view models in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m20:57:57.919058 [debug] [MainThread]: Command end result
[0m20:57:57.941486 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:57:57.941486 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:57:57.954323 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m20:57:57.954323 [info ] [MainThread]: 
[0m20:57:57.958020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:57:57.958020 [info ] [MainThread]: 
[0m20:57:57.958020 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=16
[0m20:57:57.958020 [debug] [MainThread]: Command `dbt run` succeeded at 20:57:57.958020 after 6.26 seconds
[0m20:57:57.958020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A421CC830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A421CEA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A421CCEC0>]}
[0m20:57:57.958020 [debug] [MainThread]: Flushing usage events
[0m20:58:00.215642 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:07.749275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2EDBA0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2F3E8FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA319DF4D0>]}


============================== 20:58:07.759321 | 7d7e8fd8-8dbe-41d3-aea1-3b1ff001de76 ==============================
[0m20:58:07.759321 [info ] [MainThread]: Running with dbt=1.10.15
[0m20:58:07.759321 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'invocation_command': 'dbt test', 'printer_width': '80', 'write_json': 'True'}
[0m20:58:08.040433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d7e8fd8-8dbe-41d3-aea1-3b1ff001de76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA33068560>]}
[0m20:58:08.115806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d7e8fd8-8dbe-41d3-aea1-3b1ff001de76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA331AC5C0>]}
[0m20:58:08.116977 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:58:08.333279 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m20:58:08.482915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:58:08.482915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:58:08.532912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d7e8fd8-8dbe-41d3-aea1-3b1ff001de76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA33634EF0>]}
[0m20:58:08.622848 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:58:08.623493 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:58:08.682578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d7e8fd8-8dbe-41d3-aea1-3b1ff001de76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA33BB4230>]}
[0m20:58:08.682578 [info ] [MainThread]: Found 16 models, 23 data tests, 8 sources, 468 macros
[0m20:58:08.682578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d7e8fd8-8dbe-41d3-aea1-3b1ff001de76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA31E42150>]}
[0m20:58:08.685793 [info ] [MainThread]: 
[0m20:58:08.685793 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:58:08.685793 [info ] [MainThread]: 
[0m20:58:08.685793 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:58:08.694698 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m20:58:08.702444 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m20:58:08.708266 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m20:58:08.764376 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:58:08.764376 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m20:58:08.764376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:08.764376 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:58:08.764376 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m20:58:08.764376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:08.764376 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:58:08.764376 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m20:58:08.764376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:08.788594 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m20:58:08.805205 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m20:58:08.805813 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m20:58:08.805813 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m20:58:08.805813 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m20:58:08.805813 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m20:58:08.805813 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m20:58:08.805813 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m20:58:08.805813 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m20:58:08.830214 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m20:58:08.831143 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m20:58:08.831143 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m20:58:08.831143 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m20:58:08.831143 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m20:58:08.831143 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m20:58:08.836336 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m20:58:08.836336 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m20:58:08.836336 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m20:58:08.836336 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m20:58:08.839973 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m20:58:08.839973 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m20:58:08.839973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d7e8fd8-8dbe-41d3-aea1-3b1ff001de76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA330EDD60>]}
[0m20:58:08.839973 [debug] [MainThread]: Using duckdb connection "master"
[0m20:58:08.839973 [debug] [MainThread]: On master: BEGIN
[0m20:58:08.839973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:08.839973 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:58:08.839973 [debug] [MainThread]: On master: COMMIT
[0m20:58:08.839973 [debug] [MainThread]: Using duckdb connection "master"
[0m20:58:08.839973 [debug] [MainThread]: On master: COMMIT
[0m20:58:08.839973 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:58:08.839973 [debug] [MainThread]: On master: Close
[0m20:58:08.852333 [debug] [Thread-1 (]: Began running node test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f
[0m20:58:08.852333 [debug] [Thread-2 (]: Began running node test.takehome.not_null_lab_results_patient_id.d81edf6925
[0m20:58:08.852333 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown  [RUN]
[0m20:58:08.852333 [debug] [Thread-3 (]: Began running node test.takehome.not_null_lab_results_result_date.09687ad6ea
[0m20:58:08.852333 [debug] [Thread-4 (]: Began running node test.takehome.not_null_medications_per_month_medication_id.0958d28b46
[0m20:58:08.852333 [info ] [Thread-2 (]: 2 of 23 START test not_null_lab_results_patient_id ............................. [RUN]
[0m20:58:08.852333 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f'
[0m20:58:08.852333 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.takehome.not_null_lab_results_patient_id.d81edf6925'
[0m20:58:08.852333 [debug] [Thread-1 (]: Began compiling node test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f
[0m20:58:08.852333 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_lab_results_patient_id.d81edf6925
[0m20:58:08.852333 [info ] [Thread-3 (]: 3 of 23 START test not_null_lab_results_result_date ............................ [RUN]
[0m20:58:08.883851 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"
[0m20:58:08.852333 [info ] [Thread-4 (]: 4 of 23 START test not_null_medications_per_month_medication_id ................ [RUN]
[0m20:58:08.892451 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.takehome.not_null_lab_results_result_date.09687ad6ea'
[0m20:58:08.894509 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_lab_results_patient_id.d81edf6925"
[0m20:58:08.894509 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.takehome.not_null_medications_per_month_medication_id.0958d28b46'
[0m20:58:08.894509 [debug] [Thread-3 (]: Began compiling node test.takehome.not_null_lab_results_result_date.09687ad6ea
[0m20:58:08.897815 [debug] [Thread-4 (]: Began compiling node test.takehome.not_null_medications_per_month_medication_id.0958d28b46
[0m20:58:08.897815 [debug] [Thread-1 (]: Began executing node test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f
[0m20:58:08.903226 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.not_null_lab_results_result_date.09687ad6ea"
[0m20:58:08.910140 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"
[0m20:58:08.926845 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"
[0m20:58:08.931154 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_lab_results_patient_id.d81edf6925
[0m20:58:08.933298 [debug] [Thread-3 (]: Began executing node test.takehome.not_null_lab_results_result_date.09687ad6ea
[0m20:58:08.933298 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_lab_results_patient_id.d81edf6925"
[0m20:58:08.939712 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.not_null_lab_results_result_date.09687ad6ea"
[0m20:58:08.941994 [debug] [Thread-4 (]: Began executing node test.takehome.not_null_medications_per_month_medication_id.0958d28b46
[0m20:58:08.944463 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"
[0m20:58:08.944463 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"
[0m20:58:08.944463 [debug] [Thread-1 (]: On test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f: BEGIN
[0m20:58:08.947958 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:58:08.947958 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_lab_results_patient_id.d81edf6925"
[0m20:58:08.949899 [debug] [Thread-2 (]: On test.takehome.not_null_lab_results_patient_id.d81edf6925: BEGIN
[0m20:58:08.950740 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:58:08.950740 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:58:08.950740 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"
[0m20:58:08.950740 [debug] [Thread-1 (]: On test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        age_group as value_field,
        count(*) as n_records

    from "takehome"."dev_silver"."patients_by_age"
    group by age_group

)

select *
from all_values
where value_field not in (
    '0-17','18-34','35-49','50-64','65+','unknown'
)



  
  
      
    ) dbt_internal_test
[0m20:58:08.950740 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:58:08.954504 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_lab_results_result_date.09687ad6ea"
[0m20:58:08.955015 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"
[0m20:58:08.955015 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_lab_results_patient_id.d81edf6925"
[0m20:58:08.956117 [debug] [Thread-3 (]: On test.takehome.not_null_lab_results_result_date.09687ad6ea: BEGIN
[0m20:58:08.956117 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_medication_id.0958d28b46: BEGIN
[0m20:58:08.956117 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:58:08.958275 [debug] [Thread-2 (]: On test.takehome.not_null_lab_results_patient_id.d81edf6925: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_lab_results_patient_id.d81edf6925"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_silver"."lab_results"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:08.958275 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:58:08.958275 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:58:08.964458 [debug] [Thread-1 (]: On test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f: ROLLBACK
[0m20:58:08.966425 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:58:08.966425 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m20:58:08.966425 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m20:58:08.966425 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f'
[0m20:58:08.966425 [debug] [Thread-2 (]: On test.takehome.not_null_lab_results_patient_id.d81edf6925: ROLLBACK
[0m20:58:08.966425 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_lab_results_result_date.09687ad6ea"
[0m20:58:08.966425 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"
[0m20:58:08.972774 [debug] [Thread-1 (]: On test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f: Close
[0m20:58:08.972774 [debug] [Thread-3 (]: On test.takehome.not_null_lab_results_result_date.09687ad6ea: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_lab_results_result_date.09687ad6ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select result_date
from "takehome"."dev_silver"."lab_results"
where result_date is null



  
  
      
    ) dbt_internal_test
[0m20:58:08.975010 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_lab_results_patient_id.d81edf6925'
[0m20:58:08.975010 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_medication_id.0958d28b46: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select medication_id
from "takehome"."dev_silver"."medications_per_month"
where medication_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:08.975010 [debug] [Thread-2 (]: On test.takehome.not_null_lab_results_patient_id.d81edf6925: Close
[0m20:58:08.975010 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown  [[32mPASS[0m in 0.12s]
[0m20:58:08.975010 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:58:08.975010 [debug] [Thread-1 (]: Finished running node test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f
[0m20:58:08.981090 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:58:08.975010 [info ] [Thread-2 (]: 2 of 23 PASS not_null_lab_results_patient_id ................................... [[32mPASS[0m in 0.12s]
[0m20:58:08.983078 [debug] [Thread-3 (]: On test.takehome.not_null_lab_results_result_date.09687ad6ea: ROLLBACK
[0m20:58:08.983078 [debug] [Thread-1 (]: Began running node test.takehome.not_null_medications_per_month_month.4d739bac88
[0m20:58:08.983078 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_medication_id.0958d28b46: ROLLBACK
[0m20:58:08.983078 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_lab_results_patient_id.d81edf6925
[0m20:58:08.983078 [info ] [Thread-1 (]: 5 of 23 START test not_null_medications_per_month_month ........................ [RUN]
[0m20:58:08.989404 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.not_null_lab_results_result_date.09687ad6ea'
[0m20:58:08.989404 [debug] [Thread-2 (]: Began running node test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe
[0m20:58:08.991286 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.not_null_medications_per_month_medication_id.0958d28b46'
[0m20:58:08.991286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f, now test.takehome.not_null_medications_per_month_month.4d739bac88)
[0m20:58:08.991286 [debug] [Thread-3 (]: On test.takehome.not_null_lab_results_result_date.09687ad6ea: Close
[0m20:58:08.994471 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_medication_id.0958d28b46: Close
[0m20:58:08.994471 [info ] [Thread-2 (]: 6 of 23 START test not_null_medications_per_month_patients_treated ............. [RUN]
[0m20:58:08.995654 [debug] [Thread-1 (]: Began compiling node test.takehome.not_null_medications_per_month_month.4d739bac88
[0m20:58:08.997675 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_lab_results_patient_id.d81edf6925, now test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe)
[0m20:58:08.997675 [info ] [Thread-3 (]: 3 of 23 PASS not_null_lab_results_result_date .................................. [[32mPASS[0m in 0.11s]
[0m20:58:09.006065 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.not_null_medications_per_month_month.4d739bac88"
[0m20:58:09.006065 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe
[0m20:58:08.997675 [info ] [Thread-4 (]: 4 of 23 PASS not_null_medications_per_month_medication_id ...................... [[32mPASS[0m in 0.10s]
[0m20:58:09.008984 [debug] [Thread-3 (]: Finished running node test.takehome.not_null_lab_results_result_date.09687ad6ea
[0m20:58:09.014478 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"
[0m20:58:09.016352 [debug] [Thread-4 (]: Finished running node test.takehome.not_null_medications_per_month_medication_id.0958d28b46
[0m20:58:09.016352 [debug] [Thread-3 (]: Began running node test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d
[0m20:58:09.016352 [debug] [Thread-4 (]: Began running node test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57
[0m20:58:09.018718 [info ] [Thread-3 (]: 7 of 23 START test not_null_patient_risk_flags_high_risk_flag .................. [RUN]
[0m20:58:09.018718 [debug] [Thread-1 (]: Began executing node test.takehome.not_null_medications_per_month_month.4d739bac88
[0m20:58:09.018718 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_lab_results_result_date.09687ad6ea, now test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d)
[0m20:58:09.022494 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.not_null_medications_per_month_month.4d739bac88"
[0m20:58:09.018718 [info ] [Thread-4 (]: 8 of 23 START test not_null_patient_risk_flags_patient_id ...................... [RUN]
[0m20:58:09.022494 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe
[0m20:58:09.022494 [debug] [Thread-3 (]: Began compiling node test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d
[0m20:58:09.022494 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_medications_per_month_medication_id.0958d28b46, now test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57)
[0m20:58:09.033515 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"
[0m20:58:09.033515 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_month.4d739bac88"
[0m20:58:09.033515 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"
[0m20:58:09.038678 [debug] [Thread-4 (]: Began compiling node test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57
[0m20:58:09.039800 [debug] [Thread-1 (]: On test.takehome.not_null_medications_per_month_month.4d739bac88: BEGIN
[0m20:58:09.048294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:09.048294 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"
[0m20:58:09.048294 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"
[0m20:58:09.048294 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:58:09.055756 [debug] [Thread-2 (]: On test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe: BEGIN
[0m20:58:09.055756 [debug] [Thread-3 (]: Began executing node test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d
[0m20:58:09.057766 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_month.4d739bac88"
[0m20:58:09.057766 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:09.059779 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"
[0m20:58:09.059779 [debug] [Thread-1 (]: On test.takehome.not_null_medications_per_month_month.4d739bac88: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_medications_per_month_month.4d739bac88"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "takehome"."dev_silver"."medications_per_month"
where month is null



  
  
      
    ) dbt_internal_test
[0m20:58:09.063786 [debug] [Thread-4 (]: Began executing node test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57
[0m20:58:09.070199 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"
[0m20:58:09.073161 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m20:58:09.073161 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:58:09.073161 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"
[0m20:58:09.078010 [debug] [Thread-1 (]: On test.takehome.not_null_medications_per_month_month.4d739bac88: ROLLBACK
[0m20:58:09.079040 [debug] [Thread-2 (]: On test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patients_treated
from "takehome"."dev_silver"."medications_per_month"
where patients_treated is null



  
  
      
    ) dbt_internal_test
[0m20:58:09.081442 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"
[0m20:58:09.081442 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"
[0m20:58:09.081442 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.not_null_medications_per_month_month.4d739bac88'
[0m20:58:09.081442 [debug] [Thread-3 (]: On test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d: BEGIN
[0m20:58:09.087004 [debug] [Thread-4 (]: On test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57: BEGIN
[0m20:58:09.087004 [debug] [Thread-1 (]: On test.takehome.not_null_medications_per_month_month.4d739bac88: Close
[0m20:58:09.089500 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:58:09.090652 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:58:09.090652 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:58:09.094923 [info ] [Thread-1 (]: 5 of 23 PASS not_null_medications_per_month_month .............................. [[32mPASS[0m in 0.10s]
[0m20:58:09.096870 [debug] [Thread-1 (]: Finished running node test.takehome.not_null_medications_per_month_month.4d739bac88
[0m20:58:09.097879 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m20:58:09.097879 [debug] [Thread-2 (]: On test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe: ROLLBACK
[0m20:58:09.097879 [debug] [Thread-1 (]: Began running node test.takehome.not_null_patients_by_age_patient_id.0646b9206a
[0m20:58:09.097879 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m20:58:09.097879 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"
[0m20:58:09.097879 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe'
[0m20:58:09.097879 [info ] [Thread-1 (]: 9 of 23 START test not_null_patients_by_age_patient_id ......................... [RUN]
[0m20:58:09.105960 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"
[0m20:58:09.107152 [debug] [Thread-3 (]: On test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select high_risk_flag
from "takehome"."dev_silver"."patient_risk_flags"
where high_risk_flag is null



  
  
      
    ) dbt_internal_test
[0m20:58:09.107942 [debug] [Thread-2 (]: On test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe: Close
[0m20:58:09.107942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_medications_per_month_month.4d739bac88, now test.takehome.not_null_patients_by_age_patient_id.0646b9206a)
[0m20:58:09.107942 [debug] [Thread-4 (]: On test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_silver"."patient_risk_flags"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:09.114821 [debug] [Thread-1 (]: Began compiling node test.takehome.not_null_patients_by_age_patient_id.0646b9206a
[0m20:58:09.114821 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:58:09.125251 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"
[0m20:58:09.114821 [info ] [Thread-2 (]: 6 of 23 PASS not_null_medications_per_month_patients_treated ................... [[32mPASS[0m in 0.11s]
[0m20:58:09.125251 [debug] [Thread-3 (]: On test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d: ROLLBACK
[0m20:58:09.125251 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m20:58:09.131141 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe
[0m20:58:09.135389 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d'
[0m20:58:09.135389 [debug] [Thread-2 (]: Began running node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m20:58:09.135389 [debug] [Thread-3 (]: On test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d: Close
[0m20:58:09.139926 [debug] [Thread-1 (]: Began executing node test.takehome.not_null_patients_by_age_patient_id.0646b9206a
[0m20:58:09.143418 [debug] [Thread-4 (]: On test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57: ROLLBACK
[0m20:58:09.143418 [info ] [Thread-2 (]: 10 of 23 START test not_null_patients_patient_id ............................... [RUN]
[0m20:58:09.149725 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"
[0m20:58:09.143418 [info ] [Thread-3 (]: 7 of 23 PASS not_null_patient_risk_flags_high_risk_flag ........................ [[32mPASS[0m in 0.12s]
[0m20:58:09.149725 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe, now test.takehome.not_null_patients_patient_id.330c5fb3d9)
[0m20:58:09.153145 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57'
[0m20:58:09.153145 [debug] [Thread-3 (]: Finished running node test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d
[0m20:58:09.156039 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m20:58:09.157078 [debug] [Thread-4 (]: On test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57: Close
[0m20:58:09.158042 [debug] [Thread-3 (]: Began running node test.takehome.not_null_patients_per_month_month.827712360f
[0m20:58:09.166712 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"
[0m20:58:09.175381 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m20:58:09.166712 [info ] [Thread-3 (]: 11 of 23 START test not_null_patients_per_month_month .......................... [RUN]
[0m20:58:09.177395 [debug] [Thread-1 (]: On test.takehome.not_null_patients_by_age_patient_id.0646b9206a: BEGIN
[0m20:58:09.170620 [info ] [Thread-4 (]: 8 of 23 PASS not_null_patient_risk_flags_patient_id ............................ [[32mPASS[0m in 0.15s]
[0m20:58:09.177395 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d, now test.takehome.not_null_patients_per_month_month.827712360f)
[0m20:58:09.181161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:09.181161 [debug] [Thread-4 (]: Finished running node test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57
[0m20:58:09.184219 [debug] [Thread-3 (]: Began compiling node test.takehome.not_null_patients_per_month_month.827712360f
[0m20:58:09.185185 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m20:58:09.185185 [debug] [Thread-4 (]: Began running node test.takehome.not_null_patients_per_month_new_patients.3bbd15949c
[0m20:58:09.189709 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:58:09.264522 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m20:58:09.273313 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.not_null_patients_per_month_month.827712360f"
[0m20:58:09.272720 [info ] [Thread-4 (]: 12 of 23 START test not_null_patients_per_month_new_patients ................... [RUN]
[0m20:58:09.273313 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"
[0m20:58:09.273313 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57, now test.takehome.not_null_patients_per_month_new_patients.3bbd15949c)
[0m20:58:09.273313 [debug] [Thread-1 (]: On test.takehome.not_null_patients_by_age_patient_id.0646b9206a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_silver"."patients_by_age"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:09.273313 [debug] [Thread-4 (]: Began compiling node test.takehome.not_null_patients_per_month_new_patients.3bbd15949c
[0m20:58:09.273313 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m20:58:09.280887 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"
[0m20:58:09.280887 [debug] [Thread-3 (]: Began executing node test.takehome.not_null_patients_per_month_month.827712360f
[0m20:58:09.280887 [debug] [Thread-2 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: BEGIN
[0m20:58:09.280887 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:58:09.290521 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.not_null_patients_per_month_month.827712360f"
[0m20:58:09.290521 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:09.294264 [debug] [Thread-1 (]: On test.takehome.not_null_patients_by_age_patient_id.0646b9206a: ROLLBACK
[0m20:58:09.295389 [debug] [Thread-4 (]: Began executing node test.takehome.not_null_patients_per_month_new_patients.3bbd15949c
[0m20:58:09.299026 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_patients_per_month_month.827712360f"
[0m20:58:09.299835 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.not_null_patients_by_age_patient_id.0646b9206a'
[0m20:58:09.303173 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"
[0m20:58:09.303173 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m20:58:09.303173 [debug] [Thread-3 (]: On test.takehome.not_null_patients_per_month_month.827712360f: BEGIN
[0m20:58:09.303173 [debug] [Thread-1 (]: On test.takehome.not_null_patients_by_age_patient_id.0646b9206a: Close
[0m20:58:09.305997 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m20:58:09.305997 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:58:09.305997 [debug] [Thread-2 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_patient_id.330c5fb3d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_bronze"."patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:09.305997 [info ] [Thread-1 (]: 9 of 23 PASS not_null_patients_by_age_patient_id ............................... [[32mPASS[0m in 0.20s]
[0m20:58:09.305997 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"
[0m20:58:09.309680 [debug] [Thread-1 (]: Finished running node test.takehome.not_null_patients_by_age_patient_id.0646b9206a
[0m20:58:09.309680 [debug] [Thread-4 (]: On test.takehome.not_null_patients_per_month_new_patients.3bbd15949c: BEGIN
[0m20:58:09.309680 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:58:09.309680 [debug] [Thread-1 (]: Began running node test.takehome.not_null_stg_lab_results_patient_id.71c57600ae
[0m20:58:09.309680 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:58:09.314290 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:58:09.314762 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_patients_per_month_month.827712360f"
[0m20:58:09.314762 [info ] [Thread-1 (]: 13 of 23 START test not_null_stg_lab_results_patient_id ........................ [RUN]
[0m20:58:09.314762 [debug] [Thread-3 (]: On test.takehome.not_null_patients_per_month_month.827712360f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_per_month_month.827712360f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "takehome"."dev_silver"."patients_per_month"
where month is null



  
  
      
    ) dbt_internal_test
[0m20:58:09.314762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patients_by_age_patient_id.0646b9206a, now test.takehome.not_null_stg_lab_results_patient_id.71c57600ae)
[0m20:58:09.314762 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:58:09.314762 [debug] [Thread-2 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: ROLLBACK
[0m20:58:09.314762 [debug] [Thread-1 (]: Began compiling node test.takehome.not_null_stg_lab_results_patient_id.71c57600ae
[0m20:58:09.314762 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:58:09.314762 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"
[0m20:58:09.328119 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"
[0m20:58:09.314762 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_patients_patient_id.330c5fb3d9'
[0m20:58:09.333470 [debug] [Thread-3 (]: On test.takehome.not_null_patients_per_month_month.827712360f: ROLLBACK
[0m20:58:09.333470 [debug] [Thread-4 (]: On test.takehome.not_null_patients_per_month_new_patients.3bbd15949c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select new_patients
from "takehome"."dev_silver"."patients_per_month"
where new_patients is null



  
  
      
    ) dbt_internal_test
[0m20:58:09.333470 [debug] [Thread-2 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: Close
[0m20:58:09.333470 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.not_null_patients_per_month_month.827712360f'
[0m20:58:09.333470 [info ] [Thread-2 (]: 10 of 23 PASS not_null_patients_patient_id ..................................... [[32mPASS[0m in 0.18s]
[0m20:58:09.339346 [debug] [Thread-3 (]: On test.takehome.not_null_patients_per_month_month.827712360f: Close
[0m20:58:09.339346 [debug] [Thread-1 (]: Began executing node test.takehome.not_null_stg_lab_results_patient_id.71c57600ae
[0m20:58:09.341348 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m20:58:09.341348 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:58:09.348294 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"
[0m20:58:09.343178 [info ] [Thread-3 (]: 11 of 23 PASS not_null_patients_per_month_month ................................ [[32mPASS[0m in 0.17s]
[0m20:58:09.350677 [debug] [Thread-2 (]: Began running node test.takehome.not_null_stg_lab_results_test_id.298faf8b41
[0m20:58:09.351940 [debug] [Thread-4 (]: On test.takehome.not_null_patients_per_month_new_patients.3bbd15949c: ROLLBACK
[0m20:58:09.356098 [debug] [Thread-3 (]: Finished running node test.takehome.not_null_patients_per_month_month.827712360f
[0m20:58:09.358779 [info ] [Thread-2 (]: 14 of 23 START test not_null_stg_lab_results_test_id ........................... [RUN]
[0m20:58:09.358779 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.not_null_patients_per_month_new_patients.3bbd15949c'
[0m20:58:09.358779 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"
[0m20:58:09.358779 [debug] [Thread-3 (]: Began running node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m20:58:09.358779 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patients_patient_id.330c5fb3d9, now test.takehome.not_null_stg_lab_results_test_id.298faf8b41)
[0m20:58:09.364411 [debug] [Thread-4 (]: On test.takehome.not_null_patients_per_month_new_patients.3bbd15949c: Close
[0m20:58:09.364411 [debug] [Thread-1 (]: On test.takehome.not_null_stg_lab_results_patient_id.71c57600ae: BEGIN
[0m20:58:09.364411 [info ] [Thread-3 (]: 15 of 23 START test not_null_stg_orders_order_id ............................... [RUN]
[0m20:58:09.366286 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_stg_lab_results_test_id.298faf8b41
[0m20:58:09.366286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:09.368299 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patients_per_month_month.827712360f, now test.takehome.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:58:09.366286 [info ] [Thread-4 (]: 12 of 23 PASS not_null_patients_per_month_new_patients ......................... [[32mPASS[0m in 0.09s]
[0m20:58:09.376065 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"
[0m20:58:09.376065 [debug] [Thread-3 (]: Began compiling node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m20:58:09.378028 [debug] [Thread-4 (]: Finished running node test.takehome.not_null_patients_per_month_new_patients.3bbd15949c
[0m20:58:09.378028 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m20:58:09.381131 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:58:09.388454 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"
[0m20:58:09.381131 [debug] [Thread-4 (]: Began running node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m20:58:09.389465 [debug] [Thread-1 (]: On test.takehome.not_null_stg_lab_results_patient_id.71c57600ae: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_staging"."stg_lab_results"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:09.389465 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_stg_lab_results_test_id.298faf8b41
[0m20:58:09.391478 [info ] [Thread-4 (]: 16 of 23 START test not_null_stg_patients_patient_id ........................... [RUN]
[0m20:58:09.396177 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"
[0m20:58:09.397809 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patients_per_month_new_patients.3bbd15949c, now test.takehome.not_null_stg_patients_patient_id.e578180344)
[0m20:58:09.397809 [debug] [Thread-4 (]: Began compiling node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m20:58:09.414322 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m20:58:09.416107 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"
[0m20:58:09.416107 [debug] [Thread-2 (]: On test.takehome.not_null_stg_lab_results_test_id.298faf8b41: BEGIN
[0m20:58:09.416107 [debug] [Thread-3 (]: Began executing node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m20:58:09.418117 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:58:09.422682 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:58:09.422682 [debug] [Thread-4 (]: Began executing node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m20:58:09.435384 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m20:58:09.435384 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m20:58:09.437403 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"
[0m20:58:09.437403 [debug] [Thread-2 (]: On test.takehome.not_null_stg_lab_results_test_id.298faf8b41: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select test_id
from "takehome"."dev_staging"."stg_lab_results"
where test_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:09.439467 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:58:09.439467 [debug] [Thread-3 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m20:58:09.439467 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:58:09.443883 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m20:58:09.444997 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:58:09.444997 [debug] [Thread-4 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: BEGIN
[0m20:58:09.447720 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:58:09.447720 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:58:09.451023 [debug] [Thread-3 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "takehome"."dev_staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:09.455593 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:58:09.456652 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m20:58:09.458667 [debug] [Thread-4 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_patients_patient_id.e578180344"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_staging"."stg_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:09.460177 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:58:09.464593 [debug] [Thread-3 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m20:58:09.464593 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.not_null_stg_orders_order_id.81cfe2fe64'
[0m20:58:09.468547 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:58:09.468547 [debug] [Thread-3 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m20:58:09.472922 [debug] [Thread-4 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m20:58:09.477422 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.not_null_stg_patients_patient_id.e578180344'
[0m20:58:09.472922 [info ] [Thread-3 (]: 15 of 23 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.10s]
[0m20:58:09.481335 [debug] [Thread-4 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: Close
[0m20:58:09.481335 [debug] [Thread-3 (]: Finished running node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m20:58:09.486055 [info ] [Thread-4 (]: 16 of 23 PASS not_null_stg_patients_patient_id ................................. [[32mPASS[0m in 0.09s]
[0m20:58:09.486055 [debug] [Thread-3 (]: Began running node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m20:58:09.493496 [debug] [Thread-4 (]: Finished running node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m20:58:09.497879 [debug] [Thread-4 (]: Began running node test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b
[0m20:58:09.495514 [info ] [Thread-3 (]: 17 of 23 START test not_null_stg_visits_visit_id ............................... [RUN]
[0m20:58:09.506045 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_stg_orders_order_id.81cfe2fe64, now test.takehome.not_null_stg_visits_visit_id.a2f537804c)
[0m20:58:09.503503 [info ] [Thread-4 (]: 18 of 23 START test unique_patient_risk_flags_patient_id ....................... [RUN]
[0m20:58:09.508944 [debug] [Thread-3 (]: Began compiling node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m20:58:09.510961 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_stg_patients_patient_id.e578180344, now test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b)
[0m20:58:09.527680 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m20:58:09.529692 [debug] [Thread-4 (]: Began compiling node test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b
[0m20:58:09.556072 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"
[0m20:58:09.558084 [debug] [Thread-3 (]: Began executing node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m20:58:09.564081 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m20:58:09.566815 [debug] [Thread-4 (]: Began executing node test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b
[0m20:58:09.572992 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"
[0m20:58:09.574793 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m20:58:09.574793 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"
[0m20:58:09.574793 [debug] [Thread-3 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: BEGIN
[0m20:58:09.574793 [debug] [Thread-4 (]: On test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b: BEGIN
[0m20:58:09.579843 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:58:09.582260 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:58:09.584354 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:58:09.586374 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m20:58:09.588394 [debug] [Thread-3 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_visits_visit_id.a2f537804c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from "takehome"."dev_staging"."stg_visits"
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m20:58:09.589616 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m20:58:09.591746 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"
[0m20:58:09.593767 [debug] [Thread-4 (]: On test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_silver"."patient_risk_flags"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:58:09.593767 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:58:09.598811 [debug] [Thread-3 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: ROLLBACK
[0m20:58:09.603700 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.not_null_stg_visits_visit_id.a2f537804c'
[0m20:58:09.603700 [debug] [Thread-3 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: Close
[0m20:58:09.606091 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m20:58:09.603700 [info ] [Thread-3 (]: 17 of 23 PASS not_null_stg_visits_visit_id ..................................... [[32mPASS[0m in 0.10s]
[0m20:58:09.611266 [debug] [Thread-4 (]: On test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b: ROLLBACK
[0m20:58:09.612136 [debug] [Thread-3 (]: Finished running node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m20:58:09.614615 [debug] [Thread-3 (]: Began running node test.takehome.unique_patients_by_age_patient_id.56061819f5
[0m20:58:09.616240 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b'
[0m20:58:09.616240 [debug] [Thread-4 (]: On test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b: Close
[0m20:58:09.616240 [info ] [Thread-3 (]: 19 of 23 START test unique_patients_by_age_patient_id .......................... [RUN]
[0m20:58:09.619741 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_stg_visits_visit_id.a2f537804c, now test.takehome.unique_patients_by_age_patient_id.56061819f5)
[0m20:58:09.623781 [debug] [Thread-3 (]: Began compiling node test.takehome.unique_patients_by_age_patient_id.56061819f5
[0m20:58:09.622822 [info ] [Thread-4 (]: 18 of 23 PASS unique_patient_risk_flags_patient_id ............................. [[32mPASS[0m in 0.11s]
[0m20:58:09.634754 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.unique_patients_by_age_patient_id.56061819f5"
[0m20:58:09.634754 [debug] [Thread-4 (]: Finished running node test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b
[0m20:58:09.639436 [debug] [Thread-4 (]: Began running node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m20:58:09.639436 [info ] [Thread-4 (]: 20 of 23 START test unique_patients_patient_id ................................. [RUN]
[0m20:58:09.642795 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b, now test.takehome.unique_patients_patient_id.8d0f9eb60a)
[0m20:58:09.642795 [debug] [Thread-4 (]: Began compiling node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m20:58:09.656044 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m20:58:09.658057 [debug] [Thread-3 (]: Began executing node test.takehome.unique_patients_by_age_patient_id.56061819f5
[0m20:58:09.664724 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.unique_patients_by_age_patient_id.56061819f5"
[0m20:58:09.666989 [debug] [Thread-4 (]: Began executing node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m20:58:09.672693 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m20:58:09.672693 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_patients_by_age_patient_id.56061819f5"
[0m20:58:09.672693 [debug] [Thread-3 (]: On test.takehome.unique_patients_by_age_patient_id.56061819f5: BEGIN
[0m20:58:09.672693 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:58:09.681399 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m20:58:09.683313 [debug] [Thread-4 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: BEGIN
[0m20:58:09.683313 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:58:09.685323 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m20:58:09.687334 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_patients_by_age_patient_id.56061819f5"
[0m20:58:09.687334 [debug] [Thread-3 (]: On test.takehome.unique_patients_by_age_patient_id.56061819f5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_patients_by_age_patient_id.56061819f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_silver"."patients_by_age"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:58:09.689085 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:58:09.691094 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m20:58:09.691094 [debug] [Thread-4 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_patients_patient_id.8d0f9eb60a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_bronze"."patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:58:09.694126 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:58:09.694126 [debug] [Thread-3 (]: On test.takehome.unique_patients_by_age_patient_id.56061819f5: ROLLBACK
[0m20:58:09.694126 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.unique_patients_by_age_patient_id.56061819f5'
[0m20:58:09.694126 [debug] [Thread-3 (]: On test.takehome.unique_patients_by_age_patient_id.56061819f5: Close
[0m20:58:09.704983 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m20:58:09.704983 [debug] [Thread-4 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: ROLLBACK
[0m20:58:09.704983 [info ] [Thread-3 (]: 19 of 23 PASS unique_patients_by_age_patient_id ................................ [[32mPASS[0m in 0.09s]
[0m20:58:09.704983 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.unique_patients_patient_id.8d0f9eb60a'
[0m20:58:09.704983 [debug] [Thread-3 (]: Finished running node test.takehome.unique_patients_by_age_patient_id.56061819f5
[0m20:58:09.704983 [debug] [Thread-4 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: Close
[0m20:58:09.704983 [debug] [Thread-3 (]: Began running node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m20:58:09.720745 [info ] [Thread-4 (]: 20 of 23 PASS unique_patients_patient_id ....................................... [[32mPASS[0m in 0.08s]
[0m20:58:09.723175 [info ] [Thread-3 (]: 21 of 23 START test unique_stg_orders_order_id ................................. [RUN]
[0m20:58:09.725650 [debug] [Thread-4 (]: Finished running node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m20:58:09.725650 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.unique_patients_by_age_patient_id.56061819f5, now test.takehome.unique_stg_orders_order_id.e3b841c71a)
[0m20:58:09.728199 [debug] [Thread-4 (]: Began running node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m20:58:09.731460 [debug] [Thread-3 (]: Began compiling node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m20:58:09.739488 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m20:58:09.734081 [info ] [Thread-4 (]: 22 of 23 START test unique_stg_patients_patient_id ............................. [RUN]
[0m20:58:09.743723 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.takehome.unique_patients_patient_id.8d0f9eb60a, now test.takehome.unique_stg_patients_patient_id.8907d3ccf0)
[0m20:58:09.743723 [debug] [Thread-4 (]: Began compiling node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m20:58:09.756735 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m20:58:09.759148 [debug] [Thread-3 (]: Began executing node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m20:58:09.764372 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m20:58:09.767769 [debug] [Thread-4 (]: Began executing node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m20:58:09.772710 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m20:58:09.774532 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m20:58:09.774532 [debug] [Thread-3 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m20:58:09.774532 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:58:09.774532 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:58:09.781056 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m20:58:09.781056 [debug] [Thread-3 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "takehome"."dev_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:58:09.781056 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m20:58:09.781056 [debug] [Thread-4 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: BEGIN
[0m20:58:09.781056 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:58:09.781056 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:58:09.789451 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m20:58:09.789451 [debug] [Thread-4 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_staging"."stg_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:58:09.791462 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m20:58:09.791462 [debug] [Thread-3 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m20:58:09.798327 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.unique_stg_orders_order_id.e3b841c71a'
[0m20:58:09.798327 [debug] [Thread-3 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: Close
[0m20:58:09.798327 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m20:58:09.800959 [debug] [Thread-4 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: ROLLBACK
[0m20:58:09.798327 [info ] [Thread-3 (]: 21 of 23 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.07s]
[0m20:58:09.802968 [debug] [Thread-3 (]: Finished running node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m20:58:09.802968 [debug] [Thread-3 (]: Began running node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m20:58:09.806941 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.unique_stg_patients_patient_id.8907d3ccf0'
[0m20:58:09.806941 [debug] [Thread-4 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: Close
[0m20:58:09.806941 [info ] [Thread-3 (]: 23 of 23 START test unique_stg_visits_visit_id ................................. [RUN]
[0m20:58:09.806941 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.unique_stg_orders_order_id.e3b841c71a, now test.takehome.unique_stg_visits_visit_id.17a0c34d8d)
[0m20:58:09.811940 [debug] [Thread-3 (]: Began compiling node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m20:58:09.817834 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m20:58:09.811940 [info ] [Thread-4 (]: 22 of 23 PASS unique_stg_patients_patient_id ................................... [[32mPASS[0m in 0.07s]
[0m20:58:09.826406 [debug] [Thread-4 (]: Finished running node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m20:58:09.826406 [debug] [Thread-3 (]: Began executing node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m20:58:09.832786 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m20:58:09.832786 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m20:58:09.837984 [debug] [Thread-3 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: BEGIN
[0m20:58:09.839234 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:58:09.839234 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:58:09.842384 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m20:58:09.844829 [debug] [Thread-3 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    visit_id as unique_field,
    count(*) as n_records

from "takehome"."dev_staging"."stg_visits"
where visit_id is not null
group by visit_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:58:09.847667 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m20:58:09.856094 [debug] [Thread-3 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: ROLLBACK
[0m20:58:09.856094 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.unique_stg_visits_visit_id.17a0c34d8d'
[0m20:58:09.856094 [debug] [Thread-3 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: Close
[0m20:58:09.856094 [info ] [Thread-3 (]: 23 of 23 PASS unique_stg_visits_visit_id ....................................... [[32mPASS[0m in 0.05s]
[0m20:58:09.856094 [debug] [Thread-3 (]: Finished running node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m20:58:14.292121 [debug] [Thread-1 (]: SQL status: OK in 4.912 seconds
[0m20:58:14.307832 [debug] [Thread-2 (]: SQL status: OK in 4.877 seconds
[0m20:58:14.325477 [debug] [Thread-1 (]: On test.takehome.not_null_stg_lab_results_patient_id.71c57600ae: ROLLBACK
[0m20:58:14.327490 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.not_null_stg_lab_results_patient_id.71c57600ae'
[0m20:58:14.327490 [debug] [Thread-1 (]: On test.takehome.not_null_stg_lab_results_patient_id.71c57600ae: Close
[0m20:58:14.327490 [info ] [Thread-1 (]: 13 of 23 PASS not_null_stg_lab_results_patient_id .............................. [[32mPASS[0m in 5.01s]
[0m20:58:14.327490 [debug] [Thread-1 (]: Finished running node test.takehome.not_null_stg_lab_results_patient_id.71c57600ae
[0m20:58:14.327490 [debug] [Thread-2 (]: On test.takehome.not_null_stg_lab_results_test_id.298faf8b41: ROLLBACK
[0m20:58:14.327490 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_stg_lab_results_test_id.298faf8b41'
[0m20:58:14.327490 [debug] [Thread-2 (]: On test.takehome.not_null_stg_lab_results_test_id.298faf8b41: Close
[0m20:58:14.327490 [info ] [Thread-2 (]: 14 of 23 PASS not_null_stg_lab_results_test_id ................................. [[32mPASS[0m in 4.97s]
[0m20:58:14.327490 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_stg_lab_results_test_id.298faf8b41
[0m20:58:14.339689 [debug] [MainThread]: Using duckdb connection "master"
[0m20:58:14.339689 [debug] [MainThread]: On master: BEGIN
[0m20:58:14.341426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:14.341426 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:58:14.343561 [debug] [MainThread]: On master: COMMIT
[0m20:58:14.343561 [debug] [MainThread]: Using duckdb connection "master"
[0m20:58:14.343561 [debug] [MainThread]: On master: COMMIT
[0m20:58:14.343561 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:58:14.343561 [debug] [MainThread]: On master: Close
[0m20:58:14.343561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:14.343561 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m20:58:14.343561 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m20:58:14.343561 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m20:58:14.343561 [debug] [MainThread]: Connection 'test.takehome.not_null_stg_lab_results_patient_id.71c57600ae' was properly closed.
[0m20:58:14.343561 [debug] [MainThread]: Connection 'test.takehome.not_null_stg_lab_results_test_id.298faf8b41' was properly closed.
[0m20:58:14.343561 [debug] [MainThread]: Connection 'test.takehome.unique_stg_visits_visit_id.17a0c34d8d' was properly closed.
[0m20:58:14.343561 [debug] [MainThread]: Connection 'test.takehome.unique_stg_patients_patient_id.8907d3ccf0' was properly closed.
[0m20:58:14.343561 [info ] [MainThread]: 
[0m20:58:14.343561 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 5.66 seconds (5.66s).
[0m20:58:14.350101 [debug] [MainThread]: Command end result
[0m20:58:14.385123 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m20:58:14.385615 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m20:58:14.394023 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m20:58:14.394023 [info ] [MainThread]: 
[0m20:58:14.394023 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:58:14.394023 [info ] [MainThread]: 
[0m20:58:14.394023 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=23
[0m20:58:14.394023 [debug] [MainThread]: Command `dbt test` succeeded at 20:58:14.394023 after 6.78 seconds
[0m20:58:14.401966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA3172A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA317951F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA33F13AD0>]}
[0m20:58:14.402293 [debug] [MainThread]: Flushing usage events
[0m20:58:16.199620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:15:28.898483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C8345FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C6141BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C6758FE0>]}


============================== 21:15:28.918999 | d7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6 ==============================
[0m21:15:28.918999 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:15:28.920765 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'no_print': 'None', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m21:15:29.617783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CA3CD790>]}
[0m21:15:29.842288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C91FF2F0>]}
[0m21:15:29.842288 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:15:30.853314 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:15:31.151222 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:15:31.151222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CABE1580>]}
[0m21:15:36.555193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CAFEDA30>]}
[0m21:15:36.876522 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:15:36.884985 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:15:36.996354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CAF215E0>]}
[0m21:15:36.996354 [info ] [MainThread]: Found 16 models, 1 operation, 23 data tests, 8 sources, 468 macros
[0m21:15:36.996354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CAF215E0>]}
[0m21:15:36.996354 [info ] [MainThread]: 
[0m21:15:37.012327 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:15:37.012327 [info ] [MainThread]: 
[0m21:15:37.012327 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:15:37.043311 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:15:37.055625 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:15:37.087758 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome'
[0m21:15:37.320600 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:15:37.320600 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:15:37.320600 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:15:37.320600 [debug] [ThreadPool]: Using duckdb connection "list_takehome"
[0m21:15:37.320600 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:15:37.320600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:37.320600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:37.320600 [debug] [ThreadPool]: On list_takehome: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"takehome"'
    
  
  
[0m21:15:37.320600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:37.433029 [debug] [ThreadPool]: SQL status: OK in 0.101 seconds
[0m21:15:37.433029 [debug] [ThreadPool]: On list_takehome: Close
[0m21:15:37.433029 [debug] [ThreadPool]: SQL status: OK in 0.113 seconds
[0m21:15:37.433029 [debug] [ThreadPool]: On list_takehome: Close
[0m21:15:37.433029 [debug] [ThreadPool]: SQL status: OK in 0.116 seconds
[0m21:15:37.449168 [debug] [ThreadPool]: On list_takehome: Close
[0m21:15:37.449168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_silver)
[0m21:15:37.449168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_staging)
[0m21:15:37.449168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_takehome, now create_takehome_dev_bronze)
[0m21:15:37.449168 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_silver"
"
[0m21:15:37.449168 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_staging"
"
[0m21:15:37.449168 [debug] [ThreadPool]: Creating schema "database: "takehome"
schema: "dev_bronze"
"
[0m21:15:37.486064 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m21:15:37.491889 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:15:37.499467 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:15:37.501107 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:15:37.502581 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:15:37.503966 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
        select type from duckdb_databases()
        where lower(database_name)='takehome'
        and type='sqlite'
    
  
[0m21:15:37.505422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:37.506789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:37.507935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:15:37.514285 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m21:15:37.515884 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m21:15:37.516641 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m21:15:37.520962 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:15:37.524978 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m21:15:37.527794 [debug] [ThreadPool]: On create_takehome_dev_staging: BEGIN
[0m21:15:37.531696 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:15:37.532641 [debug] [ThreadPool]: On create_takehome_dev_silver: BEGIN
[0m21:15:37.534847 [debug] [ThreadPool]: On create_takehome_dev_bronze: BEGIN
[0m21:15:37.536477 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m21:15:37.538613 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:15:37.539477 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:15:37.542450 [debug] [ThreadPool]: On create_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_staging"} */

    
    
        create schema if not exists "takehome"."dev_staging"
    
[0m21:15:37.540782 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m21:15:37.543881 [debug] [ThreadPool]: On create_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_silver"} */

    
    
        create schema if not exists "takehome"."dev_silver"
    
[0m21:15:37.545716 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m21:15:37.547665 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m21:15:37.549306 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:15:37.552145 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m21:15:37.553222 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m21:15:37.554685 [debug] [ThreadPool]: On create_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "create_takehome_dev_bronze"} */

    
    
        create schema if not exists "takehome"."dev_bronze"
    
[0m21:15:37.554685 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_staging"
[0m21:15:37.558690 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m21:15:37.561094 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_silver"
[0m21:15:37.560466 [debug] [ThreadPool]: On create_takehome_dev_staging: COMMIT
[0m21:15:37.561094 [debug] [ThreadPool]: On create_takehome_dev_silver: COMMIT
[0m21:15:37.564901 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:15:37.565818 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m21:15:37.568031 [debug] [ThreadPool]: On create_takehome_dev_staging: Close
[0m21:15:37.570986 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m21:15:37.571776 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m21:15:37.574288 [debug] [ThreadPool]: Using duckdb connection "create_takehome_dev_bronze"
[0m21:15:37.576202 [debug] [ThreadPool]: On create_takehome_dev_silver: Close
[0m21:15:37.577309 [debug] [ThreadPool]: On create_takehome_dev_bronze: COMMIT
[0m21:15:37.580128 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m21:15:37.581643 [debug] [ThreadPool]: On create_takehome_dev_bronze: Close
[0m21:15:37.588919 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m21:15:37.605460 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m21:15:37.609836 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m21:15:37.616938 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:15:37.619924 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m21:15:37.618770 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m21:15:37.619924 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m21:15:37.627975 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:15:37.629989 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m21:15:37.621934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:37.627975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:37.629989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:37.632001 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m21:15:37.635768 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m21:15:37.636126 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m21:15:37.636126 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m21:15:37.636126 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:15:37.636126 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m21:15:37.636126 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:15:37.644360 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m21:15:37.636126 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m21:15:37.710617 [debug] [ThreadPool]: SQL status: OK in 0.067 seconds
[0m21:15:37.715159 [debug] [ThreadPool]: SQL status: OK in 0.072 seconds
[0m21:15:37.715159 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m21:15:37.715159 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m21:15:37.715159 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m21:15:37.731248 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m21:15:37.731248 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m21:15:37.731248 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m21:15:37.739555 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m21:15:37.739555 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m21:15:37.747900 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m21:15:37.747900 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m21:15:37.756298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CA3C7D70>]}
[0m21:15:37.759975 [debug] [MainThread]: Using duckdb connection "master"
[0m21:15:37.759975 [debug] [MainThread]: On master: BEGIN
[0m21:15:37.759975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:15:37.759975 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m21:15:37.759975 [debug] [MainThread]: On master: COMMIT
[0m21:15:37.759975 [debug] [MainThread]: Using duckdb connection "master"
[0m21:15:37.759975 [debug] [MainThread]: On master: COMMIT
[0m21:15:37.759975 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:15:37.787819 [debug] [MainThread]: Writing injected SQL for node "operation.takehome.takehome-on-run-start-0"
[0m21:15:37.931524 [info ] [MainThread]: 1 of 1 START hook: takehome.on-run-start.0 ..................................... [RUN]
[0m21:15:37.935553 [debug] [MainThread]: Using duckdb connection "master"
[0m21:15:37.935553 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "master"} */
PRAGMA log_query_path='logs/query_log.sql';
[0m21:15:37.939574 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m21:15:37.943594 [info ] [MainThread]: 1 of 1 OK hook: takehome.on-run-start.0 ........................................ [[32mOK[0m in 0.17s]
[0m21:15:37.945602 [info ] [MainThread]: 
[0m21:15:37.945602 [debug] [MainThread]: On master: Close
[0m21:15:37.972293 [debug] [Thread-1 (]: Began running node model.takehome.stg_conditions
[0m21:15:37.972293 [debug] [Thread-2 (]: Began running node model.takehome.stg_documents
[0m21:15:37.972293 [debug] [Thread-3 (]: Began running node model.takehome.stg_lab_results
[0m21:15:37.981993 [debug] [Thread-4 (]: Began running node model.takehome.stg_med_admins
[0m21:15:37.980754 [info ] [Thread-1 (]: 1 of 16 START sql view model dev_staging.stg_conditions ........................ [RUN]
[0m21:15:37.981993 [info ] [Thread-2 (]: 2 of 16 START sql view model dev_staging.stg_documents ......................... [RUN]
[0m21:15:37.991399 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.takehome.stg_conditions'
[0m21:15:37.987101 [info ] [Thread-3 (]: 3 of 16 START sql view model dev_staging.stg_lab_results ....................... [RUN]
[0m21:15:37.998512 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.takehome.stg_documents'
[0m21:15:37.998512 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_conditions
[0m21:15:37.991399 [info ] [Thread-4 (]: 4 of 16 START sql view model dev_staging.stg_med_admins ........................ [RUN]
[0m21:15:37.998512 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.takehome.stg_lab_results'
[0m21:15:37.998512 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_documents
[0m21:15:38.015819 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_conditions"
[0m21:15:38.015819 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.takehome.stg_med_admins'
[0m21:15:38.015819 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_lab_results
[0m21:15:38.023579 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_documents"
[0m21:15:38.035422 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_med_admins
[0m21:15:38.042926 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_lab_results"
[0m21:15:38.050284 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_med_admins"
[0m21:15:38.057861 [debug] [Thread-1 (]: Began executing node model.takehome.stg_conditions
[0m21:15:38.137386 [debug] [Thread-3 (]: Began executing node model.takehome.stg_lab_results
[0m21:15:38.169960 [debug] [Thread-2 (]: Began executing node model.takehome.stg_documents
[0m21:15:38.186584 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_conditions"
[0m21:15:38.186584 [debug] [Thread-4 (]: Began executing node model.takehome.stg_med_admins
[0m21:15:38.186584 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_lab_results"
[0m21:15:38.198754 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_documents"
[0m21:15:38.202773 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_med_admins"
[0m21:15:38.202773 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m21:15:38.218724 [debug] [Thread-1 (]: On model.takehome.stg_conditions: BEGIN
[0m21:15:38.218724 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:15:38.224985 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m21:15:38.224985 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m21:15:38.227005 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m21:15:38.227005 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: BEGIN
[0m21:15:38.227005 [debug] [Thread-2 (]: On model.takehome.stg_documents: BEGIN
[0m21:15:38.227005 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m21:15:38.227005 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: BEGIN
[0m21:15:38.234614 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:15:38.234614 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:15:38.234614 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m21:15:38.234614 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:15:38.234614 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

  
  create view "takehome"."dev_staging"."stg_conditions__dbt_tmp" as (
    select
    id   as condition_id,
    name as condition_name
from "takehome"."raw"."conditions"
  );

[0m21:15:38.234614 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m21:15:38.234614 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m21:15:38.234614 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m21:15:38.250762 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m21:15:38.234614 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m21:15:38.252771 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

  
  create view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" as (
    select
    patient_id,
    patient_condition_id,
    medication_id,
    coalesce(date_stopped, date_started) as updated_at,
    date_started,
    date_stopped,
    dosage
from "takehome"."raw"."med_admins"
  );

[0m21:15:38.234614 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:15:38.250762 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m21:15:38.278735 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

  
  create view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" as (
    with raw_json as (
    select *
    from read_json_auto('src_data/lab_results/*.json')
),
flattened as (
    select
        testId::bigint            as test_id,
        orderId::bigint           as order_id,
        patientId::bigint         as patient_id,
        cast(resultDate as date)  as result_date,
        json_extract(value, '$.componentName')::varchar   as component_name,
        json_extract(value, '$.componentRefHi')::double   as component_ref_hi,
        json_extract(value, '$.componentRefLo')::double   as component_ref_lo,
        json_extract(value, '$.componentUnits')::varchar  as component_units,
        json_extract(value, '$.resultValue')::double      as result_value
    from raw_json
    cross join json_each(testResults)
)
select *
from flattened
  );

[0m21:15:38.254782 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

  
  create view "takehome"."dev_staging"."stg_documents__dbt_tmp" as (
    select
    document_id,
    patient_id,
    visit_id,
    document_line,
    document_text
from "takehome"."raw"."documents"
  );

[0m21:15:38.276726 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m21:15:38.280744 [debug] [Thread-4 (]: SQL status: OK in 0.025 seconds
[0m21:15:38.282495 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:15:38.282495 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions" rename to "stg_conditions__dbt_backup"
[0m21:15:38.282495 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m21:15:38.298275 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m21:15:38.306731 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents" rename to "stg_documents__dbt_backup"
[0m21:15:38.306731 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:15:38.306731 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins" rename to "stg_med_admins__dbt_backup"
[0m21:15:38.306731 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:15:38.322624 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m21:15:38.322624 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m21:15:38.322624 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m21:15:38.322624 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */
alter view "takehome"."dev_staging"."stg_documents__dbt_tmp" rename to "stg_documents"
[0m21:15:38.338636 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */
alter view "takehome"."dev_staging"."stg_conditions__dbt_tmp" rename to "stg_conditions"
[0m21:15:38.338636 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m21:15:38.338636 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:15:38.338636 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */
alter view "takehome"."dev_staging"."stg_med_admins__dbt_tmp" rename to "stg_med_admins"
[0m21:15:38.370625 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m21:15:38.409002 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m21:15:38.411018 [debug] [Thread-4 (]: SQL status: OK in 0.037 seconds
[0m21:15:38.417052 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m21:15:38.419065 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m21:15:38.419065 [debug] [Thread-3 (]: SQL status: OK in 0.141 seconds
[0m21:15:38.419065 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m21:15:38.419065 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m21:15:38.419065 [debug] [Thread-2 (]: On model.takehome.stg_documents: COMMIT
[0m21:15:38.435194 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m21:15:38.443528 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m21:15:38.445767 [debug] [Thread-1 (]: On model.takehome.stg_conditions: COMMIT
[0m21:15:38.446607 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: COMMIT
[0m21:15:38.446607 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */
alter view "takehome"."dev_staging"."stg_lab_results" rename to "stg_lab_results__dbt_backup"
[0m21:15:38.454030 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:15:38.454030 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m21:15:38.454030 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m21:15:38.467436 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m21:15:38.467436 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m21:15:38.471060 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */
alter view "takehome"."dev_staging"."stg_lab_results__dbt_tmp" rename to "stg_lab_results"
[0m21:15:38.490277 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_documents"
[0m21:15:38.503417 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_conditions"
[0m21:15:38.513507 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_med_admins"
[0m21:15:38.519641 [debug] [Thread-2 (]: On model.takehome.stg_documents: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_documents"} */

      drop view if exists "takehome"."dev_staging"."stg_documents__dbt_backup" cascade
    
[0m21:15:38.521668 [debug] [Thread-1 (]: On model.takehome.stg_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_conditions__dbt_backup" cascade
    
[0m21:15:38.523843 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:15:38.525867 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_med_admins"} */

      drop view if exists "takehome"."dev_staging"."stg_med_admins__dbt_backup" cascade
    
[0m21:15:38.535625 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m21:15:38.535625 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: COMMIT
[0m21:15:38.541126 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:15:38.549192 [debug] [Thread-2 (]: On model.takehome.stg_documents: Close
[0m21:15:38.551204 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m21:15:38.551204 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m21:15:38.556098 [debug] [Thread-1 (]: On model.takehome.stg_conditions: Close
[0m21:15:38.567144 [debug] [Thread-4 (]: On model.takehome.stg_med_admins: Close
[0m21:15:38.572662 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: COMMIT
[0m21:15:38.572662 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CB008140>]}
[0m21:15:38.583148 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CB464B60>]}
[0m21:15:38.572662 [info ] [Thread-2 (]: 2 of 16 OK created sql view model dev_staging.stg_documents .................... [[32mOK[0m in 0.57s]
[0m21:15:38.572662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CB464290>]}
[0m21:15:38.588010 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m21:15:38.583148 [info ] [Thread-4 (]: 4 of 16 OK created sql view model dev_staging.stg_med_admins ................... [[32mOK[0m in 0.56s]
[0m21:15:38.588518 [debug] [Thread-2 (]: Finished running node model.takehome.stg_documents
[0m21:15:38.600217 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_lab_results"
[0m21:15:38.591744 [info ] [Thread-1 (]: 1 of 16 OK created sql view model dev_staging.stg_conditions ................... [[32mOK[0m in 0.58s]
[0m21:15:38.604023 [debug] [Thread-4 (]: Finished running node model.takehome.stg_med_admins
[0m21:15:38.604023 [debug] [Thread-2 (]: Began running node model.takehome.stg_medications
[0m21:15:38.608351 [debug] [Thread-4 (]: Began running node model.takehome.stg_orders
[0m21:15:38.608351 [debug] [Thread-1 (]: Finished running node model.takehome.stg_conditions
[0m21:15:38.608351 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_lab_results"} */

      drop view if exists "takehome"."dev_staging"."stg_lab_results__dbt_backup" cascade
    
[0m21:15:38.620358 [debug] [Thread-1 (]: Began running node model.takehome.stg_patient_conditions
[0m21:15:38.616494 [info ] [Thread-2 (]: 5 of 16 START sql view model dev_staging.stg_medications ....................... [RUN]
[0m21:15:38.616494 [info ] [Thread-4 (]: 6 of 16 START sql view model dev_staging.stg_orders ............................ [RUN]
[0m21:15:38.624786 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_documents, now model.takehome.stg_medications)
[0m21:15:38.628649 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:15:38.624786 [info ] [Thread-1 (]: 7 of 16 START sql view model dev_staging.stg_patient_conditions ................ [RUN]
[0m21:15:38.630666 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_med_admins, now model.takehome.stg_orders)
[0m21:15:38.632429 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_medications
[0m21:15:38.638502 [debug] [Thread-3 (]: On model.takehome.stg_lab_results: Close
[0m21:15:38.640520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_conditions, now model.takehome.stg_patient_conditions)
[0m21:15:38.642537 [debug] [Thread-4 (]: Began compiling node model.takehome.stg_orders
[0m21:15:38.648782 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_medications"
[0m21:15:38.648782 [debug] [Thread-1 (]: Began compiling node model.takehome.stg_patient_conditions
[0m21:15:38.656939 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CA859C70>]}
[0m21:15:38.668373 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.stg_orders"
[0m21:15:38.678025 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.stg_patient_conditions"
[0m21:15:38.679455 [info ] [Thread-3 (]: 3 of 16 OK created sql view model dev_staging.stg_lab_results .................. [[32mOK[0m in 0.66s]
[0m21:15:38.682697 [debug] [Thread-2 (]: Began executing node model.takehome.stg_medications
[0m21:15:38.684708 [debug] [Thread-3 (]: Finished running node model.takehome.stg_lab_results
[0m21:15:38.697461 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_medications"
[0m21:15:38.697461 [debug] [Thread-3 (]: Began running node model.takehome.stg_patients
[0m21:15:38.697461 [debug] [Thread-4 (]: Began executing node model.takehome.stg_orders
[0m21:15:38.706750 [debug] [Thread-1 (]: Began executing node model.takehome.stg_patient_conditions
[0m21:15:38.717614 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.stg_orders"
[0m21:15:38.729165 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.stg_patient_conditions"
[0m21:15:38.697461 [info ] [Thread-3 (]: 8 of 16 START sql view model dev_staging.stg_patients .......................... [RUN]
[0m21:15:38.737459 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m21:15:38.738391 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_lab_results, now model.takehome.stg_patients)
[0m21:15:38.741086 [debug] [Thread-2 (]: On model.takehome.stg_medications: BEGIN
[0m21:15:38.743104 [debug] [Thread-3 (]: Began compiling node model.takehome.stg_patients
[0m21:15:38.743104 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m21:15:38.746183 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:15:38.754785 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.stg_patients"
[0m21:15:38.757132 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m21:15:38.757132 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: BEGIN
[0m21:15:38.761169 [debug] [Thread-4 (]: On model.takehome.stg_orders: BEGIN
[0m21:15:38.762185 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m21:15:38.762185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:38.762185 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:15:38.767097 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m21:15:38.767097 [debug] [Thread-3 (]: Began executing node model.takehome.stg_patients
[0m21:15:38.770309 [debug] [Thread-2 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

  
  create view "takehome"."dev_staging"."stg_medications__dbt_tmp" as (
    select
    id   as medication_id,
    name as medication_name
from "takehome"."raw"."medications"
  );

[0m21:15:38.770309 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m21:15:38.784485 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.stg_patients"
[0m21:15:38.786227 [debug] [Thread-4 (]: SQL status: OK in 0.021 seconds
[0m21:15:38.788247 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m21:15:38.790264 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:15:38.792278 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m21:15:38.792278 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

  
  create view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" as (
    select
    id                     as patient_condition_id,
    patient_id,
    condition_id,
    coalesce(date_ended, date_started) as updated_at,
    date_started,
    date_ended
from "takehome"."raw"."patient_conditions"
  );

[0m21:15:38.806088 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m21:15:38.808104 [debug] [Thread-4 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

  
  create view "takehome"."dev_staging"."stg_orders__dbt_tmp" as (
    select
    id            as order_id,
    patient_id,
    condition_id,
    order_date    as updated_at,
    order_date
from "takehome"."raw"."orders"
  );

[0m21:15:38.811360 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:15:38.811360 [debug] [Thread-2 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications" rename to "stg_medications__dbt_backup"
[0m21:15:38.815466 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:15:38.817482 [debug] [Thread-3 (]: On model.takehome.stg_patients: BEGIN
[0m21:15:38.817482 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m21:15:38.817482 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m21:15:38.817482 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:15:38.833350 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m21:15:38.817482 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions" rename to "stg_patient_conditions__dbt_backup"
[0m21:15:38.833350 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m21:15:38.849062 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m21:15:38.849062 [debug] [Thread-3 (]: SQL status: OK in 0.027 seconds
[0m21:15:38.849062 [debug] [Thread-4 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders" rename to "stg_orders__dbt_backup"
[0m21:15:38.849062 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m21:15:38.849062 [debug] [Thread-2 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */
alter view "takehome"."dev_staging"."stg_medications__dbt_tmp" rename to "stg_medications"
[0m21:15:38.849062 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:15:38.867873 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m21:15:38.867873 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m21:15:38.867873 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

  
  create view "takehome"."dev_staging"."stg_patients__dbt_tmp" as (
    select
    id as patient_id,
    coalesce(
        date_deactivated,
        date_activated,
        date_of_death,
        date_of_birth
    )                                    as updated_at,
    first_name,
    last_name,
    ssn,
    date_of_birth,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_death,
    date_activated,
    date_deactivated
from "takehome"."raw"."patients"
  );

[0m21:15:38.867873 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */
alter view "takehome"."dev_staging"."stg_patient_conditions__dbt_tmp" rename to "stg_patient_conditions"
[0m21:15:38.880996 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m21:15:38.880996 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m21:15:38.896748 [debug] [Thread-2 (]: On model.takehome.stg_medications: COMMIT
[0m21:15:38.896748 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m21:15:38.896748 [debug] [Thread-4 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */
alter view "takehome"."dev_staging"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m21:15:38.896748 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m21:15:38.896748 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m21:15:38.896748 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m21:15:38.912681 [debug] [Thread-2 (]: On model.takehome.stg_medications: COMMIT
[0m21:15:38.912681 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:15:38.912681 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m21:15:38.912681 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m21:15:38.912681 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients" rename to "stg_patients__dbt_backup"
[0m21:15:38.928679 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: COMMIT
[0m21:15:38.931096 [debug] [Thread-4 (]: On model.takehome.stg_orders: COMMIT
[0m21:15:38.934274 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m21:15:38.936294 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m21:15:38.938311 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:15:38.944355 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_medications"
[0m21:15:38.944355 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:15:38.944355 [debug] [Thread-4 (]: On model.takehome.stg_orders: COMMIT
[0m21:15:38.960283 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:15:38.960283 [debug] [Thread-2 (]: On model.takehome.stg_medications: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_medications"} */

      drop view if exists "takehome"."dev_staging"."stg_medications__dbt_backup" cascade
    
[0m21:15:38.964620 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.stg_patient_conditions"
[0m21:15:38.964620 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */
alter view "takehome"."dev_staging"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m21:15:38.964620 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patient_conditions"} */

      drop view if exists "takehome"."dev_staging"."stg_patient_conditions__dbt_backup" cascade
    
[0m21:15:38.976356 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m21:15:38.976356 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:15:38.989101 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.stg_orders"
[0m21:15:38.992133 [debug] [Thread-2 (]: SQL status: OK in 0.018 seconds
[0m21:15:38.994634 [debug] [Thread-3 (]: On model.takehome.stg_patients: COMMIT
[0m21:15:38.994634 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m21:15:38.994634 [debug] [Thread-4 (]: On model.takehome.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_orders"} */

      drop view if exists "takehome"."dev_staging"."stg_orders__dbt_backup" cascade
    
[0m21:15:38.994634 [debug] [Thread-2 (]: On model.takehome.stg_medications: Close
[0m21:15:38.994634 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:15:39.008146 [debug] [Thread-1 (]: On model.takehome.stg_patient_conditions: Close
[0m21:15:39.011761 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CAE016A0>]}
[0m21:15:39.013781 [debug] [Thread-3 (]: On model.takehome.stg_patients: COMMIT
[0m21:15:39.013781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CAE23950>]}
[0m21:15:39.016670 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m21:15:39.024221 [debug] [Thread-4 (]: On model.takehome.stg_orders: Close
[0m21:15:39.024221 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m21:15:39.018682 [info ] [Thread-2 (]: 5 of 16 OK created sql view model dev_staging.stg_medications .................. [[32mOK[0m in 0.39s]
[0m21:15:39.024221 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CAE235F0>]}
[0m21:15:39.020692 [info ] [Thread-1 (]: 7 of 16 OK created sql view model dev_staging.stg_patient_conditions ........... [[32mOK[0m in 0.37s]
[0m21:15:39.032418 [debug] [Thread-2 (]: Finished running node model.takehome.stg_medications
[0m21:15:39.040961 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.stg_patients"
[0m21:15:39.049103 [debug] [Thread-1 (]: Finished running node model.takehome.stg_patient_conditions
[0m21:15:39.052147 [debug] [Thread-2 (]: Began running node model.takehome.stg_visits
[0m21:15:39.040961 [info ] [Thread-4 (]: 6 of 16 OK created sql view model dev_staging.stg_orders ....................... [[32mOK[0m in 0.40s]
[0m21:15:39.052147 [debug] [Thread-3 (]: On model.takehome.stg_patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_patients"} */

      drop view if exists "takehome"."dev_staging"."stg_patients__dbt_backup" cascade
    
[0m21:15:39.056488 [debug] [Thread-1 (]: Began running node model.takehome.lab_results
[0m21:15:39.059820 [debug] [Thread-4 (]: Finished running node model.takehome.stg_orders
[0m21:15:39.057502 [info ] [Thread-2 (]: 9 of 16 START sql view model dev_staging.stg_visits ............................ [RUN]
[0m21:15:39.067354 [debug] [Thread-4 (]: Began running node model.takehome.medications_per_month
[0m21:15:39.067354 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m21:15:39.065309 [info ] [Thread-1 (]: 10 of 16 START sql table model dev_silver.lab_results .......................... [RUN]
[0m21:15:39.067354 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_medications, now model.takehome.stg_visits)
[0m21:15:39.081460 [debug] [Thread-3 (]: On model.takehome.stg_patients: Close
[0m21:15:39.074391 [info ] [Thread-4 (]: 11 of 16 START sql table model dev_silver.medications_per_month ................ [RUN]
[0m21:15:39.084065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patient_conditions, now model.takehome.lab_results)
[0m21:15:39.087340 [debug] [Thread-2 (]: Began compiling node model.takehome.stg_visits
[0m21:15:39.089358 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CB53E150>]}
[0m21:15:39.089358 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.stg_orders, now model.takehome.medications_per_month)
[0m21:15:39.093164 [debug] [Thread-1 (]: Began compiling node model.takehome.lab_results
[0m21:15:39.103994 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.stg_visits"
[0m21:15:39.109812 [debug] [Thread-4 (]: Began compiling node model.takehome.medications_per_month
[0m21:15:39.106017 [info ] [Thread-3 (]: 8 of 16 OK created sql view model dev_staging.stg_patients ..................... [[32mOK[0m in 0.35s]
[0m21:15:39.113843 [debug] [Thread-1 (]: Writing injected SQL for node "model.takehome.lab_results"
[0m21:15:39.123898 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.medications_per_month"
[0m21:15:39.139733 [debug] [Thread-3 (]: Finished running node model.takehome.stg_patients
[0m21:15:39.142894 [debug] [Thread-2 (]: Began executing node model.takehome.stg_visits
[0m21:15:39.155709 [debug] [Thread-3 (]: Began running node model.takehome.patient_results
[0m21:15:39.163847 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.stg_visits"
[0m21:15:39.155709 [info ] [Thread-3 (]: 12 of 16 START sql incremental model dev_bronze.patient_results ................ [RUN]
[0m21:15:39.163847 [debug] [Thread-4 (]: Began executing node model.takehome.medications_per_month
[0m21:15:39.163847 [debug] [Thread-1 (]: Began executing node model.takehome.lab_results
[0m21:15:39.163847 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.takehome.stg_patients, now model.takehome.patient_results)
[0m21:15:39.245562 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m21:15:39.270219 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.medications_per_month"
[0m21:15:39.294441 [debug] [Thread-1 (]: Writing runtime sql for node "model.takehome.lab_results"
[0m21:15:39.294441 [debug] [Thread-3 (]: Began compiling node model.takehome.patient_results
[0m21:15:39.294441 [debug] [Thread-2 (]: On model.takehome.stg_visits: BEGIN
[0m21:15:39.326037 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:15:39.326037 [debug] [Thread-3 (]: Writing injected SQL for node "model.takehome.patient_results"
[0m21:15:39.326037 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m21:15:39.326037 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m21:15:39.326037 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.lab_results"
[0m21:15:39.326037 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m21:15:39.326037 [debug] [Thread-4 (]: On model.takehome.medications_per_month: BEGIN
[0m21:15:39.341958 [debug] [Thread-3 (]: Began executing node model.takehome.patient_results
[0m21:15:39.341958 [debug] [Thread-1 (]: On model.takehome.lab_results: BEGIN
[0m21:15:39.341958 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

  
  create view "takehome"."dev_staging"."stg_visits__dbt_tmp" as (
    select
    id                    as visit_id,
    visit_date            as updated_at,
    patient_condition_id,
    visit_date
from "takehome"."raw"."visits"
  );

[0m21:15:39.341958 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:15:39.375597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:15:39.472837 [debug] [Thread-2 (]: SQL status: OK in 0.047 seconds
[0m21:15:39.475377 [debug] [Thread-1 (]: SQL status: OK in 0.095 seconds
[0m21:15:39.476324 [debug] [Thread-4 (]: SQL status: OK in 0.128 seconds
[0m21:15:39.497861 [debug] [Thread-3 (]: Invalid value for on_schema_change (sync) specified. Setting default value of ignore.
[0m21:15:39.513970 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m21:15:39.516000 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.lab_results"
[0m21:15:39.517896 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m21:15:39.522461 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m21:15:39.526327 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits" rename to "stg_visits__dbt_backup"
[0m21:15:39.530529 [debug] [Thread-1 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

  
    
    

    create  table
      "takehome"."dev_silver"."lab_results__dbt_tmp"
  
    as (
      select *
from "takehome"."dev_staging"."stg_lab_results"
    );
  
  
[0m21:15:39.532550 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."medications_per_month__dbt_tmp"
  
    as (
      with med_admins as (
    select
        patient_id,
        medication_id,
        date_started
    from "takehome"."dev_staging"."stg_med_admins"
    where date_started is not null
),
meds as (
    select
        medication_id,
        medication_name
    from "takehome"."dev_staging"."stg_medications"
),
med_admins_month as (
    select
        date_trunc('month', date_started) as month,
        medication_id,
        patient_id
    from med_admins
)
select
    m.month,
    med.medication_id,
    med.medication_name,
    count(*)                     as administrations,
    count(distinct m.patient_id) as patients_treated
from med_admins_month m
join meds med
    on m.medication_id = med.medication_id
group by 1,2,3
order by 1,2
    );
  
  
[0m21:15:39.534563 [debug] [Thread-3 (]: On model.takehome.patient_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_results"} */

    
  
    
    

    create temporary table
      "patient_results__dbt_tmp20251120211539481087"
  
    as (
      
with labs as (
    select
        lr.patient_id,
        lr.result_date,
        lr.component_name,
        lr.component_units,
        lr.result_value,
        lr.component_ref_lo,
        lr.component_ref_hi,
        case
            when lr.result_value < lr.component_ref_lo
              or lr.result_value > lr.component_ref_hi
            then true
            else false
        end as out_of_range
    from "takehome"."dev_staging"."stg_lab_results" lr

    
    -- sólo traer resultados nuevos
    where lr.result_date >
          (select coalesce(max(result_date), date '1900-01-01') from "takehome"."dev_bronze"."patient_results")
    
),

patients as (
    select
        patient_id,
        first_name,
        last_name,
        gender,
        date_of_birth
    from "takehome"."dev_staging"."stg_patients"
)

select
    p.patient_id,
    p.first_name,
    p.last_name,
    p.gender,
    p.date_of_birth,
    l.result_date,
    l.component_name,
    l.component_units,
    l.result_value,
    l.component_ref_lo,
    l.component_ref_hi,
    l.out_of_range
from labs l
left join patients p
    on p.patient_id = l.patient_id
    );
  
  
  
[0m21:15:39.538586 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m21:15:39.538586 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:15:39.570592 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m21:15:39.573371 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */
alter view "takehome"."dev_staging"."stg_visits__dbt_tmp" rename to "stg_visits"
[0m21:15:39.582920 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:15:39.595563 [debug] [Thread-2 (]: On model.takehome.stg_visits: COMMIT
[0m21:15:39.595563 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m21:15:39.595563 [debug] [Thread-2 (]: On model.takehome.stg_visits: COMMIT
[0m21:15:39.603930 [debug] [Thread-4 (]: SQL status: OK in 0.066 seconds
[0m21:15:39.635993 [debug] [Thread-2 (]: SQL status: OK in 0.034 seconds
[0m21:15:39.635993 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m21:15:39.635993 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.stg_visits"
[0m21:15:39.651944 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m21:15:39.651944 [debug] [Thread-2 (]: On model.takehome.stg_visits: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.stg_visits"} */

      drop view if exists "takehome"."dev_staging"."stg_visits__dbt_backup" cascade
    
[0m21:15:39.651944 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:15:39.651944 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m21:15:39.672728 [debug] [Thread-2 (]: On model.takehome.stg_visits: Close
[0m21:15:39.651944 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m21:15:39.674741 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CAB48380>]}
[0m21:15:39.676252 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'medications_per_month'
  
[0m21:15:39.678264 [info ] [Thread-2 (]: 9 of 16 OK created sql view model dev_staging.stg_visits ....................... [[32mOK[0m in 0.61s]
[0m21:15:39.678264 [debug] [Thread-2 (]: Finished running node model.takehome.stg_visits
[0m21:15:39.684696 [debug] [Thread-2 (]: Began running node model.takehome.patients
[0m21:15:39.684696 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m21:15:39.701203 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m21:15:39.684696 [info ] [Thread-2 (]: 13 of 16 START sql table model dev_bronze.patients ............................. [RUN]
[0m21:15:39.709533 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month" rename to "medications_per_month__dbt_backup"
[0m21:15:39.709533 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.stg_visits, now model.takehome.patients)
[0m21:15:39.722172 [debug] [Thread-2 (]: Began compiling node model.takehome.patients
[0m21:15:39.731887 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m21:15:39.746422 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.patients"
[0m21:15:39.738692 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m21:15:39.754318 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */
alter table "takehome"."dev_silver"."medications_per_month__dbt_tmp" rename to "medications_per_month"
[0m21:15:39.755397 [debug] [Thread-2 (]: Began executing node model.takehome.patients
[0m21:15:39.768547 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.patients"
[0m21:15:39.771679 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m21:15:39.790415 [debug] [Thread-4 (]: On model.takehome.medications_per_month: COMMIT
[0m21:15:39.792446 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m21:15:39.794210 [debug] [Thread-4 (]: On model.takehome.medications_per_month: COMMIT
[0m21:15:39.794210 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m21:15:39.794210 [debug] [Thread-2 (]: On model.takehome.patients: BEGIN
[0m21:15:39.794210 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:15:39.802166 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m21:15:39.812358 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.medications_per_month"
[0m21:15:39.812358 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m21:15:39.812358 [debug] [Thread-4 (]: On model.takehome.medications_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.medications_per_month"} */

      drop table if exists "takehome"."dev_silver"."medications_per_month__dbt_backup" cascade
    
[0m21:15:39.812358 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m21:15:39.818345 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

  
    
    

    create  table
      "takehome"."dev_bronze"."patients__dbt_tmp"
  
    as (
      
with 
pt as ( select * from "takehome"."dev_staging"."stg_patients" )
select
    * 
from pt
qualify 1 = row_number() over (
    partition by patient_id 
    order by updated_at desc
)
    );
  
  
[0m21:15:39.824844 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m21:15:39.830613 [debug] [Thread-4 (]: On model.takehome.medications_per_month: Close
[0m21:15:39.835882 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CAD59EE0>]}
[0m21:15:39.841229 [info ] [Thread-4 (]: 11 of 16 OK created sql table model dev_silver.medications_per_month ........... [[32mOK[0m in 0.74s]
[0m21:15:39.846908 [debug] [Thread-4 (]: Finished running node model.takehome.medications_per_month
[0m21:15:39.873215 [debug] [Thread-2 (]: SQL status: OK in 0.052 seconds
[0m21:15:39.878795 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m21:15:39.883047 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m21:15:39.883988 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:15:39.892821 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m21:15:39.892821 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_bronze'
      AND table_name = 'patients'
  
[0m21:15:39.899895 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:15:39.911759 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m21:15:39.913256 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients" rename to "patients__dbt_backup"
[0m21:15:39.917172 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:15:39.932887 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m21:15:39.934363 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */
alter table "takehome"."dev_bronze"."patients__dbt_tmp" rename to "patients"
[0m21:15:39.937369 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m21:15:39.943004 [debug] [Thread-2 (]: On model.takehome.patients: COMMIT
[0m21:15:39.944755 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m21:15:39.946394 [debug] [Thread-2 (]: On model.takehome.patients: COMMIT
[0m21:15:39.955027 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m21:15:39.964370 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients"
[0m21:15:39.966149 [debug] [Thread-2 (]: On model.takehome.patients: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients"} */

      drop table if exists "takehome"."dev_bronze"."patients__dbt_backup" cascade
    
[0m21:15:39.972060 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m21:15:39.977933 [debug] [Thread-2 (]: On model.takehome.patients: Close
[0m21:15:39.980053 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CB5B3230>]}
[0m21:15:39.982529 [info ] [Thread-2 (]: 13 of 16 OK created sql table model dev_bronze.patients ........................ [[32mOK[0m in 0.27s]
[0m21:15:39.986278 [debug] [Thread-2 (]: Finished running node model.takehome.patients
[0m21:15:39.989466 [debug] [Thread-4 (]: Began running node model.takehome.patients_by_age
[0m21:15:39.990989 [debug] [Thread-2 (]: Began running node model.takehome.patients_per_month
[0m21:15:39.993311 [info ] [Thread-4 (]: 14 of 16 START sql table model dev_silver.patients_by_age ...................... [RUN]
[0m21:15:39.999674 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.medications_per_month, now model.takehome.patients_by_age)
[0m21:15:40.001239 [debug] [Thread-4 (]: Began compiling node model.takehome.patients_by_age
[0m21:15:39.996626 [info ] [Thread-2 (]: 15 of 16 START sql table model dev_silver.patients_per_month ................... [RUN]
[0m21:15:40.013930 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.patients_by_age"
[0m21:15:40.016292 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.takehome.patients, now model.takehome.patients_per_month)
[0m21:15:40.017409 [debug] [Thread-2 (]: Began compiling node model.takehome.patients_per_month
[0m21:15:40.031925 [debug] [Thread-2 (]: Writing injected SQL for node "model.takehome.patients_per_month"
[0m21:15:40.034042 [debug] [Thread-4 (]: Began executing node model.takehome.patients_by_age
[0m21:15:40.049256 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.patients_by_age"
[0m21:15:40.052354 [debug] [Thread-2 (]: Began executing node model.takehome.patients_per_month
[0m21:15:40.062120 [debug] [Thread-2 (]: Writing runtime sql for node "model.takehome.patients_per_month"
[0m21:15:40.062120 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:15:40.069365 [debug] [Thread-4 (]: On model.takehome.patients_by_age: BEGIN
[0m21:15:40.071381 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:15:40.073891 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m21:15:40.075905 [debug] [Thread-2 (]: On model.takehome.patients_per_month: BEGIN
[0m21:15:40.075905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:15:40.077920 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m21:15:40.079932 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:15:40.081941 [debug] [Thread-4 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_by_age__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_of_birth,
        gender,
        race,
        ethnicity,
        smoker,
        drinks_per_week,
        date_activated,
        date_deactivated,
        date_of_death
    from "takehome"."dev_bronze"."patients"
)
select
    patient_id,
    gender,
    race,
    ethnicity,
    smoker,
    drinks_per_week,
    date_of_birth,
    date_activated,
    date_deactivated,
    date_of_death,
    date_diff('year', date_of_birth, current_date) as age,
    case
        when date_of_birth is null then 'unknown'
        when date_diff('year', date_of_birth, current_date) < 18 then '0-17'
        when date_diff('year', date_of_birth, current_date) between 18 and 34 then '18-34'
        when date_diff('year', date_of_birth, current_date) between 35 and 49 then '35-49'
        when date_diff('year', date_of_birth, current_date) between 50 and 64 then '50-64'
        else '65+'
    end as age_group
from patients
    );
  
  
[0m21:15:40.083950 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m21:15:40.085459 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m21:15:40.087860 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patients_per_month__dbt_tmp"
  
    as (
      with patients as (
    select
        patient_id,
        date_activated,
        gender
    from "takehome"."dev_bronze"."patients"
    where date_activated is not null
),
patients_by_month as (
    select
        date_trunc('month', date_activated)                           as month,
        count(*)                                                      as new_patients,
        count(distinct case when gender = 'M' then patient_id end)    as new_patients_male,
        count(distinct case when gender = 'F' then patient_id end)    as new_patients_female
    from patients
    group by 1
)
select *
from patients_by_month
order by month
    );
  
  
[0m21:15:40.093894 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m21:15:40.102093 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:15:40.102093 [debug] [Thread-4 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m21:15:40.102093 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m21:15:40.102093 [debug] [Thread-2 (]: SQL status: OK in 0.026 seconds
[0m21:15:40.117115 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m21:15:40.117115 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:15:40.117115 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m21:15:40.117115 [debug] [Thread-4 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_by_age'
  
[0m21:15:40.117115 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:15:40.133373 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m21:15:40.137410 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m21:15:40.141116 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patients_per_month'
  
[0m21:15:40.149186 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:15:40.149186 [debug] [Thread-4 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age" rename to "patients_by_age__dbt_backup"
[0m21:15:40.157451 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m21:15:40.165877 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m21:15:40.165877 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month" rename to "patients_per_month__dbt_backup"
[0m21:15:40.165877 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m21:15:40.182225 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:15:40.182225 [debug] [Thread-4 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */
alter table "takehome"."dev_silver"."patients_by_age__dbt_tmp" rename to "patients_by_age"
[0m21:15:40.182225 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m21:15:40.191367 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m21:15:40.203521 [debug] [Thread-4 (]: On model.takehome.patients_by_age: COMMIT
[0m21:15:40.207561 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m21:15:40.209578 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:15:40.211598 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */
alter table "takehome"."dev_silver"."patients_per_month__dbt_tmp" rename to "patients_per_month"
[0m21:15:40.213620 [debug] [Thread-4 (]: On model.takehome.patients_by_age: COMMIT
[0m21:15:40.217377 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:15:40.225455 [debug] [Thread-2 (]: On model.takehome.patients_per_month: COMMIT
[0m21:15:40.227473 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m21:15:40.229490 [debug] [Thread-2 (]: On model.takehome.patients_per_month: COMMIT
[0m21:15:40.229490 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m21:15:40.240215 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patients_by_age"
[0m21:15:40.240215 [debug] [Thread-4 (]: On model.takehome.patients_by_age: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_by_age"} */

      drop table if exists "takehome"."dev_silver"."patients_by_age__dbt_backup" cascade
    
[0m21:15:40.246242 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m21:15:40.256692 [debug] [Thread-2 (]: Using duckdb connection "model.takehome.patients_per_month"
[0m21:15:40.256692 [debug] [Thread-2 (]: On model.takehome.patients_per_month: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patients_per_month"} */

      drop table if exists "takehome"."dev_silver"."patients_per_month__dbt_backup" cascade
    
[0m21:15:40.262390 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m21:15:40.268667 [debug] [Thread-4 (]: On model.takehome.patients_by_age: Close
[0m21:15:40.270685 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m21:15:40.272705 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CB541EE0>]}
[0m21:15:40.278287 [debug] [Thread-2 (]: On model.takehome.patients_per_month: Close
[0m21:15:40.283025 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CA941310>]}
[0m21:15:40.281011 [info ] [Thread-4 (]: 14 of 16 OK created sql table model dev_silver.patients_by_age ................. [[32mOK[0m in 0.27s]
[0m21:15:40.289062 [debug] [Thread-4 (]: Finished running node model.takehome.patients_by_age
[0m21:15:40.287047 [info ] [Thread-2 (]: 15 of 16 OK created sql table model dev_silver.patients_per_month .............. [[32mOK[0m in 0.27s]
[0m21:15:40.294108 [debug] [Thread-2 (]: Finished running node model.takehome.patients_per_month
[0m21:15:49.485112 [debug] [Thread-3 (]: SQL status: OK in 9.940 seconds
[0m21:15:49.505739 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m21:15:49.505739 [debug] [Thread-3 (]: On model.takehome.patient_results: BEGIN
[0m21:15:49.505739 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m21:15:49.505739 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m21:15:49.505739 [debug] [Thread-3 (]: On model.takehome.patient_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'patient_results__dbt_tmp20251120211539481087'
      
      
      order by ordinal_position

  
[0m21:15:49.514729 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:15:49.523459 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m21:15:49.523459 [debug] [Thread-3 (]: On model.takehome.patient_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'patient_results'
      
      and lower(table_schema) = 'dev_bronze'
      
      
      and lower(table_catalog) = 'takehome'
      
      order by ordinal_position

  
[0m21:15:49.531224 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m21:15:49.550683 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m21:15:49.550683 [debug] [Thread-3 (]: On model.takehome.patient_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'patient_results'
      
      and lower(table_schema) = 'dev_bronze'
      
      
      and lower(table_catalog) = 'takehome'
      
      order by ordinal_position

  
[0m21:15:49.566596 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m21:15:49.569969 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m21:15:49.571128 [debug] [Thread-3 (]: On model.takehome.patient_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_results"} */
SELECT version()
[0m21:15:49.573208 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m21:15:49.578338 [debug] [Thread-1 (]: SQL status: OK in 10.040 seconds
[0m21:15:49.587599 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.lab_results"
[0m21:15:49.591309 [debug] [Thread-3 (]: Writing runtime sql for node "model.takehome.patient_results"
[0m21:15:49.591309 [debug] [Thread-1 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'lab_results'
  
[0m21:15:49.594215 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m21:15:49.595200 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:15:49.595200 [debug] [Thread-3 (]: On model.takehome.patient_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_results"} */

        
            delete from "takehome"."dev_bronze"."patient_results" as DBT_INCREMENTAL_TARGET
            using "patient_results__dbt_tmp20251120211539481087"
            where (
                
                    "patient_results__dbt_tmp20251120211539481087".patient_id = DBT_INCREMENTAL_TARGET.patient_id
                    and 
                
                    "patient_results__dbt_tmp20251120211539481087".result_date = DBT_INCREMENTAL_TARGET.result_date
                    and 
                
                    "patient_results__dbt_tmp20251120211539481087".component_name = DBT_INCREMENTAL_TARGET.component_name
                    
                
                
            );
        
    

    insert into "takehome"."dev_bronze"."patient_results" ("patient_id", "first_name", "last_name", "gender", "date_of_birth", "result_date", "component_name", "component_units", "result_value", "component_ref_lo", "component_ref_hi", "out_of_range")
    (
        select "patient_id", "first_name", "last_name", "gender", "date_of_birth", "result_date", "component_name", "component_units", "result_value", "component_ref_lo", "component_ref_hi", "out_of_range"
        from "patient_results__dbt_tmp20251120211539481087"
    )
  
[0m21:15:49.595200 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.lab_results"
[0m21:15:49.595200 [debug] [Thread-1 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'lab_results'
  
[0m21:15:49.598903 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:15:49.604059 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.lab_results"
[0m21:15:49.604059 [debug] [Thread-1 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */
alter table "takehome"."dev_silver"."lab_results" rename to "lab_results__dbt_backup"
[0m21:15:49.604059 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m21:15:49.606409 [debug] [Thread-3 (]: On model.takehome.patient_results: COMMIT
[0m21:15:49.606409 [debug] [Thread-3 (]: Using duckdb connection "model.takehome.patient_results"
[0m21:15:49.606409 [debug] [Thread-3 (]: On model.takehome.patient_results: COMMIT
[0m21:15:49.606409 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:15:49.611581 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.lab_results"
[0m21:15:49.611581 [debug] [Thread-1 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */
alter table "takehome"."dev_silver"."lab_results__dbt_tmp" rename to "lab_results"
[0m21:15:49.611581 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m21:15:49.614397 [debug] [Thread-3 (]: On model.takehome.patient_results: Close
[0m21:15:49.614397 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:15:49.614397 [debug] [Thread-1 (]: On model.takehome.lab_results: COMMIT
[0m21:15:49.616416 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.lab_results"
[0m21:15:49.616416 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CB5A1DF0>]}
[0m21:15:49.616416 [debug] [Thread-1 (]: On model.takehome.lab_results: COMMIT
[0m21:15:49.616416 [info ] [Thread-3 (]: 12 of 16 OK created sql incremental model dev_bronze.patient_results ........... [[32mOK[0m in 10.45s]
[0m21:15:49.619036 [debug] [Thread-3 (]: Finished running node model.takehome.patient_results
[0m21:15:49.620091 [debug] [Thread-4 (]: Began running node model.takehome.patient_risk_flags
[0m21:15:49.621538 [info ] [Thread-4 (]: 16 of 16 START sql table model dev_silver.patient_risk_flags ................... [RUN]
[0m21:15:49.621538 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.takehome.patients_by_age, now model.takehome.patient_risk_flags)
[0m21:15:49.621538 [debug] [Thread-4 (]: Began compiling node model.takehome.patient_risk_flags
[0m21:15:49.621538 [debug] [Thread-4 (]: Writing injected SQL for node "model.takehome.patient_risk_flags"
[0m21:15:49.626794 [debug] [Thread-4 (]: Began executing node model.takehome.patient_risk_flags
[0m21:15:49.629037 [debug] [Thread-4 (]: Writing runtime sql for node "model.takehome.patient_risk_flags"
[0m21:15:49.629037 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m21:15:49.633285 [debug] [Thread-1 (]: Using duckdb connection "model.takehome.lab_results"
[0m21:15:49.633285 [debug] [Thread-1 (]: On model.takehome.lab_results: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.lab_results"} */

      drop table if exists "takehome"."dev_silver"."lab_results__dbt_backup" cascade
    
[0m21:15:49.635025 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m21:15:49.635025 [debug] [Thread-4 (]: On model.takehome.patient_risk_flags: BEGIN
[0m21:15:49.635635 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:15:49.636889 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:15:49.637674 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m21:15:49.638195 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:15:49.638195 [debug] [Thread-4 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */

  
    
    

    create  table
      "takehome"."dev_silver"."patient_risk_flags__dbt_tmp"
  
    as (
      with conds as (
    select
        pc.patient_id,
        count(distinct pc.condition_id) as n_conditions
    from "takehome"."dev_staging"."stg_patient_conditions" pc
    group by pc.patient_id
),

labs as (
    select
        pr.patient_id,
        count(*) filter (where pr.out_of_range) as n_abnormal_labs
    from "takehome"."dev_bronze"."patient_results" pr
    group by pr.patient_id
),

base as (
    select
        coalesce(c.patient_id, l.patient_id) as patient_id,
        coalesce(c.n_conditions, 0)         as n_conditions,
        coalesce(l.n_abnormal_labs, 0)      as n_abnormal_labs
    from conds c
    full outer join labs l
      on c.patient_id = l.patient_id
)

select
    patient_id,
    n_conditions,
    n_abnormal_labs,
    case
        when n_abnormal_labs >= 3
          or n_conditions    >= 5
        then true
        else false
    end as high_risk_flag
from base
    );
  
  
[0m21:15:49.639734 [debug] [Thread-1 (]: On model.takehome.lab_results: Close
[0m21:15:49.642425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CB51FFB0>]}
[0m21:15:49.642750 [info ] [Thread-1 (]: 10 of 16 OK created sql table model dev_silver.lab_results ..................... [[32mOK[0m in 10.56s]
[0m21:15:49.645744 [debug] [Thread-1 (]: Finished running node model.takehome.lab_results
[0m21:15:49.656573 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m21:15:49.658585 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m21:15:49.658585 [debug] [Thread-4 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patient_risk_flags'
  
[0m21:15:49.658585 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:15:49.661357 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m21:15:49.661357 [debug] [Thread-4 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'dev_silver'
      AND table_name = 'patient_risk_flags'
  
[0m21:15:49.661357 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m21:15:49.661357 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m21:15:49.669159 [debug] [Thread-4 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */
alter table "takehome"."dev_silver"."patient_risk_flags" rename to "patient_risk_flags__dbt_backup"
[0m21:15:49.669159 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:15:49.669159 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m21:15:49.669159 [debug] [Thread-4 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */
alter table "takehome"."dev_silver"."patient_risk_flags__dbt_tmp" rename to "patient_risk_flags"
[0m21:15:49.669159 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m21:15:49.675049 [debug] [Thread-4 (]: On model.takehome.patient_risk_flags: COMMIT
[0m21:15:49.675049 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m21:15:49.675049 [debug] [Thread-4 (]: On model.takehome.patient_risk_flags: COMMIT
[0m21:15:49.679822 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:15:49.679822 [debug] [Thread-4 (]: Using duckdb connection "model.takehome.patient_risk_flags"
[0m21:15:49.679822 [debug] [Thread-4 (]: On model.takehome.patient_risk_flags: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "model.takehome.patient_risk_flags"} */

      drop table if exists "takehome"."dev_silver"."patient_risk_flags__dbt_backup" cascade
    
[0m21:15:49.685776 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m21:15:49.685776 [debug] [Thread-4 (]: On model.takehome.patient_risk_flags: Close
[0m21:15:49.685776 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ad3f4a-b33d-4e5d-bdaa-dd820d19f9e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D083F63860>]}
[0m21:15:49.685776 [info ] [Thread-4 (]: 16 of 16 OK created sql table model dev_silver.patient_risk_flags .............. [[32mOK[0m in 0.06s]
[0m21:15:49.685776 [debug] [Thread-4 (]: Finished running node model.takehome.patient_risk_flags
[0m21:15:49.689967 [debug] [MainThread]: Using duckdb connection "master"
[0m21:15:49.689967 [debug] [MainThread]: On master: BEGIN
[0m21:15:49.689967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:15:49.689967 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:15:49.689967 [debug] [MainThread]: On master: COMMIT
[0m21:15:49.689967 [debug] [MainThread]: Using duckdb connection "master"
[0m21:15:49.689967 [debug] [MainThread]: On master: COMMIT
[0m21:15:49.689967 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:15:49.694248 [debug] [MainThread]: On master: Close
[0m21:15:49.694248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:49.694248 [debug] [MainThread]: Connection 'create_takehome_dev_bronze' was properly closed.
[0m21:15:49.694248 [debug] [MainThread]: Connection 'create_takehome_dev_staging' was properly closed.
[0m21:15:49.694248 [debug] [MainThread]: Connection 'create_takehome_dev_silver' was properly closed.
[0m21:15:49.694248 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m21:15:49.694248 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m21:15:49.694248 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m21:15:49.694248 [debug] [MainThread]: Connection 'model.takehome.lab_results' was properly closed.
[0m21:15:49.694248 [debug] [MainThread]: Connection 'model.takehome.patients_per_month' was properly closed.
[0m21:15:49.694248 [debug] [MainThread]: Connection 'model.takehome.patient_results' was properly closed.
[0m21:15:49.694248 [debug] [MainThread]: Connection 'model.takehome.patient_risk_flags' was properly closed.
[0m21:15:49.694248 [info ] [MainThread]: 
[0m21:15:49.694248 [info ] [MainThread]: Finished running 1 incremental model, 1 project hook, 6 table models, 9 view models in 0 hours 0 minutes and 12.68 seconds (12.68s).
[0m21:15:49.698263 [debug] [MainThread]: Command end result
[0m21:15:49.730150 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:15:49.730150 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:15:49.739241 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m21:15:49.739241 [info ] [MainThread]: 
[0m21:15:49.739241 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:15:49.739241 [info ] [MainThread]: 
[0m21:15:49.739241 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=17
[0m21:15:49.739241 [debug] [MainThread]: Command `dbt run` succeeded at 21:15:49.739241 after 21.13 seconds
[0m21:15:49.739241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C86A1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C86A2ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0C8E4EC00>]}
[0m21:15:49.744764 [debug] [MainThread]: Flushing usage events
[0m21:15:51.968587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:09.805756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D769F6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7688AE40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7688A600>]}


============================== 21:18:09.821677 | 677fbdbc-43b4-41b8-973d-88253b7249e7 ==============================
[0m21:18:09.821677 [info ] [MainThread]: Running with dbt=1.10.15
[0m21:18:09.822725 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': 'C:\\Users\\usuario\\Downloads\\implementation-take-home-test-main (1) (1)\\implementation-take-home-test-main\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'printer_width': '80', 'write_json': 'True'}
[0m21:18:10.114509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '677fbdbc-43b4-41b8-973d-88253b7249e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D78A8A480>]}
[0m21:18:10.181322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '677fbdbc-43b4-41b8-973d-88253b7249e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D778230B0>]}
[0m21:18:10.186426 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m21:18:10.407738 [debug] [MainThread]: checksum: 14a228079bd6df63ba81633f9a3cf44ecfaa31056ac397c602753ec895dbf885, vars: {}, profile: , target: , version: 1.10.15
[0m21:18:10.649540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:18:10.649540 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:18:10.715818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '677fbdbc-43b4-41b8-973d-88253b7249e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D78FD5FD0>]}
[0m21:18:10.824105 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:18:10.831450 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:18:10.906590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '677fbdbc-43b4-41b8-973d-88253b7249e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D794A9B80>]}
[0m21:18:10.906590 [info ] [MainThread]: Found 16 models, 1 operation, 23 data tests, 8 sources, 468 macros
[0m21:18:10.906590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677fbdbc-43b4-41b8-973d-88253b7249e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7948EAB0>]}
[0m21:18:10.906590 [info ] [MainThread]: 
[0m21:18:10.906590 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:18:10.906590 [info ] [MainThread]: 
[0m21:18:10.906590 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m21:18:10.906590 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_silver'
[0m21:18:10.931601 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_staging'
[0m21:18:10.942405 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_takehome_dev_bronze'
[0m21:18:11.007849 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m21:18:11.007849 [debug] [ThreadPool]: On list_takehome_dev_silver: BEGIN
[0m21:18:11.007849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:11.007849 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:18:11.007849 [debug] [ThreadPool]: On list_takehome_dev_staging: BEGIN
[0m21:18:11.007849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:11.007849 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:18:11.007849 [debug] [ThreadPool]: On list_takehome_dev_bronze: BEGIN
[0m21:18:11.007849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:18:11.047657 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m21:18:11.047657 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m21:18:11.047657 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_staging"
[0m21:18:11.047657 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m21:18:11.047657 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_silver"
[0m21:18:11.047657 [debug] [ThreadPool]: On list_takehome_dev_staging: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_staging"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_staging'
    and lower(table_catalog) = 'takehome'
  
[0m21:18:11.047657 [debug] [ThreadPool]: Using duckdb connection "list_takehome_dev_bronze"
[0m21:18:11.047657 [debug] [ThreadPool]: On list_takehome_dev_silver: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_silver"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_silver'
    and lower(table_catalog) = 'takehome'
  
[0m21:18:11.047657 [debug] [ThreadPool]: On list_takehome_dev_bronze: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "list_takehome_dev_bronze"} */
select
      'takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'dev_bronze'
    and lower(table_catalog) = 'takehome'
  
[0m21:18:11.075666 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m21:18:11.079349 [debug] [ThreadPool]: On list_takehome_dev_silver: ROLLBACK
[0m21:18:11.079349 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_silver'
[0m21:18:11.079349 [debug] [ThreadPool]: On list_takehome_dev_silver: Close
[0m21:18:11.079349 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m21:18:11.079349 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m21:18:11.079349 [debug] [ThreadPool]: On list_takehome_dev_bronze: ROLLBACK
[0m21:18:11.079349 [debug] [ThreadPool]: On list_takehome_dev_staging: ROLLBACK
[0m21:18:11.079349 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_staging'
[0m21:18:11.079349 [debug] [ThreadPool]: On list_takehome_dev_staging: Close
[0m21:18:11.079349 [debug] [ThreadPool]: Failed to rollback 'list_takehome_dev_bronze'
[0m21:18:11.079349 [debug] [ThreadPool]: On list_takehome_dev_bronze: Close
[0m21:18:11.079349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677fbdbc-43b4-41b8-973d-88253b7249e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D793AB1A0>]}
[0m21:18:11.079349 [debug] [MainThread]: Using duckdb connection "master"
[0m21:18:11.079349 [debug] [MainThread]: On master: BEGIN
[0m21:18:11.079349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:18:11.093532 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:18:11.093532 [debug] [MainThread]: On master: COMMIT
[0m21:18:11.093532 [debug] [MainThread]: Using duckdb connection "master"
[0m21:18:11.093532 [debug] [MainThread]: On master: COMMIT
[0m21:18:11.095656 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m21:18:11.104389 [debug] [MainThread]: Writing injected SQL for node "operation.takehome.takehome-on-run-start-0"
[0m21:18:11.112869 [info ] [MainThread]: 1 of 1 START hook: takehome.on-run-start.0 ..................................... [RUN]
[0m21:18:11.114531 [debug] [MainThread]: Using duckdb connection "master"
[0m21:18:11.114531 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "connection_name": "master"} */
PRAGMA log_query_path='logs/query_log.sql';
[0m21:18:11.116400 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:18:11.116400 [info ] [MainThread]: 1 of 1 OK hook: takehome.on-run-start.0 ........................................ [[32mOK[0m in 0.02s]
[0m21:18:11.118411 [info ] [MainThread]: 
[0m21:18:11.118411 [debug] [MainThread]: On master: Close
[0m21:18:11.128517 [debug] [Thread-1 (]: Began running node test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f
[0m21:18:11.131089 [debug] [Thread-2 (]: Began running node test.takehome.not_null_lab_results_patient_id.d81edf6925
[0m21:18:11.131089 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown  [RUN]
[0m21:18:11.133985 [debug] [Thread-3 (]: Began running node test.takehome.not_null_lab_results_result_date.09687ad6ea
[0m21:18:11.133985 [debug] [Thread-4 (]: Began running node test.takehome.not_null_medications_per_month_medication_id.0958d28b46
[0m21:18:11.133985 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f'
[0m21:18:11.133985 [info ] [Thread-2 (]: 2 of 23 START test not_null_lab_results_patient_id ............................. [RUN]
[0m21:18:11.139303 [debug] [Thread-1 (]: Began compiling node test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f
[0m21:18:11.133985 [info ] [Thread-3 (]: 3 of 23 START test not_null_lab_results_result_date ............................ [RUN]
[0m21:18:11.139303 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.takehome.not_null_lab_results_patient_id.d81edf6925'
[0m21:18:11.133985 [info ] [Thread-4 (]: 4 of 23 START test not_null_medications_per_month_medication_id ................ [RUN]
[0m21:18:11.156339 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"
[0m21:18:11.156339 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.takehome.not_null_lab_results_result_date.09687ad6ea'
[0m21:18:11.162781 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_lab_results_patient_id.d81edf6925
[0m21:18:11.165875 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.takehome.not_null_medications_per_month_medication_id.0958d28b46'
[0m21:18:11.167887 [debug] [Thread-3 (]: Began compiling node test.takehome.not_null_lab_results_result_date.09687ad6ea
[0m21:18:11.175135 [debug] [Thread-4 (]: Began compiling node test.takehome.not_null_medications_per_month_medication_id.0958d28b46
[0m21:18:11.188050 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.not_null_lab_results_result_date.09687ad6ea"
[0m21:18:11.189360 [debug] [Thread-1 (]: Began executing node test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f
[0m21:18:11.189360 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_lab_results_patient_id.d81edf6925"
[0m21:18:11.192952 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"
[0m21:18:11.210214 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"
[0m21:18:11.210214 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_lab_results_patient_id.d81edf6925
[0m21:18:11.213823 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_lab_results_patient_id.d81edf6925"
[0m21:18:11.213823 [debug] [Thread-3 (]: Began executing node test.takehome.not_null_lab_results_result_date.09687ad6ea
[0m21:18:11.213823 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.not_null_lab_results_result_date.09687ad6ea"
[0m21:18:11.213823 [debug] [Thread-4 (]: Began executing node test.takehome.not_null_medications_per_month_medication_id.0958d28b46
[0m21:18:11.223294 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"
[0m21:18:11.223294 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"
[0m21:18:11.223294 [debug] [Thread-1 (]: On test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f: BEGIN
[0m21:18:11.223294 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_lab_results_result_date.09687ad6ea"
[0m21:18:11.223294 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_lab_results_patient_id.d81edf6925"
[0m21:18:11.223294 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:18:11.223294 [debug] [Thread-3 (]: On test.takehome.not_null_lab_results_result_date.09687ad6ea: BEGIN
[0m21:18:11.229588 [debug] [Thread-2 (]: On test.takehome.not_null_lab_results_patient_id.d81edf6925: BEGIN
[0m21:18:11.223294 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"
[0m21:18:11.229588 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:18:11.229588 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:18:11.229588 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_medication_id.0958d28b46: BEGIN
[0m21:18:11.229588 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:18:11.229588 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:18:11.229588 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:18:11.229588 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m21:18:11.229588 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"
[0m21:18:11.229588 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_lab_results_result_date.09687ad6ea"
[0m21:18:11.229588 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m21:18:11.229588 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_lab_results_patient_id.d81edf6925"
[0m21:18:11.229588 [debug] [Thread-1 (]: On test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        age_group as value_field,
        count(*) as n_records

    from "takehome"."dev_silver"."patients_by_age"
    group by age_group

)

select *
from all_values
where value_field not in (
    '0-17','18-34','35-49','50-64','65+','unknown'
)



  
  
      
    ) dbt_internal_test
[0m21:18:11.229588 [debug] [Thread-3 (]: On test.takehome.not_null_lab_results_result_date.09687ad6ea: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_lab_results_result_date.09687ad6ea"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select result_date
from "takehome"."dev_silver"."lab_results"
where result_date is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.229588 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"
[0m21:18:11.229588 [debug] [Thread-2 (]: On test.takehome.not_null_lab_results_patient_id.d81edf6925: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_lab_results_patient_id.d81edf6925"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_silver"."lab_results"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.229588 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_medication_id.0958d28b46: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_medications_per_month_medication_id.0958d28b46"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select medication_id
from "takehome"."dev_silver"."medications_per_month"
where medication_id is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.229588 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:18:11.245391 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:18:11.245391 [debug] [Thread-3 (]: On test.takehome.not_null_lab_results_result_date.09687ad6ea: ROLLBACK
[0m21:18:11.245391 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m21:18:11.245391 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_medication_id.0958d28b46: ROLLBACK
[0m21:18:11.245391 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.not_null_medications_per_month_medication_id.0958d28b46'
[0m21:18:11.245391 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_medication_id.0958d28b46: Close
[0m21:18:11.245391 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m21:18:11.245391 [debug] [Thread-2 (]: On test.takehome.not_null_lab_results_patient_id.d81edf6925: ROLLBACK
[0m21:18:11.254911 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_lab_results_patient_id.d81edf6925'
[0m21:18:11.254911 [debug] [Thread-2 (]: On test.takehome.not_null_lab_results_patient_id.d81edf6925: Close
[0m21:18:11.254911 [debug] [Thread-1 (]: On test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f: ROLLBACK
[0m21:18:11.254911 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f'
[0m21:18:11.254911 [debug] [Thread-1 (]: On test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f: Close
[0m21:18:11.254911 [info ] [Thread-4 (]: 4 of 23 PASS not_null_medications_per_month_medication_id ...................... [[32mPASS[0m in 0.09s]
[0m21:18:11.254911 [debug] [Thread-4 (]: Finished running node test.takehome.not_null_medications_per_month_medication_id.0958d28b46
[0m21:18:11.254911 [debug] [Thread-4 (]: Began running node test.takehome.not_null_medications_per_month_month.4d739bac88
[0m21:18:11.254911 [info ] [Thread-4 (]: 5 of 23 START test not_null_medications_per_month_month ........................ [RUN]
[0m21:18:11.261191 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_medications_per_month_medication_id.0958d28b46, now test.takehome.not_null_medications_per_month_month.4d739bac88)
[0m21:18:11.261191 [debug] [Thread-4 (]: Began compiling node test.takehome.not_null_medications_per_month_month.4d739bac88
[0m21:18:11.261191 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.not_null_medications_per_month_month.4d739bac88"
[0m21:18:11.261191 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.not_null_lab_results_result_date.09687ad6ea'
[0m21:18:11.261191 [debug] [Thread-3 (]: On test.takehome.not_null_lab_results_result_date.09687ad6ea: Close
[0m21:18:11.261191 [info ] [Thread-2 (]: 2 of 23 PASS not_null_lab_results_patient_id ................................... [[32mPASS[0m in 0.12s]
[0m21:18:11.261191 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_lab_results_patient_id.d81edf6925
[0m21:18:11.261191 [debug] [Thread-4 (]: Began executing node test.takehome.not_null_medications_per_month_month.4d739bac88
[0m21:18:11.272044 [debug] [Thread-2 (]: Began running node test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe
[0m21:18:11.261191 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown  [[32mPASS[0m in 0.12s]
[0m21:18:11.275569 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.not_null_medications_per_month_month.4d739bac88"
[0m21:18:11.261191 [info ] [Thread-3 (]: 3 of 23 PASS not_null_lab_results_result_date .................................. [[32mPASS[0m in 0.10s]
[0m21:18:11.275569 [debug] [Thread-1 (]: Finished running node test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f
[0m21:18:11.275569 [info ] [Thread-2 (]: 6 of 23 START test not_null_medications_per_month_patients_treated ............. [RUN]
[0m21:18:11.280055 [debug] [Thread-3 (]: Finished running node test.takehome.not_null_lab_results_result_date.09687ad6ea
[0m21:18:11.280055 [debug] [Thread-1 (]: Began running node test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d
[0m21:18:11.280055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_lab_results_patient_id.d81edf6925, now test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe)
[0m21:18:11.280055 [debug] [Thread-3 (]: Began running node test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57
[0m21:18:11.280055 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_month.4d739bac88"
[0m21:18:11.280055 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe
[0m21:18:11.280055 [info ] [Thread-1 (]: 7 of 23 START test not_null_patient_risk_flags_high_risk_flag .................. [RUN]
[0m21:18:11.289370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.accepted_values_patients_by_age_age_group__0_17__18_34__35_49__50_64__65___unknown.78499b835f, now test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d)
[0m21:18:11.280055 [info ] [Thread-3 (]: 8 of 23 START test not_null_patient_risk_flags_patient_id ...................... [RUN]
[0m21:18:11.280055 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_month.4d739bac88: BEGIN
[0m21:18:11.295570 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"
[0m21:18:11.295570 [debug] [Thread-1 (]: Began compiling node test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d
[0m21:18:11.295570 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_lab_results_result_date.09687ad6ea, now test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57)
[0m21:18:11.295570 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:11.295570 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"
[0m21:18:11.304492 [debug] [Thread-3 (]: Began compiling node test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57
[0m21:18:11.306058 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m21:18:11.307973 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe
[0m21:18:11.312602 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"
[0m21:18:11.314769 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_month.4d739bac88"
[0m21:18:11.316403 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"
[0m21:18:11.316403 [debug] [Thread-1 (]: Began executing node test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d
[0m21:18:11.316403 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_month.4d739bac88: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_medications_per_month_month.4d739bac88"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "takehome"."dev_silver"."medications_per_month"
where month is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.316403 [debug] [Thread-3 (]: Began executing node test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57
[0m21:18:11.323028 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"
[0m21:18:11.323028 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"
[0m21:18:11.323028 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"
[0m21:18:11.323028 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m21:18:11.331172 [debug] [Thread-2 (]: On test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe: BEGIN
[0m21:18:11.331172 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"
[0m21:18:11.331172 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:11.331172 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_month.4d739bac88: ROLLBACK
[0m21:18:11.331172 [debug] [Thread-1 (]: On test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d: BEGIN
[0m21:18:11.331172 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"
[0m21:18:11.331172 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.not_null_medications_per_month_month.4d739bac88'
[0m21:18:11.331172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:11.331172 [debug] [Thread-3 (]: On test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57: BEGIN
[0m21:18:11.331172 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m21:18:11.339195 [debug] [Thread-4 (]: On test.takehome.not_null_medications_per_month_month.4d739bac88: Close
[0m21:18:11.339791 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:11.340883 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:18:11.341480 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"
[0m21:18:11.341994 [info ] [Thread-4 (]: 5 of 23 PASS not_null_medications_per_month_month .............................. [[32mPASS[0m in 0.08s]
[0m21:18:11.342757 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"
[0m21:18:11.342757 [debug] [Thread-2 (]: On test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patients_treated
from "takehome"."dev_silver"."medications_per_month"
where patients_treated is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.342757 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m21:18:11.342757 [debug] [Thread-4 (]: Finished running node test.takehome.not_null_medications_per_month_month.4d739bac88
[0m21:18:11.342757 [debug] [Thread-1 (]: On test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select high_risk_flag
from "takehome"."dev_silver"."patient_risk_flags"
where high_risk_flag is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.342757 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"
[0m21:18:11.342757 [debug] [Thread-4 (]: Began running node test.takehome.not_null_patients_by_age_patient_id.0646b9206a
[0m21:18:11.347444 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m21:18:11.347444 [debug] [Thread-3 (]: On test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_silver"."patient_risk_flags"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.347444 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m21:18:11.352507 [debug] [Thread-2 (]: On test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe: ROLLBACK
[0m21:18:11.347444 [info ] [Thread-4 (]: 9 of 23 START test not_null_patients_by_age_patient_id ......................... [RUN]
[0m21:18:11.353761 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:18:11.355006 [debug] [Thread-1 (]: On test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d: ROLLBACK
[0m21:18:11.355979 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe'
[0m21:18:11.357828 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_medications_per_month_month.4d739bac88, now test.takehome.not_null_patients_by_age_patient_id.0646b9206a)
[0m21:18:11.357828 [debug] [Thread-3 (]: On test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57: ROLLBACK
[0m21:18:11.357828 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d'
[0m21:18:11.357828 [debug] [Thread-2 (]: On test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe: Close
[0m21:18:11.357828 [debug] [Thread-4 (]: Began compiling node test.takehome.not_null_patients_by_age_patient_id.0646b9206a
[0m21:18:11.364936 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57'
[0m21:18:11.364936 [debug] [Thread-1 (]: On test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d: Close
[0m21:18:11.364936 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"
[0m21:18:11.372736 [debug] [Thread-3 (]: On test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57: Close
[0m21:18:11.364936 [info ] [Thread-2 (]: 6 of 23 PASS not_null_medications_per_month_patients_treated ................... [[32mPASS[0m in 0.08s]
[0m21:18:11.374735 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe
[0m21:18:11.374735 [debug] [Thread-2 (]: Began running node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m21:18:11.372736 [info ] [Thread-1 (]: 7 of 23 PASS not_null_patient_risk_flags_high_risk_flag ........................ [[32mPASS[0m in 0.08s]
[0m21:18:11.376747 [debug] [Thread-1 (]: Finished running node test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d
[0m21:18:11.379429 [debug] [Thread-1 (]: Began running node test.takehome.not_null_patients_per_month_month.827712360f
[0m21:18:11.376747 [info ] [Thread-2 (]: 10 of 23 START test not_null_patients_patient_id ............................... [RUN]
[0m21:18:11.380953 [debug] [Thread-4 (]: Began executing node test.takehome.not_null_patients_by_age_patient_id.0646b9206a
[0m21:18:11.376747 [info ] [Thread-3 (]: 8 of 23 PASS not_null_patient_risk_flags_patient_id ............................ [[32mPASS[0m in 0.08s]
[0m21:18:11.383358 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_medications_per_month_patients_treated.7063cd50fe, now test.takehome.not_null_patients_patient_id.330c5fb3d9)
[0m21:18:11.380953 [info ] [Thread-1 (]: 11 of 23 START test not_null_patients_per_month_month .......................... [RUN]
[0m21:18:11.383358 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"
[0m21:18:11.389538 [debug] [Thread-3 (]: Finished running node test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57
[0m21:18:11.389538 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m21:18:11.389538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patient_risk_flags_high_risk_flag.80e561086d, now test.takehome.not_null_patients_per_month_month.827712360f)
[0m21:18:11.389538 [debug] [Thread-3 (]: Began running node test.takehome.not_null_patients_per_month_new_patients.3bbd15949c
[0m21:18:11.456049 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m21:18:11.456049 [debug] [Thread-1 (]: Began compiling node test.takehome.not_null_patients_per_month_month.827712360f
[0m21:18:11.456049 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"
[0m21:18:11.456049 [info ] [Thread-3 (]: 12 of 23 START test not_null_patients_per_month_new_patients ................... [RUN]
[0m21:18:11.456049 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.not_null_patients_per_month_month.827712360f"
[0m21:18:11.456049 [debug] [Thread-4 (]: On test.takehome.not_null_patients_by_age_patient_id.0646b9206a: BEGIN
[0m21:18:11.456049 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patient_risk_flags_patient_id.a3e134fd57, now test.takehome.not_null_patients_per_month_new_patients.3bbd15949c)
[0m21:18:11.456049 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:11.456049 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m21:18:11.456049 [debug] [Thread-3 (]: Began compiling node test.takehome.not_null_patients_per_month_new_patients.3bbd15949c
[0m21:18:11.472860 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m21:18:11.474873 [debug] [Thread-1 (]: Began executing node test.takehome.not_null_patients_per_month_month.827712360f
[0m21:18:11.479733 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"
[0m21:18:11.479733 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m21:18:11.483637 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.not_null_patients_per_month_month.827712360f"
[0m21:18:11.483637 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"
[0m21:18:11.486536 [debug] [Thread-4 (]: On test.takehome.not_null_patients_by_age_patient_id.0646b9206a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_by_age_patient_id.0646b9206a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_silver"."patients_by_age"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.488548 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m21:18:11.489367 [debug] [Thread-2 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: BEGIN
[0m21:18:11.490336 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:11.491221 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m21:18:11.492463 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patients_per_month_month.827712360f"
[0m21:18:11.492463 [debug] [Thread-3 (]: Began executing node test.takehome.not_null_patients_per_month_new_patients.3bbd15949c
[0m21:18:11.492463 [debug] [Thread-4 (]: On test.takehome.not_null_patients_by_age_patient_id.0646b9206a: ROLLBACK
[0m21:18:11.492463 [debug] [Thread-1 (]: On test.takehome.not_null_patients_per_month_month.827712360f: BEGIN
[0m21:18:11.492463 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m21:18:11.498135 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"
[0m21:18:11.498135 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.not_null_patients_by_age_patient_id.0646b9206a'
[0m21:18:11.498135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:11.498135 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_patients_patient_id.330c5fb3d9"
[0m21:18:11.498135 [debug] [Thread-4 (]: On test.takehome.not_null_patients_by_age_patient_id.0646b9206a: Close
[0m21:18:11.498135 [debug] [Thread-2 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_patient_id.330c5fb3d9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_bronze"."patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.498135 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:18:11.498135 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_patients_per_month_month.827712360f"
[0m21:18:11.498135 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"
[0m21:18:11.498135 [debug] [Thread-1 (]: On test.takehome.not_null_patients_per_month_month.827712360f: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_per_month_month.827712360f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from "takehome"."dev_silver"."patients_per_month"
where month is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.506033 [debug] [Thread-3 (]: On test.takehome.not_null_patients_per_month_new_patients.3bbd15949c: BEGIN
[0m21:18:11.498135 [info ] [Thread-4 (]: 9 of 23 PASS not_null_patients_by_age_patient_id ............................... [[32mPASS[0m in 0.14s]
[0m21:18:11.506554 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m21:18:11.506554 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:11.506554 [debug] [Thread-4 (]: Finished running node test.takehome.not_null_patients_by_age_patient_id.0646b9206a
[0m21:18:11.506554 [debug] [Thread-2 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: ROLLBACK
[0m21:18:11.506554 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:18:11.506554 [debug] [Thread-4 (]: Began running node test.takehome.not_null_stg_lab_results_patient_id.71c57600ae
[0m21:18:11.506554 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m21:18:11.506554 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_patients_patient_id.330c5fb3d9'
[0m21:18:11.513731 [debug] [Thread-1 (]: On test.takehome.not_null_patients_per_month_month.827712360f: ROLLBACK
[0m21:18:11.513731 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"
[0m21:18:11.513731 [info ] [Thread-4 (]: 13 of 23 START test not_null_stg_lab_results_patient_id ........................ [RUN]
[0m21:18:11.513731 [debug] [Thread-2 (]: On test.takehome.not_null_patients_patient_id.330c5fb3d9: Close
[0m21:18:11.517650 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.not_null_patients_per_month_month.827712360f'
[0m21:18:11.517650 [debug] [Thread-3 (]: On test.takehome.not_null_patients_per_month_new_patients.3bbd15949c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_patients_per_month_new_patients.3bbd15949c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select new_patients
from "takehome"."dev_silver"."patients_per_month"
where new_patients is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.517650 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patients_by_age_patient_id.0646b9206a, now test.takehome.not_null_stg_lab_results_patient_id.71c57600ae)
[0m21:18:11.519388 [debug] [Thread-1 (]: On test.takehome.not_null_patients_per_month_month.827712360f: Close
[0m21:18:11.519388 [debug] [Thread-4 (]: Began compiling node test.takehome.not_null_stg_lab_results_patient_id.71c57600ae
[0m21:18:11.519388 [info ] [Thread-2 (]: 10 of 23 PASS not_null_patients_patient_id ..................................... [[32mPASS[0m in 0.14s]
[0m21:18:11.531868 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m21:18:11.531868 [debug] [Thread-4 (]: Writing injected SQL for node "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"
[0m21:18:11.523388 [info ] [Thread-1 (]: 11 of 23 PASS not_null_patients_per_month_month ................................ [[32mPASS[0m in 0.13s]
[0m21:18:11.531868 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_patients_patient_id.330c5fb3d9
[0m21:18:11.531868 [debug] [Thread-3 (]: On test.takehome.not_null_patients_per_month_new_patients.3bbd15949c: ROLLBACK
[0m21:18:11.531868 [debug] [Thread-1 (]: Finished running node test.takehome.not_null_patients_per_month_month.827712360f
[0m21:18:11.539268 [debug] [Thread-2 (]: Began running node test.takehome.not_null_stg_lab_results_test_id.298faf8b41
[0m21:18:11.540078 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.not_null_patients_per_month_new_patients.3bbd15949c'
[0m21:18:11.540078 [debug] [Thread-1 (]: Began running node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m21:18:11.540078 [debug] [Thread-4 (]: Began executing node test.takehome.not_null_stg_lab_results_patient_id.71c57600ae
[0m21:18:11.540078 [debug] [Thread-3 (]: On test.takehome.not_null_patients_per_month_new_patients.3bbd15949c: Close
[0m21:18:11.540078 [info ] [Thread-2 (]: 14 of 23 START test not_null_stg_lab_results_test_id ........................... [RUN]
[0m21:18:11.540078 [info ] [Thread-1 (]: 15 of 23 START test not_null_stg_orders_order_id ............................... [RUN]
[0m21:18:11.551964 [debug] [Thread-4 (]: Writing runtime sql for node "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"
[0m21:18:11.551964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patients_patient_id.330c5fb3d9, now test.takehome.not_null_stg_lab_results_test_id.298faf8b41)
[0m21:18:11.551964 [info ] [Thread-3 (]: 12 of 23 PASS not_null_patients_per_month_new_patients ......................... [[32mPASS[0m in 0.10s]
[0m21:18:11.551964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patients_per_month_month.827712360f, now test.takehome.not_null_stg_orders_order_id.81cfe2fe64)
[0m21:18:11.556235 [debug] [Thread-2 (]: Began compiling node test.takehome.not_null_stg_lab_results_test_id.298faf8b41
[0m21:18:11.556235 [debug] [Thread-3 (]: Finished running node test.takehome.not_null_patients_per_month_new_patients.3bbd15949c
[0m21:18:11.556235 [debug] [Thread-1 (]: Began compiling node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m21:18:11.564814 [debug] [Thread-2 (]: Writing injected SQL for node "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"
[0m21:18:11.564814 [debug] [Thread-3 (]: Began running node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m21:18:11.564814 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"
[0m21:18:11.573304 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:18:11.575324 [info ] [Thread-3 (]: 16 of 23 START test not_null_stg_patients_patient_id ........................... [RUN]
[0m21:18:11.577336 [debug] [Thread-4 (]: On test.takehome.not_null_stg_lab_results_patient_id.71c57600ae: BEGIN
[0m21:18:11.577336 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_patients_per_month_new_patients.3bbd15949c, now test.takehome.not_null_stg_patients_patient_id.e578180344)
[0m21:18:11.577336 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:18:11.577336 [debug] [Thread-2 (]: Began executing node test.takehome.not_null_stg_lab_results_test_id.298faf8b41
[0m21:18:11.577336 [debug] [Thread-3 (]: Began compiling node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m21:18:11.581571 [debug] [Thread-2 (]: Writing runtime sql for node "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"
[0m21:18:11.581571 [debug] [Thread-1 (]: Began executing node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m21:18:11.581571 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m21:18:11.594027 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m21:18:11.594027 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:18:11.598080 [debug] [Thread-4 (]: Using duckdb connection "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"
[0m21:18:11.598080 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"
[0m21:18:11.598080 [debug] [Thread-4 (]: On test.takehome.not_null_stg_lab_results_patient_id.71c57600ae: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_lab_results_patient_id.71c57600ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_staging"."stg_lab_results"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.598080 [debug] [Thread-2 (]: On test.takehome.not_null_stg_lab_results_test_id.298faf8b41: BEGIN
[0m21:18:11.598080 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:18:11.598080 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:18:11.598080 [debug] [Thread-3 (]: Began executing node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m21:18:11.605847 [debug] [Thread-1 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m21:18:11.609722 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m21:18:11.609722 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m21:18:11.609722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:11.609722 [debug] [Thread-2 (]: Using duckdb connection "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"
[0m21:18:11.609722 [debug] [Thread-2 (]: On test.takehome.not_null_stg_lab_results_test_id.298faf8b41: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_lab_results_test_id.298faf8b41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select test_id
from "takehome"."dev_staging"."stg_lab_results"
where test_id is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.614908 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m21:18:11.615573 [debug] [Thread-3 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: BEGIN
[0m21:18:11.615573 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:18:11.615573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:11.615573 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"
[0m21:18:11.615573 [debug] [Thread-1 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "takehome"."dev_staging"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.619305 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m21:18:11.619305 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.not_null_stg_patients_patient_id.e578180344"
[0m21:18:11.621315 [debug] [Thread-3 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_patients_patient_id.e578180344"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select patient_id
from "takehome"."dev_staging"."stg_patients"
where patient_id is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.622899 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m21:18:11.622899 [debug] [Thread-1 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m21:18:11.622899 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.not_null_stg_orders_order_id.81cfe2fe64'
[0m21:18:11.622899 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m21:18:11.622899 [debug] [Thread-1 (]: On test.takehome.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m21:18:11.622899 [debug] [Thread-3 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: ROLLBACK
[0m21:18:11.622899 [info ] [Thread-1 (]: 15 of 23 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.07s]
[0m21:18:11.630976 [debug] [Thread-1 (]: Finished running node test.takehome.not_null_stg_orders_order_id.81cfe2fe64
[0m21:18:11.630976 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.not_null_stg_patients_patient_id.e578180344'
[0m21:18:11.630976 [debug] [Thread-1 (]: Began running node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m21:18:11.630976 [debug] [Thread-3 (]: On test.takehome.not_null_stg_patients_patient_id.e578180344: Close
[0m21:18:11.630976 [info ] [Thread-1 (]: 17 of 23 START test not_null_stg_visits_visit_id ............................... [RUN]
[0m21:18:11.630976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_stg_orders_order_id.81cfe2fe64, now test.takehome.not_null_stg_visits_visit_id.a2f537804c)
[0m21:18:11.630976 [info ] [Thread-3 (]: 16 of 23 PASS not_null_stg_patients_patient_id ................................. [[32mPASS[0m in 0.05s]
[0m21:18:11.636991 [debug] [Thread-1 (]: Began compiling node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m21:18:11.636991 [debug] [Thread-3 (]: Finished running node test.takehome.not_null_stg_patients_patient_id.e578180344
[0m21:18:11.643490 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m21:18:11.648153 [debug] [Thread-3 (]: Began running node test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b
[0m21:18:11.652179 [debug] [Thread-1 (]: Began executing node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m21:18:11.650165 [info ] [Thread-3 (]: 18 of 23 START test unique_patient_risk_flags_patient_id ....................... [RUN]
[0m21:18:11.657836 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m21:18:11.659851 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_stg_patients_patient_id.e578180344, now test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b)
[0m21:18:11.659851 [debug] [Thread-3 (]: Began compiling node test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b
[0m21:18:11.682941 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"
[0m21:18:11.684780 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m21:18:11.684780 [debug] [Thread-1 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: BEGIN
[0m21:18:11.684780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:11.689296 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m21:18:11.689296 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.not_null_stg_visits_visit_id.a2f537804c"
[0m21:18:11.689296 [debug] [Thread-1 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.not_null_stg_visits_visit_id.a2f537804c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select visit_id
from "takehome"."dev_staging"."stg_visits"
where visit_id is null



  
  
      
    ) dbt_internal_test
[0m21:18:11.689296 [debug] [Thread-3 (]: Began executing node test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b
[0m21:18:11.696258 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"
[0m21:18:11.698499 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m21:18:11.698499 [debug] [Thread-1 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: ROLLBACK
[0m21:18:11.698499 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.not_null_stg_visits_visit_id.a2f537804c'
[0m21:18:11.698499 [debug] [Thread-1 (]: On test.takehome.not_null_stg_visits_visit_id.a2f537804c: Close
[0m21:18:11.698499 [info ] [Thread-1 (]: 17 of 23 PASS not_null_stg_visits_visit_id ..................................... [[32mPASS[0m in 0.07s]
[0m21:18:11.706265 [debug] [Thread-1 (]: Finished running node test.takehome.not_null_stg_visits_visit_id.a2f537804c
[0m21:18:11.706265 [debug] [Thread-1 (]: Began running node test.takehome.unique_patients_by_age_patient_id.56061819f5
[0m21:18:11.706265 [info ] [Thread-1 (]: 19 of 23 START test unique_patients_by_age_patient_id .......................... [RUN]
[0m21:18:11.706265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.not_null_stg_visits_visit_id.a2f537804c, now test.takehome.unique_patients_by_age_patient_id.56061819f5)
[0m21:18:11.712876 [debug] [Thread-1 (]: Began compiling node test.takehome.unique_patients_by_age_patient_id.56061819f5
[0m21:18:11.718874 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.unique_patients_by_age_patient_id.56061819f5"
[0m21:18:11.722935 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"
[0m21:18:11.722935 [debug] [Thread-3 (]: On test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b: BEGIN
[0m21:18:11.722935 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:11.722935 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m21:18:11.722935 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"
[0m21:18:11.722935 [debug] [Thread-3 (]: On test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_silver"."patient_risk_flags"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:18:11.731329 [debug] [Thread-1 (]: Began executing node test.takehome.unique_patients_by_age_patient_id.56061819f5
[0m21:18:11.739965 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.unique_patients_by_age_patient_id.56061819f5"
[0m21:18:11.744524 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m21:18:11.744524 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.unique_patients_by_age_patient_id.56061819f5"
[0m21:18:11.744524 [debug] [Thread-1 (]: On test.takehome.unique_patients_by_age_patient_id.56061819f5: BEGIN
[0m21:18:11.747738 [debug] [Thread-3 (]: On test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b: ROLLBACK
[0m21:18:11.747738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:11.747738 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b'
[0m21:18:11.754077 [debug] [Thread-3 (]: On test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b: Close
[0m21:18:11.759065 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m21:18:11.759065 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.unique_patients_by_age_patient_id.56061819f5"
[0m21:18:11.756025 [info ] [Thread-3 (]: 18 of 23 PASS unique_patient_risk_flags_patient_id ............................. [[32mPASS[0m in 0.10s]
[0m21:18:11.759065 [debug] [Thread-1 (]: On test.takehome.unique_patients_by_age_patient_id.56061819f5: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_patients_by_age_patient_id.56061819f5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_silver"."patients_by_age"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:18:11.762624 [debug] [Thread-3 (]: Finished running node test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b
[0m21:18:11.764455 [debug] [Thread-3 (]: Began running node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m21:18:11.766333 [info ] [Thread-3 (]: 20 of 23 START test unique_patients_patient_id ................................. [RUN]
[0m21:18:11.768348 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.unique_patient_risk_flags_patient_id.62c2bb9e2b, now test.takehome.unique_patients_patient_id.8d0f9eb60a)
[0m21:18:11.770361 [debug] [Thread-3 (]: Began compiling node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m21:18:11.783339 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m21:18:11.783339 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m21:18:11.789369 [debug] [Thread-1 (]: On test.takehome.unique_patients_by_age_patient_id.56061819f5: ROLLBACK
[0m21:18:11.792037 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.unique_patients_by_age_patient_id.56061819f5'
[0m21:18:11.794054 [debug] [Thread-1 (]: On test.takehome.unique_patients_by_age_patient_id.56061819f5: Close
[0m21:18:11.796326 [debug] [Thread-3 (]: Began executing node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m21:18:11.794054 [info ] [Thread-1 (]: 19 of 23 PASS unique_patients_by_age_patient_id ................................ [[32mPASS[0m in 0.09s]
[0m21:18:11.803291 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m21:18:11.806047 [debug] [Thread-1 (]: Finished running node test.takehome.unique_patients_by_age_patient_id.56061819f5
[0m21:18:11.806047 [debug] [Thread-1 (]: Began running node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m21:18:11.806047 [info ] [Thread-1 (]: 21 of 23 START test unique_stg_orders_order_id ................................. [RUN]
[0m21:18:11.806047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.unique_patients_by_age_patient_id.56061819f5, now test.takehome.unique_stg_orders_order_id.e3b841c71a)
[0m21:18:11.806047 [debug] [Thread-1 (]: Began compiling node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m21:18:11.815871 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m21:18:11.817826 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m21:18:11.817826 [debug] [Thread-3 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: BEGIN
[0m21:18:11.817826 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:11.820042 [debug] [Thread-1 (]: Began executing node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m21:18:11.823598 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m21:18:11.823598 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m21:18:11.823598 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_patients_patient_id.8d0f9eb60a"
[0m21:18:11.829871 [debug] [Thread-3 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_patients_patient_id.8d0f9eb60a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_bronze"."patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:18:11.830815 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m21:18:11.830815 [debug] [Thread-1 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m21:18:11.830815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:11.830815 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:18:11.838442 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m21:18:11.839277 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.unique_stg_orders_order_id.e3b841c71a"
[0m21:18:11.839277 [debug] [Thread-1 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "takehome"."dev_staging"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:18:11.842949 [debug] [Thread-3 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: ROLLBACK
[0m21:18:11.842949 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.unique_patients_patient_id.8d0f9eb60a'
[0m21:18:11.842949 [debug] [Thread-3 (]: On test.takehome.unique_patients_patient_id.8d0f9eb60a: Close
[0m21:18:11.847212 [info ] [Thread-3 (]: 20 of 23 PASS unique_patients_patient_id ....................................... [[32mPASS[0m in 0.08s]
[0m21:18:11.849442 [debug] [Thread-3 (]: Finished running node test.takehome.unique_patients_patient_id.8d0f9eb60a
[0m21:18:11.849442 [debug] [Thread-3 (]: Began running node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m21:18:11.849442 [info ] [Thread-3 (]: 22 of 23 START test unique_stg_patients_patient_id ............................. [RUN]
[0m21:18:11.849442 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.takehome.unique_patients_patient_id.8d0f9eb60a, now test.takehome.unique_stg_patients_patient_id.8907d3ccf0)
[0m21:18:11.854949 [debug] [Thread-3 (]: Began compiling node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m21:18:11.854949 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m21:18:11.862280 [debug] [Thread-3 (]: Writing injected SQL for node "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m21:18:11.867734 [debug] [Thread-1 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m21:18:11.867734 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.unique_stg_orders_order_id.e3b841c71a'
[0m21:18:11.867734 [debug] [Thread-1 (]: On test.takehome.unique_stg_orders_order_id.e3b841c71a: Close
[0m21:18:11.872524 [info ] [Thread-1 (]: 21 of 23 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.06s]
[0m21:18:11.873538 [debug] [Thread-1 (]: Finished running node test.takehome.unique_stg_orders_order_id.e3b841c71a
[0m21:18:11.873538 [debug] [Thread-1 (]: Began running node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m21:18:11.876680 [info ] [Thread-1 (]: 23 of 23 START test unique_stg_visits_visit_id ................................. [RUN]
[0m21:18:11.876680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.takehome.unique_stg_orders_order_id.e3b841c71a, now test.takehome.unique_stg_visits_visit_id.17a0c34d8d)
[0m21:18:11.876680 [debug] [Thread-1 (]: Began compiling node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m21:18:11.881631 [debug] [Thread-1 (]: Writing injected SQL for node "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m21:18:11.881631 [debug] [Thread-3 (]: Began executing node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m21:18:11.890109 [debug] [Thread-3 (]: Writing runtime sql for node "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m21:18:11.892976 [debug] [Thread-1 (]: Began executing node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m21:18:11.896996 [debug] [Thread-1 (]: Writing runtime sql for node "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m21:18:11.898538 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m21:18:11.898538 [debug] [Thread-3 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: BEGIN
[0m21:18:11.901212 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:18:11.903225 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m21:18:11.904721 [debug] [Thread-1 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: BEGIN
[0m21:18:11.906790 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m21:18:11.906790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:18:11.906790 [debug] [Thread-3 (]: Using duckdb connection "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"
[0m21:18:11.906790 [debug] [Thread-3 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_stg_patients_patient_id.8907d3ccf0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "takehome"."dev_staging"."stg_patients"
where patient_id is not null
group by patient_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:18:11.913611 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m21:18:11.915117 [debug] [Thread-1 (]: Using duckdb connection "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"
[0m21:18:11.915117 [debug] [Thread-1 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: /* {"app": "dbt", "dbt_version": "1.10.15", "profile_name": "takehome", "target_name": "dev", "node_id": "test.takehome.unique_stg_visits_visit_id.17a0c34d8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    visit_id as unique_field,
    count(*) as n_records

from "takehome"."dev_staging"."stg_visits"
where visit_id is not null
group by visit_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:18:11.915117 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m21:18:11.925392 [debug] [Thread-3 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: ROLLBACK
[0m21:18:11.925392 [debug] [Thread-3 (]: Failed to rollback 'test.takehome.unique_stg_patients_patient_id.8907d3ccf0'
[0m21:18:11.925392 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m21:18:11.930975 [debug] [Thread-3 (]: On test.takehome.unique_stg_patients_patient_id.8907d3ccf0: Close
[0m21:18:11.932015 [debug] [Thread-1 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: ROLLBACK
[0m21:18:11.932015 [debug] [Thread-1 (]: Failed to rollback 'test.takehome.unique_stg_visits_visit_id.17a0c34d8d'
[0m21:18:11.932015 [debug] [Thread-1 (]: On test.takehome.unique_stg_visits_visit_id.17a0c34d8d: Close
[0m21:18:11.932015 [info ] [Thread-3 (]: 22 of 23 PASS unique_stg_patients_patient_id ................................... [[32mPASS[0m in 0.08s]
[0m21:18:11.939124 [debug] [Thread-3 (]: Finished running node test.takehome.unique_stg_patients_patient_id.8907d3ccf0
[0m21:18:11.939124 [info ] [Thread-1 (]: 23 of 23 PASS unique_stg_visits_visit_id ....................................... [[32mPASS[0m in 0.06s]
[0m21:18:11.939124 [debug] [Thread-1 (]: Finished running node test.takehome.unique_stg_visits_visit_id.17a0c34d8d
[0m21:18:18.569106 [debug] [Thread-4 (]: SQL status: OK in 6.971 seconds
[0m21:18:18.593682 [debug] [Thread-2 (]: SQL status: OK in 6.991 seconds
[0m21:18:18.628087 [debug] [Thread-4 (]: On test.takehome.not_null_stg_lab_results_patient_id.71c57600ae: ROLLBACK
[0m21:18:18.628087 [debug] [Thread-4 (]: Failed to rollback 'test.takehome.not_null_stg_lab_results_patient_id.71c57600ae'
[0m21:18:18.628087 [debug] [Thread-4 (]: On test.takehome.not_null_stg_lab_results_patient_id.71c57600ae: Close
[0m21:18:18.628087 [info ] [Thread-4 (]: 13 of 23 PASS not_null_stg_lab_results_patient_id .............................. [[32mPASS[0m in 7.11s]
[0m21:18:18.642061 [debug] [Thread-4 (]: Finished running node test.takehome.not_null_stg_lab_results_patient_id.71c57600ae
[0m21:18:18.642061 [debug] [Thread-2 (]: On test.takehome.not_null_stg_lab_results_test_id.298faf8b41: ROLLBACK
[0m21:18:18.642061 [debug] [Thread-2 (]: Failed to rollback 'test.takehome.not_null_stg_lab_results_test_id.298faf8b41'
[0m21:18:18.658465 [debug] [Thread-2 (]: On test.takehome.not_null_stg_lab_results_test_id.298faf8b41: Close
[0m21:18:18.658465 [info ] [Thread-2 (]: 14 of 23 PASS not_null_stg_lab_results_test_id ................................. [[32mPASS[0m in 7.11s]
[0m21:18:18.666613 [debug] [Thread-2 (]: Finished running node test.takehome.not_null_stg_lab_results_test_id.298faf8b41
[0m21:18:18.674812 [debug] [MainThread]: Using duckdb connection "master"
[0m21:18:18.674812 [debug] [MainThread]: On master: BEGIN
[0m21:18:18.683325 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:18:18.691920 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m21:18:18.695540 [debug] [MainThread]: On master: COMMIT
[0m21:18:18.695540 [debug] [MainThread]: Using duckdb connection "master"
[0m21:18:18.700032 [debug] [MainThread]: On master: COMMIT
[0m21:18:18.700032 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m21:18:18.700032 [debug] [MainThread]: On master: Close
[0m21:18:18.708354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:18:18.710492 [debug] [MainThread]: Connection 'list_takehome_dev_silver' was properly closed.
[0m21:18:18.713733 [debug] [MainThread]: Connection 'list_takehome_dev_staging' was properly closed.
[0m21:18:18.713733 [debug] [MainThread]: Connection 'list_takehome_dev_bronze' was properly closed.
[0m21:18:18.713733 [debug] [MainThread]: Connection 'test.takehome.unique_stg_visits_visit_id.17a0c34d8d' was properly closed.
[0m21:18:18.713733 [debug] [MainThread]: Connection 'test.takehome.not_null_stg_lab_results_test_id.298faf8b41' was properly closed.
[0m21:18:18.713733 [debug] [MainThread]: Connection 'test.takehome.unique_stg_patients_patient_id.8907d3ccf0' was properly closed.
[0m21:18:18.713733 [debug] [MainThread]: Connection 'test.takehome.not_null_stg_lab_results_patient_id.71c57600ae' was properly closed.
[0m21:18:18.721686 [info ] [MainThread]: 
[0m21:18:18.721686 [info ] [MainThread]: Finished running 1 project hook, 23 data tests in 0 hours 0 minutes and 7.82 seconds (7.82s).
[0m21:18:18.737362 [debug] [MainThread]: Command end result
[0m21:18:18.861325 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\manifest.json
[0m21:18:18.861325 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\semantic_manifest.json
[0m21:18:18.901428 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\usuario\Downloads\implementation-take-home-test-main (1) (1)\implementation-take-home-test-main\target\run_results.json
[0m21:18:18.901428 [info ] [MainThread]: 
[0m21:18:18.901428 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:18:18.901428 [info ] [MainThread]: 
[0m21:18:18.901428 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=24
[0m21:18:18.917480 [debug] [MainThread]: Command `dbt test` succeeded at 21:18:18.917480 after 9.48 seconds
[0m21:18:18.917480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7726EB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7726F260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027D7726F560>]}
[0m21:18:18.917480 [debug] [MainThread]: Flushing usage events
[0m21:18:23.038043 [debug] [MainThread]: An error was encountered while trying to flush usage events
